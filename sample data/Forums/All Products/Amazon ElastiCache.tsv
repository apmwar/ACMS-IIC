label	description
Amazon Elasticache	"ElastiCache | Restricting some users to perform GET operation only
We've a requirement where data will be written to ElastiCache with one specifc user where as other users can only READ data using GET.

In the Actions of ElastiCache didn't find any documentation related to this. 
1. Is there such support exists?
2. If Yes, please point to documentation or a sample example?

User A **** PUT key=>Value (succeed)
User B **** GET key ==> Value (Succeed)
User B **** PUT key=>value2 (Authorization Failure).

In this scenario, I need ""User B"" to be readOnly."
Amazon Elasticache	"Re: ElastiCache | Restricting some users to perform GET operation only
While researching found below reference which guided me to use Replication and restrict other users by pointing to ReplicaUrl.
https://stackoverflow.com/questions/26226861/solutions-for-a-secure-distributed-cache

1. Is this the correct way of doing?
2. If it correct way,  it solves for One User Writing and Others are Reading. However, When We've few users where they need to write and specific users should read only part.
  A -> Write <-Read<- C
  B -> Write <-Read<- D
In this case A&B should Write where as C&D can read. If I need to make C to Read what A has written and D to Read what B has written instead of creating new cluster.

What's the correct way of handling? Using Sharding We can partition. Can We restrict shard clusters to specific users?"
Amazon Elasticache	"setting key using PHP
I am able to connect to my elasticache cluster like so:
$awsElasticache = new ElastiCacheClient(CredentialProvider::atsDefaultConfigConstructor(false, false));
$clusterResult = $awsElasticache->describeCacheClusters(array('CacheClusterId'=>'my_cluster'));


When I print $clusterResult
, I get info about the cluster, good.

But how can I actually interact with the endpoint to set key/value pairs?

I am trying this without success:
 $this->mem = new Memcached();
$this->mem->addServer($this->endPoint,11211);
$this->mem->set('myKey','myValue',3600);
$result = $this->mem->get('myKey');
echo $result;


I get nothing printed from $result
.
I am confused about which object to use to set and get key/value pairs.

Do I have to install the Elasticache PHP client?

Edited by: infosys-admin on Mar 8, 2019 11:39 AM"
Amazon Elasticache	"Redis evicting almost all keys from cache in LRU
We have an application that makes use of a Redis AWS Elasticache instance for speeding up data access by the application. In it, we are storing data that is frequently used by this application. Since we don’t expect all data to fit in available Redis memory, we are attempting to use LRU technique in order to keep the most relevant data in cache, while evicting data that is less relevant when we reach a max memory event. We are using allkeys-lru for maxmemory-policy (and default value of 3 for maxmemory-samples), and none of the keys are set with a TTL.

We are observing some odd behavior with the LRU evictions. While keys are being evicted in max memory events, the algorithm is very aggressive and evicts almost all of the data in memory. While the eviction begins on a steady pace, it starts ramping up very quickly (much faster than the rate of SET operations) and leaves the memory with only a small fraction of the original items (see images with Elsaticache graphs below).

Eviction rate ramp up: https://i.stack.imgur.com/G20a6.png

Evicted items: https://i.stack.imgur.com/kvjLH.png

After this ""eviction event"" ends, evictions come to a complete stop. The cycle then repeats itself once the server hits max memory again - on average once every 24 hours. The problem with this is that while this ""mass eviction"" event is underway, Redis performance is severely compromised and response times suffer significantly. Plus, it has no relevant data to offer until the caches rebuilds. Another problem with these eviction events is that all of the replicas become completely unresponsive to queries while they are underway - effectively preventing their use.

So my questions are:


Why do we see this ramp-up in eviction rate once evictions start?
Is there a way to configure Redis so that the eviction rate is comparable with the set rate, so that the flow of keys coming in and out are equal?
Why do the replicas became unresponsive when eviction events occur?


The Redis version being used is 2.8.24. Any help or insight is highly appreciated."
Amazon Elasticache	"Can't connect to ElastiCache Redis from EB Amazon EC2 Instance
I can connect to an ElastiCache Redis cluster without a password but not one with a password (Redis AUTH i.e. with the ""-a PASSWORD"" redis-cli option) using the redis cli from the EC2 instance (ssh'd in, following https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/GettingStarted.ConnectToCacheNode.html) it gives me a
Error: Connection timed out


Weirdly enough telnetting into the cluster
telnet master.....cache.amazonaws.com 6379

works but I can't run any Redis commands"
Amazon Elasticache	"Re: Can't connect to ElastiCache Redis from EB Amazon EC2 Instance
Hello,

You need to authorize the access to your redis. Here is a link to help with that:
https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/GettingStarted.AuthorizeAccess.html

Ciao"
Amazon Elasticache	"Re: Can't connect to ElastiCache Redis from EB Amazon EC2 Instance
Hi There,
Try with this command:
openssl s_client -connect <NodeEndpoint>:<Redis Port>
Then in that shell run:
AUTH <Password>

Then try to run the commands (SET and GET) and let us know if this works.
Looking forward to the reply

Edited by: SatyamSinha-AWS on Feb 27, 2019 11:06 PM"
Amazon Elasticache	"How to debug error message re: snapshots without access to Redis logs
I just started getting this error on my staging application server:

22:41:05 [INFO] [ERROR]: ERR MISCONF Redis is configured to save RDB snapshots, but it is currently not able to persist on disk. Commands that may modify the data set are disabled, because this instance is configured to report errors during writes if RDB snapshotting fails (stop-writes-on-bgsave-error option). Please check the Redis logs for details about the RDB error.


I haven't had an problems with Redis recently and I haven't changed anything in the app related to Redis or in Elasticache. Is there a way to see the Redis logs, or another way to figure out what's behind this error?"
Amazon Elasticache	"Re: How to debug error message re: snapshots without access to Redis logs
It turned out this error was NOT from an ElastiCache Redis server, but from a Redis server spun up in the Docker image of a service that the application was dependent on (Faktory, a background job runner). The Redis error message was just propagated up from the service to the app."
Amazon Elasticache	"Redis - Recovering cache nodes leads to data loss
Hello, we lost all our Redis data and found these events in our Redis:
cache-cluster | Monday, January 7, 2019 at 7:24:37 AM UTC+1 | Finished recovery for cache nodes 0001
cache-cluster | Monday, January 7, 2019 at 7:18:34 AM UTC+1 | Recovering cache nodes 0001
cache-cluster | Monday, January 7, 2019 at 7:13:13 AM UTC+1 | Recovering cache nodes 0001


According to FAQ (Q: How does Amazon ElastiCache respond to node failure? https://aws.amazon.com/elasticache/faqs/):
The service will detect the node failure and react with the following automatic steps: Amazon ElastiCache will repair the node by acquiring new service resources, and will then redirect the node's existing DNS name to point to the new service resources. For VPC installations, ElastiCache will ensure that both the DNS name and the IP address of the node remain the same when nodes are recovered in case of failure. For non-VPC installations, ElastiCache will ensure that the DNS name of a node is unchanged; however, the underlying IP address of the node can change.

Is there some way to:
Find out what happened to our Redis node?
Prevent similar failure and data loss in future?

Eg. Do you recommend us to configure minimum of 2 replica nodes in the cluster with multi-az and automatic failover enabled?

Thanks"
Amazon Elasticache	"Re: Redis - Recovering cache nodes leads to data loss
Hello,

Could you please provide your account id, replication group id and region of the cluster so that we can investigate the issue.

Thank you."
Amazon Elasticache	"Re: Redis - Recovering cache nodes leads to data loss
Hello, our account ID is 571673159240, we do not have replication group and availability zone is eu-west-1a.

Martin"
Amazon Elasticache	"Where is Amazon Elasticache Cluster Client Support For PHP 7.2?
Hello,

Wondering if theres any news or timeline for the Amazon Elasticache Cluster Client for PHP to be offered by Amazon with support PHP 7.2? 

Only the binaries for PHP 7.0 have been available for sometime now... Seems like it'd be much easier to have downloadable or under amazon-linux-extras."
Amazon Elasticache	"Re: Where is Amazon Elasticache Cluster Client Support For PHP 7.2?
Hi There,
I have forwarded the query to our Elasticache team.

For now, you need to compile the library using the steps on the github link
https://github.com/awslabs/aws-elasticache-cluster-client-memcached-for-php

I saw that it has worked for a lot of people."
Amazon Elasticache	"[PHP] libmemcached errors when increasing from 1 to n nodes in cluster
Questions:
1. Has anyone seen intermittent ""SERVER HAS FAILED AND IS DISABLED UNTIL TIMED RETRY"" in PHP only when using a multi-node cluster? See below for our background.
2. Are there any plans to upgrade the AWS libmemcached fork (https://github.com/awslabs/aws-elasticache-cluster-client-libmemcached) to libmemcached 1.0.18+?

Issue and Background
We have an API environment running PHP inside ElasticBeanstalk and connecting to a memcached Elasticache cluster. We recently increased the size of our Elasticache cluster from 1 to 4 nodes. Everything works fine most of the time (even under what is relatively heavy load for us) but consistently every morning we get a flood of errors when writing to memcache. Mostly we get 'SERVER HAS FAILED AND IS DISABLED UNTIL TIMED RETRY' (result code 47) but we also get a few 'NO SERVERS DEFINED' (result code 20). Things seem to work fine throughout the day but this happens like clockwork at 7-8 AM EST for a couple of minutes. 

Looking around for related issues I found https://github.com/php-memcached-dev/php-memcached/issues/128 which seems possibly related (at least to the extent that these errors happen in strange situations on these older versions of libmemcached).

Beyond that, since there's no reason this should happen regularly, I have 2 thoughts:
1. There's something about the usage pattern of our API instances that changes around this time. Perhaps the number of connections to Elasticache increases in the morning as traffic inreases after things have been mostly quiet overnight and something about this is causing an error in the underlying libmemcached library. Nothing seems abnormal about the requests (and subsequent cache sets) which seem to trigger these errors and, again, I only see them in the morning. This morning I was able to see an increase in current connections to the nodes in the Elasticache cluster at the time of the errors, but that has not always been the case for other times that we've seen the errors. 

2. Because we haven't seen these errors on days where we have had more consistent overnight traffic (which for us is mostly on weekends), my other thought is that there is some issue when doing a set on a key that has expired. The rationale for that is that some of these keys would expire overnight with lower traffic volume. 


Version/Usage info:
PHP: 5.4
AWS's libmemcached: 1.0.4
AWS's memcached PECL extension: 2.1.0
Elasticache engine version: 1.4.14

We're initializing using the configuration endpoint for our host and using the dynamic client mode for auto discovery:
$memcached->setOption(Memcached::OPT_CLIENT_MODE, Memcached::DYNAMIC_CLIENT_MODE);
$memcached->addServer(MEMCACHED_HOST, MEMCACHED_PORT);


My Next Steps
1. We are on a slightly older version of the AWS libmemcached fork (1.0.4) because the ""latest"" compiled client library that's linked from the console hasn't updated yet. I'll build the Elasticache client manually to get libmemcached 1.0.8 and deploy those to an environment today for testing overnight.
2. I still haven't been able to reproduce this so I'm going to try to get some small repro case to help isolate the issue.

Any other ideas?

Thanks!"
Amazon Elasticache	"Re: [PHP] libmemcached errors when increasing from 1 to n nodes in cluster
I'm having almost an identical issue with my production cluster of 6 nodes, except it doesn't seem to have a predictable time period that it occurs. The load varies between around 400k calls-per-minute to 900k calls-per-minute, but the outage times don't match up with high volume periods. I have premium support but the case agent was unable to help, claiming they were not aware of anything that would cause such an error.

Were you able to get anywhere with this issue?"
Amazon Elasticache	"Re: [PHP] libmemcached errors when increasing from 1 to n nodes in cluster
Daryl,

We did not solve the issue we did but we: 
1. Started using mcrouter from facebook in front of our elasticache clusters (github.com/facebook/mcrouter and https://code.facebook.com/posts/296442737213493/introducing-mcrouter-a-memcached-protocol-router-for-scaling-memcached-deployments/).
2. Ditched the elasticache cluster client (since our clusters are managed by mcrouter now) and upgraded to the latest libmemcached as a result

Mcrouter does not have any kind of autodiscovery but it would be possible to make your config dynamic if you really needed that. In practice though, we don't change our clusters that often so it's not a huge deal. Mcrouter primarily solved issues that we have had in the past with cache clusters getting destroyed because of too many concurrent connections, but it also has given us a lot of flexibility in how we use cache clusters (replication, routing, failover when a node gives mysterious errors like the ones above, etc.)."
Amazon Elasticache	"Re: [PHP] libmemcached errors when increasing from 1 to n nodes in cluster
+1 Same issue, with 2 nodes in cluster. Consistently receive ""NO SERVERS DEFINED"" when autodiscovery is turned on.

Version/Usage info:
PHP: 7.0.17
AWS's libmemcached: 1.0.18
Elasticache engine version: 1.4.33"
Amazon Elasticache	"Re: [PHP] libmemcached errors when increasing from 1 to n nodes in cluster
Just ran into this ourselves unfort.
3 cache.t2.small nodes in the cluster

Hasn't happened in 3+ years of using ElastiCache; don't fully know where to begin with this.
After it (self) recovered, one of the instances lost all it's items (which was fine, since the source exists)."
Amazon Elasticache	"Cannot connect to redis from anyehere.
I created a redis replicated group with 2 nodes, and another standalone instance.

I cannot connect to the Redis port 6379 from any EC2 instance, or from the outside.
This goes for the replicated group endpoint and the standalone instance.

I've tried changing the security to groups from 'default' to one that accepts connections to 6379 from 0.0.0.0./0

Not sure what I am missing.

I've looked at the other Questions but cannot find what I might be missing.

Thanks"
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
Hi,

An Amazon EC2 instance can connect to a cache node only if you have authorized it to do so. For more information, see: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.AuthorizeAccess.html. 

Once you've authorized access to the cache cluster, you can log in to an Amazon EC2 instance and connect to a node in the cache cluster.

Please also confirm if you are connecting using the redis-cli as described here: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.ConnectToCacheNode.Redis.html

Let us know the errors that you receive should this issue still persist.

I hope this helps.

-Ashley"
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
I am having the same issue... can't connect from my EC2 instance:

$ redis-cli -h skyline-cache.i7jw04.0001.use1.cache.amazonaws.com -p 6379
Could not connect to Redis at skyline-cache.i7jw04.0001.use1.cache.amazonaws.com:6379: Name or service not known
not connected>

I've added the TCP rule on port 6379 to the VPC security group... still no dice.

Edited by: _wet_paint on Mar 20, 2014 4:49 PM"
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
It just magically started working... maybe it just took some time for DNS propagation."
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
We see the same thing happening. 

We use autoscaling and when we bring up new EC2 instances, sometimes, for a long time, they won't be able to connect to the redis instance, then suddenly, they will connect? We've been trying to work it out and opened a support ticket, but the response from the AWS guys was that perhaps the node is being overwhelmed by new connections. But I can't see how 2 new nodes will overwhelm the redis instance?

Someone over IRC mentioned that they had the same issue and it was due to this:
""In this case, if the ELB uses an ephemeral port which is lower than 32768 a SYN will be sent, but the SYN-ACK coming back from the backend will be rejected by the Network ACL, 
                thus never establishing a TCP connection. The reason why some are being marked healthy is because the ephemeral port is greater than 32768. To test this, please modify the 
                Network ACL to be 1024 - 65535.""

We are currently checking if this is the cause

Edited by: winstonn on Oct 20, 2014 10:00 PM"
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
Hi Winstonn,

Today we observed exactly same issue as you described. Did you happen to find a solution that worked? Were you able to find the root cause?"
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
A few hints to troubleshoot connection issues via Elasticache.

1.  Monitoring Elasticache Events
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ECEvents.html
You can find events that can affect the connectivity from the Cache Event. For example, failover, security group modifications can affect the connections.

2. Use CloudWatch Metrics to get some insight into Elasticache Performance.
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html
Connectivity can be affected by Exceed connection, overload, memory issue. It is possible for a single instance to establish large amount of connections to Elasticahe cache node. I do recommend customers to use CloudWatch to find more information about the cluster. 

3. Check the Security groups, route tables as mentioned before
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.AuthorizeAccess.html"
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
I am having the same issue and have followed (to the best of my knowledge) all the suggested docs.

src/redis-cli -c -h omanotalk.pljgic.0001.usw2.cache.amazonaws.com -p 6379
Could not connect to Redis at omanotalk.pljgic.0001.usw2.cache.amazonaws.com:6379: Connection refused
not connected>

It almost seems that redis is not running even though AWS console shows ""available"".... what am I missing?

UPDATE: realized I had CSF firewall running - open the ports, all good. 

Edited by: wmgilligan on Dec 28, 2018 1:35 PM"
Amazon Elasticache	"Re: Cannot connect to redis from anyehere.
Great!
Have fun using Elasticache!
If you face any other issues with Elasticache, do let us know .

Happy Cloud Computing!"
Amazon Elasticache	"Cannot access website after install php-memcached-client
I have deployed a Bitnami wordpress app on Ubuntu 16.04. Website was online. After that, I created a memcached in ElastiCache instance. When I install a PHP memcached client extension to connect the wordpress to the instance, everything's ok. I followed the instruction in the official AWS website, link below:

https://aws.amazon.com/…/memcached/wordpress-with-memcached/

However, I cannot access the website after server reboot.

Besides, when I check the status via SSH, services like apache, php-fpm and mysql are still running. Then there is a notice (code below) when I stop and restart Bitnami services again. I don't know whether it's the reason for my problem or not.

My wordpress app is fresh new with factory settings and no plugins. I install the memcached client right after the deploy.

If you have any ideas please help me!

Thank you in advance!

I am just a newbie in linux as well as AWS services. I want to use memcached or redis to speed up my wordpress using W3 total cache plugin. I have google for solutions but there is none of them.

I have tried to remove the installed file (amazon-elasticache-cluster-client.so and edit php.ini back to the setting before the installation, but nothing works.)
    #the notice below:
 
    $ sudo /opt/bitnami/ctlscript.sh stop
    Syntax OK
    /opt/bitnami/apache2/scripts/ctl.sh : httpd stopped
    /opt/bitnami/php/scripts/ctl.sh : php-fpm stopped
    /opt/bitnami/mysql/scripts/ctl.sh : mysql stopped
 
    $ sudo /opt/bitnami/ctlscript.sh restart
    Syntax OK
    /opt/bitnami/apache2/scripts/ctl.sh : apache not running
    /opt/bitnami/php/scripts/ctl.sh : php-fpm not running
    /opt/bitnami/mysql/scripts/ctl.sh : mysql not running
    /opt/bitnami/mysql/scripts/ctl.sh : mysql  started at port 3306
    [01-Jan-2019 04:11:49] NOTICE: PHP message: PHP Warning:  PHP Startup: 
    memcached                                                                                                                
    : Unable to initialize module
    Module compiled with module API=20151012
    PHP    compiled with module API=20160303
    These options need to match
    in Unknown on line 0
    /opt/bitnami/php/scripts/ctl.sh : php-fpm started
    Syntax OK
    /opt/bitnami/apache2/scripts/ctl.sh : httpd started at port 80"
Amazon Elasticache	"libhiredis.so ???
Anyone know how to install libhiredis.so on an ec2 (Amazon Linux AMI) ?"
Amazon Elasticache	"Redis Connection on new launched EC2 Instances within an ELB / Load Balance
The Configuration

Elastic Beanstalk with Load Balancer (successfully running over more than 4 years in this configuration)

1 EC2 eu-west-1a
1 EC2 eu-west-1b

REDIS on eu-west-1c

It works great until i terminate a instance and the load balancer starts a new one. Then the redis connection is extremly slow on the new instance. 

eg. normal is 0.03 sec or lower
but i have 5+ seconds on the new ec2 instance. It seems that the connectin is exactly 5 seconds longer than it should be. but where can i find this error?

all i do is to terminate the ec2 instance (cause i got an mail the underlying hardware has an issue) and the load balancer starts automatically a new instance - same type same region. 

but it has this slow redis connection. im starting getting desperate ...

my testPHP Code

  $srv = Array( 'host'     => 'myhost.0001.euw1.cache.amazonaws.com',
                'port'     => 6379,
                'database' => 1
              );
  $redis= new Predis\Client($srv);
  $redis->connect();
  echo $redis->get('existingkey');"
Amazon Elasticache	"Is there an Elasticache Redis Memory leak?
Over the last 2 weeks my ""freeable memory"" has been dropping at a linear rate: http://d.pr/i/sNKH
Over that same period of time my ""bytes used for cache"" has remained constant: http://d.pr/i/TxAx
I have verified that the current memory used is under 10mb: http://d.pr/i/TmAt

I would expect there to be an inverse correlation between  ""freeable memory"" & ""bytes used for cache"".  How can I reclaim the ""freeable memory"" when it doesn't reside in redis objects?

Edited by: academicworks on Dec 4, 2013 10:47 AM

Edited by: academicworks on Dec 4, 2013 10:51 AM"
Amazon Elasticache	"Re: Is there an Elasticache Redis Memory leak?
Hello,

FreeableMemory is the memory that's being consumed by OS cache, and it will be given back when needed and nothing to worry about.

You can refer to this thread reported by forum user : https://forums.aws.amazon.com/thread.jspa?threadID=140094&tstart=0

Thanks,
Vivek"
Amazon Elasticache	"Re: Is there an Elasticache Redis Memory leak?
If Freeable Memory is nothing to worry about, why is it shown in the first place?

Also, what metric would answer the questions ""how much memory is the current data in my Redis Elasticache cluster consuming, and how much memory is left?"" Because the ""how much is left"" metric should determine when an alarm should be set / triggered to notify whoever needs to take the appropriate actions."
Amazon Elasticache	"Re: Is there an Elasticache Redis Memory leak?
Hello,

My name is Paranshu from AWS premium support.

First let me give a clear explanation of the metrics:
BytesUsedForCache - This metric gives the exact size of the data stored by redis or memcache. This metric is obtained by running info or stats command in the engines.

FreeableMemory = RAM +SWAP - ( BytesUsedForCache +  Host OS memory usage)

RAM+SWAP is constant. Therefore, if free memory is decreasing and BytesUsedForCache is constant, it means it is getting utilized by OS cache. The thing about OS cache is if free memory is there, OS likes to keep it utilized but if there is memory pressure in the machine it can also be freed by the OS to give it to other process like redis or memcache. 

Therefore, you can put a cloudwatch alarm on BytesUsedForCache if it goes above 75% of the maximum value of permissible cache size stored in the node. The values can be found here https://aws.amazon.com/elasticache/pricing/"
Amazon Elasticache	"Re: Is there an Elasticache Redis Memory leak?
Hello @singhal-aws

We use r4.large nodes that have 12,3 GiB of RAM as shown here https://aws.amazon.com/de/elasticache/pricing/

If we query Redis for stats via getClusterStatusInfo
 we get 9.22 GiB for maxmemory:

""maxmemory"": ""9901336167"",
""maxmemory_human"": ""9.22G"",


That is 75% - the value you mentioned. So is 75% of the AWS Redis nodes reserved for redis?
An alert before 75% would make more sense then or is Redis able to use more than the 75%?"
Amazon Elasticache	"Intermittent timeouts on Redis node
Hello

I am experiencing some intermittent issues with connection timeouts to my Redis node.

It's rare enough to not be a major issue, but it will give the user an error 500.

I use predis and PHP7, and my PHP error log reads: 

[Thu Sep 29 08:29:49.436355 2016] [:error] [pid 22917] [client xxx.xxx.xxx.xxx:port] Error: Connection timed out [tcp://*****.0001.euc1.cache.amazonaws.com:6379] - Code 110 - Class: Predis\\Connection\\ConnectionException


I don't believe this has something to do with Predis, but I'm not 100% sure. I don't really know how to investigate this issue. Can I look at Redis logs somewhere? The metrics don't really help me. The node is in the same region as the EC2 instances connecting to it."
Amazon Elasticache	"Re: Intermittent timeouts on Redis node
Hello,

I have checked your Redis cluster and can not find any issues at Sep 29.
The cloudwatch metrics indicated that your cluster have sufficient memory, load. [1][2]
The Elasticache Event shows that there was no failover event occured.[3]
If you want to learn more about your redis performance, you can use redis slow log[4].

I would recommend you to try conenct redis using redis-cli when you get the timeout issues[5]. This can help you to identify if there is an issue in the application.

Please also check the redis timeout configuration in your application as it usually lead to issue like it.
In addition, please also check if your client instance is running healthy when you received the timeout error. 

[1]http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.Redis.html
[2]http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html
[3]http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ECEvents.Viewing.html
[4]http://redis.io/commands/slowlog
[5]http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.ConnectToCacheNode.html

Best regards,"
Amazon Elasticache	"Re: Intermittent timeouts on Redis node
We also occasionally experience this. Same issue as described. We have DNS caching implemented, so we shouldn't be hitting VPC DNS issues. Contacted support, which also told us everything looks fine. It's concerning that there's intermittent connection issues, but no way to track them down."
Amazon Elasticache	"Re: Intermittent timeouts on Redis node
Hello, 

Even I'm also facing intermittent timeout issue when querying Redis. Anyone got solution for this issue?
Im using - Spring Data - 1.7.1.RELEASE and Jedis client - 2.9.0 

Below is exception stack trace:
org.springframework.data.redis.RedisConnectionFailureException: Cannot get Jedis connection; nested exception is redis.clients.jedis.exceptions.JedisConnectionException: Could not get a resource from the pool
at org.springframework.data.redis.connection.jedis.JedisConnectionFactory.fetchJedisConnector(JedisConnectionFactory.java:198) ~spring-data-redis-1.7.1.RELEASE.jar:na
at org.springframework.data.redis.connection.jedis.JedisConnectionFactory.getConnection(JedisConnectionFactory.java:345) ~spring-data-redis-1.7.1.RELEASE.jar:na
.......
Caused by: java.net.SocketTimeoutException: connect timed out
at java.net.PlainSocketImpl.socketConnect(Native Method) ~na:1.8.0_171
at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) ~na:1.8.0_171
at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) ~na:1.8.0_171
at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) ~na:1.8.0_171
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~na:1.8.0_171
at java.net.Socket.connect(Socket.java:589) ~na:1.8.0_171
at redis.clients.jedis.Connection.connect(Connection.java:184) ~jedis-2.9.0.jar:na

Regards,
Girish G"
Amazon Elasticache	"Potential Elasticache Redis 5.0 issue
2018-11-14T01:06:13.802Z ioredis:connection error: {""reason"":""IP: vv.xx.yy.zzz is not in the cert's list: "",""host"":""vv.xx.yy.zzz"",""cert"":{""subject"":{""CN"":""*.MY_CLUSTER.xxxxx.use1.cache.amazonaws.com""},""issuer"":{""C"":""US"",""O"":""Amazon"",""OU"":""Se ... <REDACTED full-length=""5215"">

I'm getting errors that look like the above when trying to connect to a Elasticache Redis 5.0, Cluster Mode, with In Transit encryption enabled (identifying information redacted). Is there potentially an issue with certificates?"
Amazon Elasticache	"Elasticache (redis) stuck on creating state
I have 1 elasticache (redis) clusters stuck in ""Creating"" state for at least 2-3 hours, ""Delete"" is not available. 

How can I stop these clusters and detroy the cluster, please suggest me."
Amazon Elasticache	"Elasticache connection timeouts from new client IPs and new Read Replicas.
We're running into issues w/ our new elasticache redis 4.0. New machines can't connect to it even though existing machines in the same subnet w/ an identical security group set can. We also attempted to create a new read replica via the AWS console, to test connecting to that replica, and that replica has been stuck in creating for 40+ mins (we suspect it can't connect to the primary either).

Are there documented limitations w/ having too many connections from X number of IPs? Or is this some weird bug on the elasticache side. Networking configurations (Security Groups and ACL) are 100% not the issue. We're able to open as many connections as we'd like on existing boxes, but new ones can't open any at all and timeout. It's also very confusing that the read replica created by AWS is unable to complete initialization. Any help is much appreciated.

Edited by: azq-austin on Nov 5, 2018 12:36 PM"
Amazon Elasticache	"Is there any rate limit for Elasticache for redis API's available?
Is there any rate limit for Elasticache for redis API's available?"
Amazon Elasticache	"Re: Is there any rate limit for Elasticache for redis API's available?
Hi pavand,

I hope you are doing well. The answer to this depends on what ""API"" you are referring to. Based on you sentence I will assume that you are referring to the actual calls made directly to Redis on port 6379 such as ""set"" and ""get"".

For any action on the Redis engine there are no limits at all with the exception of what the chosen cache node/cluster type can actually handle and that depends on your specific use-case. 

I hope this helps!

Phill"
Amazon Elasticache	"What is the Usage of Timestamp in Redis API?
What is the Usage of Timestamp in Redis API?"
Amazon Elasticache	"CacheSecurityGroup creation in amazon VPC
How to CreateCacheSecurityGroup when the cluster is launched in Amazon VPC? Where can in UI we can find security groups?Getting error as ""Use of cache security groups is not permitted in this API version for your account"" when created Security group through API."
Amazon Elasticache	"How can we create Redis(Cluster mode enabled) replication group through API
How can we create Redis(Cluster mode enabled) replication group through API?when we are creating Redis(cluster mode enabled) through API we are getting error as ""Cannot use the given parameters when using an existing primary cache cluster ID""."
Amazon Elasticache	"Why does Redis Elasticache (Cluster mode enabled) impose a cap of 15 shards
Hi,

While, according to Redis specification, a Redis cluster can theoretically support 16,384 masters (https://redis.io/topics/cluster-spec), why is it that AWS imposes a limit of 15 in the managed cluster (https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/Shards.html)? 

How can this be overcome if there is more data than what 15 of largest supported Elasticache (Redis) nodes can hold?

Thanks,
Sudip"
Amazon Elasticache	"Re: Why does Redis Elasticache (Cluster mode enabled) impose a cap of 15 shards
Hi Sudip, 

Thanks for using our forums!

A 15 shard cluster is actually quite large. Consider that the largest node type you can use is a cache.r4.16xlarge, this has 437021573120 of memory for your key space. In human readable numbers that's about 437GB, now throw in Redis Cluster-mode with 15 shards. This results in about 6.5 TB, this is a very large data set.

When considering caches of that scale I would first ask these questions:

Do I really need that much data in the cache at all times?
Is the cost of storing that in a cache worth the benefit that I get from it?
Can I reduce this amount of data using TTLs to expire more data out of the cache?
Can I reduce the amount of data by only storing the pieces most critical to performance in the cache?
Would using Redis as an LRU cache save me the cost but still give me the performance I need?

You would have to test to answer some of these questions. 

If your use-case does still demand more than that then open a limit increase case with us and include your use-case and how much you need. This will allow our engineers to help answer some of those questions and our service teams to cater towards your use-case. 

I hope this helps!

PhillR"
Amazon Elasticache	"High Latency Spikes in AWS Elasticache
Hi,

We have experienced high latency spikes on Get calls from Elasticache (Redis) this morning. The latency went high for a time being and now everything is normal. There isn't anything unusal in our daily traffic and no issue in logs. 

Was this an issue at AWS side or some other issue?

Our Elasticache is in singapore region, on a master-slave (no cluster mode) config of type m3.xlarge.

Thanks,
Sudip"
Amazon Elasticache	"Entire production cache wiped out during mandatory Elasticache maintenance
On Friday 10th August we received an email titled ""Scheduled Amazon ElastiCache (Redis) Maintenance https://forums.aws.amazon.com/"" which informed us that our ElastiCache servers were scheduled for automated and mandatory maintenance patches affecting the following server:

ClusterName: ********, NodeName: *********, Region: us-west-1, replacementTime: 23:30 UTC, Sep 26, 2018

Previously, AWS infrastructure patches have always occurred without issue and as such we had no cause to expect this update to be any different. 

However, at 23:37 UTC we began receiving monitoring notifications from Pingdom that our production servers were offline and our product was down - affecting thousands of our users. During the infrastructure update, AWS failed to copy over our 10GB of cached data to the new server instance, effectively wiping our entire production cache system. The automated procedure also failed to backup our data prior to this so we were unable to restore our cache from a recent backup. As a result of this we incurred significant resource costs on AWS and were forced to scramble an emergency engineering team to triage the issue and restore our functionality.

We are aware that Elasticache services should not be used as a persistent data store, but for numerous applications caching is still a vital part of the infrastructure and as much care should be taken to insure data integrity as in persistent data stores during mandatory infrastructure updates.

I have contacted AWS support regarding this issue and have been informed that ""hardware and networking equipment will never enjoy 100% up time"" and ""we are motivated to ensure security at all times and with this comes an acceptable tone that we will need to update our servers in order to prevent vulnerabilities which may lead to customer compromise"".

Don't get me wrong, we are more than aware that we could have implemented better practices wrt fault tolerance in our Elasticache-related infrastructure. This being said, we had not been contingency planning for AWS to irreparably eviscerate our cache during maintenance. 

The information referenced by AWS (https://aws.amazon.com/elasticache/elasticache-maintenance/) explicitly states:

""For Redis nodes, the replacement process is designed to make a best effort to retain your existing data and requires successful Redis replication"". Evidently this is not correct, as our Redis data was not replicated during the maintenance procedure.

I have a number of questions.

(1) Are AWS aware that the Elasticache maintenance procedure may erase entire clusters? This appears to be the implication of the support responses but contradicts AWS help documents on the Elasticache maintenance procedure. 

(2) Does this also extend to other AWS services? Might our DynamoDB databases be erased without warning during ""scheduled maintenance""?"
Amazon Elasticache	"Must upgrade ""Clustered Redis"" to be able to delete a node but no option
Hi,

I tried to delete one node but it return this error:

Operation is not applicable for engine version less than 3.2.10 (Service: AmazonElastiCache; Status Code: 400; Error Code: InvalidParameterValue; Request ID

Look like I need to upgrade the server to version 3.2.10 to be able to delete a node... no problem let's upgrade............
I select the cluster and click on Modify but no option to upgrade, no documentation found for this case? is it a bug something not tested? 
I have other cluster in ""Redis"" mode, not ""Clustered Redis"" and this one have the select box to upgrade. Did the guy in charge forget this case or it's too complicated to make a for loop and apply to all nodes???

Is there a solution for this case or I need to delete the full cluster and create again with the correct version? it's ok this time but next time I need to upgrade I'll come back and complain again.

Thanks for any advice or fix."
Amazon Elasticache	"Re: Must upgrade ""Clustered Redis"" to be able to delete a node but no option
In place version upgrades are now supported and introduced from Aug 20, 2018[1]. Before that, only offline process for version upgrades was possible for sharded redis. Offline process involved creating a backup and creating a new cluster restoring from the backup. 

[1] https://aws.amazon.com/about-aws/whats-new/2018/08/amazon-elasticache-for-redis-adds-support-for-in-place-version-upgrades-for-redis-cluster/"
Amazon Elasticache	"Redis - Cannot change databases parameter
Hello,
I currently have a Redis node in Frankfurt running 3.2.10 and I want to change the databases parameter from 16 to 50.
I have created a separate parameter group for this cluster with the databases parameter changed to 50 but when I try to apply it to my cluster I receive the following error:

""The parameter databases has a different value in the requested parameter group than the current parameter group. This parameter value cannot be changed for a cache cluster. (Service: AmazonElastiCache; Status Code: 400; Error Code: InvalidParameterValue; Request ID: 301fa26f-a9e3-11e8-ad2f-659af75d226e)""

Also I tried changing this parameter to a non default parameter group but it shows me that is not modifiable.

How can I change this parameter?

Thanks,
Andrei Hering."
Amazon Elasticache	"Re: Redis - Cannot change databases parameter
Elasticache supports only upto 16 databases in cluster mode disabled. It is impossible to create 50 databases in redis.

For cluster mode enabled, redis supports only 1 database."
Amazon Elasticache	"During maintenance redis client get into infinite error loop
During recent maintenance ElastiCache cluster with Auto-Failover caused nodejs ioredis (https://github.com/luin/ioredis) to go into infinite loop with the error

```
2018-08-18T09:50:46.524799+00:00 (node:10) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 143): Error: Connection is closed.
18 Aug 2018 02:50:51.7872018-08-18T09:50:47.357596+00:00 6c97cc68f7-dzl68 (node:12) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 152): Error: Connection is closed.
```
We are tried to reproduce the error to fix this behaviour but were not able to do so. We did follower replica promotion and node restart but it didn't cause the same issue.

Would be great to get more details how exactly maintenance happens and how we can handle it gracefully in automatic mode in nodejs ioredis client library.

Thank you"
Amazon Elasticache	"Re: During maintenance redis client get into infinite error loop
If multi-az with automatic failover is enabled on the redis server, then preceeding the maintenance a failover happens and one of the read replicas is promoted as primary if there is replication in the cluster. After the failover, the old master node is replaced. The replacement following the failover might take considerable time. Hence, it might be unavailable for a while.

I would suggest you to optimize your code and handle errors more efficiently. I have found a link that might better help you:

https://stackoverflow.com/questions/39716569/nodejs-unhandledpromiserejectionwarning"
Amazon Elasticache	"Elasticache redis - replication between two redis clusters
Hi -
I have two elasticache redis clusters - redisTest1, redisTest2 and I need to enable data replication between those two clusters i.e redisTest1 shall act as master and it receives set commands, redisTest2 will be the slave and it just replicates data from the master cluster. Is this setup possible ? 
replication between two redis clusters"
Amazon Elasticache	"Re: Elasticache redis - replication between two redis clusters
Hello,

Replication among different clusters is not possible automatically via elasticache. However, this can be achieved by performing every write operation on both the clusters. Redis has a number of provisions to maintain strong data consistency between master and slaves but such data consistency will not be possible between 2 clusters by replicating write operations from the application."
Amazon Elasticache	"Not able to connect new created elastic redis cache
Hi,

Launched a new elastic cache in Mumbai region as a consumer, but on same vpc subnet instance ID not able to connect from any of the instances, whitelisted the IP address as well.

Regards
Satish"
Amazon Elasticache	"Re: Not able to connect new created elastic redis cache
To connect to redis, there are 2 basic conditions. If both the conditions are met, you should be able to connect to the redis server.

1. Firstly, the ec2 instance or the redis client should be in the same VPC as in the redis server.

2. Secondly, the security groups and NACLs should allow port 6379 for the redis server.

Please make sure that both the above conditions are met and then try to acces your redis cluster again."
Amazon Elasticache	"Connect to Redis cluster with In-Transit Encryption + auth + NAT instance
I'm trying to use a Ruby redis client and either one of two NodeJS clients (https://github.com/NodeRedis/node_redis or https://github.com/luin/ioredis) to connect to a ElastiCache cluster with in-transit encryption and auth enabled and am having issues. Our cluster uses a NAT instance and internet gateway to allow our cluster to be accessible from other data centers outside of a single AWS VPC. For all three clients, as soon as I connect I get an ECONNRESET error thrown immediately and over and over again when connection retries occur.

I have followed the AWS docs (https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/in-transit-encryption.html) and am able to successfully connect via redis-cli using stunnel, but haven't been able to connect with any other client so far.

From looking at this SO answer (https://stackoverflow.com/questions/47635016/connect-to-aws-elasticache-with-in-transit-encryption), it appears there is no certificate required and we simply need to pass empty options to the TLS config (if applicable), but no matter what I enter I'm unsuccessful. I've also tried passing the default stunnel stunnel.pem private key as the cert in all clients just in case, and it obviously doesn't work either. Any assistance or expertise from others who have used ElasticCache would be helpful!"
Amazon Elasticache	"Re: Connect to Redis cluster with In-Transit Encryption + auth + NAT instance
See the following support case for the resolution. In short, disable certificate verification in your clients: https://console.aws.amazon.com/support/home?#/case/?caseId=5272805051&displayId=5272805051&language=en

Edited by: whatl3y on Aug 8, 2018 2:47 PM"
Amazon Elasticache	"Re: Connect to Redis cluster with In-Transit Encryption + auth + NAT instance
There are a number of clients for all languages and most of them now support SSL encryption. I am enclosing below a snippet code in python to communicate over SSL connection with elasticache:

import redis
r = redis.StrictRedis(
    host='<host_name_of_cluster>',
    port=6379,
    password='auth_password_if_set_at_the_time_of_creation_of_cluster',
    ssl=True,
)
r.set('foo', 'bar')
response = r.get('foo')
print response

When I run the above code in a client, it successfully sets the key 'foo' to a value 'bar' and then retrieves it from the cluster. We do not need any certificate on the client side to do so.

I hope that helps."
Amazon Elasticache	"Connect my app to replica Redis instances with a single endpoint
I have a 3 nodes Elasticache Redis cluster (one primary node, two replica nodes) balanced in three different regions.
Elasticache provide me a primary cluster endpoint (something like xxx.yyyy.ng.0001.euw1.cache.amazonaws.com:6379) and 3 node instances endpoints  (xxx.yyy.N.euw1.cache.amazonaws.com:6379).
The primary cluster endpoint is usefull because if you add or remove nodes, or promote a new primary, the application do not need to be reconfigured because the primary endpoint dont not change.
But my application (PHP) need also to access to the replica nodes, in read-only mode (performance optimization for Redis ""Scan"" cmd). And Elasticache do not provide a ""replica only"" single endpoint. So I have to configure my appli with the replica node endpoints, and if a replica is not available anymore (deleted or promoted to primary), i have to reconfigure my app again.

I wish I could have a ""read only"" Elasticache endpoint, with DNS balancing to the nearest replica node. It should work like AWS Aurora cluster : a single reader endpoint allowing to connect to any on afailbale slaves.

Is there a way to do this with Elasticache Redis ?"
Amazon Elasticache	"Re: Connect my app to replica Redis instances with a single endpoint
Hello,

I understand your use-case but unfortunately there is no read replica endpoint feature available as of now. This is a limitation with elasticache. If you would like to utilized read replicas, then you would need to connect with the replica node endpoints.

One workaround is to write a lamda function which gets triggered by a failover or other failures using SNS topics. The lambda function can then change the read replica endpoints in your application using SSM run command or in a private hosted zone. However, I would suggest you to please perform thorough testing before pushing this into production."
Amazon Elasticache	"If Redis fail and reboot itself, will it cause data loss?
According to the doc (https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/AutoFailover.html)

""Whenever the primary is rebooted, it is cleared of data when it comes back online. When the read replicas see the cleared primary cluster, they clear their copy of the data, which causes data loss.""

If the primary experience a failure and reboot itself, will it cause the whole group to clear

Edited by: Asiaapp on Jun 29, 2018 9:30 PM"
Amazon Elasticache	"Re: If Redis fail and reboot itself, will it cause data loss?
You should deal with the persistence option of REDIS : https://redis.io/topics/persistence
You can probably access to this settings by using a custom ""parameter group"" of Elasticache Redis.

With this, you should have a minimal loss of information during a primary reboot. But I do not using this myself, so I cant let you know if it really work as expected."
Amazon Elasticache	"Re: If Redis fail and reboot itself, will it cause data loss?
Hello,

You are correct to say that if something happens to elasticache cluster primary node, it will result in data loss. That is the reason we recommend to configure minimum of 2 replica nodes in the cluster with multi-az and automatic failover enabled. 

If a hardware issue happens with the primary node, it will result in a failover and a slave will be promoted to master. Thus the cluster will keep running and will not result in data loss."
Amazon Elasticache	"DNS lookup error for elasticache
Hi,
I am using elasticache in our API using redisson client, we occasionally get DNS lookup error, this is the stacktrace

ERROR (redisson-netty-1-4) [
DNSMonitor(operationComplete:98)] Unable to resolve redis.kl3ise.0001.use1.cache.amazonaws.com java.lang.IndexOutOfBoundsException: Index: 0, Size: 0

at java.util.ArrayList.rangeCheck(ArrayList.java:653)
at java.util.ArrayList.get(ArrayList.java:429)
at io.netty.resolver.dns.DnsNameResolver.doResolveCached(DnsNameResolver.java:613)
at io.netty.resolver.dns.DnsNameResolver.doResolve(DnsNameResolver.java:593)
at io.netty.resolver.dns.DnsNameResolver.doResolve(DnsNameResolver.java:527)
at io.netty.resolver.SimpleNameResolver.resolve(SimpleNameResolver.java:63)
at io.netty.resolver.dns.InflightNameResolver.resolve(InflightNameResolver.java:100)
at io.netty.resolver.dns.InflightNameResolver.resolve(InflightNameResolver.java:66)
at io.netty.resolver.dns.InflightNameResolver.resolve(InflightNameResolver.java:51)
at io.netty.resolver.InetSocketAddressResolver.doResolve(InetSocketAddressResolver.java:57)
at io.netty.resolver.InetSocketAddressResolver.doResolve(InetSocketAddressResolver.java:32)
at io.netty.resolver.AbstractAddressResolver.resolve(AbstractAddressResolver.java:108)
at org.redisson.connection.DNSMonitor$1.run(DNSMonitor.java:89)

Can someone tell how can an elasticache DNS fail? isn't it promised to be always up?

Edited by: bhargavagundu on Feb 23, 2018 3:13 AM

Edited by: bhargavagundu on Feb 23, 2018 3:13 AM"
Amazon Elasticache	"Re: DNS lookup error for elasticache
Hello,

My name is Paranshu from AWS premium support.

On our modern VPC instances, we limit rate of DNS requests to protect from noisy neighbor affects i.e. we have a limit of 1024 packets per second that provides a stable performance up to that limit, as opposed to having no limit but risk of unstable performance due to noisy neighbor affects. We aim to have the limits set high enough that most DNS use cases will not hit them, but there are edge case usage patterns that can. In most cases configuring an instance side DNS cache will greatly reduce the rate of DNS requests going to the underlying system.

The following are the solutions to the above issue:
	- configure DNS cache so that queries to the DNS server can be reduced. Caching can reduce dns lookups by 99.99%.
	- enabling connection pooling to redis server so that existing connections could be utilized for making queries rather than establishing new connections everytime for making a query.

For information on this in our public docs, please refer https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-dns.html#vpc-dns-limits

I hope I was able to help you. Please let me know if you have any additional questions or concerns, I will happily assist."
Amazon Elasticache	"Re: DNS lookup error for elasticache
Hi Paranshu,

Thanks for your reply, 
I understood the limit setup by AWS for DNS requests and the reason seems fair enough,
However can you guide me on the solution suggested, 
1. How do i configure the DNS cache?

Thanks
Bhargav"
Amazon Elasticache	"Re: DNS lookup error for elasticache
I'have experienced the same problem (Redis host unreachable), and solve it by installing the ""nscd"" service (a DNS local cache) :
$> apt-get install nscd

Very simple to install, and the problem never occured again."
Amazon Elasticache	"T2 CPUCredit monitoring
I stumbled across an issue today while performance testing an application which I'm moving to new infrastructure (namely Elastic Beanstalk, but that's beside the point of this point), and I've started using the T2 cache instance types because they seem reasonably priced in comparison to the other instance types.

However, half way through a performance test, my application's performance tanked significantly for seemingly no good reason. Upon further investigation, it seemed that memcached was the bottleneck. Digging a bit further the CPU utilization on the instance had plateau'd at ~20%, and then I went looking for the CPUCreditBalance charts for that instance to see if that was the reason, or whether there was something else going on.

Of course, to my surprise, these charts don't exist. Or at least, I can't find them anywhere. They're not under the node details themselves, there appears to be no CloudWatch metric for these statistics whatsoever, so I have no way of validating whether an exhaustion of excess CPU credits was indeed the cause (though I strongly suspect it was).

It would be nice if I could monitor the CPU credit accumulation/spend on ElastiCache instances just as I can with all other AWS services that utilize T2 instance types.

Is there any reason why this is NOT available on ElastiCache instances? It seems odd that it's been omitted...like it's been forgotten about. I found a couple of other threads on there mentioning something similar, dated 1 and 4 years ago, but nothing since, so it seems that, while T2 instance types have been around for ElastiCache for some time, the CPU credit monitoring has been noteably absent throughout. It's clear that these instances ARE affected by credit exhaustion, just as other T2 services are, but with no way to monitor it, it becomes a pain to have to then deduce that by trial and error, or by ruling other things out.

Can anyone at AWS confirm that this is missing? Can anyone at AWS confirm that this metric can be monitored in ANY way? And lastly, can anyone at AWS confirm WHY this is missing (or when we might get this metric made available to us)?"
Amazon Elasticache	"Connecting to encrypted Elasticache Redis instance from spring boot app
Hi,
I have an application running as a Spring Boot jar, running in a docker image happily on ECS Fargate.  It accesses an unencrypted Redis cache.   It works great so long as that cache remains unencrypted.

But now I'd like for that cache to be encrypted both at rest and in transit.   I set one up like that within AWS.   I can connect to it using stunnel from my own localhost.   But now, I want to connect to it from my app in ECS Fargate.  I have provided the host, port, and password correctly within my spring application.properties file, but it fails to connect.   I suspect that I need to provide the key and certificate that stunnel would normally provide in this instance.   How do I do this?    Must I provide an intermediate EC2 (or premises based) system  with stunnel or similar to access my encrypted Redis or is there a more direct way to provide this?

Thanks,
JoAnn"
Amazon Elasticache	"Re: Connecting to encrypted Elasticache Redis instance from spring boot app
Answered my own question.

Within my Java code, I had to provide both useSSL AND the password.  I had only been providing the latter.

So, my java code for my JedisConnectionFactory changed to be

  @Bean
    public JedisConnectionFactory jedisConnectionFactory() {
        JedisConnectionFactory factory = new JedisConnectionFactory();
        factory.setHostName(redisHost);
        factory.setPort(redisPort);
        factory.setPassword(redisPassword);
        factory.setUseSsl(redisUseSSL);

        return factory;
    }"
Amazon Elasticache	"ElastiCache Redis cluster connects to previous primary node after failover
I'm using ElastiCache Redis (cluster mode disabled, Multi-AZ enabled) cluster with 1 primary and 1 replica node. I also have a stunnel process running on EC2 instance in the same VPC that connected to the Redis using the cluster's primary endpoint. This setup has been running without any problem for few months.  

Last weekend, the primary node went through scheduled upgrade, and the cluster failed over to the replica node. This went fine.

However, stunnel process somehow kept connecting to the previous primary which became replica after failover. It appeared that was the case because applications connecting to the ElastiCache Redis through stunnel received 'error: uncaughtException: READONLY You can't write against a read only slave. date=Sun Jun 17 2018 21:08:43 GMT-0700 (PDT)' error. This problem went on for few hours until I finally restarted stunnel process. 

My question is why stunnel connected to read-only node although it used cluster's primary endpoint? Shouldn't it connect to newly promoted primary node instead?

I will be happy to provide any configuration information if needed. Thank you.

Edited by: kro on Jun 18, 2018 4:24 PM"
Amazon Elasticache	"Re: ElastiCache Redis cluster connects to previous primary node after failover
This behavior might be on stunnel configuration.
There is ""delay"" option which, according to stunnel man page, ""delay DNS lookup for the connect option"" The man page doesn't explicitly mention it, but if this option is not set to ""yes"", it appears stunnel does DNS lookup during start up time, and reuses the result until it restarts. 
I verified that stunnel with ""delay=yes"" correctly connects to new primary node after failover without restarting."
Amazon Elasticache	"Clustered Redis - configuration endpoint is not getting resolved.
We are migrating redis from regular EC2 instance to Elastic Cache. For this purpose we have setup elasticcache with clustered redis. We are able to connect to individual nodes within cluster, but the configuration endpoint url is not getting resolved: prod-environment.orgqtl.clustercfg.use1.cache.amazonaws.com and as a result of that we are not able to establish connection. Is there anything else that has to happen before we will be able to use this endpoint?"
Amazon Elasticache	"Re: Clustered Redis - configuration endpoint is not getting resolved.
The configuration endpoint maintains CNAME entries for all of the cache nodes, the DNS name resolves to one of the nodes. 
If you are unable to resolve the endpoint, please check the DNS in the EC2 instance that your application located. By default the EC2 instance use the Amazon-provided DNS server in the VPC, but if you have setup your custom DNS server, please ensure it can resolved the aws resource endpoint. 

You can test the DNS resolve using the tool dig or host.
ec2-user@~$ dig prod-environment.orgqtl.clustercfg.use1.cache.amazonaws.com
ec2-user@~$ host prod-environment.orgqtl.clustercfg.use1.cache.amazonaws.com

The endpoint can be resolved from any EC2 instances that use the Amazon-provided DNS server. But if you want to establish the connection, please ensure the EC2 instance that you application on and the Elasticache cluster are in the same VPC."
Amazon Elasticache	"How to enable Redis Authentication fof Elasticache
It appears that usage of elasticache redis authentication is gated behind an account whitelist setting, as shown in the below excerpt. There is no indication in the documentation that a whitelist is required so I assume something else is missing from the request. Has anyone configured Redis Auth and bypassed this issue?

```
$ aws elasticache create-replication-group \
     --region us-east-1 \
     --auth-token test-that-out-right-now \
     --replication-group-id testauth \
     --cache-subnet-group testauth \
     --replication-group-description ""for auth, and glory"" \
     --engine redis \
     --engine-version 3.2.6 \
     --cache-node-type cache.m4.large \
     --num-node-groups 1 \
     --replicas-per-node-group 1 \
     --at-rest-encryption-enabled \
     --cache-parameter-group default.redis3.2.cluster.on

An error occurred (InvalidParameterValue) when calling the CreateReplicationGroup operation: This AWS account is not whitelisted for Redis Auth but AuthToken is provided.
```"
Amazon Elasticache	"Re: How to enable Redis Authentication fof Elasticache
I ran into this same issue and was able to fix it by adding this option: --transit-encryption-enabled
  The documentation for Elasticache says an auth token may only be specified on replication groups where transit encryption is enabled.  I think this behavior is expected (besides the misleading error message)."
Amazon Elasticache	"ElastiCache redis - Internal service error
We can't access our redis instances anymore. We simply see ""Internal service error"" in red.

Today we briefly attempted to switch the primary nodes - it failed in our system so we reverted. And then we created a new node.

Now we cannot fix anything and we are getting intermittent errors form Redis that we cannot do anything about.

please help?"
Amazon Elasticache	"Re: ElastiCache redis - Internal service error
Update: it returned itself to an editable state shortly after posting.

we would still love to know how this happened of course."
Amazon Elasticache	"Elasticache Redis AWOL twice
Hi,

Can someone from AWS check what happened to my Elasticache Redis node? It went AWOL twice in the last 10 days and caused hours of downtime and loss with each event.

mvl-production-redi3-0001-001 cache-cluster Fri Jun 01 08:22:17 GMT+800 2018 Finished recovery for cache nodes 0001
mvl-production-redi3-0001-001 cache-cluster Fri Jun 01 08:18:08 GMT+800 2018 Recovering cache nodes 0001
mvl-production-redi3-0001-001 cache-cluster Thu May 24 02:25:49 GMT+800 2018 Finished recovery for cache nodes 0001
mvl-production-redi3-0001-001 cache-cluster Thu May 24 02:21:38 GMT+800 2018 Recovering cache nodes 0001

I've referred to https://forums.aws.amazon.com/thread.jspa?messageID=823091, and if CPU utilisation rate of (90/2) is benchmark for cache.r4.large instance, we are below 40%/hour rate.

Thanks in advance."
Amazon Elasticache	"Can’t connect elasticache, although Ec2 Redis connection confirmed
I can’t connect elasticache Redis from nodejs eb instance. Although I confirmed connection through ec2 ssh. 

let client = require(‘redis’)
client.createClient(6379, ‘aws-elasticache-hostname’)

What’s going on here, I  keep getting ...Moved...error 
Error ReplyError: MOVED 2290 172.31.67.63:6379

Any help appretiated

Edited by: mustafa on May 22, 2018 6:08 AM"
Amazon Elasticache	"Re: Can’t connect elasticache, although Ec2 Redis connection confirmed
Hello,

It seems like you are using a cluster mode enabled Redis cluster here.
The MOVE error happen when you are trying to get/set a key that served by other node in the cluster. 
If your NodeJS has cluster feature enabled, it should be able to handle this feature.

You can check more details in the Redis website - Redis Cluster Specification.
https://redis.io/topics/cluster-spec#moved-redirection
""A Redis client is free to send queries to every node in the cluster, including slave nodes. The node will analyze the query, and if it is acceptable (that is, only a single key is mentioned in the query, or the multiple keys mentioned are all to the same hash slot) it will lookup what node is responsible for the hash slot where the key or keys belong.If the hash slot is served by the node, the query is simply processed, otherwise the node will check its internal hash slot to node map, and will reply to the client with a MOVED error.The error includes the hash slot of the key (3999) and the ip:port of the instance that can serve the query. The client needs to reissue the query to the specified node's IP address and port.""

From this redis document (https://redis.io/topics/cluster-tutorial#playing-with-the-cluster), thunk-redis offers support for Node.js and io.js, it is a thunk/promise-based redis client with pipelining and cluster. Please check the redis document for more about the client libraries."
Amazon Elasticache	"redis CONFIG and SLOWLOG commands not working from cli?
I was trying to issue below commands from cli but they do not seem to work:

slowlog get 2
(error) ERR unknown command 'slowlog'

CONFIG GET * 
(error) ERR unknown command 'CONFIG'

Any idea? I use ""Redmon"" if that matters.

Thanks,
Sam"
Amazon Elasticache	"Re: redis CONFIG and SLOWLOG commands not working from cli?
Hello Sam,

as per our documentation the CONFIG command is currently restricted[1] and the unknow command error is the expected behaviour:

telnet test-slowlog.XXX.0001.euw1.cache.amazonaws.com 6379
Trying 172.31.0.130...
Connected to test-slowlog.XXX.0001.euw1.cache.amazonaws.com.
Escape character is '^]'.
CONFIG GET *
-ERR unknown command 'CONFIG'

I am not familiar with Redmon but the slowlog command is no restricted, I performed a test without any error:

telnet test-slowlog.XXX.0001.euw1.cache.amazonaws.com 6379
Trying 172.31.0.130...
Connected to test-slowlog.XXX.0001.euw1.cache.amazonaws.com.
Escape character is '^]'.
slowlog get 2
*0

[1] http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ClientConfig.html

Regards,
Giorgio"
Amazon Elasticache	"Re: redis CONFIG and SLOWLOG commands not working from cli?
Please don't give that bullshit answers, 
It's my humble request to AWS please at least give us a sample code structure to start our code.
I am trying to develop a java application and I wanted to use Redis. I struggled 2 weeks and I am still just reached how to connect endpoints to the instance and then I am blank or I can say, I am not finding a way about ""What is next"". If anyone has an idea please tell me.

I wanted to use redis for session management."
Amazon Elasticache	"Need suggestions: Elasticcache replica at Zone level
Hi All,

We have a challenge that we trying to solve, we want to expire cache on EU zone elasticcache node else use one elasticcache node for all zone's(US, EU, AP etc..)

Let's say, our model is we have servers in US regions and EU regions and also we have one Redis elasticcache on each zone.. So when user near to the US if they update the data from application it is expiring on US regions redis elastic-cache not on FR region. So we are looking for a wat that either we can use one elasticcache that uses on all zones with no latency.. else replica for all zones.."
Amazon Elasticache	"ElasticCacheのt2インスタンスの残クレジットについて
ご担当者様

お世話になります。表題の件についてお伺いいたします。

ElasticCacheのt2インスタンスがバーストした際の
残クレジットはどこで確認すればよろしいでしょうか？
EC2やRSSについては公式ドキュメントに記載もあり、わかったのですが、
ElasticCacheのインスタンスについての公式見解がどこにも見当たらず。。

ElasticCacheのインスタンスはt2であってもバーストしないのでしょうか？
（バーストによる課金はされない？）

恐れ入りますが、何卒よろしくお願いいたします。

Edited by: fatcreamstudioapartment on May 9, 2018 12:06 AM"
Amazon Elasticache	"Re: ElasticCacheのt2インスタンスの残クレジットについて
こちら、AWS様より正式に回答いただきました。
ElastiCacheの残クレジットは現時点では確認できないようです。また、バーストしても課金されないそうです。（t2.unlimitedの対象外のサービスとのこと）
ありがとうございました。"
Amazon Elasticache	"Please whitelist ""Redis Auth"" for account
Hello,

We would like to use your managed redis services, but when I try to create a cluster I have the following errors:

aws --region eu-west-1 elasticache create-cache-cluster --cache-cluster-id  xxxx --num-cache-node 1 --cache-node-type cache.t2.micro --engine redis --cache-parameter-group-name default.redis3.2.cluster.on --cache-subnet-group-name yyyyyyyyyyyyy --cache-security-group-names zzzzzz  --preferred-maintenance-window mon:06:00-mon:07:00 --no-auto-minor-version-upgrade --snapshot-retention-limit 1 --snapshot-window 04:00-05:00 --auth-token secrettoken --engine-version 3.2.6

An error occurred (InvalidParameterValue) when calling the CreateCacheCluster operation: Use of cache security groups is not permitted in this API version for your account.

Then: ( --cache-security-group-names zzzzzz removed )

aws --region eu-west-1 elasticache create-cache-cluster --cache-cluster-id  xxxx --num-cache-node 1 --cache-node-type cache.t2.micro --engine redis --cache-parameter-group-name default.redis3.2.cluster.on --cache-subnet-group-name yyyyyyyyyyyyy  --preferred-maintenance-window mon:06:00-mon:07:00 --no-auto-minor-version-upgrade --snapshot-retention-limit 1 --snapshot-window 04:00-05:00 --auth-token secrettoken --engine-version 3.2.6

 This AWS account is not whitelisted for Redis Auth but AuthToken is provided

We would like to be able to use the redisauth token, can you please whitelist our account?"
Amazon Elasticache	"Redis Primary endpoint unreachable
Hi,

I have a redis instance (cache.m3.medium) with 2 nodes, 1 shard and Multi-AZ auto-failover enable.

I configured my system with the primary endpoint but didn't work (timeout) but when I add a node endpoint it's work.

the dig +short command with the primary endpoint returns nothing but works with the node endpoint (an IP appear)

Is this a normal behavior? I expected to use the primary endpoint with my app.

Thanks! 

Edited by: Sergi on Apr 25, 2018 8:57 AM"
Amazon Elasticache	"Redis Cache encryption is not supported in Latest Version i.e. 3.2.10
Hello,

This is related to AWS Redis Cache encryption and I would like to know why is it only supported in Redis 3.2.6 and not in latest version i.e. 3.2.10?

Thank-you!"
Amazon Elasticache	"t2 instance credits monitoring
Hello,
I got a couple of Redis clusters sized cache.t2.micro and I am wondering who I can monitor the CPUCreditUsage of this clusters/nodes.
The cloudwatch dashboard doesn't show the CPUCreditUsage metric neither I'm able to get this data using the AWS cli.
Any advice?"
Amazon Elasticache	"Re: t2 instance credits monitoring
Good day luigitagliamonte,

I understand that you are looking for information on how to go about monitoring the CPUCreditUsage on your redis clusters/nodes.

Unfortunately at this time there's no Memory usage metric in Cloudwatch, however you can use the Redis info command to find usage information of your cluster:

http://redis.io/commands/info

I would also advise you to take a look at the following documentation as well on what metrics should be monitored.

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html

I hope the information sent was found use full to you.

Kind Regards,
Dominic M"
Amazon Elasticache	"Re: t2 instance credits monitoring
+1 for adding a CPUCreditUsage CloudWatch metric in Elasticache!"
Amazon Elasticache	"Are there any examples for Cloudwatch alerts for ElastiCache Redis?
I'm looking for some examples for Cloudwatch Alerts for ElastiCache Redis cluster:

regarding host metrics - which instance IDs I should use?
cluster availability - is there any example for alerting?


TIA,
Vitaly"
Amazon Elasticache	"Re: Are there any examples for Cloudwatch alerts for ElastiCache Redis?
You wouldn't choose an instance id, you would set an alert on one of these metrics for your cluster:
https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CacheMetrics.Redis.html

Recommended metrics to monitor: https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html

Step 3a choose elasticache:
https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/ConsoleAlarms.html

 Edited by: Ehehron on Mar 28, 2018 11:22 PM

Edited by: Ehehron on Mar 28, 2018 11:29 PM"
Amazon Elasticache	"VPC does not appear in dropdown when creating a new Redis Instance.
Hello everyone,

I'm trying to create a new ElasticCache instance to connect with one of our EC2 instances, for which they need to be on the same VPC but when the dropdown appears to select one, the VPC where the instances are does not appear. I have already checked and both resources exist in the same region (Oregon). What could be the cause for this and how can I fix it?"
Amazon Elasticache	"Re: VPC does not appear in dropdown when creating a new Redis Instance.
Hello,

Thanks for posting on AWS forums.

I understand that you are facing issues creating a new ElasticCache Redis cluster/node in an existing VPC, wherein that specific VPC does not seem to appear in the dropdown list of subnet group field, in the cluster creation wizard.

As indicated in our aws documentation link- https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Clusters.Create.html, if you're going to launch your cluster in an Amazon VPC, you need to create a subnet group in the same VPC before you start creating a cluster. Please verify if you have an existing Subnet Group with the desired VPC .If not, please attempt to create the Subnet Group with the desired VPC and with the desired number of subnets. Once done, you should be able to view it in the dropdown during cluster creation. Please see the below link for more information on how to create and leverage subnets and subnet groups to manage access to your ElastiCache resources.

https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/SubnetGroups.html"
Amazon Elasticache	"Are ElastiCache nodes reservation modifiable like EC2?
If I reserve a ElastiCache node say m4.2xlarge and I have a cluster with two m4.xlarge nodes running, will the reserved bigger node apply to two smaller nodes?  This would happen in case of ec2 instances, but I am not sure about the ElastiCache scenario.
Also, are reservations for cache nodes cluster specific?"
Amazon Elasticache	"elastic cache cluster configuration endpoint first connects to read only
Hi,

when we tried to connect to redis cluster configuration endpoint, first command is being executed as read-only, we are getting error and second command onwards its connecting to write redis node

{Wed-Mar-14-2018,19:53:26}
~/-(2 dirs, 10 files)
xxxx@xxxxx:[]$redis-cli -h xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> keys *
(empty list or set)
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
(error) READONLY You can't write against a read only slave.
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> 

{Wed-Mar-14-2018,20:12:39}
~/-(2 dirs, 10 files)
xxxx@xxxxx:[]$redis-cli -h xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> keys *
(empty list or set)
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
(error) READONLY You can't write against a read only slave.
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> 

{Wed-Mar-14-2018,20:12:57}
~/-(2 dirs, 10 files)
xxxx@xxxxx:[]$ping xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com
PING xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com (10.0.0.27) 56(84) bytes of data.
^C





xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com ping statistics ---





2 packets transmitted, 0 received, 100% packet loss, time 1007ms


{Wed-Mar-14-2018,20:21:27}
~/-(2 dirs, 10 files)
xxxx@xxxxx:[]$redis-cli -h xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> keys *
(empty list or set)
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
(error) READONLY You can't write against a read only slave.
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379> flushdb
OK
xxxx.navfqb.clustercfg.aps1.cache.amazonaws.com:6379"
Amazon Elasticache	"Elasticache - Redis cluster primary endpoint is not reachable from Java
We are trying to connect to Elasticache - Redis cluster primary endpoint using Spring boot code. The connection is failing. I verified the security group associated with the cluster, the port 6379 is open for everyone."
Amazon Elasticache	"Re: Elasticache - Redis cluster primary endpoint is not reachable from Java
Hello,

My name is Paranshu from AWS premium support. 

Here are a few prerequisites while connecting to elasticache. Please make sure that all of them are met.

1. The elasticache cluster and the instance or resource accessing the cluster should be in the same VPC. Elasticache cannot be accessed from outside the vo=pc directly.
2. The security group of the elasticache cluster allows port 6379 for redis and 11211 for memcache for the world(0.0.0.0/0) or the Ip of the originating connection to the cluster.

If redis in-transit encryption is enabled:
1. If you have enabled redis in-transit-encryption or at-rest encryption or both, please make sure that you are using a client which supports SSL. 
 I am enclosing below a snippet code in python to communicate over SSL connection with elasticache:

import redis
r = redis.StrictRedis(
    host='<host_name_of_cluster>',
    port=6379,
    password='auth_password_if_set_at_the_time_of_creation_of_cluster',
    ssl=True,
)
r.set('foo', 'bar')
response = r.get('foo')
print response
When I run the above code in a client, it successfully sets the key 'foo' to a value 'bar' and then retreives it from the cluster. We do not need any certificate on the client side to do so. All you need is an auth password you must have set at the time of creation of the cluster.

There is another way. You can use stunnel. Please refer https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.ConnectToCacheNode.html for more information."
Amazon Elasticache	"Re: Elasticache - Redis cluster primary endpoint is not reachable from Java
That helps. Thank you."
Amazon Elasticache	"CloudWatch not displaying metrics for ElastiCache node
CloudWatch metrics are not displaying for one of my ElastiCache nodes. See attached screenshot -- for the last 7 days, CloudWatch metrics show for CPU Utilization, Swap Usage, Freeable Memory, and Network Bytes In/Out. But no data shows at all for the other 20-25 CloudWatch metrics (e.g., Current Connections, Current Items, Get Commands, Set Commands, Get Hits/Misses, etc.).

This node has been up for an extended period of time and I don't remember ever seeing this kind of issue before.

Does anyone know why this would be happening? Is there anything I can do to get my cache node to start reporting all metrics again? I'd rather not have to lose or reboot this cache node."
Amazon Elasticache	"Re: CloudWatch not displaying metrics for ElastiCache node
Hello,

I have reached out to Elastic cache team to investigate the missing cloudwatch metrics issue. We will update this thread to keep you updated."
Amazon Elasticache	"Re: CloudWatch not displaying metrics for ElastiCache node
Any further update on this from the ElastiCache team?

Thank you,
Matt"
Amazon Elasticache	"Re: CloudWatch not displaying metrics for ElastiCache node
Hi Matt,

We're still awaiting a response at the moment. We'll post back when we have one.

Richard"
Amazon Elasticache	"Re: CloudWatch not displaying metrics for ElastiCache node
Hello Matt,

Can you verify if you are still unable to see the metrics in CloudWatch?

Best regards,
Justin G."
Amazon Elasticache	"Re: CloudWatch not displaying metrics for ElastiCache node
Yes, it looks like metrics have been getting collected on the ElastiCache node in question for the last 3 days or so.

What was the issue? Is there anything I can do myself to resolve this in the future?

Thanks,
Matt"
Amazon Elasticache	"Re: CloudWatch not displaying metrics for ElastiCache node
Hi Matt,

Apologies for the delayed response here. Metrics can go missing if the instance is used too aggressively, for example, if the client drives way too many connections to the node. We recommend tracking CloudWatch metrics and setting alarms to detect and remedy extreme usage.

Kind regards,
Chris"
Amazon Elasticache	"Re: CloudWatch not displaying metrics for ElastiCache node
I have an issue as the same Matt, please help me to check the Redis service."
Amazon Elasticache	"Adding more than 5 Read Replicas to a Redis Cluster
We are running into an issue where having more read replicas would help us with an increase in our traffic. Unfortunately at this time, we are unable to migrate to the new Redis Cluster functionality so that option is out. Is it possible to increase the maximum number of Read Replicas in a cluster (up from 5 that aws allows)?"
Amazon Elasticache	"Re: Adding more than 5 Read Replicas to a Redis Cluster
Hello,

My name is Paranshu from AWS premium support. 

Unfortunately, you cannot increase the number of read replicas from more than 5 in a single cluster. The only way to do so is to create a backup of the cluster and restore the backup to build a cluster with cluster mode enabled. For more information please refer https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Replication.Redis-RedisCluster.html

You should also be able to handle or absorb the increased traffic by scaling up the cluster or increasing the tier of the cluster. Please let us know if you face any issues."
Amazon Elasticache	"After paying the unpaid fee, ElastiCache Redis Internal service error
Hello everyone.
I am having trouble using elastiCache redis.

I have not been able to access the console due to payment problems due to a payment problem,
I tried to check the Redis list created by clicking Service / ElastiCache / Redis.
The list is not displayed and only the message ""Internal service error"" is displayed in red text.

Even if you create a new Redis, the list does not appear and only ""Internal service error"" is displayed. Is there any way to fix this?

plz. help me T.T"
Amazon Elasticache	"Backup - Memcached
Hi there,

Why does memcached backup in elasticache not available?

thnaks"
Amazon Elasticache	"Elasticache Redis Crashed.
Hi,

We experienced a crash of our cache.t2.medium node around Thu Feb 15 12:00:25 GMT+530 2018 for no apparent reason. The CPU utilization as per the cloudwatch metrics were well within 15%. 
It removed all the keys stored in redis and causing downtime of our services. 

There is not much data provided in the AWS panels to troubleshoot from our end. There are some logs for recovery events, but there is no info on why these events were triggered.

Is there a way to get more details to understand what exactly happened? Or any other suggestions to debug this?"
Amazon Elasticache	"Can't connect to Elasticache Redis Node in EC2 despite VPC security config
I am trying to connect to a Redis node in Elasticache from my EC2 instance (created via Elastic Beanstalk) in the same account.  I have configured the VPC's security group this Redis Node is in to allow the connections:

Type | Protocol | Port Range| Source
Custom TCP Rule | TCP (6) | 6379 | 0.0.0.0/0

I additionally tried adding the EC2 security group to the cache security group just in case the VPC config was insufficient which of course did not help either since it's in a VPC.

In addition to my app being unable to connect I also tested direct from the commandline of the EC2 instance via the Redis test instructions ( http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.ConnectToCacheNode.Redis.html ).

Results:
$ src/redis-cli -h node-XXXXX.cache.amazonaws.com -p 6379
Could not connect to Redis at node-XXXXX.cache.amazonaws.com:6379: Connection timed out

I've dug around for hours, restarted various instances, removed & re-added ports for the security groups without any luck. Pointers or assistance would be greatly appreciated.

Edited by: Dustin Bolton on Sep 15, 2014 2:02 PM"
Amazon Elasticache	"Re: Can't connect to Elasticache Redis Node in EC2 despite VPC security config
I have not figured out why inbound redis connections won't work but as a workaround I can deploy my beanstalk app into the same VPC as Redis by assigning the subnets and VPCId within the .elasticbeanstalk/options-XXX file."
Amazon Elasticache	"Re: Can't connect to Elasticache Redis Node in EC2 despite VPC security config
Hi there,

It sounds like you're trying to access your Redis cache node from a different VPC and that's likely the issue.

If you run a 'dig' command on the end point, you'll see that it's addressing a private IP address. For example:

$ dig +short sample.ld3koc.0001.usw2.cache.amazonaws.com
172.31.52.132


So when your instance from one VPC is trying to pull that IP address, it's not going to find it in that VPC because it's in a different VPC.

I hope this helps. If you need additional clarifications, would you provide your VPCs, front end instance id, and the name of the cluster so we can help you better."
Amazon Elasticache	"Re: Can't connect to Elasticache Redis Node in EC2 despite VPC security config
I'm having a similar problem where I'm trying to connect to redis hosted by compose.io but it keeps on failing to connect.

I keep on getting the error `EPIPE` followed by the endless error `ECONNRESET`
[Error: Auth error: Redis connection to aws-us-east-1-portal.4.dblayer.com:10582 failed - write EPIPE]
REDIS ERROR
[Error: Redis connection to aws-us-east-1-portal.4.dblayer.com:10582 failed - write EPIPE]
REDIS ERROR
[Error: Auth error: Redis connection to aws-us-east-1-portal.4.dblayer.com:10582 failed - write EPIPE]
REDIS ERROR
[Error: Redis connection to aws-us-east-1-portal.4.dblayer.com:10582 failed - write EPIPE]
[Error: Auth error: Redis connection to aws-us-east-1-portal.4.dblayer.com:10582 failed - read ECONNRESET]
[Error: Redis connection to aws-us-east-1-portal.4.dblayer.com:10582 failed - read ECONNRESET]
[Error: Auth error: Redis connection to aws-us-east-1-portal.4.dblayer.com:10582 failed - read ECONNRESET]
...
...
..

I have a hunch that it might be because EB is trying to connect something hosted in a different VPC since they host their redis instances on AWS, but this doesn't totally make sense to me since I have it running just fine on a vanilla EC2 instance which says it's connected to the same VPC as my EB instance.

I've also tried install redis directly on the EB machine which worked and I was able to connect to the instance but get my connection reset every time I run a command:
[ec2-user@ip-172-31-2-8 src]$ ./redis-cli -h aws-us-east-1-portal.4.dblayer.com -p 10582 -a mysupergoodpass
aws-us-east-1-portal.4.dblayer.com:10582> ping
Error: Connection reset by peer
aws-us-east-1-portal.4.dblayer.com:10582> ping
Error: Connection reset by peer 


Any help is greatly appreciated."
Amazon Elasticache	"Re: Can't connect to Elasticache Redis Node in EC2 despite VPC security config
Hello! I know that you were having this problem a long time ago, but I'm wondering if you were ever able to resolve it?

I'm seeing the same symptoms:
$ redis-cli -c -h master...com -p 6379 -a 'mysecret'
master...com:6379> ping
Error: Connection reset by peer
$


I have the subnet group and security group set up to give access from this ec2 instance to this redis node, and it does seem to connect, but any command results in an immediate disconnect. I think that's what you were also experiencing.

Any insight would really help!"
Amazon Elasticache	"Re: Can't connect to Elasticache Redis Node in EC2 despite VPC security config
Hello MrStarr,

I see you are facing errors while connecting to elasticache through AWS CLI.

Please could you confirm if redis encryption in-transit is not enabled for your cluster. If it is enabled, then you would be unable to connect using redis-cli as it does not support SSL encryption. The only way to connect in redis with in-transit encyption enabled is using a SDK. 

There are a number of clients for all languages out there and most of them now support SSL encryption. Since I am not sure of the SDK you are using, I am mentioning below an example code in python to communicate over SSL connection:

import redis

r = redis.StrictRedis(
    host='<host_name_of_cluster>',
    port=6379,
    password='auth_password_if_set_at_the_time_of_creation_of_cluster',
    ssl=True,
)

r.set('foo', 'bar')
response = r.get('foo')
print response

When I run the above code in a client, it successfully sets the key 'foo' to a value 'bar' and then retreives it from the cluster. We do not need any certificate on the client side to do so. All you need is an auth password you must have set at the time of creation of the cluster.

For a list of all the redis clients that support SSL encryption, please refer https://redislabs.com/blog/secure-redis-ssl-added-to-redsmin-and-clients/"
Amazon Elasticache	"Intermittent Errors Redis::connect(): Name or service unknown
We are using redis in our vpc and our servers using redis are throwing 5-10 below connection errors intermittently everyday. Seems like dns resolution issue within vpc. Can you tell us what is going on here?

Thanks.

Mon May 22 19:30:47.518097 2017] https://forums.aws.amazon.com/ https://forums.aws.amazon.com/ client 10.0.0.173:26439 PHP Warning:  Redis::connect(): php_network_getaddresses: getaddrinfo failed: Name or service not known in Controller.php on line 174
Mon May 22 19:30:47.518349 2017 https://forums.aws.amazon.com/ https://forums.aws.amazon.com/ client 10.0.0.173:26439 PHP Fatal error:  Uncaught exception 'RedisException' with message 'Redis server went away' in"
Amazon Elasticache	"Re: Intermittent Errors Redis::connect(): Name or service unknown
Can you guys look into this? Thanks."
Amazon Elasticache	"Re: Intermittent Errors Redis::connect(): Name or service unknown
I have the same issue.
I have an RDS postgresql.

From time to time (about once/twice a day), one of the database client fails to establish a connection due to what seems to be a DNS error.

What can be done?

could not translate host name ""usp******ycz.us-east-1.rds.amazonaws.com"" to address: Name or service not known

Note that this is happening from inside the VPC (EC2 instance and RDS instance are in the same VPC)

Edited by: gbataille on Jan 14, 2018 10:49 PM"
Amazon Elasticache	"Re: Intermittent Errors Redis::connect(): Name or service unknown
Hello skchub and gbataille,

I am singhal-aws from AWS premium support. 

Each Amazon EC2 instance limits the number of packets that can be sent to the Amazon-provided DNS server to a maximum of 1024 packets per second per network interface. This limit cannot be increased. The number of DNS queries per second supported by the Amazon-provided DNS server varies by the type of query, the size of response, and the protocol in use. If your queries to the DNS server exceeds this limit, it will start throwing unknown host error for elasticache or rds instances as the issue you are facing.

Solutions:

Enabling connection pooling in the database connector/client.   PHPMySQL mysqli php etc...
Enabling DNS caching on the EC2 instance. NSCD DNSMASQ
Change the timeout and retry values for the DNS resolver. (timeout:2 and attempts:5)"
Amazon Elasticache	"Exception with configuration poller when using elasticache cluster client
Hi,
We have an Elasticache cluster setup with two nodes. I downloaded the elasticache cluster client and connected using the cluster end point and the port. I am able to access the items from the cache and insert them into the cache. The auto discovery feature works great as well. But there are tons of errors in my tomcat logs about not being able to find the nodes. 

Here are the exceptions. We are are JDK 1.6.0_27. Does anybody have any thoughts on why this is happening? 

ERROR net.spy.memcached.ConfigurationPoller:  Error encountered in the poller. Current cluster configuration: null
java.lang.RuntimeException: Exception waiting for config
	at net.spy.memcached.MemcachedClient.getConfig(MemcachedClient.java:1673)
	at net.spy.memcached.ConfigurationPoller.run(ConfigurationPoller.java:115)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:351)
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:178)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:165)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:267)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1146)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:679)
Caused by: java.util.concurrent.ExecutionException: net.spy.memcached.internal.CheckedOperationTimeoutException: Operation timed out. - failing node: /10.10.0.95:11211
	at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:106)
	at net.spy.memcached.internal.GetConfigFuture.get(GetConfigFuture.java:50)
	at net.spy.memcached.MemcachedClient.getConfig(MemcachedClient.java:1661)
	... 9 more
Caused by: net.spy.memcached.internal.CheckedOperationTimeoutException: Operation timed out. - failing node: /10.10.0.95:11211

Edited by: Gowthams on Apr 16, 2013 8:00 AM"
Amazon Elasticache	"Re: Exception with configuration poller when using elasticache cluster client
Gowthams, how did you solve this issue?
I am facing the same problem. When using auto-discovery, at times the defaultMemcachedClient fails to get created because of an exception waiting for config. 
I am using SSM with AWS elasticache."
Amazon Elasticache	"Re: Exception with configuration poller when using elasticache cluster client
Has any body of you found out the solution to the above problem?"
Amazon Elasticache	"Re: Exception with configuration poller when using elasticache cluster client
I just hit the same issue in production yesterday.  I ended up having to delete a node in the cache cluster and build another.  After that everything worked fine.  I would love to hear from somebody at AWS about this.  Here is the log from our application:

2015-09-22 16:11:23.627 ERROR net.spy.memcached.ConfigurationPoller:  Error encountered in the poller. Current cluster configuration: 1
prod.rrzk9u.0001.usw2.cache.amazonaws.com|10.250.250.25|11211 prod.rrzk9u.0002.usw2.cache.amazonaws.com|10.250.250.72|11211
java.lang.RuntimeException: Exception waiting for config
	at net.spy.memcached.MemcachedClient.getConfig(MemcachedClient.java:1668)
	at net.spy.memcached.ConfigurationPoller.run(ConfigurationPoller.java:115)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.util.concurrent.ExecutionException: net.spy.memcached.internal.CheckedOperationTimeoutException: Operation timed out. - failing node: /10.250.250.72:11211
	at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:106)
	at net.spy.memcached.internal.GetConfigFuture.get(GetConfigFuture.java:50)
	at net.spy.memcached.MemcachedClient.getConfig(MemcachedClient.java:1656)
	... 8 more
Caused by: net.spy.memcached.internal.CheckedOperationTimeoutException: Operation timed out. - failing node: /10.129.69.72:11211
	... 11 more"
Amazon Elasticache	"Re: Exception with configuration poller when using elasticache cluster client
I see this is an old problem, but I just stumbled across this in my own code base. With the help from SSM, I was able to figure out what the issue is. 

SSM uses net.spy.memcached under the covers. In ClientMode.Dynamic net.spy.memchached sets up a poller which goes out to the mechached cluster once a minute to retrieve the current cluster configuration. For some reasons these get config calls take just under 5 seconds for me, however the net.spy.mechased time by default is set to 2.5 seconds and hence the errors in the logs. 

SSM allows to configure the timeout value which for me eliminated the errors in the log: 

ElastiCacheConfiguration cacheConfiguration = new ElastiCacheConfiguration();
//As opposed to DefaultHashAlgorithm.NATIVE_HASH
//Consistent hashing uses DefaultHashAlgorithm.KETAMA_HASH
//and locatorType Locator.CONSISTENT
cacheConfiguration.setConsistentHashing(true);
//If UseAutoDiscovery is set to true, all settings in cacheConfiguration are discarded in favor of default values
cacheConfiguration.setUseAutoDiscovery(false);
//Starts a poller in net.spy.memcached which once every minute goes out and retrieves the cluster config
cacheConfiguration.setClientMode(ClientMode.Dynamic);
//For some reason the get config calls can take up to 5 seconds. The default net.spy.memcached timeout is 2.5 seconds,
//therefore the timeout needs to be increased to above 5 seconds
cacheConfiguration.setOperationTimeout(10000);
cacheFactory.setConfiguration(cacheConfiguration);"
Amazon Elasticache	"Connecting to a ElastiCache Cluster Launched in EC2-Classic from EC2-VPC
Hi everyone!

I have an ElastiCache Cluster launched in EC2-Classic for years and is only connected to by EC2-Classic instances.

I launched some EC2-VPC instances recently, and would need these EC2-VPC instances to connect to that same ElastiCache Cluster. However, since the cluster is in EC2-Classic, there is nothing from Security Group that I can add for the EC2-VPC instances.

I have gone through documentations, and it seems that there is a way to work it out if the situation is the other way round (i.e., EC2-Classic instance connecting to EC2-VPC ElastiCache Cluster), but not in my situation. Do you have any suggestion on whether there is a workaround for my situation (without re-launching the ElastiCache Cluster in EC2-VPC, and have my EC2-Classic instances connecting to it)?

I can think of setting up a proxy on one of my EC2-Classic instance (or a new instance) for the EC2-VPC instances to connect to, but this sounds a bit silly to do.

Thank you very much!"
Amazon Elasticache	"Elasticache Redis & Websockets - Redis becomes unresponsive
We currently have a php application running on EC2 which uses a single Redis node (r3.large) for managing sessions and data caches for ~500 concurrent users. 

We recently developed a node application with socket.io in order to push updates to the users browsers. Its running in ECS with one task (memory usage < 10%). The node app subscribes to Redis over Pub/Sub and then pushes messages to different socket.io rooms & namespaces.

On every page load in the php application it requests  a socket connection to the node socket app.

----

When we deployed the new node application and changes in the PHP application to request sockets, Redis becomes unresponsive or very slow. CPU is never over 50% and number of connections is < 1000.

When I add a read replica for the Elasticache Redis node and tell the node socket app to use that read replica to subscribe we dont have Redis connectivity issues.

----

What limits are we hitting? How can I get more insights into our issue? Is there a better way to implement websockets in AWS? Should we be separating concerns by pub/sub'ing on a separate node then our sessions/data caches?"
Amazon Elasticache	"Restoring from backup to scale down, but no option to reenable encryption
I'm not sure if this is a bug but I'm trying to scale down my EC cluster which is a Redis 3.2.6 c4.2xl(cluster mode disabled) with one primary and replica, multi-AZ and encryption at-rest. I read the docs,  it says I need to do a restore from backup and the option to enable encryption at-rest during restore is there but it's not. When I try to restore from backup in EC, no matter which node type, setting clustered disabled, I still do not see an option for encryption.  https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/at-rest-encryption.html#at-reset-encryption-enable-existing-cluster

After restoring, I have to go in to reenable multi-AZ, security groups, but still no option for encryption... is this a bug or missing feature or am I doing something wrong? I'm trying to scale down to a c4.large which is what I restored to. Thanks!"
Amazon Elasticache	"Re: Restoring from backup to scale down, but no option to reenable encryption
so console still does not work, but I was able to get it work with the aws cli instead."
Amazon Elasticache	"Re: Restoring from backup to scale down, but no option to reenable encryption
Hello,

I will submit a feature request to Elasticache console team to enable this feature.

At the moment, you can use AWS CLI or AWS API call to restore Backup with encrption.

This is an example command you can use:
aws elasticache create-replication-group \
   --replication-group-id my-clustered-rg \
   --replication-group-description ""redis clustered cluster"" \
   --cache-node-type cache.m3.large \
   --num-node-groups 1 \
   --replicas-per-node-group 2 \
   --engine redis \
   --engine-version 3.2.6 \
   --at-rest-encryption-enabled \
   --cache-parameter-group default.redis3.2.cluster.on \
   --cache-subnet-group default \
   --snapshot-name backup-name"
Amazon Elasticache	"Redis replication cross region
Hi there,

I am looking to speed up global responsiveness of our web service by replicating Redis cache to multiple regions? After looking around I could not find any suggestions of how to solve this issue.

Any suggestions? 

Dee"
Amazon Elasticache	"Re: Redis replication cross region
Moving this post to the ElastiCache forum which would be more appropriate for getting visibility. Thank you."
Amazon Elasticache	"Re: Redis replication cross region
Thanks!"
Amazon Elasticache	"Re: Redis replication cross region
I'm also wishing there was a good way to handle cross region replication of Redis in ElastiCache. Anyone have a decent solution for this?"
Amazon Elasticache	"Re: Redis replication cross region
Hi there,
Did any of you ever discovered any solution to cross region replication of cache ?"
Amazon Elasticache	"Urgent: Elasticache Redis 3.2.10 crashed twice in last 24 hours!
Hello

Yesterday evening one of our redis nodes (created on December 12, 2017 at 2:20:03 PM UTC+1) suddenly no longer started accepting connections, as well could be seen that the CloudWatch metric charts were no longer updating. The node / cluster status however was shown as 'available' in the AWS console.

After approximately 10 minutes of connection loss we decided to reboot the node, which brought the node back up, but to our surprise completely empty (we would have assumed that a simple reboot on the same host would keep the Redis data).

We thus restored a snapshot to a fresh node (created January 3, 2018 at 9:52:21 PM UTC+1), which also crashed on today (around approx 13:00 PM UTC +1) with the same connection issues and also still shown as 'available' in the dashboard, however this time the node auto-recovered in approx 10 minutes, but completely lost its memory. There is NO indication in events log that this node would have had any problem or would have had restarted. It just suddenly no longer accepted connections and then lost its memory.

Assuming this has something to do with Redis release 3.2.10, we now created a new 3.2.4 version node out of an older 3.2.4 backup, as it's not possible to downgrade Redis versions from a newer backup.

Can AWS please urgently look into this issue and contact us by PM in case you need to know the exact node names in order to investigate (we didn't terminate yet the faulty ones).

We are hoping that 3.2.4 will continue running fine and are looking for feedback on what has caused this.

Regards
Marcel"
Amazon Elasticache	"Re: Urgent: Elasticache Redis 3.2.10 crashed twice in last 24 hours!
Please check my response at 
https://forums.aws.amazon.com/thread.jspa?messageID=823091"
Amazon Elasticache	"URGENT: Serious problem with Elasticache Redis CRASHING 3rd time in 24hours
Hi

As I already wrote in https://forums.aws.amazon.com/thread.jspa?threadID=270691&tstart=0 our Elasticache Redis instances keep crashing since January 3rd 2018. The instances suddenly no longer accept any connections and approx 15 minutes later they're available again but the Redis memory has been lost!! The dashboard indicates that the instance would be 'available' all the time.

Initially we thought this could have something to do with Redis 3.2.10 release, for which we went back to an earlier 3.2.4 version and this now has the exact same issue. We run Elasticache Redis on AWS for many years and never experienced such issues.

We now assume AWS has rolled out some host patches related to Intel's CPU Meltdown and Spectre bugs, which make Elasticache Redis crash.

3 crashes / memory lost instances during 24 hours are totally UNACCEPTABLE for a production service! AWS needs to solve this IMMEDIATELY!

Marcel"
Amazon Elasticache	"Re: URGENT: Serious problem with Elasticache Redis CRASHING 3rd time in 24hours
Hello,

I have looked at your Elasticache Redis Cluster. I can see that the Redis clsuter has been running at the maximum CPU utilisation from last month after it is created. All your three Redis nodes are crashed due to the high usage. This is not caused by the Redis 3.2.10 release and Intel's CPU Meltdown+Spectre bugs.

Since Redis is single-threaded, the threshold is calculated as (90 / number of processor cores).
The threshold for CPU utilization would be (90/4) or 22.5% for m2.2xlarge node type (4 vCPU).
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html
You should be able to find that your Elasticache nodes are all running above 22.5%. 

When the Elasticache node running via the maximum CPU utilisation, the node can become unresponsive randomly. If the node unresponsive for a lonh time, it would fail.  As you are using a standalone Redis node without any replica. The data was lost when failure happen.
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/FaultTolerance.html#FaultTolerance.Redis

I would suggest you:
1. Add replica and enable Multi-AZ with automatic failover on your Redis replication groups to mitigate failure. 
2. Increase Read capacity by adding read replica as your main workload is from read requests.
3. Consider about using cluster mode enabled Redis cluster and add more shards to distribute the write workload across more primary nodes.
4. Monitor the performance metrics for performance issues
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html"
Amazon Elasticache	"Meltdown patch on ElasticCache (Redis) instances
Hi everybody.
Has Amazon applied Meltdown patches to VMs hosting ElasticCache (redis) instances? Does this patch requieres a reboot or, although involving kernel, can be hot applied without service disruption?
We have experienced a noticiable increase in CPU usage on our Redis instances and we don't know if this could be due to this patch.
Thanks in advance."
Amazon Elasticache	"Re: Meltdown patch on ElasticCache (Redis) instances
Hello,

The AWS infrastructure underlying these services has already been protected. Further details on RDS/Elasticache/Redshift updates will be posted in a forthcoming AWS Security Bulletin.
https://aws.amazon.com/security/security-bulletins/AWS-2018-013/

As a result of these fixes, depending on the precise workload, operating system, and hypervisor, customers may experience increased CPU usage.

As a result of the high rate of IOP/s that ElastiCache workloads have, some ElastiCache clusters are experiencing increased CPU usage. For clusters where this increase pushes past the scaling threshold, we recommend customers either scale up (by moving to larger instance types) or scale out (by adding more shards and/or read replicas) to bring cluster utilization back to previous levels. Please follow ElastiCache’s best practices for scaling (https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Scaling.html) and resharding (https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/best-practices-online-resharding.html )."
Amazon Elasticache	"Elasticache redis clusters do not disappear from list after create-failed
We have three redis clusters that we attempted to seed from missing or misconfigured redis dumps. The creation failed on all three, but the clusters refused to disappear from the cluster list. They cannot be deleted or modified in any way.

I do not believe we are being charged for these, but it is distracting to see these clusters in the list every time I look at it. Also, while these remain in the list it is impossible to re-use the cluster names.

I believe this is a bug in the create-cluster failure workflow. 

We need someone to look at these clusters behind the scenes and help remove them permanently."
Amazon Elasticache	"Re: Elasticache redis clusters do not disappear from list after create-failed
Hello,

This is a console bug in Elasticache and our console team is actively working on the issue. 

To remove the ""creation-failure"" cluster, please use the AWS cli command.
$ aws elasticache delete-replication-group --replication-group-id cluster-name

[1]Deleting a Cluster with Replicas (Console, CLI, API)
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Replication.DeletingRepGroup.html

[2] Cli command
https://docs.aws.amazon.com/cli/latest/reference/elasticache/delete-replication-group.html

Best regards,
Louisa"
Amazon Elasticache	"How does ElastiCache service manage Redis single node mode?
If I use Redis single node as ElastiCache service, e.g,  no multi-AZ mode and no replica node either, just a single node to save cost for my poor man's application. Is the availability (uptime) SLA roughly equals the EC2's availability?

If the Redis instance gets down for whatever reason, is Amazon going to bring it back automatically (I understand the data got lost in this case, but I am ok with that to save my cost)? What is the MTTR for that?"
Amazon Elasticache	"Re: How does ElastiCache service manage Redis single node mode?
Hello,

If a standalone redis node fail, Elasticache will replace this node with a empty node. Base on personal experiences, it completes within five to twenty minutes. You may consider talking regular backup to secure your data.

Other than underlying host issue that similar to EC2, the cache node can also fail because of other issues such as insufficient memory. Following the best practices can help you to improve the availability. 
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/BestPractices.html"
Amazon Elasticache	"ElastiCache Node + KUE
So we have been running a KUE server on an Ubuntu EC2 instance for 3 years. KUE comes with Redis and runs locally. On Sunday, December 21st, 2017 it stopped working. Every day around midnight something happens and the local Redis server becomes unreachable. 

Error: Redis connection to 127.0.0.1:6379 failed - connect ECONNREFUSED

I check usage and I have 60% space left so not sure why Redis is going down? I decided to move to ElastiCache REDIS since keeping Redis running locally isn't such a good idea. My question is since ElastiCache doesn't use passwords and relies on Security Groups, how do I reference the external Redis in Node (KUE)?

var thing = kue.createQueue({redisConfig = {
    redis: {
      port: 6379 //process.env.REDIS_PORT,
      host: what goes here? //process.env.REDIS_HOST,
      auth: null?
   }
  }
});

What do I put for HOST this?
http://blahblah.44449vz.0002.usw2.cache.amazonaws.com

What do I put for AUTH this?
null or remove it completely?

Edited by: jdog1973 on Dec 21, 2017 11:56 AM"
Amazon Elasticache	"Maintenance window change not respected / Why no live migration?
Hi

We received node replacement e-mails for our memcache and redis instances, where the one for memcache was just sent with 2 days notice (Saturday 9th 2017 with node replacement on Monday 11th).

Having noticed this during weekend, we opted to change the maintenance window from Monday to Tuesday in order to give us more time. According http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheNodes.NodeReplacement.html such maintenance shift should be possible within 1 week from the originally scheduled time.

In our case this change was not respected and AWS performed the node replacement already at Monday. Can you please check why the rescheduling had no effect and/or if the documentation is wrong regarding this?

Having said that, those 2 instances (the redis one scheduled for a bit later on 18th Dec) were just freshly created back in October 2017 (also due to a maintenance event back then). How come that AWS provisions new instances on hosts that are already within 2 months time taken out of service or require reboots?

Why can't AWS simply perform live-VM migration of Memcache & Redis instances to other hosts while they are running? This shouldn't be too much asked from a cloud provider of your size, given the fact that live migration is standard on Google Cloud Platform.

Looking forward to improvement in this area.

Regards
Marcel"
Amazon Elasticache	"Elasticache Snapshot/Backup SnapshotFeatureNotSupportedFault Error
I'm getting an error ""An error occurred (SnapshotFeatureNotSupportedFault) when calling the CreateSnapshot operation: The given configuration of this cluster does not support snapshotting."" when trying to create a snapshot of my Redis setup. I found  http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_CreateSnapshot.html where it mentions ""Creating a snapshot of a Redis cluster running on a cache.t1.micro cache node"" and ""Creating a snapshot of a cluster that is running Memcached rather than Redis"" as reasons for failure.

I confirmed that this is Redis and not Memcached, and that my node type is cache.t2.small.

Is there other reasons for this error that aren't documented?"
Amazon Elasticache	"Redis: all keys disappeared
We have single node Redis in ElasticCache (cache.t2.medium), and today we experienced connection failures that lasted for about one minute. Once we connected again, it appears that all keys were gone. According to Cloudwatch CurrentItems dropped from almost 10M to 0.
BytesUsedForCache was about 1.7GB. The last couple of days, Swap usage has grown, and shortly before the error, it peaked to 20MB. 

Is there a way to find out what happened? Any suggestions what to look for?

Edited by: andersff on Dec 7, 2017 5:11 AM"
Amazon Elasticache	"Will ASP.NET local session state work properly in Free Tier configuration?
I have a new Free Tier account, and I'm about to port an existing (under development) ASP.NET application to it.  The application is currently configured with the ""local"" (default) session state provider. 

I understand that the local session state will not work properly when the application scales and needs to operate across multiple virtual server instances, and that when I scale to that level I would need to use Elasticache for session state.

Question:  if the application is only running in the Free Tier configuration, with its ""micro"" EC2 instance, will the ""local"" session state provider work?  Or do I need to move to Elasticache immediately? (And if so, why?)

I need to know for planning because the application code will need to be modified to use a different session state provider.

Thanks!"
Amazon Elasticache	"Elasticache Redis (cluster mode enabled) config endpoint empty CNAME
Hi, I've created a 2 shard - 2 replica redis cluster that returns the following config endpoint CNAME:
clustertest.pa8css.clustercfg.euw1.cache.amazonaws.com

but when doing a dig on it it returns no A records:
;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 0
;; QUESTION SECTION:
;clustertest.pa8css.clustercfg.euw1.cache.amazonaws.com.        IN A

;; AUTHORITY SECTION:
euw1.cache.amazonaws.com. 60    IN      SOA     ns-108.awsdns-13.com. awsdns-hostmaster.amazon.com. 1 7200 900 1209600 86400

;; SERVER: 172.30.0.2#53(172.30.0.2)

However, the CNAME records for the shards primary node and replica do work.

From the docs at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Replication.Endpoints.html:
""Redis (cluster mode enabled) has a configuration endpoint which ""knows"" all the primary and node endpoints in the cluster. Your application connects to the configuration endpoint. Whenever your application writes to or reads from the cluster's configuration endpoint, Redis, behind the scenes, determines which shard the key belongs to and which endpoint in that shard to use. It is all quite transparent to your application.""

Am I doing something wrong or is this out of my control?"
Amazon Elasticache	"No pricing information for m3 nodes.
The m3 node specs are on the current generation pricing page, but there are no prices for them.

They're not mentioned at all on the pricing page for previous generations.

The m3 prices should be available somewhere."
Amazon Elasticache	"Re: No pricing information for m3 nodes.
Found them.  The m3 aren't available in us-east-2 where the pricing page was defaulting to."
Amazon Elasticache	"Redis encryption though CloudFormation
I am creating Cluster through a CloudFormation template. I try to enable AtRest encryption (http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/at-rest-encryption.html) but it looks like it's not supported inside CloudFormation. No option here: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html#w2ab2c21c10d532b9

Is there some other way to enable encryption through CloudFormation?

Thanks!"
Amazon Elasticache	"Connection between AWS Elasticache and godaddy server not happening
I have tried to connect the AWS Elasticache (Elasticache created in AWS server) from my godaddy server which is not connecting each other. Could anybody suggest the solution for resolve this problem which would helpful for me to implement."
Amazon Elasticache	"Using Redis ElastiCache with existing Java app on ElasticBeanstalk
Hi,

Currently I have a Java app running on ElasticBeanstalk on PostgreSQL DB which resides on AWS RDS.

I require to utilize a cache for this app. For this purpose I created a Redis ElastiCache instance. I Also did the changes to my ElasticBeanstalk application as per http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-environment-resources-elasticache.html#customize-environment-resources-elasticache-defaultvpc, ie: by adding the two .config scripts.

I didn’t get any errors when starting the application and the application is working as usual.

How do I know that my app is utilizing the Redis ElastiCache instance which I created?
Are there any further changes I need to do to my app for this purpose?

Appreciate any assistance in this regard."
Amazon Elasticache	"Elasticache server suddenly dead?
We have a redis server that suddenly stopped taking connections. No indication on any logs as to why. Can't reboot, can't make a backup. Can someone help us recover it?"
Amazon Elasticache	"Re: Elasticache server suddenly dead?
We're also unable to make new redis servers. They have been creating for a very long time with no progress. Is anything wrong on a service-wide level?"
Amazon Elasticache	"Re: Elasticache server suddenly dead?
Looks like it's back -- we think this was related to the ec2 connectivity issue reported here https://status.aws.amazon.com/.

Edited by: webstronggroup on Oct 13, 2017 5:27 PM"
Amazon Elasticache	"Redis requirepass configuration
Looking to use Redis via ElastiCache with a service that lives outside of my Amazon security groups (Heroku). Do not see the requirepass configuration parameter exposed in the Elasticache which would let me secure the interface. Any plans on adding this configuration option to the parameters available in ElastiCache?"
Amazon Elasticache	"Re: Redis requirepass configuration
Hi,

Thanks for your interest in ElastiCache.  Currently ElastiCache for Redis does not provide a requirepass configuration parameter, instead  VPC Security Groups and Cache Security Groups are used for access control.  We will take your request for supporting the requirepass configuration parameter under consideration.

Sincerely,
Tony"
Amazon Elasticache	"Re: Redis requirepass configuration
I am getting ""(error) ERR unknown command 'requirepass'"" when trying to set password. Is redis authentication still not available in Elasticache"
Amazon Elasticache	"Re: Redis requirepass configuration
Not know when ElasticCache will support requirepass configuration. Could try to install Redis on AWS ECS by yourself. You could use requirepass or other configuration you want. FireCamp, https://github.com/cloudstax/firecamp, could help to simplify setting up Redis cluster on ECS, and automate the management."
Amazon Elasticache	"Re: Redis requirepass configuration
Thanks CloudStax"
Amazon Elasticache	"Redis AOF enabled, rebooted, data gone
Not sure if this is a bug, or if we're just misconfigured.
We've got appendonly set to yes, appendfsync set to everysec. When we reboot the node, all data is missing.

The endpoint in question is test-bc.n7emm3.ng.0001.use1.cache.amazonaws.com, if someone from AWS take a peek, that'd be awesome."
Amazon Elasticache	"Re: Redis AOF enabled, rebooted, data gone
Hello,

Please check the document about Redis AOF. You need to ensure your redis node have the versions and instance type that supported AOF.
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/RedisAOF.html


AOF is not supported on Redis versions 2.8.22 and later.
Append-only files (AOF) are not supported for cache.t1.micro and cache.t2.* nodes. For nodes of these types, the appendonly parameter value is ignored.
For Multi-AZ replication groups, AOF is disabled.


If you are enabling AOF to protect against data loss, consider using a replication group with Multi-AZ enabled instead of AOF. 
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/BestPractices.AOF.html"
Amazon Elasticache	"Re: Redis AOF enabled, rebooted, data gone
One additional question: why ElastiCache Multi-AZ with Automatic Failover and append-only file (AOF) are mutually exclusive? The cost of AOF is too high? If multi-azs loses power around the same time, data lose might happen. But the probability that multi-azs lose power concurrently is very low. So could disable AOF for performance?

Thanks!"
Amazon Elasticache	"Elasticache  Redis cluster endpoint
I'm curious about how the ""Configuration endpoint"" works with Elasticache Redis cluster (cluster mode enabled).    It comes up as a DNS entry with N IPs where N = number of shards.   

Now, when i use a cluster client i'm supposed to flatten this configuration endpoint to N host:port addresses because redis requires you to address the redis instance you are writing to.   Does the configuration endpoint for the cluster do any proxying at the backend ?   I don't believe so hence i'm a little confused when i read this statement.

""Use the Configuration Endpoint for both read and write operations. Redis determines which of the cluster's node to access."".  

Does it refer to clients that automatically take a DNS entry and create a list of host:port out of it ?  The C client i'd like to use does not do this i think.  it needs the full list of nodes."
Amazon Elasticache	"Re: Elasticache  Redis cluster endpoint
Hi,

When working with Cluster mode enabled Redis clusters, you need to use a 'Cluster Aware' client. 

The cluster aware clients reply on Redirections Messages from the Redis nodes to connect to the correct shard. Such clients should also learn the hash slot to node mapping to connect to the correct node. 

Please go through the documentation from Redis about redirections for more information:
https://redis.io/topics/cluster-spec

Hope this helps.

Best Regards,
Jayakrishnan L."
Amazon Elasticache	"Re: Elasticache  Redis cluster endpoint
My question was w.r.t whether there is any proxying done.   It appears the answer is No although not spelt out clearly."
Amazon Elasticache	"Re: Elasticache  Redis cluster endpoint
yes, don't think ElasticCache Redis does the internal proxy. Redis node will send the Redirections message to Redis client. Client will then talk to the node directly."
Amazon Elasticache	"Cannot connect to ElastiCache from Elastic Beanstalk
I have an Elastic Beanstalk (EB) platform with an EC2 instance, and want to configure an Elasticache (EC) redis instance for it to talk to. I've followed the example here (http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-environment-resources-elasticache.html) but am instead using a t2.micro instance for EC.

However, I'm unable to connect to the EC instance from my EC2 instance at all -- I can't connect via redis-cli or even look up the hostname (there's no DNS entry if I nslookup the EC endpoint while ssh-ing into the EC2 instance).

I have double checked to ensure the following:


both instances are running
I am trying to connect to the right hostname (there's only one EC node)
EC and EC2 instance are in the same region and AZ
EC and EC2 instance are in the same VPC, but in their own security groups.
The EC group allows inbound TCP traffic on port 6379 (redis) and outbound anything. In fact, I'm still unable to connect if I allow all incoming traffic from everywhere on the EC instance.
EC2 instance allows outbound anything. I don't think inbound matters for the EC2 instance.
EC and EC2 instances are in the same subnet group


I'm now stuck. Any help would be appreciated!"
Amazon Elasticache	"Elastic Cache of Redis available but unable to connect remotely
Hi 

I have created ElastciCache Redis instance under t2.micro 

clusterweatherapp.1uttjy.0001.aps1.cache.amazonaws.com:6379

in the dashboard it says ""available"" however if I try to connect to this instance from my local terminal, I get error 

Is the server running on host ""weatherapp.1uttjy.0001.aps1.cache.amazonaws.com"" (172.32.20.183) and accepting
	TCP/IP connections on port 6379?

Well it is running as per the dashboard on 6379 , can I not access it outside the AWS from terminal on local machine ?"
Amazon Elasticache	"Re: Elastic Cache of Redis available but unable to connect remotely
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Access.Outside.html
The service is designed to be accessed exclusively from within AWS"
Amazon Elasticache	"Elasticache redis HIPAA ?
I was wondering if there are any plans to have redis elasticache service as a HIPAA compliant service!?

Short of running my own EC2 with redis on it (both caching and queueing... ), are there any alternatives that other members are using ?

Thanks
-sBham"
Amazon Elasticache	"ElastiCache Memcached nodes are not used some what evenly
Hi,

We run a 2 node Memcached cluster (cache.m3.medium). After we restarted the 
the nodes where the Memcached clients are running, 
only one of the Memcached node is in use, now. The other Memcached node is inactive.
We saw a similar behavior after we restarted the 'client' nodes before but not so 
drastically. Meaning that now only one node is getting all the traffic and the second 
sits there with out any work.

We connect via the configuration endpoint.

Any idea why the nodes are used not evenly or even one node is not used at all?"
Amazon Elasticache	"Elasticcache instance bounced mysteriously
This morning we received a notification  - ElastiCache:CacheNodeReplaceComplete  - that  one our our redis server instances was recycled. This caused the system too loose all data  

We did not request this so we suspect that either the host crashed or AWS had do perform some emergency  fix and endded up moving our instance..  I would have expected some kind of notification in the form of a scheduled event..   There  was no maintenance advisory on our account for this service.. 

Who can help explain ?  

node label - cos-prod-redis-mg1 

thanks  

mb"
Amazon Elasticache	"Memcached: Swap Usage is slowly and continuously growing
Hi,

We use 2 node (cache.m3.medium) ElastiCache Memcached cluster.
After a while the first node started to use swap space (currently around 23MB).
The second node also started using swap space.  I am wondering why the nodes 
use swap space even there is still memory available. 
Further, the two nodes are used not evenly.  I would have expected that the nodes are utilized
some what evenly.

Any idea what might go on there?

Thanks 
    Stefan Schulz"
Amazon Elasticache	"Redis connection errors when using M4.Xlarge to connect
We are using ElastiCache (a Redis cache.m4.2xlarge instance) for our PHP session storage and some caching.

The redis server is only running at about CPU 7-15%, and we are connecting to it from about 10-15 M4.Large Centos/Apache/PHP webservers.

We have been thinking about cutting down on our server count by upgrading to M4.Xlarge webservers, so that it would cut the number of servers in half.  However when doing this something weird starts happening with redis; we start to get failed connection errors, such as session errors:

Failed to write session data (redis). Please verify that the current setting of session.save_path is correct (tcp://****our-redis-server:6379)


So after upgrading to all M4.XLarge webservers, so we have (for example) 7 webserver instances, and getting the same CPU load levels as when we were running 15 M4.Large (as expected)...redis server is still running as normal...7-15% CPU and similar stats as with the M4.Large servers...but keep getting the failed connection errors.

Any idea why this would occur, or ways to troubleshoot this?"
Amazon Elasticache	"Migrate Redis ElastiCache into VPC
We are moving our system from EC2 Classic to VPC. We are using EC2 instances for app servers, ElastiCache for Redis/Memcache, and RDS. I found a tutorial on dumping & uploading data from Redis in order to populate a new cluster within a VPC, but this would require downtime while we copy data over. 

Is there any way to do data replication from ElastiCache EC2 Classic to ElastiCache within VPC? Basically we want a SLAVEOF relationship with VPC Redis being slave and Classic Redis being master, until we do the switchover, when we promote VPC Redis to master. I know SLAVEOF is disabled in ElastiCache, but is there any documented strategy for this migration without data loss or downtime?"
Amazon Elasticache	"Elasticache primary performance tanks when backup taken from replica.
We recently migrated from self-hosted redis to Elasticache. We now have 10 separate Elasticache clusters which all perform normally except for one that shows very weird behavior when a nightly backup occurs.

Specifically when automated backup is starts on replica node, performance utterly tanks on the primary node, to the point that our client applications see a ton of socket timeouts on both reads and re-connects querying the primary. This spike in errors is very dramatic and only occurs on one of our DBs and only when the automated backup on the replica is taking place.

We also observe that the “Current Items” cloudwatch chart on the **replica** drops from around 850K items (correct) to around 20k when the backup starts. At the same time the “Replication Bytes” on the primary and the “Network In” charts on the replica spike dramatically. 
We do NOT see any drop in “Current Items” in the primary.

Our best (but incomplete) theory is that for reasons unknown when the automated backup starts it causes the replica to lose all its state (hence current items drops from 850k to 20k) and it immediately replicates like crazy to rebuild its state and while this happens latency increases dramatically, resulting in socket timeouts both reading data and reconnecting. NOTE: Since the Cloudwatch data is minutely, we suspect the number of items may actually drop to closer to 0, but since replication kicks in, it increases to 20k)

We would like to understand why a replica would appear to lose all its contents and require a major replication cycle each time a backup occurs and also understand what we need to do to fix it.

The problematic instance is a cache.r3.2xlarge

redis info shows:
  used_memory:38563018072
  used_memory_human:35.91G
  used_memory_rss:39477035008
  used_memory_rss_human:36.77G
  used_memory_peak:39809264680
  used_memory_peak_human:37.08G

One thing that caught our attention is max memory: 
redis info shows: maxmemory:46871347200
However the AWS documentation says the maxmemory for a cache.r3.2xlarge should be 62495129600
This puzzles us. Are we looking at the wrong max-memory setting? Why is the reported max_memory so different to the expected value for the cache instance? We are using the default.redis.3.2 parameter group.

All our instances are configured similarly. 
Redis Engine 3.2.4, parameter group: default.redis.3.2
Cluster mode disabled, Multi-Az (primary: us-east-1a, replica: us-east-1b)
Backups are performed on the replica (us-east-1b) node.
We only see this problem on one of our clusters.

Has anyone seen a similar problem? 
Can anyone suggest any metrics we should be looking at to further diagnose the problem?
Any suggestions as to what configuration changes we should consider other than increasing to a larger server size?"
Amazon Elasticache	"ElastiCache redis 4.0 support
Hi,

Does anybody know when redis 4.0 will be available in ElastiCache?
It has new features, particularly c modules, I would be happy to start using right now.

Thanks!"
Amazon Elasticache	"Production elasticache node stopped responding without any alert
Hi,
We've encountered an issue in which one of our elasticache nodes failed responding -
attempts to open connections \ curl \ telnet didn't work, restarting of instance didn't make a change.
Dashboard states that node is in sync, we've also verified SG definitions, but nothing is accessible.

We had to raise another instance (with same specs) to overcome this issue.
Help is required to understand what's the root cause of this reason (and is it due to misuse by us or something on hardware level)

Thanks,
Maor

Edited by: maor_hayun on Aug 15, 2017 1:51 AM"
Amazon Elasticache	"Re: Production elasticache node stopped responding without any alert
Hi,

I had a look at your account and saw that there was an underlying hardware issue due to which a node replacement was done. 

I see that as of now your redis cluster is in a healthy state. I understand that this failure is a great inconvenience for you as an AWS user, please accept my apologies for this. You can opt for multi-AZ replication group [1].

I hope you find my reply useful.

References:

[1] - https://aws.amazon.com/blogs/aws/elasticache-redis-multi-az/"
Amazon Elasticache	"Change the ""hz"" configuration option for redis2.8 node
We're having an issue with our redis servers reaching huge amounts of redis connections using sidekiq on our ruby on rails app servers. Essentially we're at 10s of thousands of connections which by default is handled by redis very well using its default ""hz"" config value of 10. We need to increase this in order to boost performance and hopefully avoid an issue where, every now and then, our sidekiq servers will hang and become completely unresponsive along with very strange, unpredictable symptoms like the filesystem on the ec2 host machine remounting and becoming readonly.

The developer of sidekiq recommends increasing the ""hz"" value on the redis server https://github.com/mperham/sidekiq/wiki/Using-Redis#tuning however I can't find this parameter in the parameter group when I create a new one for redis 2.8.

Is it not possible to change that on AWS ElastiCache?

Thanks in advance!"
Amazon Elasticache	"Failure creating Redis cluster from snapshot from equally sized cluster
I'm trying to create an ElastiCache instance from a snapshot of another ElastiCache cluster. The other cluster is equally sized, using 1 cache.m4.large node. However, mysteriously, I get this error trying to create it:
	RedisElastiCache	The requested cache node type cache.m4.large with 1723148288 bytes of reserved memory does not have enough memory for the requested snapshot automatic.opt-re-4lg0go8owppb-2017-08-15-08-00.

This is creation via cloudformation, e.g.
{
			""Type"": ""AWS::ElastiCache::CacheCluster"",
			""Properties"": {
				""Engine"": ""redis"",
				""NumCacheNodes"": 1,
				""AutoMinorVersionUpgrade"": false,
				""CacheNodeType"": ""cache.m4.large"",
 				""SnapshotName"": ""automatic.opt-re-4lg0go8owppb-2017-08-15-08-00"",
...

The backup is 3.2.4, and current default is 3.2.4, so it doesn't seem like a versioning issue, either.

To get things working right away, I switched the node type to cache.r3.large. This worked properly.

I dunno, an off-by-one issue in the memory size checking for cloudformation updates, perhaps?"
Amazon Elasticache	"Issue with Caching and dynamo db combination
I am using AWS Elasticache and here is the method I am using with annotation,
@Cacheable(unless = ""#result != null and #result.size() == 0"")
 public List<SomeObject> findById(String id) {
        return dynamoDBMapper.query(SomeObject.class, queryExpression(id));
 }


Here is my query expression, 
DynamoDBQueryExpression<SomeObject> queryExpression(String id) {
        SomeObject object = new SomeObject();
        object.setId(id);
        return new DynamoDBQueryExpression<SomeObject>()
                .withIndexName(""idIndex"")
                .withConsistentRead(false)
                .withHashKeyValues(object)
                .withLimit(Integer.MAX_VALUE);
    }


I keep on getting this error in my application log, 
java.io.NotSerializableException: com.amazonaws.services.dynamodbv2.datamodeling.PaginatedQueryList


Looks like it need the PaginatedQueryList class as Serializable. Though I am trying to cache List<SomeObject>, not sure how this PaginatedQueryList is coming into picture. 

Appreciate help!"
Amazon Elasticache	"T2 cache nodes with Multi-AZ (non cluster mode) ?
Hello

""Redis Multi-AZ with Automatic Failover is supported on T2 node types only if you are running Redis version 3.2.4 or later."" http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoFailover.html#AutoFailover.Overview 

I get ""Automatic failover is not supported for T1 and T2 cache node types"" when trying to modify a cluster.

The multi-az button is diabled if I try creating a new cluster with t2 nodes with cluster mode disabled.

Using redis version 3.2.4 in both cases with cache.t2.small with at least 1 replica.

thanks"
Amazon Elasticache	"Re: T2 cache nodes with Multi-AZ (non cluster mode) ?
Hello,

I agree to what you are saying and have tested it out in my lab. As this is not explicitly stated in our documentation I have put in a request with our documentation team to get this added.

Regards,
Harpreet Singh"
Amazon Elasticache	"Re: T2 cache nodes with Multi-AZ (non cluster mode) ?
Thanks"
Amazon Elasticache	"Plans to support ElastiCache from Lambda without NAT/VPC?
Greetings,

Are there plans to make ElastiCache more easily accessible from Lambda functions? If so, are there any rough timeframes?

I'd rather not need to configure the Lambda to run from inside a VPC and deal with the NAT instance. It seems like DynamoDB or Aurora are much lower friction to use with Labmda, but I'm looking for the latency profile and durability tradeoffs of ElastiCache.

Thanks!"
Amazon Elasticache	"Does automatic failover help keeping minimal downtime on maintenance?
We're planning to use Redis (cluster mode disabled) in AWS ElastiCache.

Multi-AZ with automatic failover feature helps keeping minimal downtime in case the primary node goes down.

However, nothing is said about scheduled maintenance. I understand that different availability zones are in different places in region, but will failover work in case of maintenance? Will all nodes go down simultaneously or one by one with automatic failover to each other? Will be data left intact?

Docs do not cover these questions or it is unclear. They just say I should pick a maintenance interval, they don't say what will happen with my data, will be service accessible at all or not, how much does this “fraction of my maintenance window” actually longs.

From docs:
Q: What is a maintenance window? Will my nodes be available during software maintenance?

You can think of the Amazon ElastiCache maintenance window as an opportunity to control when software patching occurs, in the event either are requested or required. If a ""maintenance"" event is scheduled for a given week, it will be initiated and completed at some point during the 60 minute maintenance window you identify.

Your nodes could incur some downtime during your maintenance window if software patching is scheduled. Please refer to Engine Version Management for more details. Patching can be user requested - for example cache software upgrade, or determined as required (if we identify any security vulnerabilities in the system or caching software). Software patching occurs infrequently (typically once every few months) and should seldom require more than a fraction of your maintenance window...

So, what does it mean?"
Amazon Elasticache	"Redis (Elasticache) stops working after sometime
We previously use to store User Sessions in our DB table (Postgres RDS)

We decided to migrate User Session from DB to Redis and made changes in our application

For Redis, we decided to use Elastic Cache service with 1 shard, 2 nodes (primary + replica) and Multi AZ enabled

On the Live environment, things were pretty smooth till a point where number of session crossed 0.5 million (around 3 PM)

At this juncture, Redis Node suddenly stopped responding resulting in complete crash of our Production environment (too many threads waiting for connection)

We had to reboot our instance to resume the service

This happened again later in the evening around 9 PM

The exception generated at Java end (spring)

2016/11/22 09:19:31.749 [http-nio-8080-exec-780] [ERROR] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/].[dispatcherServlet] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception
 
org.springframework.data.redis.RedisConnectionFailureException: Cannot get Jedis connection; nested exception is redis.clients.jedis.exceptions.JedisConnectionException: Could not get a resource from the pool
 
at org.springframework.data.redis.connection.jedis.JedisConnectionFactory.fetchJedisConnector(JedisConnectionFactory.java:140) ~[spring-data-redis-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
 
at org.springframework.data.redis.connection.jedis.JedisConnectionFactory.getConnection(JedisConnectionFactory.java:229) ~[spring-data-redis-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
 
....
 
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) [na:1.7.0_72]
 
at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-8.0.20.jar!/:8.0.20]
 
at java.lang.Thread.run(Thread.java:745) [na:1.7.0_72]
 
Caused by: redis.clients.jedis.exceptions.JedisConnectionException: Could not get a resource from the pool
 
at redis.clients.util.Pool.getResource(Pool.java:42) ~[jedis-2.5.2.jar!/:na]
 
at redis.clients.jedis.JedisPool.getResource(JedisPool.java:84) ~[jedis-2.5.2.jar!/:na]
 
at redis.clients.jedis.JedisPool.getResource(JedisPool.java:10) ~[jedis-2.5.2.jar!/:na]
 
at org.springframework.data.redis.connection.jedis.JedisConnectionFactory.fetchJedisConnector(JedisConnectionFactory.java:133) ~[spring-data-redis-1.4.2.RELEASE.jar!/:1.4.2.RELEASE]
 
... 55 common frames omitted
 
Caused by: redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketTimeoutException: connect timed out
 
at redis.clients.jedis.Connection.connect(Connection.java:150) ~[jedis-2.5.2.jar!/:na]
 
at redis.clients.jedis.BinaryClient.connect(BinaryClient.java:71) ~[jedis-2.5.2.jar!/:na]
 
at redis.clients.jedis.BinaryJedis.connect(BinaryJedis.java:1783) ~[jedis-2.5.2.jar!/:na]
 
at redis.clients.jedis.JedisFactory.makeObject(JedisFactory.java:65) ~[jedis-2.5.2.jar!/:na]
 
at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:836) ~[commons-pool2-2.2.jar!/:2.2]
 
at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:434) ~[commons-pool2-2.2.jar!/:2.2]
 
at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:361) ~[commons-pool2-2.2.jar!/:2.2]
 
at redis.clients.util.Pool.getResource(Pool.java:40) ~[jedis-2.5.2.jar!/:na]
 
... 58 common frames omitted
 
Caused by: java.net.SocketTimeoutException: connect timed out
 
at java.net.PlainSocketImpl.socketConnect(Native Method) ~[na:1.7.0_72]
 
at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339) ~[na:1.7.0_72]
 
at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200) ~[na:1.7.0_72]
 
at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182) ~[na:1.7.0_72]
 
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) ~[na:1.7.0_72]
 
at java.net.Socket.connect(Socket.java:579) ~[na:1.7.0_72]
 
at redis.clients.jedis.Connection.connect(Connection.java:144) ~[jedis-2.5.2.jar!/:na]
 
... 65 common frames omitted


We still don't know the root cause of this? Can someone point us in the right direction and help us in identifying the root cause and solution of this problem?"
Amazon Elasticache	"Re: Redis (Elasticache) stops working after sometime
On some versions of Spring framework, Spring will not close the redis connection after a transaction completes, so connections are eventually exhausted.  If you are initializing your Jedis template with setEnableTransactionSupport(true), this can trigger the bug.  Setting that to false should fix it.  

There are other workarounds if you need transactions.  See the section ""A transaction pitfall in Spring Data Redis"" in this article; http://www.javaworld.com/article/3062899/big-data/lightning-fast-nosql-with-spring-data-redis.html"
Amazon Elasticache	"Storing cache(Key and Value) in (Elasticache)Redis cluster using .net SDK
I have to Store the logs(in form of Key, Value) in Elasticache Redis cluster using AWS .net SDK.
But I could see only memcached cluster related methods in .net SDK. But I need to store the logs in RedisCluster.
1. Suggest the steps to store the logs in Redis Clster using AWS .net SDK.
2. Also I am seeing lots of memcached eamples in AWS Documents. Please add some example commands for Redis Cluster as well.

Thanks,
Prakash"
Amazon Elasticache	"Redis Cluster Names
Why has the character limit on Redis cluster names been dropped to 16 characters? All the docs that I can find still say 20.
Ex: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Clusters.Create.CON.Redis.html

Changing the naming constraints without any kind of notice is really troublesome, because now my company's existing naming conventions cannot be used on new clusters, and I only find this out as I'm in the process of standing up a cluster for a promote that's intended to go out tomorrow."
Amazon Elasticache	"Can't authorize in VPC
I provisioned my first Elasticache cluster to a VPC I am using for an EB app. I want to eventually use it from the EB app.

I started up a vanilla EC2 instance in the same VPC to connect to it (Redis) for testing.

I followed the instructions at https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.AuthorizeAccess.html#GettingStarted.AuthorizeAccess.Classic . I found this very confusing because it seems to want me to use the ""EC2 classic"" instructions... even though I provisioned into a VPC.

So I went to ""authorise"" the instance for connections from other security groups... only the security groups in the VPC are not listed, so I can't authorize.

I also tried just following the VPC instructions. The VPC's security group is currently open to all ports.

Either way, I just get timeouts when trying to connect.

I'm mighty confused about authorisation."
Amazon Elasticache	"Re: Can't authorize in VPC
Having another go at this trialling elasticache today.

I decided to ignore the docs and trusted my instinct that even though I have both EC2-Classic and VPC as supported platforms, I should follow the VPC instructions.

I overrode the default security group rules for the VPC, and this has appeared to work.

So I think the docs need work on the ""To determine whether you launched your cluster into EC2-VPC or EC2-Classic using the AWS Management Console"" section - if the user knowingly provisioned into a VPC, they should follow the VPC instructions."
Amazon Elasticache	"Support for new versions of redis
Hello,
Do you have a schedule for making redis 4.0 available on elasticache? It's already on RC3 and will soon be released officially. It brings great new features and it would be awesome to see it running on elasticache ASAP.

Thanks in advance!"
Amazon Elasticache	"Memcached Swap Usage
Hello,

Our memcached instance has been running for a long time without ever touching the swap.  I just checked the graphs and noticed that our instance has started swapping even though there is freeable memory.  I do see what looks like a pattern of the freeable memory dropping sharply at what appears to be a specific interval.  We're trying to figure out what that may be.

Could someone look into it for us?

Thanks"
Amazon Elasticache	"Re: Memcached Swap Usage
Hello,

I had a look at your memcached cluster in AWS. I see that the swap usage is < 10Mb.

In general, as long as the swap usage is not growing indefinitely, you have free space in the memcached slabs (see ""stats slabs"" memcached command) and you are not observing any application slowness, you need not be worried. You can also refer to this link http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html that talks about what metrics to monitor and what is levels are alarming.

Regards,
Harpreet S."
Amazon Elasticache	"Can I use ElastiCache with third-party server?
Hi
I need some consultation, please.
I have a Wordpress site and I'm going to use ElastiCache with memcache for caching my site with WP Total Cache plugin.
My site is located on third-party server.
Can I use ElastiCache in whis case?
Or do I need to transfer my site on Amazone Cloud and only after that I will be able to use ElastiCache for caching my site?
Thank you, very much.
Best regards."
Amazon Elasticache	"Create a custom parameter group for clustered Redis
Hi, I need to set some parameters in a clustered Redis install that currently is tied to ""default.redis3.2.cluster.on"" parameter set.
Creating a new parameter set results in the cluster options disabled.
Ho can I clone/modify the ""default.redis3.2.cluster.on"" parameter set? The default one cannot be modified of course.
Doc say to create e new one ""based"" on the old one, but it is not possibile. Ref. (http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ParameterGroups.Redis.html#ParameterGroups.Redis.3-2-4):
default.redis3.2.cluster.on – Specify this parameter group or one derived from it, when you want to create a Redis (cluster mode enabled) replication group.

To be more explicit: do I need to clone the default 3.2 and check one by one 116 parameters against the cluster.on version?

Thanks"
Amazon Elasticache	"elasticache default parameter group - modern enabled not effective?
Recently I reconfigured one of my elasticache clusters to be v1.4.34 and with that, the modern parameter in the default parameter group should have been enabled by default (which it said it was state 1 = enabled), which was to also enable several other params (including slab_reassign and slab_automove). Then the evictions began, and after examining the two nodes which were evicting, it did not appear that these params were enabled (no slabs reassigned or pages moved). Looking at the default parameter set, those were set at 0. Do those settings in the parameter group override modern? if so, enabling the modern parameter is misleading. I have (hopefully) resolved the issue by creating my own custom parameter group with the relevant params enabled, but this impacted our service as I had to reboot the cache in order for these new settings to take effect and I thought I had already done this weeks ago. Would love confirmation that the modern parameter indeed is not effective on its own. Thanks."
Amazon Elasticache	"Re: elasticache default parameter group - modern enabled not effective?
Hi,

Sorry for the troubles caused.

The 'modern' parameter is supposed to enable the below parameters: 
slab_reassign, slab_automove, lru_crawler, lru_maintainer, maxconns_fast, and hash_algorithm=murmur3. 

You can confirm that from the Memcached terminal as well using the below command:

telnet> stats settings

Regards,
Jayakrishnan L."
Amazon Elasticache	"Java client for memcache
Hello,

What java client should I use for Elasticache?
Will this client also work in local development on my laptop?"
Amazon Elasticache	"Re: Java client for memcache
Is there an official aws java client for their memcached based elasticache?"
Amazon Elasticache	"Re: Java client for memcache
You can refer to this code snippet for connecting to the cache cluster http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.Using.html#AutoDiscovery.Using.ModifyApp.Java. Moreover you cannot connect to the cluster from your local machine. You can only connect to it from the EC2 that too in the same VPC.

Edited by: srikanth01 on Jun 14, 2017 12:40 PM"
Amazon Elasticache	"Elastic Cache Connection Time Out
Hi,

All of sudden our elastic cache became timed-out on 22 May 2017 around 15:15 UTC. I try to connect from *redis-cli` command from one of our EC2 instance, but no luck.

I can ensure there are no modifications were made during that time. Any help for figurring out what cause its connection time out ? Thanks

Regards,
PJ

Edited by: pjuanda on May 26, 2017 8:01 PM"
Amazon Elasticache	"Re: Elastic Cache Connection Time Out
this issue occur randomly. #FYI our ec2 instances and elasticache (redis) instance using the same vpc and usually there is no issue about the connection to elasticcache instance from our ec2"
Amazon Elasticache	"Accessing Elasticache cluster
From the doc I read
Redis (cluster mode enabled) clusters, use the cluster's Configuration Endpoint for all operations. You must use a client that supports Redis Cluster (Redis 3.2). You can still read from individual node endpoints (In the API/CLI these are referred to as Read Endpoints).

I have that configuration, with 3 shards/nodes. When using python redis-py-cluster library if I put the Config Endpoint name in the connection I get 
ResponseError: unknown command 'CONFIG'
I found out that the config endpoint name does not resolve at all (clusterdevredis3.xlg9qp.clustercfg.euw1.cache.amazonaws.com). The node names resolve and they are reachable.

I think until the name does not resolve I cannot start a connection to the cluster.
Thanks"
Amazon Elasticache	"Re: Accessing Elasticache cluster
The config endopoint definitely does not resolve, so that document may need some revision.
The redis-py-cluster added from 1.3.2 the parameter
skip_full_coverage_check=True
that allows you to initialize a connection to servers that do not expose the CONFIG command (other cloud providers do the same as AWS).
So you need the list of all nodes and that parameter set, NOT the Configuration Endpoint."
Amazon Elasticache	"dns endpoint resolution error under heavy use.
Under heavy load, it seems the endpoint dns resolution seems to stop working.  Our application starts tossing these errors.

19 18:37:21 localhost apache2https://forums.aws.amazon.com/: https://forums.aws.amazon.com/ https://forums.aws.amazon.com/ client 10.4.20.89:25618 PHP Warning:  Redis::connect(): php_network_getaddresses: getaddrinfo failed: Name or service not Warning:  Redis::connect(): connect() failed: php_network_getaddresses: getaddrinfo failed: Name or service not known"
Amazon Elasticache	"Re: dns endpoint resolution error under heavy use.
adding nscd (local dns cache) to servers seems to fix it."
Amazon Elasticache	"Re: dns endpoint resolution error under heavy use.
Hello,

I see that you have resolved the issue by using nscd. Hence resolving the thread.

Regards,
Harpreet Singh"
Amazon Elasticache	"Elasticache Redis servers become unreachable
I have an Elasticache Redis cluster, with one master and one replica node. A couple times, once a few months ago and again a few days ago, the master node become unreachable. Neither my application code or redis-cli could connect to the node. It wasn't an issue with security groups, in both cases the replica remained reachable and newly added nodes were reachable.

At first I thought this meant that the master node had crashed. However, the Cloudwatch graphs for the node continued to update, and after failing over and making the replica the new master node, the old master node graphs suggested it had become a replica and was getting updates. Its object count graph exactly matched the new master, indicating it was receiving the replication stream from it.

I don't know how to explain this except as a bug in how Elasticache handles security or network routing to the nodes. Has anyone else encountered a similar issue, or know of any possible solutions?"
Amazon Elasticache	"Re: Elasticache Redis servers become unreachable
Hello,

I see that you have two redis replication groups one with two replica, and one with no replica. Can you please confirm the cluster name and time when you observed the issue via Private Message. 

I also see that you have developer support so you can also raise a case with us for faster resolution at https://aws.amazon.com/contact-us/

Regards,
Harpreet S."
Amazon Elasticache	"Re: Elasticache Redis servers become unreachable
Hi,

I am unable to see the replication group in your account.

Regards,
Harpreet Singh"
Amazon Elasticache	"Intermittent very high latency - up to 9.5 seconds!  (ElastiCache Redis)
I'm experiencing very high latency while connecting to the Redis (2.8) ElastiCache cluster I have set up .

root@xxx # redis-cli --latency -h xxx.0001.euw1.cache.amazonaws.com              
min: 0, max: 4587, avg: 8.23 (8053 samples)

The region is EU West 1C and the master + my EC2 node are both in that region as well.

This problem has been ongoing since last night, and it is causing our connection pool to fail. I can reproduce this consistently.

==

Just did another test. I ran 10 000 samples without going over 13ms, but then all of the suddent 9500 ms.

redis-cli --latency -h xxx.0001.euw1.cache.amazonaws.com                                              
min: 0, max: 9459, avg: 3.83 (14234 samples)

Edited by: jbye on Aug 11, 2016 3:17 PM

redis-cli --latency-history -h xxx.0001.euw1.cache.amazonaws.com
min: 0, max: 1732, avg: 6.79 (885 samples) -- 15.01 seconds range
min: 0, max: 1239, avg: 6.72 (889 samples) -- 15.01 seconds range
min: 0, max: 370, avg: 2.46 (1213 samples) -- 15.33 seconds range
min: 0, max: 1894, avg: 6.75 (886 samples) -- 15.01 seconds range
min: 0, max: 472, avg: 1.45 (1288 samples) -- 15.01 seconds range
min: 0, max: 12, avg: 0.88 (1356 samples) -- 15.01 seconds range
min: 0, max: 13, avg: 0.77 (1369 samples) -- 15.00 seconds range
min: 0, max: 11, avg: 0.82 (1365 samples) -- 15.01 seconds range
min: 0, max: 38, avg: 0.98 (1342 samples) -- 15.00 seconds range
min: 0, max: 25, avg: 0.94 (1350 samples) -- 15.01 seconds range
min: 0, max: 167, avg: 1.32 (1304 samples) -- 15.00 seconds range
min: 0, max: 140, avg: 1.52 (1284 samples) -- 15.01 seconds range
min: 0, max: 1835, avg: 4.36 (1122 samples) -- 16.32 seconds range
min: 0, max: 4842, avg: 13.62 (629 samples) -- 15.00 seconds range
min: 0, max: 407, avg: 1.59 (1273 samples) -- 15.00 seconds range

Edited by: jbye on Aug 11, 2016 3:23 PM

Edited by: jbye on Aug 11, 2016 10:22 PM"
Amazon Elasticache	"Re: Intermittent very high latency - up to 9.5 seconds!  (ElastiCache Redis)
I´ve also experienced a very high latency on memcached nodes yesterday at us-east-1b."
Amazon Elasticache	"Re: Intermittent very high latency - up to 9.5 seconds!  (ElastiCache Redis)
Hi,

Did you check the SLowlogs of the Redis cluster?  Were there any long running queries?

How was your CPU performance on the cache node?

Could you provide us with your cache node endpoint so that we can check this up?

Regards,
Jayakrishnan L."
Amazon Elasticache	"Re: Intermittent very high latency - up to 9.5 seconds!  (ElastiCache Redis)
Hi, thanks for getting back to me

The CPU on the cache node does not seem to have been an issue. The slowlogs does not indicate any issue that should cause the latency I am seeing on a regular basis (4 seconds+). We use about 25 blocking rpoplpush queries at once max.

The endpoint is ab.mzhfaq.ng.0001.euw1.cache.amazonaws.com:6379 (It belongs to another account)

FYI: I ran a quick latency-history check just now, and I did not see any latency spike in the first time since I first noticed the issue some days ago.


redis-cli --latency-history -h ab.mzhfaq.ng.0001.euw1.cache.amazonaws.com

min: 0, max: 17, avg: 0.99 (1341 samples) -- 15.00 seconds range
min: 0, max: 13, avg: 0.82 (1366 samples) -- 15.00 seconds range
min: 0, max: 7, avg: 0.78 (1372 samples) -- 15.01 seconds range
min: 0, max: 9, avg: 0.88 (1359 samples) -- 15.01 seconds range
min: 0, max: 14, avg: 1.16 (1324 samples) -- 15.01 seconds range
min: 0, max: 16, avg: 0.88 (1359 samples) -- 15.01 seconds range
min: 0, max: 17, avg: 1.07 (1333 samples) -- 15.01 seconds range
min: 0, max: 10, avg: 0.85 (1363 samples) -- 15.01 seconds range
min: 0, max: 11, avg: 0.89 (1352 samples) -- 15.01 seconds range
min: 0, max: 7, avg: 0.85 (1362 samples) -- 15.01 seconds range
min: 0, max: 9, avg: 0.78 (1370 samples) -- 15.01 seconds range
min: 0, max: 13, avg: 0.88 (1358 samples) -- 15.01 seconds range
min: 0, max: 12, avg: 1.01 (1338 samples) -- 15.01 seconds range
min: 0, max: 9, avg: 0.96 (1351 samples) -- 15.00 seconds range
min: 0, max: 14, avg: 0.99 (1344 samples) -- 15.01 seconds range
min: 0, max: 8, avg: 0.79 (1368 samples) -- 15.00 seconds range
min: 0, max: 11, avg: 1.02 (1336 samples) -- 15.00 seconds range
min: 0, max: 8, avg: 0.94 (1351 samples) -- 15.01 seconds range
min: 0, max: 11, avg: 0.98 (1345 samples) -- 15.01 seconds range
min: 0, max: 24, avg: 0.96 (1347 samples) -- 15.01 seconds range
min: 0, max: 11, avg: 1.04 (1334 samples) -- 15.01 seconds range
min: 0, max: 11, avg: 0.93 (1351 samples) -- 15.00 seconds range
min: 0, max: 16, avg: 0.92 (1349 samples) -- 15.01 seconds range
min: 0, max: 23, avg: 0.94 (1351 samples) -- 15.01 seconds range
min: 0, max: 11, avg: 0.98 (1343 samples) -- 15.01 seconds range
min: 0, max: 9, avg: 0.81 (1364 samples) -- 15.01 seconds range

Edited by: jbye on Aug 13, 2016 4:08 PM"
Amazon Elasticache	"Re: Intermittent very high latency - up to 9.5 seconds!  (ElastiCache Redis)
FYI: Still experiencing intermittent latency spikes, today at:

10:57:15 UTC
11:50:04 UTC
13:31:51 UTC
13:58:16 UTC
14:09:01 UTC
14:17:17 UTC
15:59:38 UTC
16:02:22 UTC
16:03:14 UTC
16:09:07 UTC"
Amazon Elasticache	"Re: Intermittent very high latency - up to 9.5 seconds!  (ElastiCache Redis)
Hi,

Did you find anything to fix the latency?"
Amazon Elasticache	"Redis node swap usage increasing with backups
I have a Redis ElastiCache node running on a cache.m3.large instance with a parameter group that inherits from the default.redis3.2 group. The maxmemory-policy is set to allkeys-lru, and the reserved-memory-percent is set to 25. Each night when the back up occurs, the swap usage goes up and then stays the same for the day (see attached graph). Why is this happening, and what can I do to stop it from increasing indefinitely?"
Amazon Elasticache	"Re: Redis node swap usage increasing with backups
Hello,

I have send a PM to you about my analysis about the swap usage.

Regards,
Harpreet S."
Amazon Elasticache	"Increase in Redis Memory Footprint post the recent changes announced
I was using Redis in Standalone mode in the month of Feb and at that point of time my data was taking around 80GB in Elastic Cache - Redis in standalone mode.

In Feb, last run on 22nd Feb 2017 
Below are the details:
Size of data on disk 21.3
Number of keys: 767967004
Used memory on Redis: 78332634408 bytes 
Bytes per key: 102 bytes

Redis Node Details:
Engine:Redis
Engine Version Compatibility:3.2.4
Node type:cache.r3.4xlarge
Availability Zones:us-east-1a
Shards:0
Number of Nodes:1 node
Multi-AZ:Disabled
Description:Description-
Configuration Endpoint:The configuration endpoint of the cluster-
Parameter Group:default.redis3.2 (in-sync)

Recently(7th and 10th April 2017) when I ran the same code with the same file and same setup of Redis, it is taking around 115GB which is almost around 149 bytes per key. Is this a expected behavior post the recent upgrades to Redis. How can I go back to the previous version of Redis. This is a big impact on my cost as I would now need to take a bigger machine for the same data.

Also sharing an observation which I made earlier, when I used a Redis cluster instead of a standalone machine then the amount of memory required was somewhat similar however when I moved to a standalone Redis machine, the Redis memory requirement decreased to around 80GB . Please help me with what has changed in the past 2 month"
Amazon Elasticache	"Re: Increase in Redis Memory Footprint post the recent changes announced
Hello,

I had a look into your account but I did not find any Redis cluster of r3.4xlarge. If you can PM me cluster name I would be able to look into the specifics. I would also request you to check http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html link which give insight into what all metrics should be monitored that will effect Elasticache performance.

As far as the increase in the memory usage in cluster mode is concerned, it would be due to the overhead of cluster meta data, replication (applicable for cluster with more than one node), etc.

I also checked for any changes that would be effect the key size in 3.2.4 release https://raw.githubusercontent.com/antirez/redis/3.2/00-RELEASENOTES but found none.

Regards,
Harpreet S."
Amazon Elasticache	"ElastiCache logging
I'm using ElastiCache with memcached engine v1.4.34. Trying to debug an application issue and would like to see detailed streaming logs for fetches, evictions or mutations. Any pointers on how / where would I find these logs?"
Amazon Elasticache	"Issues with ElastiCache Cloudwatch metrics GetMetricStatistics usage
I am trying what should be a basic test with Postman send a GET request for elatiscache cloudwatch metrics. I think I have having problems with the dimensions. 

This does not work. I am trying even to encode the ""'s 

https://monitoring.us-east-1.amazonaws.com/?Action=GetMetricStatistics&MeasureName=CPUUtilization&EndTime=2017-04-07T16:00&Namespace=AWS%2FElastiCache&Period=900&StartTime=2017-04-07T13:00&Statistics.member.1=Average&Dimensions.member.1=%22CacheClusterId%3Dmytest1%22&Dimensions.member.2=%22CacheNodeId%3D0001%22

I have tried this also (no encode of the quotes) with the same results.

https://monitoring.us-east-1.amazonaws.com/?Action=GetMetricStatistics&MeasureName=CPUUtilization&EndTime=2017-04-07T16:00&Namespace=AWS%2FElastiCache&Period=900&StartTime=2017-04-07T13:00&Statistics.member.1=Average&Dimensions.member.1=CacheClusterId%3Dmytest1&Dimensions.member.2=CacheNodeId%3D0001

However if I specify no dimensions at all I get a response. 

I assume that in this case the CPUUtilization which is host-level metric can support sending the dimensions for CacheClusterId and CacheNodeId.

The error response is 

<ErrorResponse xmlns=""http://monitoring.amazonaws.com/doc/2009-05-15/"">
    <Error>
        <Type>Sender</Type>
        <Code>MalformedInput</Code>
        <Message>Unexpected complex element termination</Message>
    </Error>
    ...
</ErrorResponse>

Also if I don't encode the = it does not work.

I am starting to wonder if the dimensions are not supported with all metrics. 

Here is a good response with no dimensions specified.

ttps://monitoring.us-east-1.amazonaws.com/?Action=GetMetricStatistics&MeasureName=CPUUtilization&EndTime=2017-04-07T16:00&Namespace=AWS%2FElastiCache&Period=900&StartTime=2017-04-07T13:00&Statistics.member.1=Average

<GetMetricStatisticsResponse xmlns=""http://monitoring.amazonaws.com/doc/2009-05-15/"">
    <GetMetricStatisticsResult>
        <Datapoints>
            <member>
                <Average>2.561818181818182</Average>
                <Unit>Percent</Unit>
                <Samples>22.0</Samples>
                <Timestamp>2017-04-07T15:15:00Z</Timestamp>
            </member>
            <member>
                <Average>0.3831666666666667</Average>
                <Unit>Percent</Unit>
                <Samples>60.0</Samples>
                <Timestamp>2017-04-07T15:45:00Z</Timestamp>
            </member>
            <member>
                <Average>0.44283333333333336</Average>
                <Unit>Percent</Unit>
                <Samples>60.0</Samples>
                <Timestamp>2017-04-07T15:30:00Z</Timestamp>
            </member>
        </Datapoints>
        <Label>CPUUtilization</Label>
    </GetMetricStatisticsResult>
    ...
</GetMetricStatisticsResponse>"
Amazon Elasticache	"How to test elasticache redis multizone failover
I have setup an elasticache with redis multizone AZ following this guide https://aws.amazon.com/blogs/aws/elasticache-redis-multi-az/ . Now I want to test that a failover works.

I tried to restart the primary node in an attempt to test a primary node failover. But instead I saw that when the primary node restarted, redis db was cleared on all nodes. Not want I wanted to see. I guess this happened because the AOF feature(appendonly = false) is false for multi AZ.

Is there anyway I can test a failover, or do I just trust it works?"
Amazon Elasticache	"Re: How to test elasticache redis multizone failover
Hi monojetski,

The Multi-AZ feature works and is successfully used by many of our ElastiCache for Redis customers. However, unfortunately there is currently no manual way to trigger and test a failover. Such capability will be available in the future.

Best,
Dan"
Amazon Elasticache	"Re: How to test elasticache redis multizone failover
thanks for answering the question Dan. I'll keep an eye out for the capability to test a failover in the future."
Amazon Elasticache	"Re: How to test elasticache redis multizone failover
It would be great if you guys could include this. Currently I want to simulate Elasticache hanging by using the debug commands

http://redis.io/commands/debug-segfault"
Amazon Elasticache	"Re: How to test elasticache redis multizone failover
Hello Dan, what is the current status of the availability of this capability? It would be really useful to have a way to test this, as currently we can only trust that it happens and works.

It would be particularly interesting to know the time it takes for the replica to be promoted and write-ready (an estimated average / rule-of-thumb at least)...

Thanks!
AB"
Amazon Elasticache	"Re: How to test elasticache redis multizone failover
Has there been any update on this?"
Amazon Elasticache	"Re: How to test elasticache redis multizone failover
Resurrecting an old thread, but this is the first one that pops up on google when searching for ""aws elasticache simulate failure"".

Has anyone seen anything new or should we push the AWS team for an update on this?

Sorry, found this.. of course it was posted just yesterday (4/4/2017):

https://aws.amazon.com/blogs/database/testing-automatic-failover-to-a-read-replica-on-amazon-elasticache-for-redis/

Edited by: bran17 on Apr 5, 2017 9:20 AM"
Amazon Elasticache	"Elasticache - Memcached -net.spy.memcached.internal.CheckedOperationTimeout
Hi,

Since about a week, we have a lot of errors in our elasticache memcached, it seems that our backend server has trouble to connect with the memcached, we just have random timeout exception : 
 - net.spy.memcached.internal.CheckedOperationTimeoutException

And when we get this error we have to restart our backend serveur and/or the elasticache server.

We didnt do any changes and we started to have this trouble one week ago, before it was working perfeclty.

Our backend server is Java and we use the spy memcached client library (version 2.12.0), the elasticache server is version 1.4.24, the region is sa-east-1.

Could you help us on that ?

Cheers,

Julien

Edited by: jvi_21 on Apr 3, 2017 8:09 PM

Edited by: jvi_21 on Apr 3, 2017 8:57 PM"
Amazon Elasticache	"ElastiCache Redis-Cli restricted commands
Hi,

Is there a way to activate restricted commands ?

I really need to set ""notify-keyspace-events"" option but the CONFIG command is restricted.

CONFIG SET notify-keyspace-events Kx
(error) ERR unknown command 'CONFIG'

Or can I do it another way? Like using StackExchange.Redis dll or any UI ?

Edited by: Vincent Gravel on Jun 16, 2016 12:12 PM

Edited by: Vincent Gravel on Jun 16, 2016 12:13 PM"
Amazon Elasticache	"Re: ElastiCache Redis-Cli restricted commands
It can be done!  Key is that you need to adjust the redis parameter groups to enable this function, you can't do in software.  Create a new parameter group, then edit it, find the key notify-keyspace-events, and set a value, such as ""AKE"" to generate all possible log events.  This is document at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ParameterGroups.Redis.html."
Amazon Elasticache	"Cannot initialize a MULTI/EXEC transaction over aggregate connections.
I've set up a Clustered Redis with 1 node and 1 shard and configured my Laravel 5.2 application to use the configuration endpoint in the console and I installed the predis library. And when I run php artisan queue:work I get the following message when it attempts to process a job in the queue:

[Predis\NotSupportedException]                                          
  Cannot initialize a MULTI/EXEC transaction over aggregate connections.


Is clustering not supported by PHP when using the MULTI/EXEC? Do I need to use the Redis extension for PHP? or is there something I'm missing."
Amazon Elasticache	"Consuming SNS notification about data loss of a Redis ElastiCache node
In my system, I need to perform some actions when a node in my Redis cluster loses its data. I assume that I need to listen to ElastiCache:CacheNodeReplaceComplete and ElastiCache:CacheNodesRebooted as described at  http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ElastiCacheSNS.html 
Three questions:
1. Are there any other events I need to listen to, to get notified about data loss by a node?
2. I need to know which node has lost its data. The name of the node is included into the notification message, but parsing text message to get an id is a fragile solution. Is there a better way to find out which node in the cluster emitted the event?
3. How can I simulate these events to verify that my system processes them correctly? I can publish my own simulated messages to an SNS endpoint, but I need exact examples of these messages. Can anyone share the exact json that is sent in these messages?"
Amazon Elasticache	"Memcached timeout
Hello,

I setup an Elasticache cluster recently. It was working fine on the first days, but now we keep getting random timeout errors.
I checked the elasticache and nothing indicates that it is overloaded.

-----Exception--- 
Node xx.xxx.xxx.xxx:11211 is dead.
Acquiring stream from pool. xx.xxx.xxx.xxx:11211
Pool is dead or disposed, returning null. xx.xxx.xxx.xxx:11211
Could not init pool. - System.TimeoutException: Could not connect to xx.xxx.xxx.xxx:11211

Thanks
Gustavo"
Amazon Elasticache	"Re: Memcached timeout
Did you ever solve this? I am just now configuring use with ElastiCache and having similar issues. Thanks."
Amazon Elasticache	"Re: Memcached timeout
I have this issue too"
Amazon Elasticache	"Re: Memcached timeout
I am still having this problem.

It is an intermittent issue and I have no clue how to solve it."
Amazon Elasticache	"Re: Memcached timeout
We're experiencing same issues, but I believe they're because of the buggy 'libmemcached' library.
https://bugs.launchpad.net/libmemcached/+bug/928696

Do you use 'libmemcached' at all?"
Amazon Elasticache	"Elasticache (Redis) maintenance - possible downtime?
Hi, we are looking at performing two types of maintenance to our existing single-node Redis Elasticache:

1) add 1 node so that we have a total of 2 nodes

2) increase instance size of original node

Should we expect any downtime during either one of these maintenance activities?

If yes (we should expect downtime), then is there any indication of roughly how long the outage will last?  I know it is not possible to give exact guarantees on how long maintenance will take, but is there any guidance available as to whether it takes seconds, minutes, or hours?  The documentation says a node replacement ""typically completes within a few minutes,"" but I was wondering if there was anything more specific other than ""a few minutes"" we could expect.

Thanks for your help!"
Amazon Elasticache	"ElastiCache Redis has no endpoint?
After launching a Redis node under free tier account, it does not have a primary or configuration endpoint displayed anywhere. Where do we find the endpoint?"
Amazon Elasticache	"Re: ElastiCache Redis has no endpoint?
Hello,

Thanks for reaching out to us.

You can find your endpoint details, if you select your ""ElastiCache Dashboard"", from the left select ""Redis"", then selecting your Cluster Name.

More details on this can be found from the link below:
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Endpoints.html#Endpoints.Find.Redis

If you have any further questions, please feel free to let us know."
Amazon Elasticache	"Re: ElastiCache Redis has no endpoint?
But that's not the case, it just displays:
""Primary Endpoint: -"""
Amazon Elasticache	"Re: ElastiCache Redis has no endpoint?
Is there an update from AWS on this issue?  I followed the ""getting started"" guide, and my cluster Primary Endpoint is shown as ""-"".  It's not clear to me what I've done wrong, if anything?"
Amazon Elasticache	"Re: ElastiCache Redis has no endpoint?
I see... for single node clusters, you actually have to click on the cluster name.  This brings up a row showing the cluster and its endpoint address.  If you simply expand the cluster, using the chevron, you are not shown the endpoint IP.  The UI needs some work, as this is confusing."
Amazon Elasticache	"In-Memory Cache Security
There is a growing trend to utilize more In-Memory Storage for a wide variety of use cases from big data analytics (Spark) to faster processing power (MemSQL) to caching (Redis) most frequently accessed data before making a trip to disk based RDBMS. AWS Elasticache is an example of this. One architectural 'Best Practice' I've heard recently is to cache everything first. Then make trips to disk only for less used (cold) data.

With this growing trend to leverage more in-memory storage, I've not seen very much written about securing these data stores along with potential associated vulnerabilities that come along with them. When I asked Amazon during an Architecture course if there is encryption available for Elasticache data they said no.

In addition, I'm not sure if traditional data storage security guidelines apply in the same manner as disk based storage for regulated agencies. For example, encrypting data at rest (DAR) is a NIST requirement for sensitive data (e.g. PII, PHI) in the cloud. Does this same standard apply to data which only exists in-memory? If not, is that really a good idea? Have NIST and other security organizations even considered the potential attack vectors in this space yet? If so, are there any published guidelines out there for in-memory storage? Or are we supposed to infer from old rules/regulations/guidelines and then extrapolate into this storage environment?

Could this be at least partially why Elasticache is not offered within GovCloud? Possibly because it does not conform to NIST Security Standards?

Any thoughts on Securing In-Memory Data Stores appreciated, especially from those who've had to certify the security of their systems through third-party assessors.

Thanks,
Derek"
Amazon Elasticache	"Debugging Consistent >90% CPU Redis Usage
I use Redis and ElastiCache as my remote server session storage with my NodeJS application and I am trying to figure out what is causing CPU utilization issues and firing my CloudWatch alert, CPUUtilization >= 0.9 for 5 minutes, on a daily basis. I have a live EC2 instance that uses my ElastiCache node, but the application itself is not being promoted and only has one page (It is still in the development phases and should only be known to exist by myself). Beyond the occasional 100% CPU utilization, it averages around 75% utilization.  This situation seems bizarre to me that I should be running into CPU issues being the only user of the application despite using a single node with a cache.t2.micro Node type. 

As a result, I'm trying to figure out what I should look for to determine why the cause of the issue. Is it how I'm storing sessions in my NodeJS code? Are security groups an issue? Could there be someone spamming the node?

Here is how I am setting a session with my NodeJS code. (Session is set when site is accessed and destroyed when a session is associated with a user account and logs out):
var sess = {
    store: new RedisStore({
        host: process.env.REDIS_ENDPOINT || 'localhost',
        port: 6379
    }),
    secret: process.env.SESSION_SECRET || 'test-SeSS',
    resave: true,
    saveUninitialized: true,
    cookie: {
        httpOnly: true,
        domain: process.env.DOMAIN_NAME || 'localhost'
    }
}


Here is my CloudWatch Alert:
Threshold:CPUUtilization >= 0.9 for 5 minutes
Metric Name:CPUUtilization
Statistic:Average

Here is my security group setup:
SSH TCP 22 IP
Custom TCP Rule TCP 6379 0.0.0.0/0"
Amazon Elasticache	"Creation of multiple nodes for Redis cluster through provisioning API
Maybe this is confusion on my part, but when I create cluster using API, it only allows for me to put 1 to the ""number of nodes"" attribute, otherwise it returns the error about illegal value.  Use of UI is not an option, as we're completely codified the prod provisioning. Running with cluster with single node with simply not an option as we are HA shop. How can I create 2 nodes cluster for Redis using API?"
Amazon Elasticache	"Re: Creation of multiple nodes for Redis cluster through provisioning API
Hi,

If you use the CreateCacheCluster api call, NumCacheNodes must be 1 for clusters running Redis.
If you would like to create a 2 nodes Redis replication group, please use CreateReplicationGroup API call. 

CreateReplicationGroup
http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_CreateReplicationGroup.html
Create-replication-group CLI
http://docs.aws.amazon.com/cli/latest/reference/elasticache/create-replication-group.html"
Amazon Elasticache	"T2 Instance Without VPC
Hi,

I'm running a test, involving Lambda using memcache for which I would like to use ElastiCache. As I try to use the free tier (T2), the only option I could use to create Redis/Memcached (no replicas, one node) was by creating a VPC. I created a VPC for it and connected it to Lambda, but with no luck (timeout when connecting to the memcache). Obviously, in order to debug it, I'll have to set a VPC with public NAT which will carry costs. Reading previous posts, it doesn't seem that any solution applies. Is there any way to create a T2 without VPC? (or any way to debug connection to T2 without building public NAT)

Thanks!"
Amazon Elasticache	"Amazon ElastiCache for Redis don't support RDB persistence?
Amazon ElastiCache for Redis don't support RDB persistence?
As we all know,Redis provides two different persistence options:
RDB persistence
AOF persistence

Amazon ElastiCache for Redis only support AOF persistence?
Can you tell me how to support RDB persistence?"
Amazon Elasticache	"Re: Amazon ElastiCache for Redis don't support RDB persistence?
Hi arcsoft-hz,

ElastiCache for Redis supports both AOF and RDB persistence. The feature for RDB persistence is called Backup and Restore and you can find more information about it under the ""Backup and Restore"" section of the FAQ at http://aws.amazon.com/elasticache/faqs/.

Best regards,
Dan

Edited by: DanZ@AWS on Sep 23, 2014 2:18 PM"
Amazon Elasticache	"Re: Amazon ElastiCache for Redis don't support RDB persistence?
Hi Dan,
Thanks for you quick response.

I do not want to enable AOF persistence,
I hope to restart redis server, without losing data.

In my own build redis server, i can enable the RDB persistence, then restart the redis server without losing data.

But the RDB persistence of ElastiCache for Redis can not achieve this functionality.

According to your description: 
When you choose a snapshot to restore, a new ElastiCache for Redis cluster will be created and populated with the snapshot's data.

The RDB persistence of ElastiCache for Redis  is used only for Backup and Restore?"
Amazon Elasticache	"Re: Amazon ElastiCache for Redis don't support RDB persistence?
If you want to restart a Redis server without losing data, AOF is the solution for that. RDB is point-in-time snapshot thus you would lose the data from the point of taking the RDB snapshot to the point or restarting the server. Here is a good read about AOF vs. RDB:
http://redis.io/topics/persistence

Using the Backup and Restore feature in ElastiCache you can take a snapshot and then use it to pre-seed a new cluster with that data."
Amazon Elasticache	"Re: Amazon ElastiCache for Redis don't support RDB persistence?
Hi Dan,
Thanks for you quick response.

By default Redis saves snapshots of the dataset on disk, in a binary file called dump.rdb. You can configure Redis to have it save the dataset every N seconds if there are at least M changes in the dataset, or you can manually call the SAVE or BGSAVE commands.
For example, this configuration will make Redis automatically dump the dataset to disk every 60 seconds if at least 1000 keys changed:
save 60 1000

I want to know how long ElastiCache for Redis do a snapshot? 
How to change the frequency of snapshots."
Amazon Elasticache	"Re: Amazon ElastiCache for Redis don't support RDB persistence?
Can this be achieved?"
Amazon Elasticache	"Redis AOF persistence and automatic backups - fsync every second?
We recently experienced a catastrophic loss of data when our Elasticache Redis cluster was restarted.  Since then, we've switched to AOF (append-only file) persistence, with a 1-second fsync frequency.

An old, but related thread touches on this: https://forums.aws.amazon.com/thread.jspa?messageID=571606򋣖

However, I wanted to better understand how the AOF is being persisted in between backups.  Presumably, it is being written to disk local to the Elasticache cluster (or individual nodes).  Otherwise, if the AOF were only stored at the time of backups (automatic or otherwise), there would essentially be no difference between AOF and RDB persistence - one would only have data at the time of each snapshot.

The documentation about AOF:http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/RedisAOF.html doesn't go into the details of this, and I was wondering if anyone at AWS, or who has had experience with this, can shed some light on the details of how AOF is implemented behind the scenes."
Amazon Elasticache	"[confuse] Does node type t2 support multi-az?
I am confused after reading document http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoFailover.html#AutoFailover.Notes & FAQ https://aws.amazon.com/elasticache/faqs/. 

In doc it says:
Redis Multi-AZ with Automatic Failover is not supported on t1 and t2 cache node types.

In FAQ it says:
Q: What node types support Multi-AZ?
All available node types in ElastiCache support Multi-AZ with one exception. When using Redis 3.x with cluster_mode=disabled, T2 family doesn’t support Multi-AZ.

My question is, does t2 node using Redis 2.8.24 support multi-az with cluster_mode disabled ?"
Amazon Elasticache	"How to diagnose performance issues related to background save?
We are currently running ElastiCache on the largest instance. We noticed a very spiky CPU utilization pattern, that seems to correlate only with the ""SaveInProgress"" metrics. With AOF disabled, what are other operations or commands that could cause frequent background save? Or, how do I diagnose this issue. I attached a screenshot of the graph.

Edited by: StrailZlaber on Nov 25, 2016 11:08 AM"
Amazon Elasticache	"Redis t2.micro
Hello,

I have a redis t2.micro with one replica.
In case of failover, do I need to promote the replica as primary manually?"
Amazon Elasticache	"PHP ElastiCache without ElastiCache Client
Hi all,

I am just trying to make a connection to an elasticache node as the PHP example used with Memcached. I can connect to the node but I am unable to write any data. I am in an scenario where I cannot install the ElastiCache Client so I must to use the default libmemcached and php-memcached.

There is a mode, additional configuration that I have missed up to write/read data from ElastiCache node?"
Amazon Elasticache	"Jedis Client side implementation for ElastiCache
When we create a cluster with multiple nodes in Elasticache. We get multiple end points.

Does that mean we need to use ShardedJedis and config all the end points to do client side data sharding,  then AWS Elasticache will do the HA for us?

Thanks,
David

Edited by: magicyin on Nov 14, 2016 2:47 PM"
Amazon Elasticache	"Possible to connect to redis from paas hosted on aws?
Hi,
I'm going to host my sites with a paas provider called pythonanywhere. They use aws ec2 on aws east
 1 to provide their services. 

Is it possible to access directly an elasticache redis aws instance within aws private network?
I hope not to have to make a roundrip to the internet and access it from private network. 

Is this possible?
(They do allow external access)"
Amazon Elasticache	"Node constantly recovering
Suddenly last week, one of our Redis nodes started recovering every 12-14 hours. My event log shows repeated entries of:

Recovering cache nodes 0001
Cache node 0001 restarted

Any suggestions on how to fix / mitigate this? I'd prefer not to rely on failover if possible."
Amazon Elasticache	"Re: Node constantly recovering
No responses on this? I've been using the same AWS config for >2 years, and never experienced this issue. Then all of a sudden on Thursday, node recovering every 12 hours.

No one else has experienced anything like it?"
Amazon Elasticache	"Cannot install ElastiCache Client in latest E Beanstalk PHP Platform 2.1.5
Looks like the latest Elastic Beanstalk PHP Platform (2.1.5) does not support ElastiCache cluster client. I got these error message during installation:
Connection to `__uri:443' failed: php_network_getaddresses: getaddrinfo failed: Name or service not known

Due to this error, my environments stopped working after upgrading to the latest PHP platform. Tried this on both PHP5.5 and PHP5.6. Is there anyway to resolve this?"
Amazon Elasticache	"Re: Cannot install ElastiCache Client in latest E Beanstalk PHP Platform 2.1.5
Got some help from AWS support engineer, and this issue is resolved now. I was trying to install the cluster client directly from S3: pecl install https://s3.amazonaws.com/elasticache-downloads/ClusterClient/PHP-5.5/latest-64bit. Somehow, it won't work for later Elastic Beanstalk platforms. The solution is download the file to local and install the client from there."
Amazon Elasticache	"Do we need to retry sending failed commands during Multi-AZ Failover?
Hi, 

During failover and least-lag slave promoted to primary, do application sent SET, REMOVE and CLEAR commands to Replication Group Node fail?

In other words, do you advise to retry sending these failed commands until new primary is available?

Thanks in advance
Baris

Edited by: baris_a on Oct 27, 2016 3:32 AM

Edited by: baris_a on Oct 27, 2016 3:32 AM"
Amazon Elasticache	"Re: Do we need to retry sending failed commands during Multi-AZ Failover?
Hi Baris,

During failover, the write operations/commands to the primary node are blocked, so any write commands will fail during this time. Of course, it is advisable to construct your application to be able to handle command errors and retry them if necessary.  From Elasticache perspective, the write commands will be temporarily blocked during the failover.

You can find more information on this subject in the below document:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoFailover.html

I hope this information is useful. Should you have any additional questions, we can surely help with clarifications.

Best regards,
Alex"
Amazon Elasticache	"ElastiCache:NodeReplacementScheduled
Hello,

This is the third (or forth) time we get a notification and an ElastiCache node is being replaced. What's going on this past year?"
Amazon Elasticache	"Re: ElastiCache:NodeReplacementScheduled
Hi,

We performance regular maintenance on the Elasticache services  to improve security, reliability and operational performance. If a software patching is scheduled, the cache Nodes could incur some downtime during your maintenance window. Patching can be user requested - for example cache software upgrade, or determined as required (if we identify any security vulnerabilities in the system or caching software). Software patching occurs infrequently (typically once every few months) and should seldom require more than a fraction of your maintenance window. 
https://aws.amazon.com/elasticache/elasticache-maintenance/

Every cluster has a weekly maintenance window during which any system changes are applied. 
You can specify a preferred maintenance window when you create or modify a cache cluster. 
The maintenance window should fall at the time of lowest usage and thus might need modification from time to time. You can specify a time range of up to 24 hours in duration during which any maintenance activities you have requested should occur. Any deferred or pending cluster modifications you have requested occur during this time.
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/VersionManagement.MaintenanceWindow.html

Regards,
Louisa"
Amazon Elasticache	"Re: ElastiCache:NodeReplacementScheduled
Hi Louisa,

Thanks for your reply. It just seems that this past year had much more node replacements than any other (almost none) and we wonder if this anything to do with us and if there's anything we can do to reduce these node replacements (use a different node type?)

Thanks"
Amazon Elasticache	"Re: ElastiCache:NodeReplacementScheduled
We likewise received notification of ""Node Replacement Scheduled"" and we are wondering how long this takes?

I see in your reply you have said ""the cache nodes could incur some downtime,"" but should ""seldom require more than a fraction of your maintenance window.""  Is there any way of getting a more specific estimate?  We are trying to figure out whether any downtime would be on the order of a few seconds, or a few minutes.  (we have a cache.m1.small Redis node)  Do you know typically how long downtime lasts on a node replacement?  Any additional info would be appreciated.  Not looking for a guarantee so much as an order of magnitude (seconds vs. minutes).  Thanks!"
Amazon Elasticache	"Re: ElastiCache:NodeReplacementScheduled
Hello there,

As an indication of order of magnitude, a cache node replacement typically completes within a few minutes. You can find more information concerning cache node replacements in the below FAQ page:
https://aws.amazon.com/elasticache/elasticache-maintenance/

Below article also goes over the actions you can take to handle scheduled cache node replacements:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheNodes.NodeReplacement.html

I hope this information is useful. Should you have any additional questions on this topic, we can surely help with clarifications.

Best regards,
Alex"
Amazon Elasticache	"ElasticCache using Redis Engine with cluster mode enabled
Hi

We have been testing out ElasticCache with redis engine (cluster mode enabled) for caching purposes. Our configuration is 3 shards each with 1 primary and 1 read replica (replica in different AZ). Instance type for our test was cache.m3.medium.

This setup is responding dead-slow. We benchmarked with a script which writes to the cache and reads back the written value immediately afterwards and retry if the read value is not equal to the written value. Redis with cluster mode disabled took 5 secs on average with most latent call taking 6 secs. However with cluster mode enabled and above setup, its taking ages (*upto 40 secs* with same script).

What could be wrong here? Is this due to replication lag between cluster's instances as we have to ensure that value read from cache must be the same as we have written just before reading?

Any one else facing such an issue?"
Amazon Elasticache	"How to increase lua script execution time
I'm going use ElasticCache with Redis as primary storage, to achive this I have to import data to redis. I use lua scripts to do this, but elastic kill lua execution after 5 seconds, I found in documentaiton https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ParameterGroups.Redis.html property called lua-time-limit, this is what I need, but docs says this parameter not modifiable. How can I use lua that work more that 5 seconds with elastic?

Edited by: istrakhouski on Oct 26, 2016 12:51 AM"
Amazon Elasticache	"Elastic Cache auto failover happened but dns was not propagated.
Hello There,

Recently, we faced a problem with elastic cache. We have a replication group with one primary node and a read replica node. Multi A-Z enabled with auto fail-over enabled.

2 node dns are below.
test001.dhufct.0001.usw2.cache.amazonaws.com:6379  -- primary 
test002.dhufct.0001.usw2.cache.amazonaws.com:6379 -- read replica

we have used test001.dhufct.0001.usw2.cache.amazonaws.com:6379 URL in our application. Elastic cache failover event was initiated and after failover 

test001.dhufct.0001.usw2.cache.amazonaws.com:6379  -- read replica
test002.dhufct.0001.usw2.cache.amazonaws.com:6379 --  primary.

In the application logs I got this error ""Error: READONLY You can't write against a read only slave.""

I was going through the below blog and it say that we don't need to change anything in our application the dns will propagates automatically. "" ElastiCache also propagates the DNS of the promoted replica so that if your application is writing to the primary endpoint, no endpoint change will be required in your application"" but that didn't happened. I have to update my application with test002.dhufct.0001.usw2.cache.amazonaws.com:6379 dns.
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoFailover.html

Can any one please help me to understand what exactly happened and how can i avoid this in future.

Regards,
Sintu Kumar.

Edited by: sintu on Oct 6, 2016 10:33 PM"
Amazon Elasticache	"Re: Elastic Cache auto failover happened but dns was not propagated.
Hello Sintu,

Thanks for reaching out to us. Allow me to provide a few useful information regarding this topic.
As the mentioned document indicates, ""ElastiCache also propagates the DNS of the promoted replica so that if your application is writing to the primary endpoint, no endpoint change will be required in your application.""
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoFailover.html

However your application will need to be configured to use the primary endpoint (the primary endpoint usually includes an "".ng."" in its name). As you described the situation, your application was configured to use the read endpoints of the Redis cache cluster. 

As a recommendation, your application should always point towards the primary endpoint which will always point towards the primary cache node. Below article explains how to find the endpoints for your cluster:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Endpoints.html#Endpoints.Find.Redis

I hope this information is helpful.

Edited by: alexandruaws on Oct 13, 2016 3:28 AM"
Amazon Elasticache	"Subnet group name via cloudformation
Hello,

We are trying to create ElastiCache subnet groups via cloudformation and not have them name some random string  so that they are then easier to reference in cloudformation that actually creates a cluster.    It appears that there is no way to do that and you are stuck with the random generated name.

Is this correct?   It is clearly possible from the cli and the console.

Any help is appreciated."
Amazon Elasticache	"Re: Subnet group name via cloudformation
I'm having the same issue.  In fact, it looks like you can't use the Name Type property for the CacheSubnetGroup or the ReplicationGroup.  It says I can use ""Name"" on the CacheCluster's themselves, but there appear to be lots of restrictions on that name.  0-20 characters, no consecutive dashes, and in my case it isn't letting me use multiple dashes despite alphanumeric being between them.  It's very obnoxious, especially since the ""Name"" field is available for all of the above if I was to create this in the console.

Name Type info is here:  http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-name.html. Clearly this is only available for the CacheCluster at this point via CloudFormation, but it seems to me that some work needs to be done here to make CloudFormation produce the same thing you can produce via Console."
Amazon Elasticache	"creating and destroying ElastiCache using boto 2.4.2
I need to create and then destroy an ElastiCache cluster. 

I am able to  make a connection using:
connection_cache = boto.elasticache.connect_to_region('us-east-1')
when the AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY are in etc/boto.cfg.
With this connection I can perform general tasks like ask all available regions, but when I try to create 
 a cache cluster using :
connection_cache.create_cache_cluster('test_cluster','memcached', 'cache.t2.small', 1, 'us-east-1', 'sun:05:00-sun:09:00')

I get the following error:
raise self.ResponseError(response.status, response.reason, body)
boto.exception.BotoServerError: BotoServerError: 403 Forbidden
{""Error"":{""Code"":""InvalidClientTokenId"",""Message"":""The security token included in the request is invalid."",""Type"":""Sender""}

Final Note:
I have used the same credentials to successfully create and restore rds snapshots. 

Any help would be greatly appreciated.

Thank you,

Mike"
Amazon Elasticache	"SLAVEOF not enabled?
I was migrating from one redis server to the new elasticache redis cluster.
As I don't want any downtime, and we have 5-6 services and some developers that must do the change at the same time i found this article solves the problem:

http://redis4you.com/articles.php?id=005&name=Seamless+migration+from+one+Redis+server+to+another

But when I try it on Elasticache with redis-cli command it reports back '(error) ERR unknown command 'SLAVEOF', why we can't use it? there is any alternative better than use the S3 RDB?"
Amazon Elasticache	"Re: SLAVEOF not enabled?
Thanks for reaching out via the AWS Forums.

ElastiCache has restricted the SLACEOF command when running Redis.  Please see the following AWS documentation for more information on this:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ClientConfig.html#ClientConfig.RestrictedCommands"
Amazon Elasticache	"Re: SLAVEOF not enabled?
So, which solution for zero-downtime migration? How do you ""deliver a managed service experience"" at this point?"
Amazon Elasticache	"Elasticache memcached Current Connections (CloudWatch metrics)
Hi all,

We are trying to find the bottleneck in our VPC system.
We have 3 c3.2xlarge instances connected to cache.r3.large memcached cluster. 
The ""Current Connections"" metric in CloudWatch for memcached cluster is always 30. This number only changes if add or remove new instances. 
I have several questions to understand the situation better. I would appreciate if I can get answers for below questions.

Does 30 value for ""Current Connections"" for 3 instances mean; one server can only make 10 connections to the memcached node?
Is this number has any effect performance during high traffic time, when we make many requests to cache?
Is there any configuration that we can use to increase this number to optimum a value.


Thanks in advance
Serkan"
Amazon Elasticache	"Re: Elasticache memcached Current Connections (CloudWatch metrics)
Hi Serkan,

The current Connection is ""A count of the number of connections connected to the cache at an instant in time. ""
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.Memcached.html

The maximum number of simultaneous connections for memcached node is 65000. This nomber is not modifiable. You can check the value of this parameters in the parameter group of your cache node.
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ParameterGroups.html
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ParameterGroups.Memcached.html

The number of connections(not number of requests) usually will not affect your performance during high traffic time. However, if you have make large amount of connections to the memcached node, you need to be care wit the memcached connection overhead. It is the amount of memory to be reserved for Memcached connections and other miscellaneous overhead. If the connection overhead exceed the maximum memory configured,  you may get errors like connection timeout.
The configuration are in the parameter group. Please refer to above link for more information. 

Regards,
Louisa"
Amazon Elasticache	"Elasticache Redis stuck on creating
Is there some way to resolve a redis elasticache instance which is stuck on creating? This is in us-east-1c"
Amazon Elasticache	"Re: Elasticache Redis stuck on creating
I'm having similar issues, in two different accounts creating both Redis and Memcached caches - stuck on creating for hours.
This appears on the status dashboard as increased create times, but I've not had anything successfully create this afternoon."
Amazon Elasticache	"Re: Elasticache Redis stuck on creating
Seems all better today."
Amazon Elasticache	"Apache Invalid Pointer Error
I am trying to connect to the elasticache from an EC2 instance to handle PHP sessions and something very odd happens, when I load a php page with this code,

	if (session_status() === PHP_SESSION_NONE)
			session_start();
	$_SESSION = 'test01';
	echo $_SESSION;
	exit();

Everything works fine and the page display 'test1' and there is no errors at all, but if I refresh the page, it stops working and gives me an Invalid pointer error.






Error in `/usr/sbin/httpd-prefork': free(): invalid pointer: 0x00007f9e69a54018 ***





======= Backtrace: =========
/lib64/libc.so.6(+0x7277f)0x7f9e6fb0977f
/lib64/libc.so.6(+0x78026)0x7f9e6fb0f026
/lib64/libc.so.6(+0x78d53)0x7f9e6fb0fd53
/usr/lib64/php7/extensions/amazon-elasticache-cluster-client.so(php_memcached_exist+0x43)0x7f9e697be173
/usr/lib64/php7/extensions/amazon-elasticache-cluster-client.so(ps_validate_sid_memcached+0xc)0x7f9e697bfa0c
...

I followed this procedure to install the client,
https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Appendix.PHPAutoDiscoverySetup.html

PHP version: 7.07
SUSE Linux Enterprise 12.1
php.ini:
extension=amazon-elasticache-cluster-client.so
session.save_handler = memcached
session.save_path = ""group001memcache01.qkr61s.cfg.usw2.cache.amazonaws.com:11211""

Any ideas ??

Cheers"
Amazon Elasticache	"High Latency memcached us-east-b
I've experienced a very high latency at memcached (us-east-b). I solved the problem replacing nodes from us-east-b. It was very difficut to find out the problem at memcached because it does not have a latency metric. Is there any way to monitor it?

Edited by: danielmelobrasil on Aug 12, 2016 8:32 AM"
Amazon Elasticache	"Re: High Latency memcached us-east-b
Hi,

You should check the CloudWatch logs associated with your Memcached Nodes. Check if you cache node was overwhelmed by CPU/Network/Memory intensive queries. You should check your application logs as well to understand the access pattern to your cache clusters from the application nodes. 

If you could provide us with your cache node ID, we can check our the metrics from our end, but I am afraid since you have replaced the node, we may not be able to find any logs associated with the previous node.

Regards,
Jayakrishnan L."
Amazon Elasticache	"Re: High Latency memcached us-east-b
Hi Jayakrishnan,

I´ve done that. The number of commands processed have decreased, and my app latency have increased. After replacing node the problem was solved. 

As elasticache does not provide a way for monitoring latency for memcached nodes it was very difficult to identify the problem.

Now i´m experiencing anothe problems. Look a the swap usage of my instances. Why is it always growing if instances have avaible memory?"
Amazon Elasticache	"When will AWS redis support ""Redis Cluster data sharding""?
On this:
https://groups.google.com/forum/#!msg/redis-db/dO0bFyD_THQ/Uoo2GjIx6qgJ

It was mentioned redis 3.0 is out and supports Redis Cluster data sharding. Any idea when AWS Redis will support that?

Thanks."
Amazon Elasticache	"Re: When will AWS redis support ""Redis Cluster data sharding""?
Hello,

Thank you for you feedback, I have open a feature request on your behalf but at the moment I cannot tell if and when it will be implemented.

Regards,
Giorgio"
Amazon Elasticache	"Re: When will AWS redis support ""Redis Cluster data sharding""?
Hi Giorgio, any update on this feature request? Thanks.

Edited by: finweb on Jan 28, 2016 2:21 AM

Edited by: finweb on Jan 28, 2016 2:22 AM"
Amazon Elasticache	"Re: When will AWS redis support ""Redis Cluster data sharding""?
Hi, 
I've reached the team taking care of this request and sadly there is still not ETA for this feature to be added but we are working on this, you can always keep and eye on this page https://aws.amazon.com/new/ to get the last notices about what is new on Amazon and the announcements of future releases and features. 

Thanks for reach us and have a nice day"
Amazon Elasticache	"Re: When will AWS redis support ""Redis Cluster data sharding""?
Giorgio,

Can you please open a feature request from me too? I'd rather the Redis Cluster be managed by AWS than deploy my own cluster using EC2 instances.

Thanks,
Carlos"
Amazon Elasticache	"Re: When will AWS redis support ""Redis Cluster data sharding""?
Hi Giorgio,

This is a crucial feature for us, would you please open a feature request for us as well?  Thanks.  We're on the verge of deploying our own Redis cluster since we also require GeoCaching features.

Thanks,
Pete"
Amazon Elasticache	"Re: When will AWS redis support ""Redis Cluster data sharding""?
Hi Everyone,

The feature request is placed with internal teams on behalf of all AWS customers. We do not have any ETA when the newer version will be available. Please keep eye on our blogposts to stay updated with latest news on feature releases.

Regards,
Umair A."
Amazon Elasticache	"php7 not support redis yet?
We have just find that @amzn-updates does not have php70-redis package, is it mean that amazon's php7 has not support redis yet?

If it is not supported, do anyone have any suggestion?
We really want to use php7 and redis for our company e-commerce service.

Thank you."
Amazon Elasticache	"AWS ElastiCache - Strategy for eager loading cache items
Wanted to check what the best practices are with respect to eagerly loading a cache with data items thats sourced from an on-prem system. There would be a few million items to be cached, so wanted to check if there are any suggestions on moving the data from on-prem to the elasticache."
Amazon Elasticache	"Redis Cluster 4x slower than local redis-server
Let me start by saying that I'd expect Redis cluster to be a little bit slower given the network latency and such, but at a magnitude of OVER 4x is excessive.  Is this expected and standard?  We're using persistent connections with Redis.

Now, I will say, the request in question that's making the Redis calls is quite heavy.  I think the requst makes a few thousand hits for the single http request.  It's a very beefy page that I'm testing within our application.  In the test case I have with the largest dataset we have, with a local redis-server instance we're getting a 45 second load time.  However, with Redis Cluster, it's a 200 second load time!  45 seconds is already way too long - but 200 is crazy.

I'd love to hear some thoughts on this as we need to move to a remote redis instance and was hoping that Redis cluster would suffice.  Is a VPC necessary?  We only have one node in the cluster, it's an m3.medium and the load is very low while testing.

Please advise as this is very upsetting.  Thanks."
Amazon Elasticache	"Re: Redis Cluster 4x slower than local redis-server
Hello,

I understood that you are testing Redis in AWS. However I have no clues about your configuration and how you are doing the testing.

Are you using ElastiCache Redis service or using a vanilla Redis installed on EC2 instance?

It seems you are comparing Redis with a local one, so is your application hosted in you local data center and you are testing Redis installed on EC2 instance and on a local server on your data center? Well if that is the case I would suggest you to check the feasibility of caching. Redis is supposed to provide you a response in sub microsecond range, but the RTT involved in sending and retrieving the data may be huge. So there is no point in having a cache layer which is not in close proximity with your apps tier.

Have you testing configuring your application in EC2 instance and using AWS ElastiCache Redis service?

Regards,
Jayakrishnan L.
View Thread RSS Feed"
Amazon Elasticache	"Re: Redis Cluster 4x slower than local redis-server
Hey Jayakrishnan.  We're using EC2 as an application server and we're using Elasticache Redis instance.  Both are in the same AZ.

I'm understanding that this is just latency over a local network with AWS.  I get that there is network overhead, but a 4x decrease in performance is upsetting."
Amazon Elasticache	"Re: Redis Cluster 4x slower than local redis-server
Hi,

Could you share the Elasticache Endpoint and EC2 instance ID you are using here?

I am not able to see any ElastiCache nodes in your account. 

Also are you comparing performance between Redis installed locally on the application instance and an ElastiCache node? As I updated earlier, local interprocess communication is either between loopback or using Linux sockets. It is a known fact that such a socket or a loopback communication will be much faster than a TCP based communication. So you should be generic while doing a comparison.

Also I would like to have a look on your Cache nodes to understand if there is any other issues."
Amazon Elasticache	"Re: Redis Cluster 4x slower than local redis-server
Sure, the EC2 instance is i-4d2be7e4.  The Elasticache instance was deleted because I didn't see a way to  suspend it and we can't use it with those type of response times currently.

And yes, I'm talking about the loopback vs elasticache.  And yes, I understand that there is obviously performance differences between those two.  I was just upset to find that it's 4x slower.  However, if this is normal, that's that.  But that's what I'd like to confirm, and that it's not another setting or configuration issue.

Thank you."
Amazon Elasticache	"Elasticache Redis Single-AZ Failover Behavior
I had two quick questions about Elasticache Redis failover behavior...

The article on automatic failover at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoFailover.html outlines that ""During certain types of planned maintenance, or in the unlikely event of a primary cluster or Availability Zone failure, if your replication group is Multi-AZ enabled, ElastiCache will automatically detect the primary cluster's failure, select a read replica cluster and promote it to primary cluster so that you can resume writing to the new primary cluster as soon as promotion is complete""

And states a few other things about that, always referring to whether or not ""Multi AZ"" is available. 

But I'm curious to know if the article is out of date, and all of the above simply applies to ""replication"" regardless of whether that replication is Multi-AZ. It appears this may be the case since some of the other things in the article are true about replication, regardless of multi-AZ, like the fact that t2 nodes can't do it, or the existence of a primary endpoint DNS.

Question 1: Are the above semantics true for all elasticache clusters with replication enabled, and not just Multi-AZ replication?

The article also says ""ElastiCache also propagates the DNS of the promoted replica so that if your application is writing to the primary endpoint, no endpoint change will be required in your application. However, because you read from individual endpoints, you will need to change the read endpoint of the replica promoted to primary cluster to the new replica's endpoint.""

Question 2: What if we're not actually using the read replica endpoints in our app, and we just use replication for insurance / backups... If our app reads and writes to the primary endpoint, would we not need to do any update in our application in the case of a failover at all?

Edited by: David Ells on Jun 26, 2016 3:08 PM"
Amazon Elasticache	"Re: Elasticache Redis Single-AZ Failover Behavior
Not sure about #1, but for #2 if you're using the Primary Endpoint it eventually becomes the new master after a failover event.  I've noticed a period (usually less than a minute or two) of ""Cannot write to READ-ONLY slave"" errors and then they clear themselves up."
Amazon Elasticache	"Aws elasticache memcache + php: very slow connection
I, i'm doing test with elasticache memcache + php, and i found out that the connection  to memcache is very slow.

The script i vey simple:

<?php

$m = microtime( true );
$memcache_obj = new Memcache;
$memcache_obj->connect('myhost.cache.amazonaws.com', 11211);
printf('%.5f', microtime( true ) - $m) ;


The result is more than a second!!!
I connect from an EC2 instance

Thanks

Edited by: essetech on Jun 6, 2016 5:18 AM

Edited by: essetech on Jun 6, 2016 5:18 AM"
Amazon Elasticache	"Re: Aws elasticache memcache + php: very slow connection
I add that Elasticache node is in the same region, AZ and has the same Security Group of the EC2 instance from where i do the test"
Amazon Elasticache	"Re: Aws elasticache memcache + php: very slow connection
UPDATE

I removed the cluster and... surprise!!

It keeps working and now it's fast as lightning!!!

A true mistery to me, is anyone able to explain it ?

Thanks

Edited by: essetech on Jun 24, 2016 5:22 AM"
Amazon Elasticache	"Re: Aws elasticache memcache + php: very slow connection
Hey, I'm seeing the exact same thing, only with Redis.  When you say removed, do you mean you created a new cluster and replaced the old one?  I've had performance issues with EC2 instances in the past.  I'm wondering if this is similar.

The performance is very upsetting here :/"
Amazon Elasticache	"Re: Aws elasticache memcache + php: very slow connection
I, when i say removed i mean deleted and not replaced with a new one with the same name.

Edited by: essetech on Aug 1, 2016 3:51 AM"
Amazon Elasticache	"can i know elasticache for redis failover event using sns notification?
hello.
i wonder ""can i know elasticache for redis failover event using sns notification? ""
i saw elasticache FAQ and there is metioned  under the below.
But It belongs to memcached section.  so  i want to know that  redis also received sns notification when redis occured automatic failover



Q: How does Amazon ElastiCache respond to Cache Node failure?

The service will detect the Cache Node failure and react with the following automatic steps:

Amazon ElastiCache will repair the Cache Node by acquiring new service resources, and will then redirect the Cache Node's existing DNS name to point to the new service resources. For VPC installations, ElastiCache will ensure that both the DNS name and the IP address of the Cache Node remain the same when Cache Nodes are recovered in case of failure. For non-VPC installations, ElastiCache will ensure that the DNS name of a Cache Node is unchanged; however, the underlying IP address of the cache node can change.
If you associated an SNS topic with your Cache Cluster, when the new Cache Node is configured and ready to be used, Amazon ElastiCache will send an SNS notification to let you know that Cache Node recovery occurred. This allows you to optionally arrange for your applications to force the Memcached client library to attempt to reconnect to the repaired Cache Nodes. This may be important, as some Memcached libraries will stop using a server (Cache Node) indefinitely if they encounter communication errors or timeouts with that server.

thanks"
Amazon Elasticache	"Re: can i know elasticache for redis failover event using sns notification?
Hello,

You can configure SNS with elasticache service to get notified about important events related to your redis & memcahced cache clusters.

See below link to see what cache events are delivered through SNS.
[1] http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ElastiCacheSNS.html

Regards,
Umair A."
Amazon Elasticache	"EC2 able to connect to redis ""read replica"" but not to ""primary""
EC2 instance (no VPC) is able to connect to redis ""read replica"" but not to ""primary""
Replication Group consists of 3 nodes 
Security groups are ok because i can connect to both ""read replica"" nodes 
I can ping ""primary"" node but either redis-cli or telnet can't connect to port 6379 on primary endpoint

I restarted the ""primary"" didn't fix anything 
Thx for any help"
Amazon Elasticache	"How to connect to Redis outside our VPC from inside our VPC?
We have a collection of servers outside our VPC and a collection within our VPC. The servers within our VPC are only accessible by ELB, and we don't have a NAT instance. We have a Redis server inside our VPC that works fine from the servers in the VPC.

Now, we want to create a Redis server outside our VPC and be able to connect to it from both the servers outside the VPC and inside the VPC. My dilemma comes with the security groups. From what I understand, the Redis server and EC2 servers need to using the same security group to connect to each other. Can anyone fill me in on the process, or if it's possible, to connect to a Redis server outside our VPC from both VPC servers and non-VPC servers.




I have already been able to setup the Redis server outside our VPC and connect to it from a non-VPC server, I'm just having problems connecting to it from inside the VPC.




Thanks!"
Amazon Elasticache	"Re: How to connect to Redis outside our VPC from inside our VPC?
Hello,

You would need a NAT instance in order to make the ElastiCache available for servers outside of VPC. Currently, I don't think there are any functionalities in the ELB that could help you achieve this.

You can find steps for this in the below link:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Access.Outside.html#Access.Outside.Limitations

I could think of using a VPN tunnel between your servers and the VPC. But I would need more information regarding your use case. What do you want your ideal stack to look like? What kind of servers are accessing the cache and how?

You mentioned that you created a Redis outside the VPC. Again, in this case, you could use a NAT instance/gateway for your internal servers to connect to the Redis outside the VPC. However, again, it would be helpful if you could provide some information regarding your end goal.

Please get back with this information.

Anup

Thanks,
Anup"
Amazon Elasticache	"Re: How to connect to Redis outside our VPC from inside our VPC?
we too have a similar issue our use case is

SNS -> Lambda -> ElastiCache & DynamoDB.

ElastiCache provides essential caching methods along with help in making the Lambda state-ful. 

The concern is that for Lambda to work nice with DynamoDB it should be set to NoVPC. 
If we have to use ElastiCache, Lambda and both have to be in the same VPC.

TO use Both ElastiCache and DynamoDB together is quite a challenge specially with Lambda. Given the VPC challenges.

Do you have any suggestions to make this easier?"
Amazon Elasticache	"Re: How to connect to Redis outside our VPC from inside our VPC?
Thanks for the reply, Anup.

I may not have been clear in my original description. When I say 'Non-VPC' or 'Outside our VPC' I'm referring to EC2 Classic. So they are still in the amazon network, just not in our self-created VPC. We don't need to access Redis from outside the AWS network. 

Essentially, our setup would look like:
VPC-Server(10.0.1.5) <--> Non-VPC Redis (172.31.1.2) <--> EC2-Classic Server (172.31.1.3)
(I know, that's not how IPs go for Redis, but just for the sake of explanation.)

Would we still need to setup a NAT instance to go between the VPC-Server and the Redis server?
I see that you can assign multiple EC2 Security Groups to the Cache Security Group in Elasticache. Would it be possible to assign the VPC security group and the EC2-Classic security group to the Cache Security Group and have it work that way?

Thanks for the help."
Amazon Elasticache	"Re: How to connect to Redis outside our VPC from inside our VPC?
thats interesting, i am not sure if i am missing something. we werent even able to create a non vpc redis (elasticache instance). any tips on how to create that?"
Amazon Elasticache	"Re: How to connect to Redis outside our VPC from inside our VPC?
I just created the Redis Cache Cluster with no Cache Subnet Group selected. When I create them within my VPC, I select that Cache Subnet Group that goes to the VPC. If there isn't one select, I can't access it from my VPC, but I can access it from servers outside my VPC.

I'm guessing that's how you do it, just don't assign it to the Cache Subnet Group."
Amazon Elasticache	"Re: How to connect to Redis outside our VPC from inside our VPC?
even if i try to not assign to a cache subnet group, a default one is created for you. The UI initially shows blank but it is created"
Amazon Elasticache	"Re: How to connect to Redis outside our VPC from inside our VPC?
I'm concluding that this isn't really possible besides doing a NAT to the Redis instance, or to the servers in my VPC.

We have decided to bring the Redis instance into our VPC and our EC2-Classic servers into our VPC as well."
Amazon Elasticache	"Commands for using ElastiCache in vb.net
Hi

I want to use elasticCache in my asp.net WebSite with VB. I have gone through Amazon “ElastiCache Getting Started Guide”. 

Please tell me some link to learn basics (commands) of using elastic cache inside vb.net. 

What commands AWS SDK for visual studio has for using it.

Thanks"
Amazon Elasticache	"Re: Commands for using ElastiCache in vb.net
Out dated. Things have moved far ahead."
Amazon Elasticache	"Connecting to ElastiCache (Outside VPC) instance from a EC2 inside VPC
Hi,

We have large number of applications that uses one ElasticCache instance (Redis) which is located outside the VPC (a classic instance). Some Applications are located with in VPCs and Some are outside VPC (Classic instances). How can we connect all applications to the cache ?


We have no issue connecting applications outside VPC to the cache as the cache is also located outside VPC
There is a smaller number of applications inside VPCs that cannot connect to the cache. We tried to use a NAT, and it didn't work


All answers are highly appreciated.

Thanks."
Amazon Elasticache	"Re: Connecting to ElastiCache (Outside VPC) instance from a EC2 inside VPC
Hello,

You wont be able to directly access the classic-cluster from a VPC instance. The workaround would be configuring NAT on the classic instance. The following link have some details: 

https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Access.Outside.html

Regards,
Umair A."
Amazon Elasticache	"Re: Connecting to ElastiCache (Outside VPC) instance from a EC2 inside VPC
Hi,
Thanks for the help"
Amazon Elasticache	"ElastiCache Redis multiple databases
Hi,

Does ElastiCache supports using multiple databases in redis ?

Thank you."
Amazon Elasticache	"Re: ElastiCache Redis multiple databases
I would like clarification of this also. Using the redis-cli, I have confirmed that I can put keys in a separate database (the redis default is 16 available databases), and that appears to be supported.

I think I recall reading somewhere that multiple databases were not supported, so some clarification from AWS staff would be much appreciated."
Amazon Elasticache	"Re: ElastiCache Redis multiple databases
In looking a but closer at the supported options in the ""parameter group"" there is an option to set the number of databases (defaulting to 16). 

Of course you should be aware of how redis treats multiple ""databases"" with regard to eviction, as they are not the same thing as multiple instances."
Amazon Elasticache	"Can't create Redis Cache Cluster in VPC
I originally ran across this issue when running Cloudformation to create a new stack. The template we use includes the creation of a Redis cluster associated with a VPC. When I ran it yesterday, the status stayed in ""CREATE_IN_PROGRESS"" for well over an hour before rolling back due to an ""incompatible network"" error from the Redis cluster.

Today, I tried to troubleshoot the issue by creating a new Redis cluster in a VPC by hand, and ran across the same error.
I then tried different configurations like using earlier Engine Versions and Node Types, but always got the same ""incompatible network"" error.
I also tried creating brand new subnet groups and vpc security groups, then using those to create a new Redis cluster, but that didn't work either.

So, to sum up the issue, I am unable to create a Redis Cache Cluster within a VPC. This is true whether it's through Cloudformation as part of a larger set of actions, or just only creating a Redis cluster by hand.
All of this occurred in the US East Region.

Perhaps it has something to do with our VPC settings? Could other actions done in the account have caused something to become misconfigured?
I tried creating a Redis cluster using all the defaults with no VPC, and that created fine. 
I also tried creating a brand new VPC (using a Cloudformation template to ensure it is the same as the original VPC that I encountered the error with in US East Region) in the US West Region and creating a Redis cluster in it, and that worked as well.

Edited by: jzhu9 on Jun 9, 2016 2:48 PM"
Amazon Elasticache	"Re: Can't create Redis Cache Cluster in VPC
After digging around a little more, I managed to track down the cause of this issue.

Turns out, we had reached the limit on allowed number of ENI's in our US East Region, and since a Redis Cluster needs an ENI, the Redis creation was failing.
After doing a cleanup of our ENI's, I am now able to create Redis Clusters, both by hand and through Cloudformation."
Amazon Elasticache	"Redis Cache Cluster has been in state Modifying for 16 hours
I used CloudFormation to create a Redis ElastiCache cluster that originally had an ElasticacheSecurityGroup.   I changed the CF to remove the ElasticacheSecurityGroup and use a EC2SecurityGroup (VPC) instead and it has been in state ""Modifying"" for the past 16 hours.

I have tried to delete the CF stack, but that failed.  I cannot find a way in the AWS Console or CLI to abort the update operation.

I tried to delete the ElasticacheSecurityGroup using the CLI, but it failed with error message ""A client error (InvalidParameterValue) occurred when calling the DeleteCacheSecurityGroup operation: Use of cache security groups is not permitted in this API version for your account.""

Any ideas would be much appreciated!"
Amazon Elasticache	"Redis extension is not loaded
Hello,

I setup a Redis instance on Elasticache. When trying to test it I get an error ""Redis extension is not loaded"".

The Redis instance appears to be fine in the dashboard - is there additional configuration required to actually allow my PHP application to use redis?

I have things working locally with Redis.

Thanks"
Amazon Elasticache	"Export redis data - unknown command 'sync'
Is it still possible to connect a redis server running on a ec2 instance as a slave to the elasticcache master?

That solution is suggested in
https://forums.aws.amazon.com/thread.jspa?messageID=589199&#589199

However, when I attempt to issue an slaveof command, I'm getting an error
MASTER aborted replication with an error: ERR unknown command 'SYNC'"
Amazon Elasticache	"Re: Export redis data - unknown command 'sync'
Hello,

From redis version 2.8.22 SYNC has been disabled:

   ""To maintain enhanced replication performance in Multi-AZ replication groups and for increased cluster stability, non-ElastiCache replicas are no longer supported""[1]

[1] http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/SelectEngine.html#SelectEngine.RedisVersions.2-8-22

Regards,
Giorgio"
Amazon Elasticache	"Re: Export redis data - unknown command 'sync'
My understanding is that creating a new redis instance in EC2 and sync'ing it was the only way to generate an RDB file.  

It sounds like, as of the latest version, once the data is in ElastiCache, it can never come out (i.e. the sole backup method (snapshots) can only be used to create new ElastiCache clusters)

That's kind of ridiculous... I'm trying to get an RDB file out to do some troubleshooting of memory usage"
Amazon Elasticache	"Re: Export redis data - unknown command 'sync'
Any answers here? I've bumped into this too"
Amazon Elasticache	"Re: Export redis data - unknown command 'sync'
Yes, same here. I need access to the RDB for profiling / troubleshooting."
Amazon Elasticache	"Re: Export redis data - unknown command 'sync'
I found this work-around for now: https://gist.github.com/thomasst/afeda8fe80534a832607

pip install click progressbar redis
wget https://gist.githubusercontent.com/thomasst/afeda8fe80534a832607/raw/0d2bebec337b095aa390dffc890c803510ec57fc/migrate-redis.py
python migrate-redis.py <source-redist-hostname> <destination-redis-hostname>"
Amazon Elasticache	"Re: Export redis data - unknown command 'sync'
You can easily export your Redis snapshots to S3 using our latest feature: https://aws.amazon.com/blogs/aws/amazon-elasticache-update-export-redis-snapshots-to-amazon-s3/"
Amazon Elasticache	"Redis connection count increasing but never decreasing?
I have a situation where Cloudwatch is reporting that new connections are being created, but never cleaned up. This happens whenever I spin up new EC2 instances in my cluster.

Currently when we push a new build out, I spin up additional instances (4) with the new binary and then shut down the instances running the previous version. When this happens, I get 4 new connections reported in cloudwatch. However, shutting down the old instances doesn't seem to get rid of the 4 connections it has. Is this an issue with the Cloudwatch metric or am I somehow leaking connections for EC2 instances that no longer exist.

This pattern can be observed going back for weeks. The new connections never seem to go away. It's not just a short lived phenomenon."
Amazon Elasticache	"Re: Redis connection count increasing but never decreasing?
Found it.

The default Redis Cache parameters for AWS have both tcp-keepalive and timeout set to 0. Which means it will never clean up connections on the Redis side.

Seems like an odd choice to set these to 0. It's seems like a guaranteed resource leak."
Amazon Elasticache	"ElastiCache redis cluster upgrade has been modifying for almost 2 hours
Hi I changed one of my replication groups from t2.small to m3.medium almost 2 hours ago.  It has been stuck in a modifying state every since.  Previously when I have done this it has taken ~10 minutes.

Is there anything I can do or do on my end to abort the modification and try again?

Edited by: searchalerts on May 30, 2016 12:00 PM"
Amazon Elasticache	"Re: ElastiCache redis cluster upgrade has been modifying for almost 2 hours
it switched over about an hour ago. All is good"
Amazon Elasticache	"Round-Robin DNS and HealthChecks in ReplicationGroups
Hi!

I'm creating a replication group of Redis in ElastiCache. This ReplicationGroup may have from 1 up to 5 replicas and ReplicationGroup give me one read endpoint for each replica. I'm also creating a single DNS entry in Route53 in order to balance readings to all replicas (using weight). Following the documentation about replicas disponibility it says:

If any of the read replica clusters fail, ElastiCache detects the failure, takes the cluster off line, launches, and provisions a replacement cluster. The new cluster is then synchronized with the primary cluster. During this time your application can continue reading and writing data.

That means there is no downtime in the replication group but the client is in charge of handling possible failures and send reads to another replica, isn't it? I mean, a client that sends a read operation against the CacheCluster being replaced, will have to handle that error and to send the read operation to another CacheCluster.

I tried to use Route53 HealthChecks to solve that, but I don't see a way to monitor CacheClusters since the DNS resolution gives to the Health Checker the CacheCluster's private IP, not the public one. Is there a way to associate HealthChecks to CacheClusters?

Thanks!"
Amazon Elasticache	"How to map RDS MySQL data to ElastiCache memcached?
Just wondering how to map RDS MySQL data to ElastiCache memcached?"
Amazon Elasticache	"Re: How to map RDS MySQL data to ElastiCache memcached?
Hi, 
you may want to take a look into this link 
http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Appendix.MySQL.Options.html

cheers
Javier C#"
Amazon Elasticache	"Time out errors while connecting to elasticache(redis) node
Hello 

I configured an elasticache(Redis) node to be accessed from outside AWS network. In the beginning I used the m1.small type NAT instance and the moment i started using the elasticache my process got slow after sometime. ON digging onto it i found that the Network's IN & OUT graph utilization was high around 30 - 35 Mbytes whereas the other resources(like CPU, RAM & Server Load) were fine. Then i tried upgrading the NAT instance to c4.2xlarge in order to have more bandwidth but still i am facing the same issue again. This time also Network IN & OUT graph shows the utilization of 35 Mb max.
The error which i am getting in the logs is : 
redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketException: Network is unreachable
redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketTimeoutException: Read timed out
redis.clients.jedis.exceptions.JedisConnectionException: java.net.SocketTimeoutException: connect timed out
these are three types of exceptions that we are still getting while reading and writing redis cache

Can any one of you tell me that where the issue is?

Also, can i get a detail of the instances with how much bandwidth it can cater.
And as per the instance details provided at : https://aws.amazon.com/elasticache/details/. What is Network Performance referring too ?

Thanks
Rohit"
Amazon Elasticache	"Elasticache Timeout (memcached)
Hi Team,

We have setup Elasticache as a disturbed cach shared across our application recently. It was working fine for the first couple of days, then we are starting to get random timeout exception. I have posted the stack trace below. Please could someone tell me is this related to AWS, our application code, the memcached server or database.

Whenever that happen, i have check the load on our apps, the cache node and RDS server and all of them has nothing to indicate it's overloaded. I am really lost in what's happening here.

Thanks
Gavy

08:03:41,214 ERROR http://DataNucleus.Cache - Exception thrown creating value for field org.sly.main.shared.data.advisor.AdvisorCompany.offices of type java.util.ArrayList
net.spy.memcached.OperationTimeoutException: Timeout waiting for value: waited 2,500 ms. Node status: Connection Status { productionsgpcache.2m9xuf.cfg.apse1.cache.amazonaws.com/10.130.17.59:11211 active: true, authed: true, last read: 18,084 ms ago }
	at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1176)
	at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1192)
	at org.datanucleus.cache.spymemcached.SpymemcachedLevel2Cache.get(SpymemcachedLevel2Cache.java:130)
	at org.datanucleus.ExecutionContextImpl.getObjectFromLevel2Cache(ExecutionContextImpl.java:5321)
	at org.datanucleus.ExecutionContextImpl.getObjectFromCache(ExecutionContextImpl.java:5212)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3158)
	at org.datanucleus.cache.L2CacheRetrieveFieldManager.getObjectFromCachedId(L2CacheRetrieveFieldManager.java:402)
	at org.datanucleus.cache.L2CacheRetrieveFieldManager.fetchObjectField(L2CacheRetrieveFieldManager.java:192)
	at org.datanucleus.state.JDOStateManager.replacingObjectField(JDOStateManager.java:2172)
	at org.sly.main.shared.data.advisor.AdvisorCompany.jdoReplaceField(AdvisorCompany.java)
	at org.sly.main.shared.data.advisor.AdvisorCompany.jdoReplaceFields(AdvisorCompany.java)
	at org.datanucleus.state.JDOStateManager.replaceFields(JDOStateManager.java:3410)
	at org.datanucleus.state.JDOStateManager.replaceFields(JDOStateManager.java:3437)
	at org.datanucleus.state.JDOStateManager.initialiseForCachedPC(JDOStateManager.java:641)
	at org.datanucleus.state.ObjectProviderFactoryImpl.newForCachedPC(ObjectProviderFactoryImpl.java:298)
	at org.datanucleus.ExecutionContextImpl.newObjectProviderForCachedPC(ExecutionContextImpl.java:1462)
	at org.datanucleus.ExecutionContextImpl.getObjectFromLevel2Cache(ExecutionContextImpl.java:5326)
	at org.datanucleus.ExecutionContextImpl.getObjectFromCache(ExecutionContextImpl.java:5212)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3158)
	at org.datanucleus.cache.L2CacheRetrieveFieldManager.getObjectFromCachedId(L2CacheRetrieveFieldManager.java:402)
	at org.datanucleus.cache.L2CacheRetrieveFieldManager.fetchObjectField(L2CacheRetrieveFieldManager.java:336)
	at org.datanucleus.state.JDOStateManager.replacingObjectField(JDOStateManager.java:2172)
	at org.sly.main.shared.data.user.User.jdoReplaceField(User.java)
	at org.sly.main.shared.data.user.User.jdoReplaceFields(User.java)
	at org.datanucleus.state.JDOStateManager.replaceFields(JDOStateManager.java:3410)
	at org.datanucleus.state.JDOStateManager.replaceFields(JDOStateManager.java:3437)
	at org.datanucleus.state.JDOStateManager.initialiseForCachedPC(JDOStateManager.java:641)
	at org.datanucleus.state.ObjectProviderFactoryImpl.newForCachedPC(ObjectProviderFactoryImpl.java:298)
	at org.datanucleus.ExecutionContextImpl.newObjectProviderForCachedPC(ExecutionContextImpl.java:1462)
	at org.datanucleus.ExecutionContextImpl.getObjectFromLevel2Cache(ExecutionContextImpl.java:5326)
	at org.datanucleus.ExecutionContextImpl.getObjectFromCache(ExecutionContextImpl.java:5212)
	at org.datanucleus.ExecutionContextImpl.findObject(ExecutionContextImpl.java:3158)
	at org.datanucleus.store.rdbms.query.PersistentClassROF.getObjectForApplicationId(PersistentClassROF.java:484)
	at org.datanucleus.store.rdbms.query.PersistentClassROF.getObject(PersistentClassROF.java:379)
	at org.datanucleus.store.rdbms.query.ForwardQueryResult.nextResultSetElement(ForwardQueryResult.java:175)
	at org.datanucleus.store.rdbms.query.ForwardQueryResult$QueryResultIterator.next(ForwardQueryResult.java:379)
	at org.datanucleus.store.rdbms.query.ForwardQueryResult.processNumberOfResults(ForwardQueryResult.java:137)
	at org.datanucleus.store.rdbms.query.ForwardQueryResult.advanceToEndOfResultSet(ForwardQueryResult.java:158)
	at org.datanucleus.store.rdbms.query.ForwardQueryResult.<init>(ForwardQueryResult.java:117)
	at org.datanucleus.store.rdbms.query.JDOQLQuery.performExecute(JDOQLQuery.java:698)
	at org.datanucleus.store.query.Query.executeQuery(Query.java:1786)
	at org.datanucleus.store.query.Query.executeWithArray(Query.java:1672)
	at org.datanucleus.api.jdo.JDOQuery.executeWithArray(JDOQuery.java:312)
	at org.sly.main.server.service.general.PersistenceServiceImpl.executeQuery(PersistenceServiceImpl.java:769)
	at org.sly.main.server.service.general.PersistenceServiceImpl.getManagementEntities(PersistenceServiceImpl.java:823)
	at sun.reflect.GeneratedMethodAccessor83.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:601)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:319)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:196)
	at sun.proxy.$Proxy21.getManagementEntities(Unknown Source)
	at org.sly.main.server.service.userspace.UserServiceImpl.getUser(UserServiceImpl.java:150)
	at org.sly.main.server.service.userspace.UserServiceImpl.getUser(UserServiceImpl.java:132)
	at sun.reflect.GeneratedMethodAccessor85.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:601)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:319)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
	at sun.proxy.$Proxy22.getUser(Unknown Source)
	at org.sly.main.server.service.general.GeneralServiceImpl.getStartupData(GeneralServiceImpl.java:78)
	at org.sly.main.server.service.general.GeneralServiceImpl.getStartupData(GeneralServiceImpl.java:64)
	at sun.reflect.GeneratedMethodAccessor559.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:601)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:319)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
	at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:64)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
	at sun.proxy.$Proxy68.getStartupData(Unknown Source)
	at org.sly.main.server.utils.preserialize.PreSerializeHelper.getStartupData(PreSerializeHelper.java:37)
	at org.apache.jsp.Controller_jsp._jspService(Controller_jsp.java:218)
	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
	at org.sly.main.dispatcher.RequestFilter.doFilter(RequestFilter.java:97)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
	at org.sly.main.compression.CompressionFilter.doFilter(CompressionFilter.java:227)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
	at net.bull.javamelody.MonitoringFilter.doFilter(MonitoringFilter.java:203)
	at net.bull.javamelody.MonitoringFilter.doFilter(MonitoringFilter.java:181)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:330)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:118)
	at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:84)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:103)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:183)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:342)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:192)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:160)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
	at org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:680)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:722)
Caused by: net.spy.memcached.internal.CheckedOperationTimeoutException: Timed out waiting for operation - failing node: productionsgpcache.2m9xuf.cfg.apse1.cache.amazonaws.com/10.130.17.59:11211
	at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:166)
	at net.spy.memcached.internal.GetFuture.get(GetFuture.java:69)
	at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1166)"
Amazon Elasticache	"Re: Elasticache Timeout (memcached)
might be related to this bug

https://code.google.com/p/spymemcached/issues/detail?id=136"
Amazon Elasticache	"Re: Elasticache Timeout (memcached)
Hello Gavy,
I have sent you an email.
Thanks,
-Omer"
Amazon Elasticache	"Re: Elasticache Timeout (memcached)
What is the solution here?

i am running into this issue everywhere.."
Amazon Elasticache	"Re: Elasticache Timeout (memcached)
Hi Omer,
I am also getting the same error, what is the solution?

Caused by: net.spy.memcached.internal.CheckedOperationTimeoutException: Timed out waiting for operation - failing node: /xxx.xx.xx.xx:11211
+	at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:93)+
+	at net.spy.memcached.internal.GetFuture.get(GetFuture.java:62)+
+	at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1235)+

-Niraj"
Amazon Elasticache	"ElastiCache:NodeReplacementScheduled
Hi, 

I got an email about the above scheduled maintenance but currently there's no indication in the AWS console.
How can I tell if it's still happening? How I can find the changes between a new node that will be created to the one we currently use?

Thanks,
Alan"
Amazon Elasticache	"Feature Request: Allow T2 to be used with Multi-AZ failover
I was hoping to be able to setup a small Redis ElastiCache cluster with auto failover. But the smallest type supported by Multi-AZ appears to be m3.medium. I really don't need anything bigger then t2.small. Thanks."
Amazon Elasticache	"Re: Feature Request: Allow T2 to be used with Multi-AZ failover
I came here to create exactly this thread.

Why must we create so large clusters for HA? Just because something is not large does not mean it is not critical. I too would like Multi-AZ for the smallest instance type. You support it for MySQL with the smallest RDS - why not the smallest Redis?"
Amazon Elasticache	"Redis - Encryption on disk
Hello,

We are planning to use Elasticache-Redis 2.8.24. But our requirement is that any data at rest needs to be encrypted. I see during replication, redis persists to disk and then collects client buffer etc. Further the snapshots are written to S3. So is encryption supported for these two activities via AWS KMS?

Thanks for your quick response."
Amazon Elasticache	"Re: Redis - Encryption on disk
EC2 Admins, 

Can you please respond if encryption is an option for snapshots or data written to disk during replication?
Thanks!"
Amazon Elasticache	"Scheduled Maintenance
Hi,

I received an email making me aware of a scheduled maintenance on ElastiCache Nodes

I just wanted to know, when the maintenance is done, will the new node have the same ENDPOINT URL as it did before the maintenance? or will I have to update my code to point to the new ENDPOINT?

I understand that if I do it manually, this is the case, but if the maintenance is done by AWS, is this still the case?"
Amazon Elasticache	"Re: Scheduled Maintenance
I believe all you have to do is sit tight. If you have Redis there may be an additional step or two. Check out this doc on the maintenance when you have a sec, it will explain all:

https://aws.amazon.com/elasticache/elasticache-maintenance/

Thanks,

Paul K"
Amazon Elasticache	"Any possibility to find out the size of a key in ElastiCache REDIS?
Hi,

I am trying to determine the size of an object in REDIS. As the DEBUG command is disabled ... is there any way to do it? I am interested in the serializedlength value.

Can e.g. a slave have less restricted commands than a primary endpoint?

Thx and all best
Johannes"
Amazon Elasticache	"Re: Any possibility to find out the size of a key in ElastiCache REDIS?
Any thoughts about that?"
Amazon Elasticache	"Re: Any possibility to find out the size of a key in ElastiCache REDIS?
Any news?"
Amazon Elasticache	"SYNC not supported?
We have a tool to manually re-shard redis servers cluster by dumping all data from old Redis server and rewrite data back to new servers. The dump is impemented by connect to redis server, and send SYNC command and receive RDS file and replicated commands from redis over socket. 

However when I tried this tool with ElastiCache Redis, it didn't work due to error on SYNC command.   

Try SYNC command with redis-cli, I got the following error.

*SYNC with master failed: -ERR unknown command 'SYNC'**

It seem SYNC is not one of restricted command
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ClientConfig.RestrictedCommands.html

Any idea why SYNC does not work?
BTW, we are using Redis 2.8.24, node type is cache.m3.medium

Thanks,
Zihui"
Amazon Elasticache	"Re: SYNC not supported?
Just notice this question had been asked in others thread https://forums.aws.amazon.com/thread.jspa?threadID=220449&tstart=0"
Amazon Elasticache	"Disable save on Redis
Hi,

I want to use Redis as an in-memory only cache and don't need to persist the data to disk. For this purpose I would disable all ""save"" params. It seems that this param isn't support on AWS though. Is there any other way to archive this?

Cheers,
Philipp"
Amazon Elasticache	"ElastiCache Cluster Client via yum
Just out of curiosity why is library not managed though yum on Amazon Linux? Or I guess the better question would be can it be? IMHO, seems like it would eliminate some confusion and barriers to entry"
Amazon Elasticache	"ElastiCache Cluster Client Support for PHP 7.0?
Hi guys,

Any details on the release map for the next EC Cluster Client that supports PHP 7.0?

Looking to move to PHP 7.0x across our infrastructure as soon as possible and the ElastiCache Cluste Client is one of the major blockers.

Cheers,"
Amazon Elasticache	"Re: ElastiCache Cluster Client Support for PHP 7.0?
Hello,

We are continuously adding support for new features to our services. Currently we do not have any timelines when the newer versions will be supported. 

Please keep an eye on our blogs to see latest updates and feature releases.


https://aws.amazon.com/blogs/aws/
https://aws.amazon.com/new/"
Amazon Elasticache	"java Redis client to connect to read replica endpoint?
Hi,

I would like to use Jedis client to connect to my Redis read endpoints, could someone point me to how to do that? Some code example would be great.

If Jedis could not do that (it is not clear from the Jedis source code), any other Java Redis client can do that?

Thanks."
Amazon Elasticache	"Re: java Redis client to connect to read replica endpoint?
Hi, 

I'm not very familiar with the Jedis client but I did find these external articles that may help you: 
https://github.com/xetorthio/jedis 
https://github.com/xetorthio/jedis/wiki/AdvancedUsage

Jedis jedis = new Jedis(""node_endpoint"");
 
jedis.set(""foo"", ""bar"");
String value = jedis.get(""foo"");
 
// A Pipelining example
 
Pipeline p = jedis.pipelined();
p.set(""fool"", ""bar""); 
p.zadd(""foo"", 1, ""barowitch"");  p.zadd(""foo"", 0, ""barinsky""); p.zadd(""foo"", 0, ""barikoviev"");
Response<String> pipeString = p.get(""fool"");
Response<Set<String>> sose = p.zrange(""foo"", 0, -1);
p.sync(); 
 
int soseSize = sose.get().size();
Set<String> setBack = sose.get();


We do have an AWS library that you can use to control elsticache itself (not GET/SET):
https://us-west-2.console.aws.amazon.com/elasticache/home?region=us-west-2#client-download:

Have a look at this white-paper for an overview of caching strategies and some examples:
https://d0.awsstatic.com/whitepapers/performance-at-scale-with-amazon-elasticache.pdf

With redis in particular I can suggest that you use pipelining and connection pools to dramatically improve performance. 

I hope this helps!

Best regards, 
PhillR"
Amazon Elasticache	"Access REDIS (ElastiCache) cluster from local machine for development
We have setup ElastiCache service with REDIS as the cache engine. From the documentations that we have read so far, it seems AWS has designed ElastiCache to be accessed from within AWS only.

There is a documentation given by AWS for accessing cluster from outside AWS.
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Access.Outside.html
However, the process described above looks convoluted.

Is there no simpler way to be able to connect to REDIS externally to program against it? Given we are in the development phase, it seems an over-kill to deploy the application to EC2 every time we want to test REDIS connectivity and explore its features.

I tried writing a small test client to check the access to REDIS, but the client fails to connect.
Below is the snippet of the code that we would like to extend further.

RedisClient client = new RedisClient(""<cluster-node>:6379"");
RedisPubSubConnection<String, String> connection = client.connectPubSub();


Edited by: joshivis on Feb 25, 2016 12:57 AM"
Amazon Elasticache	"Restore to previous generation instance type not possible
Hello

We have a cluster called 'redis-2-8-19' which is based on cache.m2.2xlarge node type, for which we have an active Heavy Utilization reservation. Today we wanted to upgrade this node to Version 2.8.24 by restoring a snapshot to a new cluster and switching backends to the new endpoint, however that's not possible as AWS (due to bug?) only presents 'Current generation' instances in the selection list.

We also cannot switch the Redis version on the current running instance, as according AWS notification shown this would clear all cache data.

Can you please check our account and authorize it so we can restore a snapshot to previous instance node types, for which as said we have an active reservation.

Thanks

Regards
Marcel"
Amazon Elasticache	"Re: Restore to previous generation instance type not possible
Hello, 

So there is not going to be a way to restore to a previous generation instance type, as only current generation types are available for new clusters. If this isn't something you're okay with, you can contact Customer Support to pursue any options you may have with what you've paid for this Reserved Instance type. 

For upgrading, you'll want to set your cluster to multi-AZ to prevent downtime and/or loss of cache data. You can read more on this topic here: 
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/SelectEngine.html#VersionManagement 
Redis engine version upgrades may or may not be a disruptive process, depending upon whether or not Multi-AZ is enabled.

For Multi-AZ enabled clusters (Redis version 2.8.6 or higher), upgrading is a non-disruptive process. Your cache data is retained.

For clusters running a Redis version prior to 2.8 and any clusters with Multi-AZ disabled, changing a cache engine version is a disruptive process which clears all cache data in the cluster. If you are running a Redis 2.8.x version, we recommend that you enable Multi-AZ before you upgrade so that upgrading will not be disruptive. If you want, you can always disable Multi-AZ after the upgrade.

Regards,
Nick"
Amazon Elasticache	"We can use both method memcached and redis on magento1.9.2 by elasticache?
Hi Guys,
Currently we are doing website on magento 1.9.2 version. We are using our elasticache for session and caching system for fast loading. Here, we have planned to use memcahed for session and redis for caching system. In this case we have received error on cart session problem. got sign out on customer and admin end.
if we use redis method only means, the site working successfully.
Is it possible use both memcahed and redis method on single website?.
Actually whats the problem going or what are the setting we have to do.
Please help me our shopping cart had trouble on live.

Thanks in advance,"
Amazon Elasticache	"Does 10GBit = 10GBit out or 5GBit out?
We have an r3.8xl Redis Elasticache.

We're seeing a maximum network output of 40 billion bytes in Cloudwatch Metrics. I think that's per minute, which would make ~5GBit/sec out.

Is that expected, or do we have a bottleneck somewhere else in our stack?"
Amazon Elasticache	"Multi-AZ Redis cluster failed and did not recover automatically
Hi,

Our ElastiCache Multi-AZ Redis cluster failed this morning and did not recover automatically.  The management console claimed the cluster to be available, even though connecting to it failed (network timeout).  It was only when we manually had requested a snapshot that ElastiCache determined the nodes to be failed and restarted(?) them, clearing the entire cache in the process.

The cluster with 2 instances failed this morning at 5:01 UTC and we see a “Recovering cache nodes 0001” event in the Cache Events.  Somewhere between 05:23-05:30 UTC we requested taking a snapshot of the cache cluster as a backup.  At 05:35 we see another set of “Recovering cache nodes 0001” event in the Cache Events, and “Finished recovery for cache nodes 0001” at 05:40 (at which point the entire cache was emptied).

CloudWatch metrics have a gap between 04:58 - 05:38 UTC.

We have enabled automatic failover and Multi-AZ.  Our database is very small (a snapshot is ~4MB).  It seems that our CloudFormation template may be lacking the preferred AZ configuration, and ElastiCache has placed both nodes in the eu-west-1b zone.

What caused the failure and how can we prevent it in the future?

We switched from our own hosted Redis to ElastiCache one week ago for better reliability and easier maintenance, and have already had 45 minutes of downtime because of it."
Amazon Elasticache	"Redis with AZ replication and automatic failover - slave endpoints
Hi all,

I have a redis replication group with AZ replication and automatic failover enabled. For such group I have a single endpoint for the master (write) node. Is it possible to set up such endpoint for slave (read) nodes? Ideally it would round robin through healthy slave nodes but skip the ones that failed. Or this logic always has to be done on the client side?

Thanks!"
Amazon Elasticache	"t2.large node type
Are there any plans for a t2.large node type using the recently announced t2.large specs (8GB memory)?"
Amazon Elasticache	"Re: t2.large node type
Hello,
many thanks for the request. 
I opened a new feature request to the Elasticache team!

Regards"
Amazon Elasticache	"Re: t2.large node type
6 months passed, but I still not seeing the t2.large node."
Amazon Elasticache	"Cannot connect to Redis cluster from EC2 in VPC
I am trying to connect to a Redis cluster from an EC2 instance. I have been following the Getting Started documentation for ElastiCache at the following link: 

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.html

The EC2 instance is in a VPC, so I configured the instance's VPC Security Group with a Custom TCP Rule as described in the documentation.
Since the cluster has to be in the same VPC as the EC2 instance, I created a Cache Subnet Group for the cache, using the VPC ID that the EC2 instance also uses. I then launched a cache cluster using the wizard, selecting Redis, disabling replication as the Getting Started guide recommended (this cluster is just for testing purposes), and on the Configure Advanced Settings screen, I selected the Cache Subnet Group I had just created in the dropdown.
Then, I sshed in to the EC2 instance and, after installing the redis cli utility, attempted to connect to the cluster endpoint. The command:

src/redis-cli -h {my_cluster_name}.0001.usw2.cache.amazonaws.com
results in the error:

Could not connect to Redis at {my_cluster_name}.0001.usw2.cache.amazonaws.com:6379: Connection timed out

Any help would be greatly appreciated. I've spent a number of hours fiddling with configuration details and have yet to make any progress. Thanks.

Edited by: natealmeida on Jan 15, 2016 8:33 AM"
Amazon Elasticache	"cache.t2.nano?
When will be available t2.nano on elasticache?
thank you"
Amazon Elasticache	"Installing aws ElastiCache Cluster Client for PHP
I have folllowed the steps suggested at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Appendix.PHPAutoDiscoverySetup.html#Appendix.PHPAutoDiscoverySetup.Downloading

I have compiled php version 5.6.

I have downloaded the elasticache cluster client package of php 5.6 for 64 bit from 
https://s3.amazonaws.com/elasticache-downloads/ClusterClient/PHP-5.6/latest-64bit

I ran the following commands:
1. Installed php5.6 from tar ball through compilation

2. sudo /etc/php/bin/pecl install https://s3.amazonaws.com/elasticache-downloads/ClusterClient/PHP-5.6/latest-64bit

3.echo ""extension=amazon-elasticache-cluster-client.so"" | sudo tee /etc/php.d/memcached.ini

Everything ran successfully.
When I ran php -v, I got following response:
PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib64/php/modules/amazon-elasticache-cluster-client.so' - /usr/lib64/php/modules/amazon-elasticache-cluster-client.so: cannot open shared object file: No such file or directory in Unknown on line 0

I am not able to download  the amazon-elasticache-cluster-client.so on my server.

Please help in getting out of this."
Amazon Elasticache	"Redis replica failed for unknown reason (second failure this week!)
Our production cache cluster ""production-redis-001"" (account 956931515010) which is a replica of ""production-redis-002"" failed and had to be recovered at 11:44AM UTC today (January 1). 

According to our monitoring software (Datadog), ""production-redis-001"" started to experience high latency spikes at 3:34AM UTC on December 31. The latency spikes were 10 minutes to multiple hours apart and ranged from 150ms to 6 seconds (mostly they were in the second range).

Three days ago, we had failover from ""production-redis-001"" to ""production-redis-002"". According to Richard@AWS, it may have been triggered by a hardware fault. 

Did this new replacement ""production-redis-001"" get provisioned on bad hardware? What caused this failover? We are having what seems like non-stop problems since switching from our own EC2 instance running Redis to ElastiCache."
Amazon Elasticache	"Re: Redis replica failed for unknown reason (second failure this week!)
Hello,

I can confirm that replacement hardware was provisioned for production-redis-001 approximately two hours prior to this post.

I can further advise that the cause of this was indeed hardware failure; I have investigated the old node and can see that the physical device it was on was diagnosed as faulty by our automated systems at Fri Jan 01 2016 12:30:43 GMT+0000 and it has now been taken out of production.

The AWS service is built on commodity hardware and thus occasional failures are an expected limitation of the service. Failures are relatively rare as a rule; while you have seen two failures in a week, that is simply bad luck I'm afraid -- the same thing could has easily have happened while running your own Redis instances, though in that situation you would need to have recovered manually, whereas in this case the service did the work for you.

Apologies for the inconvenience caused.

Richard"
Amazon Elasticache	"Re: Redis replica failed for unknown reason (second failure this week!)
Thanks for the update Richard@AWS!"
Amazon Elasticache	"Redis Multi-AZ failover for unknown reason
Our production replication group ""production-redis"" (account 956931515010) failed over for an unknown reason today, December 28 at 12:11 PM UTC. It failed over from master node ""production-redis-001"" to replica node ""production-redis-002"".

What was the cause of the failure of the master node? It caused a disruption for ~2 minutes. 

According to our monitoring, everything was normal until the failover occurred. Also, our SNS topic (subscribed to via a Lambda) only received a notification for the ""ElastiCache:CacheNodeReplaceComplete"" message. We did not receive a notification for when the failover occurred or when the recovery completed."
Amazon Elasticache	"Re: Redis Multi-AZ failover for unknown reason
Hello,

I've had a look at this. 

While my logs are somewhat limited, I can see that our systems provisioned replacement hardware for production-redis-001 approximately ten hours ago (~00:15 UTC December 29th). From that it seems likely that the fail-over was triggered by an underlying hardware fault.

I hope this helps.

Richard"
Amazon Elasticache	"Re: Redis Multi-AZ failover for unknown reason
Thanks Richard@AWS.

I incorrectly specified that the date time was 2015/12/28 12:11 PM UTC in my original post when it was in fact 2015/12/29 12:11 AM UTC. So, I'm guessing you are correct in that it was a hardware fault."
Amazon Elasticache	"Redis Appears to Have a Memory Leak
I have a question about a Redis cluster.  The cluster in question is the only under account 428692811555.  I have read other forum articles about Redis constantly eating the freeable memory and that it was nothing to worry about.  However, after it got down to a very low range of freeable memory it started to use swap which is not ideal for an in memory cache as that starts to use the slow hard disk for memory.

I am worried that this will eventually fill up the allotted swap and start to cause crashes with Redis.  Do I need to create a new cluster and switch it?  If I do that is this going to be a constant thing that every so often I have to destroy an old cluster just because it uses all available memory?  It appears that a reboot does not help as I have already tried that.

I have included a capture of the graphs to show what is happening.  Any help is greatly appreciated.

Thanks"
Amazon Elasticache	"Re: Redis Appears to Have a Memory Leak
Hi,

This seems to be a duplicate of the post.

I have answered you on the above thread. 

Regards,
Jayakrishnan L."
Amazon Elasticache	"Redis Appears to Have a Memory Leak
I have a question about a Redis cluster.  The cluster in question is the only under account 428692811555.  I have read other forum articles about Redis constantly eating the freeable memory and that it was nothing to worry about.  However, after it got down to a very low range of freeable memory it started to use swap which is not ideal for an in memory cache as that starts to use the slow hard disk for memory.

I am worried that this will eventually fill up the allotted swap and start to cause crashes with Redis.  Do I need to create a new cluster and switch it?  If I do that is this going to be a constant thing that every so often I have to destroy an old cluster just because it uses all available memory?  It appears that a reboot does not help as I have already tried that.

I have included a capture of the graphs to show what is happening.  Any help is greatly appreciated.

Thanks"
Amazon Elasticache	"Re: Redis Appears to Have a Memory Leak
Hi,

As you know, freeable memory is the memory used by OS cache and will be given back when needed.

However if you see that the freeable space is not coming back and swap usage continues to increase, I suggest you to look into 'reserved-memory' settings. Setting adequate reserved-memory ensures the OS has enough memory for its underlying process. 

You can checkout our Redis parameters guide here.

I also recommend you to go through our Elasticache Best Practices Guide.

Hope this helps,

Regards,
Jayakrishnan L."
Amazon Elasticache	"Are Redis Transactions Supported?
Does the Redis engine used by ElasticCache support transactions? Specifically the MULTI and EXEC commands. I've spent hours trying to troubleshoot and figure out why the client connection is closed prematurely when using MULTI/EXEC to batch commands together. I can confirm that the individual commands I am using between MULTI and EXEC work fine when ran synchronously on their own.

The only error I see is: Error: Redis connection lost and commands aborted in uncertain state. They might have been processed.

Could this be a bug or configuration issue? Are transactions somehow disabled by AWS?"
Amazon Elasticache	"Re: Are Redis Transactions Supported?
Mystery solved. We are using twemproxy which does not support transactions."
Amazon Elasticache	"about redis data loss possibility
Hi,
I am developing an app and I will use redis to store some keys. But these keys are important and in case of losing any data on any fail cases might cause serious problems. Because the data stored in redis is a live data. I have an understanding of snapshots, aof and multi-az deployments. But in amazon services, could it be possible to not lose any data on fails. Or what is the least amount of time that it can be do reads and writes."
Amazon Elasticache	"Re: about redis data loss possibility
Hi,

Please note that Elasticache is an In Memory caching service. As you know there is a possibility of losing data. You can use AOF (Prior to Redis version 2.8.22), Multi-AZ deployment, snapshots etc to reduce data lose. 

But if you need durability and redundancy for your data, you should consider using AWS DynamoDb.

Hope this helps."
Amazon Elasticache	"Easiest way to flush Redis ElastiCache
I'm using Redis on ElastiCache as a session store. During testing, I need to flush the entire cache. What's the easiest/fastest way to entirely flush the cache? Thanks!"
Amazon Elasticache	"Re: Easiest way to flush Redis ElastiCache
Hi,

You can use FLUSHDB to clear data from your connection's current database. Else if you want to delete everything, you can use FLUSHALL which will delete everything from all databases in the Redis. However be careful while using these commands, FLUSHALL in particular.

You can read about the Redis documentation about the commands here FLUSHDB, FLUSHALL.

Hope this helps.

Regards,
Jayakrishnan L."
Amazon Elasticache	"Expiration Time of Items or residing time of item in elasticache.
Hi,
can you suggest me on these points:
1. where can i found the setting for item expiration? 
2. Can  we set the expiration time for items?
3. Minimum time for items reside in elasticache?
4. how can i set the expiration time on items ?
5. can we have some expiration settings for those items which are less used(used in a month or a year) ?"
Amazon Elasticache	"Re: Expiration Time of Items or residing time of item in elasticache.
Issue has been resovled"
Amazon Elasticache	"High latency for Redis ElastiCache nodes
Hi there,

Starting on Dec 15 2am UTC we began to see high latency from our Redis replication group, hosted in us-west-2b (primary) and us-west-2c (read). CloudWatch metrics don't point out any alerts, but the instances consuming Redis are seeing 5s-6s response times. The image attached shows the response times we are getting.

We don't see any failover events in our dashboard. Have you detected any issues with Redis in this Region or AZs?

Thanks."
Amazon Elasticache	"Re: High latency for Redis ElastiCache nodes
Hello,
I reviewed our Service Health Dashboard here [1], but there were no known issue with Elasticache service, yesterday 14/12/2015.

Could you please share with us Elasticache cluster name/id to continue troubleshooting?

[1] http://status.aws.amazon.com/

Regards,
Alessandro"
Amazon Elasticache	"Re: High latency for Redis ElastiCache nodes
Hi Alessandro,

The cluster ID is 'prodredis2', created on July 15, 2015 and it's a cache.m3.medium instance.

Thank you,

Tom."
Amazon Elasticache	"Can't select t2.micro, t2.small, or t2.medium
Hi,

See attached screenshot. Why are they disabled? They are listed as part of your product offering.

Thanks,
Vincent"
Amazon Elasticache	"Re: Can't select t2.micro, t2.small, or t2.medium
Hi Vincent,

That's because Multi-AZ with Auto Failover is not supported on t1 or t2 instances.
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheNodes.SupportedTypes.html

Thanks."
Amazon Elasticache	"Re: Can't select t2.micro, t2.small, or t2.medium
Ah ha! Thanks!"
Amazon Elasticache	"ElastiCacheClusterClient for PHP 5.6 refuses to work (but installs fine)
I install the memcached elastic cache cluster just like it says in the official docs (using a PHP 5.6 worker ami-ec295a86) and it goes through without a problem. The trouble is that PHP refuses to load the module with the following error:$php -v
PHP Warning:  PHP Startup: memcached: Unable to initialize module
Module compiled with module API=20100525
PHP    compiled with module API=20131226
These options need to match
 in Unknown on line 0
PHP 5.6.14 (cli) (built: Oct 16 2015 22:58:32) 
Copyright (c) 1997-2015 The PHP Group
Zend Engine v2.6.0, Copyright (c) 1998-2015 Zend Technologies
    with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2015, by Zend Technologies

Things I tried to solve the problem:
*) Removing the php-memcached extension like it says in the docs: 
sudo pecl uninstall __uri/AmazonElastiCacheClusterClient

*) And also removing php-memcached with yum: 
sudo yum -y remove php-pecl-memcached

The result is always the same: the extension gets uninstalled properly (php -m confirms this) yet installing with the official instructions always yields the above mentioned problem.

What am I missing?"
Amazon Elasticache	"Is there any error log for Elasticache Redis?
Hi,
our Redis cache repeatedly hangs. As soon as we flush the whole cached contents it becomes responsive again.

During the hanging period we noticed all metrics are nearly flat (low cpu usage, low network traffic and so on), but the client-side php code (Magento redis backend) doesn't expose useful info.

Is there any place where we could find some error logs from redis?"
Amazon Elasticache	"Re: Is there any error log for Elasticache Redis?
Hello,

Thank you for writing into the AWS Forums.

Unfortunately there are no error logs provided by us for ElastiCache Redis, however most of the time the application should expose something.

What you can review however is cache node events, which will give insight to things like reboot/maintenance etc.

Regards,
Troy W"
Amazon Elasticache	"Redis cluster in unconsolidated state
Hi, we have one of our redis cache cluster in an unconsolidated state since last friday. We can't apply it any action not even delete it.


redis-test-001 is either not present or not available (Service: AmazonElastiCache; Status Code: 404; Error Code: CacheClusterNotFound; Request ID: 2e5065ce-8712-11e5-b58f-adef9ac66671)

Thanks for your help."
Amazon Elasticache	"Re: Redis cluster in unconsolidated state
We have created another redis cluster to be able to continue working. Today I can see that the oldone finally become deleted."
Amazon Elasticache	"MySql RDS with ElastiCache Service
I am using RDS on amazon with MYSQL database. I have a RSS parser written in node.js which runs every 3,15,30 minutes and does some CRUD operations.

At the same time I have webservices written in node.js where I approximately have 1500 to 2000 requests/sec which is only HTTP GET operations.

We have decided to use ElastiCache service so data can be synced on Cache Server from RDS probably every 15 minutes.

Now for my scenario which should be appropriate one from the below options

a.) Memcached or Redis
b.) Managed cache service
c.) Launch cluster nodes"
Amazon Elasticache	"Sample code examples for ElastiCache seems missing
Hi I am new to AWS services. I am trying to understand API's  to use Redis with AmazonElastiCacheClient.  Like Kinesis, Redshift and others we have many sample code examples which helps faster to understand the basic API' usage. 
Could you please guide me if we have similar examples available for Java for ElastiCache Client.
which can show as how to  set your cache objects and perform fetch operations and best practices.
 something like 

 AmazonElastiCacheClient client = new AmazonElastiCacheClient(new DefaultAWSCredentialsProviderChain());
        DescribeCacheClustersRequest dccRequest = new DescribeCacheClustersRequest();
        dccRequest.setShowCacheNodeInfo(true);
        DescribeCacheClustersResult clusterResult = client.describeCacheClusters(dccRequest);
        List<CacheCluster> cacheClusters = clusterResult.getCacheClusters();

        for (CacheCluster cacheCluster : cacheClusters) {
            List<CacheNode> cacheNodes = cacheCluster.getCacheNodes();

        }

where to set cache objects and then move ahead to get that cache value back. Thanks"
Amazon Elasticache	"Cache node Freeable Memory Graph
We were looking into some of the usage on Cache Cluster,  And looking at Freeable Memory, its very odd for this Graph to be true.

In attached graph below it shows; we flush 2 odd GB of data once a day.

How can we investigate if that is Graph plotting issue?
http://s21.postimg.org/4b6zmdkw7/Capture.png"
Amazon Elasticache	"How my clients can make use of my many Redis read replica?
When I add many read replica, so many slaves. How my clients can make use of these extra slaves?

Do I need to provide my clients with the DNS addresses of all my slaves?"
Amazon Elasticache	"During maint. downtime, will nodes in same cluster be down simultaneously?
My app requires at least 1 memcached server to be up at any given time.
I want to create several ElastiCache nodes, so that if one is down for maintenance, others will be available.

The question is,
maintenance window is set for ElastiCache cluster, not node - does this mean all nodes in the same cluster can be down at the same time?
(in which case I would have to create two clusters with different maintenance windows, instead of two nodes in one cluster)

Thanks,
Edward Chernenko"
Amazon Elasticache	"Getting ""OperationTimeoutException"" exception while accessing ElasiCache
Hello, Guys

Here is my problem


I'm getting ""OperationTimeoutException"" while trying to access elasticache. Following is the error message


Caused by: net.spy.memcached.OperationTimeoutException: Timeout waiting for value
	at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1142)
	at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1157)

Caused by: net.spy.memcached.internal.CheckedOperationTimeoutException: Timed out waiting for operation - failing node: xxxxxxx.yyyyy.0001.use1.cache.amazonaws.com/11.11.111.111:11211
	at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:65)
	at net.spy.memcached.internal.GetFuture.get(GetFuture.java:37)
	at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1135)

Here is what I did.
I'm using Elastic Beanstalk as my application environment. 
My Elastic Beanstack environment is in US-east zone.
From AWS EC2 console I copied the security group, which is 'elasticbeanstalk-default"".
And entered it in ""EC2 Security Group to Link"" field, entered the correct ""AWS account id"" and configured the security group.

What should I do to access the ElastiCache?
My guess is there might be something wrong with security group settings.
Am I missing something while configuring the security group. Do I have to edit the ""elasticbeanstalk-default"" security group in EC2.
If yes, what should I enter for the following fields?
	Port number:
	Source:

Thank you.

Anil Madamala


Edited by: srini994 on Sep 23, 2011 1:22 PM"
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
srini994: We've requested some additional information in a Private Message - please review and reply to that message so we can determine next steps. Thank you."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
Hello, Guys
I still haven't figured out how to access ElastiCache without getting ""OperationTimeoutExceptions"". 

My Cache Security Group is membase. Here is the snapshot of my security settings.
https://skitch.com/amadamala/fhmqs/aws-management-console 
I'm accessing ElastiCache from my app in Elastic Beanstalk. And Elastic Beanstalk is using the same security group. 
So why does I'm getting ""OperationTimeoutException"" error while accessing my ElastiCache.


Anil Madamala


Edited by: srini994 on Sep 27, 2011 11:51 AM"
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
srini994: We've requested some additional information in a Private Message - please review and reply to that message so we can determine next steps. Thank you."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
@ KamalG@AWS I am also facing the exact same error. Can you tell me what information do you want so that we can debug this issue?"
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
gensent: We've requested some additional information in a Private Message - please review and reply to that message so we can determine next steps. Thank you."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
Hi,

can someone post possible causes and solutions to this error?  I've been stuck with it for 2 days."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
ykovalek: We've requested some additional information in a Private Message - please review and reply to that message so we can determine next steps. Thank you."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
I'm struggling with this myself, and I am also using the spy memcache client library. I am able to telnet to the memcache node fine, but when running with the library, I get similar exceptions to those posted above."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
J. Nichols: Please review and reply to the following questions at elasticache-forums@amazon.com so that we can determine next steps. Thank you.

•	Are you trying to telnet to ElastiCache node from the same machine on which you are running spymemcached client ?
•	Can you let us know which spymemcached version you are using ?
•	Can you paste the telnet and spymemcached logs ?
•	Can you please provide us with your account number and cache identifier information ?
•	Can you please provide us with node and port information that you are using to configure spymemcached ?

Thanks,"
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
We also have this problem.  operations start to time out randomly.  sometimes this spikes the cpu up to 100% and occasionally the process never recover.  We switched to xmemcached, the problem still occurs with regularity, but xmemcached actually recovers.  This is a huge problem for us."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
I have the same problem. I'm using spymemcached 2.8.1."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
Has anyone found a solution to this? I'm getting the same problem."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
Did you find a solution instead of using xmemcached ?"
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
We are facing very similar problems. We have two clusters with two nodes in each for redundancy. We have random node failures that we can't explain from our application logs nor from the cache events. Has anyone found the solution for this? I cannot find any information that can help."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
I am having similar problem..

What is the solution here? Any workarounds?

Any help is greatly appreciated."
Amazon Elasticache	"Re: Getting ""OperationTimeoutException"" exception while accessing ElasiCache
same problem here.

anyone?"
Amazon Elasticache	"Cannot seed Redis instance from S3
Hi,
I'm trying to create a new Redis Elasticache cluster using an rdb file in S3.

The operation fails with the error: Aws::ElastiCache::Errors::InvalidParameterValue: No permission to access S3 object


The .rdb object definitely exists in S3, and has public-read permissions. (I have also tried adding the aws-scs-s3-readonly@amazon.com email permission to the object to no effect).

The SDK request (in Ruby) looks like this:

elasticache.create_cache_cluster(
  cache_cluster_id: 'redis-master', 
  az_mode: 'single-az', 
  preferred_availability_zone: 'eu-west-1b', 
  num_cache_nodes: 1, 
  cache_node_type: 'cache.r3.large', 
  engine: 'redis', 
  engine_version: '2.8.19', 
  cache_parameter_group_name: 'my-custom-param-group',     # doesn't work with default either
  cache_security_group_names: ['default'], 
  snapshot_arns: ['arn:aws:s3:::mybucket/redis.rdb']
)


Somebody please help me stop losing my mind and solve this. 

Thanks.

Edited by: rf909 on May 26, 2015 9:38 AM"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Still not working - any ideas?"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Hi rf909,
We have discovered and working to fix an issue that's related to this. Will be fixed soon and you will be able to seed an ElastiCache Redis cluster from your RDB snapshot.
Thanks,
Dan"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
@DanZ Is there any time frame for this? This is preventing us from migrating our self hosted redis instances into elasticache."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
It's also preventing us from migrating to redis elasticache."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
@DanZ any updates here, we're also running up against this and are looking for an update on the status."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
I've sent a few emails and actually resorted to twitter to finding out if we can get an update on this.

Can we please get an ETA on this?"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
@DanZ any updates on this?"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
DanZ@AWS any update on this?  Your Redis offering is already limiting .. this is adding one more board to the coffin for us!"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Guys we're aware that the issue is causing pain and our engineers are working to resolve this asap. I will have a more specific ETA for fix shortly, will post on this forum once we have it. 
Apologize for any inconvenience caused by this."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Hi I have the similar problem and here is my error message received from web console.

No permission to access S3 object: ... (Service: AmazonElastiCache; Status Code: 400; Error Code: InvalidParameterValue; Request ID: ...)

I am not sure if it is the same problem and hope it could be solved asap."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
thank you for the update DanZ"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
We wanted to try out ElastiCache as an alternative to our existing Redis hosting, but was prevented from trying it out because of this issue. Is there any other ways to create an ElastiCache instance from an existing .rdb file, or will we have to wait for this issue to be fixed?

Thank you."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
There is no other way, we're all waiting on this."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
We are starting to roll out a fix, stay tuned for more updates."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Hi Dan,

Still experiencing the same error at this stage. Should we expect anything else yet?

Thanks."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Working at last!"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Not working for me yet.

No permission to access S3 object: redis-dumps-redact/dump.rdb (Service: AmazonElastiCache; Status Code: 400; Error Code: InvalidParameterValue; Request ID: redacted)"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
fwiw, I only tried using an S3 object with a public-read ACL."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
We ran into this issue as well, but opted to migrate using a migration script from this repo https://github.com/brandonwamboldt/redis-tools

This method is probably a bad idea if your dataset is large. Ours was very tiny."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Keep in mind that this script uses the ""KEYS"" command which is a blocking call to Redis. You will take down production if you're not careful .

There are lots of reasons not to use KEYS -- http://redis.io/commands/KEYS

We considered this approach as well but it is not viable as our dataset is too large."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
It's been 5 days. Any more updates here?"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Another option is to use https://github.com/sripathikrishnan/redis-rdb-tools `rdb --command protocol your_file.rdb` to convert the RDB dump to a Redis protocol stream and pipe it in to the server using `redis-cli --pipe -h your_endpoint`.

@antirez also mentioned loading the RDB and sending BGREWRITEAOF should work, but not sure on the specifics for that.

It would be great to see this fixed though, I spent a couple of hours trying to work out what was going on before I stumbled on this thread!

James"
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Hi guys,
The restore from RDB files on S3 to ElastiCache should work now. Please let us know if you are running into problems. Again apologize for any inconvenience this might have caused."
Amazon Elasticache	"Re: Cannot seed Redis instance from S3
Hi there,

I have the same error when I try to backup from a .rdb on S3 when the permissions are read only for the account. If I add public-read access to the .rdb file then it will work..

Is this the expected behaviour? Public read is far from optimal for us!

Cheers,
Levi"
Amazon Elasticache	"BeITMemcached - ENYIM changeover
I have been using BeITMemcached as my memcache client and now want to change over to using Enyim with Autodiscovery as provided by AWS. I only have a single node in my cluster at the moment, but will be adding to it in the coming months.

I have done an initial change on a test webserver to use the Enyim client, however I am seeing mixed results. The Enyim client finds some objects but fails to find others.

The production server using BeITMemcached still retrieves all objects as expected.
The only difference is the client change over from BeITMemcached to Enyim.

 Note: The client that inserted the objects into cache is still BeITMemcached, is this relevant? Can both be used on the same cache server (single node) to read/write data?

Any help or advice appreciated."
Amazon Elasticache	"Node resize in an ElasticCache redis cluster
Hi,

Is there any way to resize (change instance type) a redis elasticcache cluster node?
I cannot find anywhere how can I do this. We could ofcourse launch a nwe bigger cluster but we would like to do this change online (without downtime)... is it possible?

Thanks!"
Amazon Elasticache	"Re: Node resize in an ElasticCache redis cluster
Hello,

at the moment is not possible to resize an Elasticache Redis cluster live, but I added you request to an existent feature request.

The only way is to launch a new cluster with a different instance size, if needed you can take a snapshot of your existent cluster and launch a new one starting from your snapshot but in any case it will require a (minimum) downtime.

Thanks,
Giorgio"
Amazon Elasticache	"My ElastiCache Cluster just died. I also can't reboot or create a new one.
Hello,

My Redis Cache Cluster machines died hours ago. All my webservers couldn't connect to the replication host. I tried to restart the servers but no luck, it stuck on ""rebooting cache cluster nodes"". After that I tried to create a new cluster and it's now stuck on ""creating"".

Please help me, the cache is critical to my application.

Thank you."
Amazon Elasticache	"Redis error logs
Hi,

Our redis cache drops cache at 1pm everyday. Where can we get the error to debug?

Thanks"
Amazon Elasticache	"Re: Redis error logs
Hello,

in order to investigate your issue can you give me the AWS Account Id and the name of your elasticache cluster?

Regards,
Giorgio"
Amazon Elasticache	"cant connect to a memecache node
Hi,
I have and instance on a vpc (10.0.0.188) , I create a memecache node on the same VPC
xxxxxx-magento.bsue8j.0001.use1.cache.amazonaws.com on 11211 (IP: 10.0.0.246)
but I can't connect or telnet or even ping this IP from my instance

do you have any idea ? 

thanks"
Amazon Elasticache	"Re: cant connect to a memecache node
Hi,
fixed , I opened 11211 port on the security group cache cluster used 

thanks"
Amazon Elasticache	"Statically link the libmemcached library into the PHP binary fails
I am trying to use the amazon elasticache client on CentOS 6.7 with php 5.5.

Using the pre compiled client throws a glibc error, so I'm attempting to compile it myself following the instructions at https://github.com/awslabs/aws-elasticache-cluster-client-memcached-for-php

I created a new EC2 instance and followed the instructions exactly and get the following error:

*** Warning: Linking the shared library memcached.la against the
*** static library /usr/lib/libmemcached.a is not portable!
libtool: link: cc -shared  -fPIC -DPIC  .libs/php_memcached.o fastlz/.libs/fastlz.o .libs/g_fmt.o .libs/php_memcached_session.o   -L/usr//lib /usr/lib/libmemcached.a -lcrypt -lpthread -lm -lstdc++ -lsasl2 -lz  -O2 -Wl,-rpath -Wl,/usr//lib   -Wl,-soname -Wl,memcached.so -o .libs/memcached.so
/usr/bin/ld: /usr/lib/libmemcached.a(libmemcached_libmemcached_la-auto.o): relocation R_X86_64_32 against `.rodata' can not be used when making a shared object; recompile with -fPIC
/usr/lib/libmemcached.a: could not read symbols: Bad value
collect2: error: ld returned 1 exit status
make: *** [memcached.la] Error 1"
Amazon Elasticache	"URGENT : Redis Memory became full frequently
Hi friends,

My Redis memory always become full and crash the application. The solution to bring the app back UP is by using flushdb. This is happening every 2 days. How can I automatically flushdb when Redis memory became full or is there any other way to solve this issue? 

Thank you."
Amazon Elasticache	"Connect to Redis Cluster from Peered VPC?
I have a corporate setup that primarily has 2 peered VPCs at the moment. We want to provision Elasticache (for Redis) so that 2 EC2 IIS Web Servers (one in each of the two VPCs) can connect to the same Elasticache cluster, is this possible? 

Currently I can successfully connect to the cluster from the EC2 instance that is in the same VPC that the Elasticache cluster was provisioned in, but the other EC2 instance in the peered VPC cannot connect.

I tried allowing all access through security groups, turned off firewalls, etc... but nothing works.

Any help you can provide would be greatly appreciated.

(I have cross posted this on SO: http://stackoverflow.com/questions/32240607/connecting-to-elasticache-redis-cluster-from-peered-vpc and will update should I find anything)

Edited by: markmacumber on Aug 27, 2015 4:42 PM"
Amazon Elasticache	"Re: Connect to Redis Cluster from Peered VPC?
Hello,
Can you give us more details here? You mentioned that you peered two VPCs. Are you able to connect between the instances in these VPCs using their private IP addresses? WIll you be able to share the instance from which you want to connect to your ElastiCache Cluster and also the details of your ElastiCache cluster?
Regards
Shiroy"
Amazon Elasticache	"Elasticache stuck in ""creating""
Good afternoon,

I have 4 elasticache clusters stuck in ""Creating"" for at least an hour. ""Delete"" is not available; how can I stop these clusters? 

Thanks in advance

William"
Amazon Elasticache	"Re: Elasticache stuck in ""creating""
William,

Thanks for the post and I am sorry to hear that you are having a problem creating ElastiCache clusters. I just reached out to you via e-mail for details, will work to resolve the issue.

Best,

Dan"
Amazon Elasticache	"Re: Elasticache stuck in ""creating""
hello,
im facing the same issue with elastic cache.The cache clusters are stuck in creating state for the past 2hours.

any help will be appreciated.

regards,
karthik"
Amazon Elasticache	"Re: Elasticache stuck in ""creating""
Hello Karthik,

How are you trying to launch the elasticache cluster? Are you trying to launch them directly via console/cli/api call or using cloud formation templates? Were you able to get rid of this issue? Do you need any further support on this?

Regards
Shiroy"
Amazon Elasticache	"Redis cluster failover
Is it possible for somebody from AWS to tell me the reason our Redis cluster (multiple AZ) failed over on September, 9th at 2:27PM CST? 

Thanks,

Andrew"
Amazon Elasticache	"ElastiCache Cluster Client for Java — tracked SpyMemcached version?
We recently switched to the ElastiCache Cluster Client (ECC) for our Java application. We deploy to Tomcat, and use Memcached Session Manager (MSM). Recent versions of MSM have upgraded the version of SpyMemcached the client that ECC is forked from.

There seem to be two versions of ECC that are the “latest”, depending on where you look. The download page and GitHub both have the 1.0.1 tag, and seem to date to the first half of 2013. Maven Central has a JAR tagged 1.0.61, dated to early 2014.

Which version of SpyMemcached does 1.0.61 track? Is there a plan to have ECC track upstream changes, with version correlation so that we can clearly match dependencies?"
Amazon Elasticache	"Re: ElastiCache Cluster Client for Java — tracked SpyMemcached version?
Hi,

We are looking for the same information. 

christian_eager wrote:Which version of SpyMemcached does 1.0.61 track? Is there a plan to have ECC track upstream changes, with version correlation so that we can clearly match dependencies?

Thanks in advance!"
Amazon Elasticache	"E-mail alert for Redis memory
Hi friends,

I am wondering if there is a way to alert via e-mail is Redis memory usage reached 90% or became full.

I was searching for this all over the web but couldn't find one.

Thank you."
Amazon Elasticache	"Elasticache is inaccessible from some nodes but not others in same ASG
We run Redis in Elasticache, the instance is located in us-east-1a.
We have ASGs with instances spread across all availability zones, instance types are r3.4xlarge and r3.8xlarge, all spot instances. What we observe is that most of our instances are able to connect to the redis cluster (telnet and netcat succeeds) while some cannot connect, telnet and netcat times out. These instances are all in us-east-1a, which makes it even more strange.

Since instances are in the same auto-scale group they have the same security group settings, instance profile, so I don't think it's permission related issue.

Did anyone experienced the same?"
Amazon Elasticache	"Re: Elasticache is inaccessible from some nodes but not others in same ASG
Hello akerekes,

Thanks for posting on AWS Forum.

I have just sent a private message asking additional details.

Regards,
Giorgio"
Amazon Elasticache	"Expected QPS and response time for memcached cluster
Hi,

I was wondering what number of  get/set-s per second should I expect a memcached based elasticache cluster to handle (per core), and what's the typical response time I should see for gets/sets? 

Thanks!"
Amazon Elasticache	"Add Nodes Disabled in elasticache
Hi - I created a elasticache cluster with redis. In the cluster settings ""Add Node"" option is disabled (so is delete and other options) and I am not able to add more than one nodes to the cluster. It shows that cluster has only 1 Node. 
How can i enable this option and add more nodes to cluster?
thanks"
Amazon Elasticache	"Re: Add Nodes Disabled in elasticache
Hello,

Thank you for posting on AWS Forum.

As per our documentation[1], at this time, ElastiCache supports single-node Redis clusters.
With a Redis ElastiCache cluster you can create a replication group. Replication group is a collection of nodes, with one primary read-write cluster and up to five secondary, read-only clusters. This solution is particularly indicated if your application need to provide a high volume of read operations.

Here[2] you can find additional information or replication group.

[1] http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheNode.Redis.html
[2] http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Replication.html

Regards,
Giorgio"
Amazon Elasticache	"Followed getting started guide, can't connect my EC2 to Redis ElasticCache
Hello everyone,

I've followed this getting started guide to the letter: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.html

My AWS account is set to EC2 only. I set my default security group to 6379 and 0.0.0.0/0.

Then on my EC2, I try to connect with redis-cli and I get this error:

Could not connect to Redis at xxxxx.nnlh1g.0001.use1.cache.amazonaws.com:6379: Connection timed out

I'm going to shut this server down since I can't pause it. Is there any way I can debug these connection issues?

Mark"
Amazon Elasticache	"Re: Followed getting started guide, can't connect my EC2 to Redis ElasticCache
Bumping the thread! Has anyone had success getting ElasticCache to work, at all? Seems like something is broken, either the documentation, or the service itself."
Amazon Elasticache	"How to access Tomcate URL outside EC2
I have successfully configured Tomcat 7 inside Ec2 but i am not able to access Tomcat URL from Outside Ec2. I tried to use ec2 public IP along with port 8080.But it was not accessible. Please let me know how access this Tomcat application outside Ec2."
Amazon Elasticache	"Re: How to access Tomcate URL outside EC2
Hi,
I have checked the AWS configuration of your instance (security groups, route tables, network ACLs) and everything looks good.
Could it simply be the binding is on the local IP only?

You can check this with netstat: if you don't find tomcat is listening on 0.0.0.0:8080 for example, but just YOURLOCALIP:8080 or 127.0.0.1:8080, then you won't be able to access it from an external location as the application itself won't accept the connection.

I hope this helps!"
Amazon Elasticache	"Re: How to access Tomcate URL outside EC2
Many Thanks for your reply..

Firstly, Please elaborate following line because i did not get your drift..

Could it simply be the binding is on the local IP only? 
Secondly

What do you mean by Local IP ?
1) Is it private ip of Ec2 Instance ?
2) Is it public ip of Ec2 Instance ?
3) Is it Local ip of my Local machine ?
What is that ?
Regards,
Deepak"
Amazon Elasticache	"Need help with accessing ElastiCache (Redis) Resources from Outside AWS
Hello,
I was following the description in this article: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Access.Outside.html
Everything went fine until ""step 4. Add an iptables rule to the NAT instance"".
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 11211 -j DNAT --to 10.0.1.230:11211

Since I'm using a redis replication group I don't have an ip address to enter here.
I just have the primary endpoint of the replication group with one master and some slaves (""cs-repgrp-prod.mfaizi.ng.0001.usw1.cache.amazonaws.com:6379"").
And since iptables is not able to do dns lookups I'm somehow in trouble and don't know what to do here.
This is really urgent because we need the replication group to be in its own VPC and reachable through a NAT instance (even using the HA NAT setup).
But, I don't know how to do the portforwarding in this case! Unfortunately, this is currently blocking the creation of our production stack.
So, any help would be much appreciated!"
Amazon Elasticache	"Re: Need help with accessing ElastiCache (Redis) Resources from Outside AWS
Hi tpstiller,

For getting the IP address of the Elasticache cluster, you can do a nslookup on the DNS name and use that IP in the iptables rule.

However, the document http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Access.Outside.html also talks about few considerations and limitations that should be kept in mind if you are following this approach. I recommend you to look out for the sections ""Considerations"" and ""Limitations"" in the above document.

Regards,
-Neel"
Amazon Elasticache	"How to access Elasic Cache node outside EC2
I have successfully  configured Elastic Cache(Redis) instance. It's accessible from EC2 rather it's not accessible outside EC2. kindly help me to know to access Elastic IP from Outside EC2 hence i can use in my application ."
Amazon Elasticache	"Re: How to access Elasic Cache node outside EC2
Hi. ElastiCache nodes are only accessible from within the AWS network i.e. from EC2 instances. They can't be directly accessed from the internet.

Workarounds include setting up a VPN to the VPC or setting up port forwarding to/from an EC2 instance. I hope this provides you with some options."
Amazon Elasticache	"Redis ElastiCache:NodeReplacementScheduled and data preservation
To whom this may concern,

I’ve researched a bit, but I’m still not sure our data is safe, so i just need confirmation;

We have 2 redis cache-clusters in the same replication group. One is a replica of the other. Amazon has sent us a mail saying 

ElastiCache:NodeReplacementScheduled : Cache Cluster ID: session-node, Node Id: 0001, Start Time:2015-08-2201:00:00.00, End Time: 2015-08-22 02:00:00.00

And another

ElastiCache:NodeReplacementScheduled : Cache Cluster ID: session, Node Id: 0001, Start Time:2015-08-2901:00:00.00, End Time: 2015-08-29 02:00:00.00 

So first the slave, and then a week later the master. Can we trust that you guys will circulate them around, and leave the same CNAMEs, so we don’t have to do anything? It’s our session store, so we would really really like the data not to get lost"
Amazon Elasticache	"Elasticache is PCI DSS??
Hi!

I have this doubt, Elasticache accomplishes PCI DSS?

Thanks for the answer."
Amazon Elasticache	"Re: Elasticache is PCI DSS??
Hi,
A full list of PCI DSS complaint services can be found here:

https://aws.amazon.com/compliance/pci-dss-level-1-faqs/

If you have any further query you can be contacted by an Amazon Web Services Business Representative by filling out this form:

https://aws.amazon.com/compliance/contact/

I hope this helps!"
Amazon Elasticache	"Re: Elasticache is PCI DSS??
Hi, 

Thanks for the answer; I saw that page before asking here, but i think that PCI DSS faq is not updated, because few weeks ago Cloudfront accomplish PCI DSS and this service doesn't appear.

Regards."
Amazon Elasticache	"Freeable Memory + Swap Issues
Hi there,

We've started seeing some strange behaviour with our primary Redis cache cluster in the past few days.

Fundamentally, the problem is that ""Freeable Memory"" is getting quite low, around 75MB. This hasn't happened before, and started a few days ago. And yesterday, we started to accumulate a bit of ""Swap Usage"", albeit a small amount at around 80KB.

I'd like to understand why this happening, and whether it is something we should worry about. I suspect it's just the OS soaking up cache due, but it could easily be something else.

Please find a link to our core graphs below showing the changing trends/numbers/issues,

http://imgur.com/a/TeF7f 

As you can see, the amount we're storing is on a steady increase. The spikes in reclaimed items happened when my colleague connected to the server using  redis-commander . No idea what the increase in network in (and out) was about, and it stopped the minute the box started swapping.

I feel a reboot may help, but we'd like to avoid this as although all data isn't critical, it'd be nice not to lose any.

Any ideas?

Thanks"
Amazon Elasticache	"Re: Freeable Memory + Swap Issues
Hi there,

I've taken a look at your graphs here and everything appears to be normal. Looking at your cache cluster, I do see the increase in the swap usage (~80 KB) and the amount of bytes used for cache. This usually signals that cache usage is slowly approaching its limits, although it doesn't necessarily mean that it's an issue. The more data you have, the more memory the system will need to run activities such as snapshot or replication. It's also needed to manage network connections. It does appear that you had an increase in inbound and outbound network connections right before freeable value decreased.

At this point, you're probably reaching a point where the available memory for data is starting to run out. A reboot isn't required here. That said, I would keep an eye on it. If freeable space doesn't come back up and swap continues to increase, I would look into setting reserved-memory to make sure that the underlying process and OS have enough memory to do their job:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html

Lastly, we've written a best practice guide that explains what memory usage looks like:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/BestPractices.html

I hope this is helpful!"
Amazon Elasticache	"Snapshot failed, instance restarted, data lost
We have a replicated redis set and it appears to have been failing to take snapshots for a few days.  Then about 20 minutes ago, the instance was restarted and we lost all data in the cache.  Is there a way to recover this data?  The replica doesn't have any old data at this time either.

Can you provide an explanation as to how this happened?"
Amazon Elasticache	"Re: Snapshot failed, instance restarted, data lost
Hello,
can you please provide us instance id so we can further investigate?

Thank you.
Regards,
Alessandro"
Amazon Elasticache	"Re: Snapshot failed, instance restarted, data lost
There is no instance id, this is elasticache, not ec2.

it is the only replication group on this account"
Amazon Elasticache	"Elasticache Cluster (redis) data lose and auto Snapshot failed
Hi AWS Support,

We have ElastiCache cluster and suddenly all data were lost on both nodes, would like to know what happened during this period as the events is not clear enough and is there any way to recover the data?, is there something wrong with failover because it should auto fail over ?
also the snapshot for the same date failed 

Cache events:
hoofit-prod cache-cluster Wed Aug 05 12:31:49 GMT+700 2015 Finished recovery for cache nodes 0001
hoofit-prod cache-cluster Wed Aug 05 12:30:19 GMT+700 2015 Snapshot failed for snapshot with ID 'automatic.hoofit-prod-2015-08-05-04-30' of cache cluster with ID 'hoofit-prod' 
hoofit-prod cache-cluster Wed Aug 05 12:30:18 GMT+700 2015 Could not start snapshotting within snapshot window for snapshot with ID 'automatic.hoofit-prod-2015-08-05-04-30' of cache cluster with ID 'hoofit-prod'
hoofit-prod cache-cluster Wed Aug 05 12:26:05 GMT+700 2015 Recovering cache nodes 0001

Cache Cluster ID: hoofit-prod  and Read replica ID: hoofit-prod-2

Thanks and waiting for reply

Edited by: bhegazy on Aug 5, 2015 5:38 AM
adding more information"
Amazon Elasticache	"PHP support for Elasticache dead?
I see very little activity with regards to the ElastiCache client support for PHP in this forum. There is no support for PHP 5.6 ElastiCache client whilst in the mean time active support for PHP 5.4 and PHP 5.5 has ended . 

Can someone within the Amazon ElastiCache team elaborate on this, are you dropping support for PHP? If not why is it taking so much time to release a PHP 5.6 supported client, let alone PHP7 that is down the road this year?

Maybe you should consider a solution that doesn't require a specialized/augmented client library and rather find a solution that works with the PHP standard libraries?

Apologies for being so critical but I find the current situation astounding from a support perspective and certainly not up to the professional standards I expect from Amazon.

Edited by: meint on Jul 23, 2015 12:19 PM

Edited by: meint on Jul 23, 2015 12:21 PM"
Amazon Elasticache	"Re: PHP support for Elasticache dead?
Agreed 110%. IMO, it would be better to abandon ElastiCache completely and instead manually manage the memcache servers yourself with the standard libmemcached extension in PHP 5.6 or 7.0 beta 2."
Amazon Elasticache	"Re: PHP support for Elasticache dead?
Hi guys,

I want to make sure you noticed that earlier today we launched the ElastiCache Memcached Auto Discovery Client for PHP 5.6 and also open sourced the code, it is now available on GitHub. You can find the announcement at: https://forums.aws.amazon.com/ann.jspa?annID=3179.

Thanks for the feedback, and please keep it coming. Our roadmap is heavily based on customer requests just like this one.

Best regards,
Dan"
Amazon Elasticache	"Re: PHP support for Elasticache dead?
Hi Dan,
That is great news, thank you for dispelling my fears so promptly and professionally. I just returned from my holiday and in the next couple of days I'm going to try out the new client.
Thanks again and kind regards
Meint"
Amazon Elasticache	"Re: PHP support for Elasticache dead?
As I sidenote, I found that the version for PHP 5.6 requires glibc 2.14. Red Hat Enterprise Linux 6.x ships with glibc 2.12 effectively requiring you to run RHEL 7. Is the glibc 2.14 dependency a real requirement or perhaps a byproduct of the platform on which the client was compiled? Otherwise you might want to consider compiling it statically to make it available for the folks on RHEL/CENTOS 6.x as well.
I'm going to give it a go with the source code on github, many thanks for opening that up!
Regards
Meint"
Amazon Elasticache	"Cache node null restarted
Hi,

I'm operating a 3 node ElastiCache (memcached) cluster, and noticed that yesterday one node appeared to spontaneously free up all of its memory. There was no notification email or indication otherwise that the node was reset or rebooted, but we have the single ElastiCache event in the console which simply says ""Cache node null restarted"". Since a node losing all its items clearly is not good for performance of our application, this is a bit concerning.

What does this message mean, and why might the node have been restarted?"
Amazon Elasticache	"Re: Cache node null restarted
Hello  Oliver,

I wasn't able to find any Elasticache resources in this AWS Account, can you please specify your cache cluster id / aws account used?

Regards,
Giorgio"
Amazon Elasticache	"Re: Cache node null restarted
Hi Giorgio,

I've PM'd you the cache cluster ID and account that the node is part of."
Amazon Elasticache	"Re: Cache node null restarted
Hi Oliver,

replied.

Giorgio"
Amazon Elasticache	"Deleted default VPC, things going downhill
Hi,

So I deleted my default VPC because I wanted to get Elasticache and EC2 instance into the same VPC, and the EC2 instance was in another VPC than the default.

Mistake.

Now when I'm creating an Elasticache cluster, I still see the old default VPC as an option (which is deleted) and no other VPC is listed. That won't work. 

There are no VPC Security Groups to select from either, as you can see in the image, the box is empty and there are no options when I focus into that box.

So basically I can't create an Elasticache instance, even though I have non-default VPCs. Is this a bug?

Thank you.

Edited by: Ilkka Huotari on Jul 29, 2015 3:15 AM"
Amazon Elasticache	"Re: Deleted default VPC, things going downhill
Seems that I had to create a Cache Subnet Group. The UI was a bit confusing."
Amazon Elasticache	"Can't connect to ElastiCache: Redis engine, EC2-Classic
Hi, I've created an ElastiCache cluster with a Redis engine, and launched it into EC2-Classic with a cache.m3.medium node type. The status is ""available"", and I have attached a Security Group that allows inbound TCP rules from the IP address of my EC2 instance on port 6379. (Should this rule specify the public or private IP address of the EC2 instance? I've used both). My cluster is in eu-west-1a, the EC2 instance in eu-west-1b (and is a Microsoft Windows Server 2008 SP2 64-bit)

I've been following the steps in the Getting Started guide at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.html. When I try to connect from redis-cli on my instance, like this:

redis-cli -h <cluster-endpoint>.euw1.cache.amazonaws.com -p 6379

I get this error:

Could not connect to Redis at <cluster-endpoint>.euw1.cache.amazonaws.com:6379: Unknown error

Can you let me know what I've missed?

Thanks,

Tony"
Amazon Elasticache	"Re: Can't connect to ElastiCache: Redis engine, EC2-Classic
Any suggestions for this? We're still experiencing the same issue. I've started from scratch with a new cluster, and have the same problem. It's probably a security group problem, but I can't see what I've done wrong as I've followed the guidelines at the links mentioned in the Getting Started guide. 

To summarise: create cluster in EC2-Classic, apply security group through ""Modify"" dialog, try to connect from EC2 instance. Get ""Unknown error"" response."
Amazon Elasticache	"Re: Can't connect to ElastiCache: Redis engine, EC2-Classic
For anyone else encountering this problem, the simple answer (thanks to a couple of weeks' to and fro with AWS Premium Support) is that you can't with EC2 Classic. Use VPC."
Amazon Elasticache	"Can't Select t2 instances for redis
I'm trying to create a redis ElastiCache cluster. I'm on the free usage tier and am hoping to keep costs to a minimum right now.

During the creation process I cannot set the node type to cache.t2.micro if using redis. If I change the cluster type to memcached I am able to select t2 instances. Is this a resource requirement related to redis or am I missing something?"
Amazon Elasticache	"Re: Can't Select t2 instances for redis
You can!
But without replication.

If you disable replication the t2.micro type will be avalible."
Amazon Elasticache	"Re: Can't Select t2 instances for redis
Hello,

User Luis Oliveira is correct, you need to disable the replication in order to select t2 instance type for Redis Elasticache.

Keep in mind that this instance type does not support also Redis Backup/Restore and the Redis AOF feature.

Regards,
Giorgio"
Amazon Elasticache	"How to change cache node type
Hi,
Currently I am using cache.t2.micro. How do I change the current node type to t2.small?

Thank You"
Amazon Elasticache	"Re: How to change cache node type
Hello,

It is not possible to change the instance type in Elastic Cache. 

If you are using memcached engine, you can add additional nodes to your cluster to increase the total cache size. If you want to use bigger instance type, you will have to launch a new cache cluster and make your application to start using it.

If you are redis engine, you can create snapshot of your elastic cache node and restore it to a bigger cache node and make your application to start using it. However, you mentioned that you are using a t2.micro cache node. Redis backup/restore is not supported for t2 instances. So in this case, you will have to launch a new cache node and start using that.

Regards
Shiroy"
Amazon Elasticache	"Redis SwapUsage and AWS' recommendation to ignore it
Could someone explain why AWS' recommendation is to not set a CloudWatch alarm on SwapUsage for Redis?  Is it truly ok to just ignore?


SwapUsage
This is a host-level metric.
Memcached: This metric should not exceed 50 MB. If it does, we recommend that you increase the ConnectionOverhead parameter value.
Redis: At this time, we have no recommendation for this parameter; you do not need to set a CloudWatch alarm for it.

Source: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.WhichShouldIMonitor.html"
Amazon Elasticache	"Plans on memcached version upgrades?
Twitter, Facebook, et all have been making strides improving memcached.  

1.4.14 is now nearly 3 years old, and the current version is 1.4.24

https://code.google.com/p/memcached/wiki/ReleaseNotes

What are the current thoughts in supporting newer versions, especially 1.4.18+ with the LRU crawler?"
Amazon Elasticache	"Re: Plans on memcached version upgrades?
Hello,

Thank you for your feedback, I have just forwarded it to our Service Team.

Regards,
Giorgio"
Amazon Elasticache	"redis cache cluster stuck in creating state
I have a redis elasticache cluster that has been stuck in the 'creating' state for more than an hour.  It was part of a nested cloudformation stack that was cancelled while in progress.  Now the entire stack -- parent and several of the nested children -- are stuck in 'delete failed'.

I've found several older threads here with similar problem, all resolved either 'magically' by support or by themselves after up to several hours.

Any suggestions for how to force the deletion?

Thanks
Nik"
Amazon Elasticache	"Re: redis cache cluster stuck in creating state
Hello Nik,

I understand that this forum post was opened some time back. However I did a quick look on your cloud formation stacks and could not find any stacks which is in state delete failed. So I assume that the issue that you were facing is already resolved/addressed. If you need any further help with this regard, do let us know.

Regards
Shiroy"
Amazon Elasticache	"Error Could not connect to Redis at  cache.amazonaws.com from EC2
I have an EC2 which cannot connect to ElasticCache end point with Error:
Could not connect to Redis at lnl-redis-cluster.i2oix4.0001.use1.cache.amazonaws.com:6379: Connection timed out when using the redis cli.

I have followed the instructions here:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/GettingStarted.html

I see this:
Supported Platforms

    EC2
    VPC

Which indicates it's ""classic mode"" but I cannot find/create a security group common to both ElasticCache and EC2.  All the security groups show up in the Security Groups tab, but the only ones without a VPC are visible to ElasticCache and the only ones the EC2 can pick from in 'change security group' are the ones with a VPC id.

The EC2 is a micro instance  i-381826c5 with Ubuntu  which says it's a VPC, or at leat it has a VPC ID vpc-29239a4c and the security group says it default

Which I have configured the VPC's security group this Redis Node is in to allow the connections:

Type | Protocol | Port Range| Source
Custom TCP Rule | TCP (6) | 6379 | 0.0.0.0/0

I cannot fully tell if the EC2 is in a VPC or not.   I cannot find a security group that both EC2 and the Elasticache can both access, Elasticache only sees those not in a VPC and will not enable me to select a VPC as 

""Cache Subnet Group"" is disabled See http://screencast.com/t/Ozl3PrMPPD

yet,  in the EC2 console. Action > ClassicLink -> link to VPC and unlinke from VPC are disabled which seems to mean it's not a part of a VPC or eligible to join one.

Edited by: lnltroyg on Jun 10, 2015 12:17 AM"
Amazon Elasticache	"Re: Error Could not connect to Redis at  cache.amazonaws.com from EC2
Hello,

I see that your instance i-381826c5 is not online. I understand that this post was opened some time back. But wanted to check if you were able to connect to your elastic cache node successfully.

Do you need any support with this regard?

Regards
Shiroy"
Amazon Elasticache	"Redis suddenly down and recover
Hi,

Today, my application (run on Elastic Beanstalk) send me many exception because it cannot connect to Redis - which is on Elasticache. There are 2 error message typs:

A Redis::CannotConnectError occurred in boards#index:

 Timed out connecting to Redis on xxxxxxxxxxx.xxxxxx.0001.apse1.cache.amazonaws.com:6379
 redis (3.1.0) lib/redis/client.rb:307:in `rescue in establish_connection'
An Errno::EHOSTUNREACH occurred in boards#show:

 No route to host - connect(2)
 redis (3.1.0) lib/redis/connection/ruby.rb:129:in `connect_nonblock'


I have checked Elasticache events on AWS console and see an event: ""Recovering cache nodes 0001"". After 11 mins, there is new event ""Finished recovery for cache nodes 0001"" and my application works well from there.

So, can you (AWS Supporter?) tell me:


What is the problem with my Redis? 
How frequently can this happen? 
How to prevent this?


Please let me know if you need any additional information.

Thank you,
Nam

Edited by: namtv on Jun 18, 2015 8:17 PM"
Amazon Elasticache	"Re: Redis suddenly down and recover
Hello Nam,

I did take a look at your Elastic Cache node and it appears there was a maintenance activity on your Elastic Cache node during that time period. The maintenance activity was carried out during the specified weekly maintenance period.

For more information about maintenance window and how to change it, please read the section ""What is a maintenance window? Will my Cache Nodes be available during software maintenance?"" in the URL : http://aws.amazon.com/elasticache/faqs/

Regards
Shiroy"
Amazon Elasticache	"Re: Redis suddenly down and recover
Hi Shiroy,

Thank you for your information. So, how can I keep Redis 100% uptime? I thought about 2 nodes in a cluster with different Maintenance Window but it seem to be impossible because I can only set Maintenance Window for whole cluster, not for each node (and actually, adding nodes is not available for redis now). Any idea?

Thanks,
Nam"
Amazon Elasticache	"Memcached - a rotating, uneven Network Bytes Out
We have seen a rotating imbalance of Network Bytes Out favoring a single node at a time as you can see in this screenshot: http://gyazo.com/ec116a062133ca37dea73bc13eb602f5.  We also see an imbalance in Get Commands: http://gyazo.com/ce9bc222ffacca26fbad393438c16867.  This same imbalance can be seen from within the servers making calls to Elasticache within AWS - traffic coming from one node is drastically higher than the rest.  We are using Enyim to connect to Elasticache using the KetamaNodeLocator and TigerHashKeyTransformer.  

What could cause this imbalance?  We would suspect our keys are favoring certain nodes over others except the favored node changes over time, and also we are using ketama to consistently hash."
Amazon Elasticache	"An error occurred (Throttling) when calling the DescribeReplicationGroups
A client error (Throttling) occurred when calling the DescribeReplicationGroups operation: Rate exceeded

When I try to go to my cache clusters/replication groups in the console, or via cli, or via boto, I keep getting rate exceeded.  Even if I make one request, it keeps saying I am being throttled.  Why is it being throttled when I'm not making requests right now?

Edited by: mrnickt on Jun 23, 2015 7:57 PM"
Amazon Elasticache	"How to connect Redis Cluster Cache Node using java client?
Hi,

Is there a way to connect to the Redis Cache Cluster Node by providing the Node endpoint?
Which library should I use for this?

Also, which API should I use to store and retrieve contents from the Cache?

Thanks,
Arul

Edited by: arul on Jun 16, 2015 8:53 AM

Edited by: arul on Jun 16, 2015 9:55 AM

Edited by: arul on Jun 16, 2015 1:56 PM"
Amazon Elasticache	"Your ElastiCache Instance is Scheduled for Reboot - No indication as to why
I received 2 emails saying a reboot has been scheduled.  It does not say why.  I am not seeing any scheduled maintenance or notifications in the console.  The reboots are a week apart on a Sunday, but not doing my scheduled maintenance window.  Any one know why?  Or where I can find out what is scheduled?

Thanks

ElastiCache:NodeRestartScheduled : redis-backup-01, Node Id: 0001, Start Time: 2015-06-21 00:00:00.00, End Time: 2015-06-21 01:00:00.00"
Amazon Elasticache	"Re: Your ElastiCache Instance is Scheduled for Reboot - No indication as to why
Hi ryjaetmaer,
Can you please verify your current maintenance window and confirm that the maintenance is scheduled to be outside of that time frame? Maintenance should be scheduled in your maintenance window, unless it was specifically communicated otherwise. 
Thanks,
Dan"
Amazon Elasticache	"Redis replica GET very slow
I created Cache Clusters Redis with 1 Primary Node and 1 Read Replica Node. Node type is cache.r3.large. The benchmark to  Primary Node the result is very well, but The Read Replica Node is very slow.

Before reboot:
Before reboot:
root@bbbbbbbbbb redis# src/redis-benchmark -h <Read Replica Node> -c 10 -n 100000 -q
PING_INLINE: 183.09 requests per second
PING_BULK: 195.91 requests per second
SET: 186.89 requests per second
GET: 801.84 requests per second
INCR: 4952.46 requests per second
LPUSH: 4934.62 requests per second
LPOP: 4970.43 requests per second
SADD: 4956.38 requests per second
SPOP: 4842.62 requests per second
LPUSH (needed to benchmark LRANGE): 4920.53 requests per second
LRANGE_100 (first 100 elements): 4593.69 requests per second
LRANGE_300 (first 300 elements): 4171.88 requests per second
LRANGE_500 (first 450 elements): 4071.00 requests per second
LRANGE_600 (first 600 elements): 3933.14 requests per second
MSET (10 keys): 4905.09 requests per second

After Reboot:
root@prod-atv-batch redis# src/redis-benchmark -h prod-atv-redis-002.ykyj7i.0001.apne1.cache.amazonaws.com -c 10 -n 100000 -q
PING_INLINE: 4952.46 requests per second
PING_BULK: 4864.29 requests per second
SET: 4944.13 requests per second
GET: 4944.13 requests per second
INCR: 4941.93 requests per second
LPUSH: 4942.67 requests per second
LPOP: 4907.01 requests per second
SADD: 4949.03 requests per second
SPOP: 4972.90 requests per second
LPUSH (needed to benchmark LRANGE): 4957.37 requests per second
LRANGE_100 (first 100 elements): 4850.13 requests per second
LRANGE_300 (first 300 elements): 4351.80 requests per second
LRANGE_500 (first 450 elements): 4238.37 requests per second
LRANGE_600 (first 600 elements): 4095.00 requests per second
MSET (10 keys): 4926.59 requests per second

Please tell me how to slove it.
Thanks

Edited by: ngocduy2711 on Jun 10, 2015 3:02 AM

Edited by: ngocduy2711 on Jun 10, 2015 3:03 AM

Edited by: ngocduy2711 on Jun 10, 2015 7:15 PM

Edited by: ngocduy2711 on Jun 10, 2015 7:51 PM

Edited by: ngocduy2711 on Jun 10, 2015 8:21 PM"
Amazon Elasticache	"t2.micro unavailable in us-east-1
It would appear as though I cannot start an on-demand t2.micro cache node in us-east-1.  The console is letting me buy a t2.micro reservation, however.  Is there a reason I would be unable to buy a t2.micro on-demand cache node?  And just to make sure, if I buy the reservation, I will be able to start a t2.micro cache node?"
Amazon Elasticache	"Re: t2.micro unavailable in us-east-1
Hi,

I are you having issues launching issues from the AWS EC2 console or buying Reserved instances?

I'm not sure what you mean by cache nodes. What are the exact steps you are taking and what errors do you get?

Thanks,
Julian H."
Amazon Elasticache	"Re: t2.micro unavailable in us-east-1
When I try to start a new cache cluster I don't see a t2.micro in the node type list.

When I try to purchase a reserved cache node, I do see t2.micro in the cache node type list

If I purchase that reserved cache node, will I be able to launch the node?

Is there a reason I cannot launch a t2.micro cache cluster?"
Amazon Elasticache	"Getting Started Guide detail
In the ""Getting Started Guide"", the following sentence can be found under ""Where Do I Go from Here?""

""Amazon ElastiCache is a rich service offering many things we haven't covered in this guide, such as controlling automatic backup and maintenance schedules, security features, and more.""

Looks like this was copied from the RDS guide."
Amazon Elasticache	"Re: Getting Started Guide detail
This is now fixed. Thanks for bringing it to our attention!"
Amazon Elasticache	"Re: Getting Started Guide detail
The link to the getting started guide appears to be broken on this page:
http://aws.amazon.com/elasticache/getting-started/

The link takes you to http://docs.aws.amazon.com/AmazonElastiCache/latest/GettingStartedGuide/ which 404s.

Thanks!"
Amazon Elasticache	"Re: Getting Started Guide detail
Will be fixed shortly. Thanks for letting us know!"
Amazon Elasticache	"Increase in HTTP:408
I enabled ELB on one site. So far have 1 instance but the ELB keeps ""cashing"" saying the instance is bad. But the instance is fine. 

The access_log has a high number of ... 

10.170.59.15 - - 28/May/2015:05:59:41 +0100 ""GET / HTTP/1.1"" 200 10383 ""-"" ""ELB-HealthChecker/1.0""                                                                      
10.153.145.44 - - 28/May/2015:05:59:46 +0100 ""-"" 408 0 ""-"" ""-""                     
10.170.59.15 - - 28/May/2015:05:59:56 +0100 ""-"" 408 0 ""-"" ""-""          

I've changed the ELB health check to use a static html file."
Amazon Elasticache	"Re: Increase in HTTP:408
https://forums.aws.amazon.com/message.jspa?messageID=307851 yay Google."
Amazon Elasticache	"How to download redis logs
I can't seem to find anywhere to download redis command logs for an elasticache instance, am I missing something?"
Amazon Elasticache	"Possible to rename a cluster?
I have a cluster with a very specific name that I’d like to make more general. Is it possible to rename it?"
Amazon Elasticache	"Re: Possible to rename a cluster?
Hello, 

There isn't any direct method to rename an ElastiCache cluster. I can think of two alternative solutions though to achieve the same result of changing the 'name' though:

1. Create an identical cluster with the shorter name you desire, then when it's convenient for you, you can switch over your applications to use the new ElastiCache cluster and then delete the old one once it's no longer in use. 
2. Use Route53 or any other DNS service to create a CNAME to forward to your ElastiCache cluster. So as an example you could create a CNAME entry for 'elasticache.example.com' to resolve to your Elasticache CNAME so you'd have a shorter CNAME to resolve. 

Let us know if you have any additional questions or concerns. 

Regards,
Nick"
Amazon Elasticache	"Cannot create a new Replication Group
Hey folks,

I'm stuck in Amazon ElastiCache. I did have a bundle-production cache cluster with Redis nodes. Until we received timeout errors from our application on Saturday. So, I switched our production API to use bundle-staging instead as cache cluster (which didn't throw timeout errors). I have deleted bundle-production as replication group and wanted to build it up from the ground again. But it seems I cannot create a new replication group anymore. Am I doing something wrong? Could appreciate some help.

I have attached the corresponding error from the dashboard."
Amazon Elasticache	"memcached large_memory_pages - what does it do?
There is no documentation around the parameter 'large_memory_pages' for memcached.

What does it do?"
Amazon Elasticache	"Re: memcached large_memory_pages - what does it do?
Hi,

I can't seem to find much either, however the below link tells you what it means if set to true (1)

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Memcached.html

If 1 (true), ElastiCache will try to use large memory pages.

Cheers,

Stooby..."
Amazon Elasticache	"Re: memcached large_memory_pages - what does it do?
Yes, though that doesn't really say anything other than rewording the key name."
Amazon Elasticache	"Re: memcached large_memory_pages - what does it do?
Is it related to:

https://dev.mysql.com/doc/refman/5.0/en/ha-memcached-using-memory.html

""If your operating system supports it, you can also start memcached with the -L command line option. This option preallocates all the memory during startup using large memory pages. This can improve performance by reducing the number of misses in the CPU memory cache."""
Amazon Elasticache	"Is memory size listed for an instance type the allocated cache size?
For example, cache.t2.micro is listed as having memory of 0.555 GB. Where as an equivalent EC2 t2.micro has 1 GB of memory.

What is this discrepancy? Is the memory listed on a Elasticache instance (http://aws.amazon.com/elasticache/pricing/) the estimated size of memory available for the cache? (Redis in my case)

If it is, something seems off, as I have a cache.t2.micro Redis node that is completely empty but there is only 70MB of Freeable Memory on the node, a far cry from the listed 0.555 GB.

Can someone shed some light on this?"
Amazon Elasticache	"Redis: unexpected connected clients and commands processed?
Hi there, new to Elasticache. My redis instance has more connected clients and commands processed that I think it should have. The only client that I am connecting is a single node instance, but the INFO command shows about 1-2 commands are being issued per second to 5 clients. The cache is non-replicated.

Does AWS connect to the cache and issue commands, or is something going wrong here?"
Amazon Elasticache	"Can't telnet to elasticache node, even with authorized security group
Hi, I'm trying to telnet to an elasticache node:

telnet ***.cache.amazonaws.com 11211

It simply doesn't work. Times out every time. I've already authorized the security group for the ec2 instance that is making the connection (yes, it reads ""authorized"" in the list) but still nothing, even after rebooting the cluster.
I can ping the node just fine.

Any ideas on what might be wrong?"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Could someone at Amazon please look into this.
I've been trying ever since the first post to get it to work with no success. It's a very simple test. I set up a one node cluster, authorize the security group for one of my ec2 instances and, from that instance, after the security group is authorized, I telnet to the node on port 11211. I get a timeout every time although I can ping the address.
I tried rebooting the cluster, creating a new cluster, and I even tried authorizing all of my security groups at the same time with no success.
I checked and double-checked everything from the telnet command line to every security group so I'm pretty sure this is a real issue and not just something I'm doing wrong."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
We're sorry you are running into this issue - we are looking into it and will contact you when we have more information."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Great! Thanks! Tell me if you need any more info or need me to do any tests."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
dsouza42: We've requested some additional information in a Private Message - please review and reply to that message so we can determine next steps. Thank you."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
I am having the same issues. I double checked, and the ec instance and node are in the same zone. But telnet times out. Security group is authorized. I even open up the security group from just the 11211 port to the entire TCP range. And still timeout on telnet. Any solutions on this?"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
OK, call me when its working. 
I created 1 node small caches in east availably zones a,b,d (c does not support small caches yet). I created a 1 rule security group. And I opened it wide up. All IP address, all TCP ports. (don't try this on a production system). 0.0.0.0/0 TCP: 0 - 65535

SSH into one of my servers in the zone, and was able to ping, but could not telnet. I even created one of the caches with an alternate port for memcache (11212) instead of the default. Still nothing. Cloudwatch also shows nothing. 

Going back to my internal memcache setup...

This is not working. I really wish it was. The dashboard is showing that this service is up running normally. Apparently it is not. Try for yourself, and let me know if you get same results. From the post on the forum, somebody has it working, but others are experiencing what I am.

BTW, love AWS using it for 4 years now.

Thanks."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
franklinmayfield: Have you tried accessing your ElastiCache Node from an EC2 instance that is launched with the same EC2 security group as the one used for authorizing access to the corresponding Cache Cluster?
For example, if the EC2 security group that you authorized your Cache Cluster for access is “app-memcache”, the EC2 Instance from which you are accessing your Cache Nodes, should have been launched with the same security group “app-memcache”."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Yes, my security groups were created before I launched any of the 5 clusters that I tried to get this to work with. I progressively loosened security as I was testing. Ending with it wide open. Changes made during or before a cache node was launched made no difference. My last test I had it opened up (security group), launched cache, did my telnet tests. And got nowhere. Thank you for addressing this. I would hope, that it was something simple missing in the docs, my setup or between my ears. But so far, it appears outside my walls.

Thanks again."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Just did another test and I'm happy to report that it started working now!

Will do more tests and report back if the problem returns.

Thank you, Amazon support!"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Frank: Just want to make sure I understand your update. We have two different Security Groups here. One is the EC2 Security Group and the other is the Cache Security Group. Looks like you linked one of your EC2 Security Groups to a Cache Security Group. But what we want to understand is if that EC2 Security Group is associated to the EC2 Instance from which you are accessing the Cache Nodes. 

The easiest way to check the security group settings for your EC2 instances is to visit the EC2 Instances screen on the Amazon EC2 tab of the AWS Management Console and check that the ""Security Group"" column has the same EC2 security group you linked to the Cache Security Group.

Looks like you are relaxing the EC2 security group definitions. Doing so just makes more clients from the internet access your EC2 instances, but does not do anything to make your Cache Nodes accessible from your EC2 Instances. 

Thanks,
Pavan"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
The issue is back. Just about half an hour ago it was working fine."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
OK this may be a documentation issue. Let me see if I got this right. Here is what I did, and here is what I understand you are saying.

What I did. 

Create a new, unconnected EC2 Security Group > Added my EC servers: port 11211 > Copied the name > Created a Cache Security Group > Paste Security Group Name, my account ID Save/Assign.

My thinking is the firewall around the cache system would then allow my servers and ports to access the system.

If I understand you, you are saying. 

Look at my existing EC2 Security Groups, that are already assigned to the servers > Copy name > Created a Cache Security Group > Paste Security Group Name, my account ID Save/Assign.

Would I not have to add the 11211 port (example only) and the specific cache server IP address to allow access to my servers. (Inbound rules). Which is not defined at startup, but will have to be added after the nodes are generated. And since the node provide a name, and not IP, I have to resolve that first to enter into the rule. So editing the rules post creation of the nodes.

Future upgrade suggestion. Make it work the same way the RDS Rules work. Unless this is a future trend, this is one of 5 different ways that ACL/Firewalls can be done, it is not simplifying the process of managing security."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
""Look at my existing EC2 Security Groups, that are already assigned to the servers > Copy name > Created a Cache Security Group > Paste Security Group Name, my account ID Save/Assign.""

This is correct.

""Would I not have to add the 11211 port (example only) and the specific cache server IP address to allow access to my servers. (Inbound rules). Which is not defined at startup, but will have to be added after the nodes are generated. And since the node provide a name, and not IP, I have to resolve that first to enter into the rule. So editing the rules post creation of the nodes.""

I think you are referring to configuring the Memcached client libraries so that they are aware of the key space and the server addresses. This step needs to be done so that your application can talk to the right Cache Nodes to get or put key/values. However, this step is not necessary for the telnet test you are trying to work out.

""Future upgrade suggestion. Make it work the same way the RDS Rules work. Unless this is a future trend, this is one of 5 different ways that ACL/Firewalls can be done, it is not simplifying the process of managing security.""

Amazon RDS DB Security Groups work in exactly the same manner as Cache Security Groups. That said, we will work towards making the documentation more informative.

Thanks,
Pavan"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
OK, that worked. So the logic is the cache security groups makes an invisible (to me) firewall entry for the devices that share that ec2 security group. So I do not need to worry about securing it myself. Nothing but my servers can connect based upon the use of the ec2 group. Is that correct?

I did set an EC2 rule for the nodes for the memcache port. Is it necessary? I firewall out access to my existing memcache setups normally, and not securing it from on both sides just seems strange.

Thank you. I will continue my testing ahead of moving production servers under this service. I have great hopes for it. Thank you for your help and patience.

Franklin

Edited by: franklinmayfield on Aug 29, 2011 8:01 PM"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Still having the same issues. Yesterday it worked for a brief period but the issue came back soon after."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Finally found out what´s going on!

What happens is that all my instances register with my own DNS server and also do resolution on my own DNS exclusively so the instances can find each other with the names I give them.

What happens is that for some reason my DNS server is resolving all elasticache nodes with their respective external IPs. So it seems that the nodes only allow connections through Amazon´s internal network even if the connecting IPs are from EC2 instances with the appropriate security groups.

So ***.cache.amazonaws.com should resolve to 10.x.x.x and not 204.x.x.x.
All I have to do is fix my DNS resolution for the elasticache nodes.

Many thanks to the Amazon AWS team that spent a lot of time and effort trying to help me solve it!

Edited by: dsouza42 on Sep 2, 2011 12:23 AM"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Just want to say thanks for asking the question and then posting your solution. I had exactly the same problem and this solved it!"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Hi,

You said that sometimes you were able to connect using your own DNS servers - do that mean that periodically elasticache is accessible externally?

Maybe it periodically worked for you because you had both Amazon and your own DNS configured, so your instance was round-robin DNS between Amazon and your own DNS, causing intermittent connectivity?

Would like to clarify because it would be major security concern if elasticache becomes available publicly due to transient conditions in EC2 network.

Thanks"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Yes, Somehow it is missing in the documentation.
You can connect to elasticache only form AWS instance that its security group has defined in the Cache Security Group.
Seems strange that it is not written in bolt in AWS documentation,
I am a fan of AWS too, but their documentation is amateur and premature.here"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
So ***.cache.amazonaws.com should resolve to 10.x.x.x and not 204.x.x.x.
All I have to do is fix my DNS resolution for the elasticache nodes.

How is this done exactly?"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
I'm facing similar issues.

This is my setup:
-EC2 instance in us-east-1a in security group ""Ubuntu""
-EC2 security group ""Ubuntu"" has port 11211 open to itself
-ElastiCache security group ""memcachegroup"" and ElastiCache cluster using it
-Cache security group ""memcachegroup"" has EC2 security group added to it

On the ec2 instance, when I go to telnet to ElastiCache, it resolves to what looks like a public IP, then times out.

Anyone know how to force the ec2 instance to resolve to the internal IP, rather than public IP for the cache cluster? Running ubuntu."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
Have the same problem.
1. ""Instance1"" belongs to security group - ""security_group""
2. Default cache security group has authorized to ""security_group""
3. Trying to access ElastiCache from ""Instance1"" via telnet and got error ""Connecting To ****.cache.amazonaws.com...Could not open connection to the host, on port 11211: Connect failed""

How to fix that issue?(some instruction will be appreciate)."
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
It looks like there are several possible problems, here: 

Possible Problem #1: 
"" You can connect to elasticache only form AWS instance that its security group has defined in the Cache Security Group."" This seems to be the problem for most people visiting this page. To see whether you have this problem, just check whether you have a Cache security group. 
Solution: 
https://forums.aws.amazon.com/post!reply.jspa?messageID=395395

Possible Problem #2: 
""...my instances register with my own DNS server and also do resolution on my own DNS exclusively so the instances can find each other with the names I give them."" One can test whether this is the problem with a few simple ping requests. 
Solution: 
https://forums.aws.amazon.com/post!reply.jspa?messageID=275569




Nathan Basanese / 37coins




Edited by: NathanBasanese on Jun 3, 2014 3:18 PM

Edited by: NathanBasanese on Jun 3, 2014 3:18 PM"
Amazon Elasticache	"Re: Can't telnet to elasticache node, even with authorized security group
delete

Edited by: richardpaws on Oct 17, 2014 8:34 AM"
Amazon Elasticache	"Managed ElastiCache and Hbase EMR
Hello everyone,

I'm building a system using ElastiCache and Hbase EMR and I'm wondering whether they are fully managed by AWS. What i mean is that there is no planned downtime, guaranteed auto-failover, and data replication in the case of node failure. 

thanks

km"
Amazon Elasticache	"Best way to connect private VPC instance to elastiCache in Ec2-Classic
I'm having trouble connecting an ec2 instance running in a private VPC (created late 2014) to an ElastiCache (memcached) singe-node cluster that was created in a Classic-Ec2 VPC (created in 2013). 

I thought that my ec2 instance would go through my NAT instance, and hit the public IP of the memcached endpoint. However, this is not working. (telnet endpoint-7qwen1.0001.usw1.cache.amazonaws.com 11211 fails). I've checked the security group settings of the existing memcached cluster, though I may be missing something. The Security-Group associated with my memcached cluster includes a rule to allow Inbound access from the NAT instance's public IP access to port 11211. 

What is the recommended technique to connect my new stack (private VPC) to the old, existing stack (Classic-Ec2 VPC)? Is there something else that I'm missing?"
Amazon Elasticache	"Re: Best way to connect private VPC instance to elastiCache in Ec2-Classic
Hello FlywheelNetworksDevOps ,

""Amazon EC2 instances running in an Amazon VPC are unable to connect to ElastiCache cache clusters in EC2-Classic."" http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingSecurityGroups.html

I'm sorry but the only way forward is to create a new instance to EC2 Classic or create a new ElastiCache Cluster in VPC.  http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.html

I hope this clears things up for you.

Kind Regards,
Anthony H."
Amazon Elasticache	"ElasiCache  - Cache Subnet Group only listing default VPC
Hello,

I'm trying to setup and configure ElastiCache Redis on a custom VPC, however both my cloudformation template and the wizard in the portal only list the default VPC subnet in the drop down box.

Are there any dependencies to get ElasiCache up and running on another VPC other than the default?

I've attached a screen shot of the Cache Subnet Group dropdown box.

Marcus"
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,

Are you setting this up within the same region as your VPC, or is it a different region? 

Cheers,

Stooby..."
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,

Same region - eu-west-1 (Ireland).

Marcus"
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,

Is your VPC set up with Dedicated Tenancy? If so, then Elasticache will not work in your VPC.

See link below that identifies when you can use Elasticache in a VPC:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.html

Hope this helps,

Cheers,

Stooby..."
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,

No we're not using Dedicated Tenancy on any of our VPC's.

Marcus"
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Following on from my previous comment, you can check your tenancy within the VPC services within the AWS console.  Select your VPC and look under the ""tenancy"" column to see if its 'dedicated' or 'default'.  It needs to be 'default' for elasticache to work

Cheers,

Stooby"
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,

Our VPC's are set to 'Default' for Tenancy.

Marcus"
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,

Have you been through all the information on the link I sent earlier to confirm that your setup does not meet any of this criteria stated which would ultimately create your elasticache cluster in your default vpc?

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.html

Stooby..."
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,
Yeah been through the documentation and our setup should be fine.

Marcus"
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
I found the issue, there wasnt a Cache Subnet Group assigned to any of the VPC's.  Creating one allows me to create the ElastiCache against any VPC."
Amazon Elasticache	"Re: ElasiCache  - Cache Subnet Group only listing default VPC
Hi,

Glad its sorted, however this was one of the items to check in the previous link I sent you?

Cheers,

Stooby..."
Amazon Elasticache	"EC2 Security Group isn't listed in Cache Security Group editor
I've got an Elasticache node, and an EC2 instance, both in the same VPC. If I understand it correctly, the final step in connecting the two is to add the EC2 Security Group to the Cache Security Group, which is essentially a whitelist of security groups that can access the Elasticache node. 

When I go to Amazon ElastiCache -> Cache Security Groups, and check the box for my only Cache Security Group, there are two EC2 Security Groups listed, but not the one for my EC2 instance that's in this VPC. 

How do I get my EC2 Security Group to show up in the Cache Security Group editor?

thanks in advance..."
Amazon Elasticache	"Cannot Create a Cache Subnet Group
after the installation, which i did exactly the same of 

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/StartCLI.html

and after all, i cannot create a cache subnet group

likewise in the following instruction

http://docs.aws.amazon.com/AmazonElastiCache/latest/CommandLineReference/CLIReference-cmd-CreateCacheSubnetGroup.html

Amenes-MacBook-Pro:~ Bluelysium$ elasticache-create-cache-subnet-group --cache-subnet-group-name mycachesubnetgroup --description ""Created by John Smith"" --subnet-ID-list subnet-85596dee
elasticache-create-cache-subnet-group:  Malformed input-Some input subnets in :subnet-85596dee are invalid.
Usage:
elasticache-create-cache-subnet-group
        CacheSubnetGroupName  --description  value  --subnet-ID-list 
       valuehttp://,value... General Options
For more information and a full list of options, run ""elasticache-create-cache-subnet-group --help""

i have java version 1.6.0_45, mac osx10.8.4"
Amazon Elasticache	"Re: Cannot Create a Cache Subnet Group
Hello sudokux ,

From the error you are seeing :
Malformed input-Some input subnets in :subnet-85596dee are invalid.
Usage.

Please make sure that all input subnet IDs must be in same VPC.

Please refer to the document below :

http://docs.aws.amazon.com/AmazonElastiCache/latest/CommandLineReference/CLIReference-cmd-CreateCacheSubnetGroup.html

Regards,

Baseer M."
Amazon Elasticache	"Re: Cannot Create a Cache Subnet Group
Can a single subnet id not be in the same VPC?

Sorry, by that I mean since only one subnet id is specified how can the list contain subnet ids from more than one VPC?

Edited by: pugpig on Mar 23, 2015 9:49 AM"
Amazon Elasticache	"Re: Cannot Create a Cache Subnet Group
I think the problem is more likely to be a misreporting of the group not meeting the coverage requirement as one sees this when trying with a browser:

DB Subnet Group doesn't meet availability zone coverage requirement. Please add subnets to cover at least 2 availability zones. Current coverage: 1 (Service: AmazonRDS; Status Code: 400; Error Code: DBSubnetGroupDoesNotCoverEnoughAZs; Request ID: 4f5ed667-d17d-11e4-8e27-afb47ae63577)"
Amazon Elasticache	"Unable to delete elastic cache cluster
The cache cluster is in deleting state for about an hour and the status is not changing. I use cloudformation stack to build this and the stack is not deleting because the elastic cache is not getting deleted.

Is there a way to force delete the cache cluster? The nodes are removed, but the cache cluster is sitting preventing me from deleting the network interfaces, the vpc, etc.

Thanks."
Amazon Elasticache	"Re: Unable to delete elastic cache cluster
Hello,
I checked  all regions on your account but I was unable to find any clusters. Can you please confirm if you are still seeing this issue and provide me with the region and with cluster ID?

Best Regards,
-Dimos C."
Amazon Elasticache	"Re: Unable to delete elastic cache cluster
This issue is not happening..Thanks!"
Amazon Elasticache	"Elasticache Redis Instance appeared to simply stop functioning
Our elasticache redis cache appeared to simply stop working for about 15 minutes earlier today. The portions of our stack that use it didn't record any errors connecting to redis, but it seems as though the server just sort of stopped/slowed dramatically based on the usage graphs (attached).

Is there any way to get some insight/logging from the redis instance in elasticache?"
Amazon Elasticache	"Connection failure for a long period. Working after rebooting
I have been using ElastiCache with Redis and we got intermittent connectivity issues as everyone else, but a week ago we got a permanent failure, completely outside of maintenance windows. The only way to solve this was to reboot the machines but what worries me is that we didn't get any warning about anything not working. If I didn't have my own way to know if elasticache is available, I would not know this was happening. 

So, before I move to another Redis solution, I would like to know if there is a way to debug or know what happened and why. We could try to use the CLI to reboot the cache cluster if the connection stays down for a long period, but before resorting to that I would like to know if there is another way around this."
Amazon Elasticache	"An error occurred during the ""Add Read Replica"".
Please tell me what to do.

Here is what I am doing:
1. Create ""Cache Subnet Group"" in CloudFormation.
2. Create ""Cache Cluster"" (master) in CloudFormation.
3. Create ""Cache Replication"" group in ElastiCache console.
4. Create ""Cache Cluster"" (replica) in ElastiCache console.
5. Run ""Add Read Replica"" in ElastiCache console.

But,status of the replica cluster is ""creating"".

It is an error that is displayed in the ""Description"".

(cluster_name) is either not present or not available (Service: AmazonElastiCache; Status Code: 404; Error Code: CacheClusterNotFound; Request ID: 1a97759b-c8a5-11e4-8239-4d8f7bd4a44f)


I can't of course be deleted.
Help me.

Edited by: aiko_trok on Mar 12, 2015 8:11 AM"
Amazon Elasticache	"Re: An error occurred during the ""Add Read Replica"".
This problem has been resolved .
The cause of the error is not known , but it was created took three hours ."
Amazon Elasticache	"Re: An error occurred during the ""Add Read Replica"".
Hi aiko_trok,

Please let us know if you are having any ongoing issues. 

Regards,
Julian H."
Amazon Elasticache	"Re: An error occurred during the ""Add Read Replica"".
Hi Julian .
Thank you for reply.

Sorry,""mcky_tmt"" account is what I have used in the work.
I was wrong account to be used when posting.

There is no problem now.
But,Do you know cause of the error?"
Amazon Elasticache	"Re: An error occurred during the ""Add Read Replica"".
Hi,

I'm glad it's fixed. I do not have any further info on the problem. Our system are designed to self heal if there are issue so I expect whatever the problem it just took time for monitoring to pick it up and make corrections.

Regards,
Julian H."
Amazon Elasticache	"Redis 2.8.9
Just wondering if / when there will be support for Redis 2.8.9? We'd love to start using the new features."
Amazon Elasticache	"Re: Redis 2.8.9
Hi there,

We don't have a solid release date for that, but keep an eye out for our releases here:

http://aws.amazon.com/new/
https://forums.aws.amazon.com/forum.jspa?forumID=127"
Amazon Elasticache	"Re: Redis 2.8.9
Any update to this?

I just got excited about PFADD only to realize Elasticache's version does not support this 

Not sure if I should wait if AWS will add this in the near future, or set up Redis on my own somewhere"
Amazon Elasticache	"Re: Redis 2.8.9
Any updates here?"
Amazon Elasticache	"Re: Redis 2.8.9
http://download.redis.io/redis-stable/00-RELEASENOTES

ElastiCache's Redis engine is now:


1 year
6 ""HIGH"" priority redis updates
13 minor versions
44 new features (including HyperLogLog, v2.8.9 4/22/14)
57 bug fixes and performance improvements


...behind the current stable release of Redis (2.8.19). Does AWS have any plans to adopt a sane upgrade schedule or is ElastiCache just another poorly-maintained AWS vaporpaas?"
Amazon Elasticache	"Re: Redis 2.8.9
Support for newer version of the Redis engine in ElastiCache is in the works and will be available soon, within a few weeks.
Thanks for the input guys."
Amazon Elasticache	"Re: Redis 2.8.9
I'm happy to let you know that ElastiCache for Redis now supports engine version 2.8.19. To learn more, please read our blog."
Amazon Elasticache	"is there an SLA for Elasticache ?
I did not find the SLA for Elasticache in AWS documentation, any help? thanks."
Amazon Elasticache	"Re: is there an SLA for Elasticache ?
I've been looking for the same, have you been able to figure it out?, Thank you.

Edited by: wexio on Feb 19, 2015 9:51 AM"
Amazon Elasticache	"Re: is there an SLA for Elasticache ?
No, I am still waiting for the response from AWS experts. thanks."
Amazon Elasticache	"Re: is there an SLA for Elasticache ?
Hi there, 

I can confirm that ElastiCache does not have an official SLA. However, we are running on the same reliable hardware as other AWS services and keep further improving our infrastructure. 

If you have any specific questions/concerns please let us know and we can address this for you. 

Kind regards, 
Belynda"
Amazon Elasticache	"Should I be able to select a micro node type for Redis?
I have not come across any docs saying otherwise yet it is not one of the options in the drop down list in the console when setting up a configuration for the first time. For current generation the smallest I see is a medium and for previous generation a small."
Amazon Elasticache	"Re: Should I be able to select a micro node type for Redis?
From Multi-AZ with Redis Replication Groups:
""Multi-AZ is not supported on T1 and T2 cache nodes.""

You can expect to see the micro instance type once you uncheck the multi-az option."
Amazon Elasticache	"Re: Should I be able to select a micro node type for Redis?
Thanks, I did not realize the list was changing based on the check boxes."
Amazon Elasticache	"Dataloss after Redis cluster crash
I have a redis 2 node cluster (primary + read replica) and both  nodes seem to have crashed in the morning, based on the messages I see in cache events. After the cluster was up, data has gone missing from it as if it was reinitialised from scratch. I had to restore data from one of the snapshots, but I am still losing data for a sunstantial period of time. Question is, if both nodes in  redis cluster crash simultaneously, then does it cause dataloss? Is there any way to recovery it? Cache Event says ""Recovering cache nodes XXXX"", but is it recovering or just faking it? 

===
XXXXXX-002 cache-cluster Mon Feb 23 08:07:44 GMT+530 2015 Finished recovery for cache nodes 0001
XXXXXX-001 cache-cluster Mon Feb 23 08:06:06 GMT+530 2015 Finished recovery for cache nodes 0001
XXXXXX-001 cache-cluster Mon Feb 23 08:03:49 GMT+530 2015 Recovering cache nodes 0001
XXXXXX-002 cache-cluster Mon Feb 23 08:02:23 GMT+530 2015 Recovering cache nodes 0001
XXXXXX-002 cache-cluster Mon Feb 23 08:02:23 GMT+530 2015 Recovering cache nodes 0001
XXXXXX-002 cache-cluster Sun Feb 22 20:05:38 GMT+530 2015 Finished recovery for cache nodes 0001
XXXXXX-002 cache-cluster Sun Feb 22 20:02:20 GMT+530 2015 Recovering cache nodes 0001
==="
Amazon Elasticache	"Unable to choose VPC Security Group(s) when try to create an ElastiCache
Hi, there

I want to study AWS ElastiCache and try to create one using wizard. In the second step: Configure Advanced Settings, there is no VPC Security Group(s) displayed, so I am unable to choose one, thus unable to continue. please see elasticache.png

In fact, I have one VPC created by myself. please see snapshot : vpc.png. BTW, I have deleted the default vpc.

Your help is greatly apprecriated!"
Amazon Elasticache	"Re: Unable to choose VPC Security Group(s) when try to create an ElastiCache
Hello,

Thank you for posting on AWS Forum.

Seems that you have not create a Cache Subnet Group for your Elasticache cluster. A cache subnet group is a collection of subnets that you may want to designate for your cache clusters in an Amazon VPC.

Here you can find a step by step guide and additional documentation on cache subnet groups:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.CreatingSubnetGroup.html"
Amazon Elasticache	"randomly, new web nodes can't communicate with Elsaticache Redis
We have an array of web nodes that scale up and down everyday from multiple availability zones within a VPC.  About twice a week we will have a node that launches and goes live, for the most part, communicates with the ELBs, RDS DB servers, Nats and begins serving web pages but can't contact the redis server.  After about 30 minutes it begins communicating with the redis server with no changes being made.  Can anyone suggest why this happens or how to fix it?"
Amazon Elasticache	"Re: randomly, new web nodes can't communicate with Elsaticache Redis
I'm having this problem as well. There are some other forum posts that show more people are experiencing this."
Amazon Elasticache	"Re: randomly, new web nodes can't communicate with Elsaticache Redis
here are some other related threads:
https://forums.aws.amazon.com/message.jspa?messageID=602537#602537
https://forums.aws.amazon.com/message.jspa?messageID=602536#602536"
Amazon Elasticache	"Re: randomly, new web nodes can't communicate with Elsaticache Redis
more related threads:
https://forums.aws.amazon.com/thread.jspa?threadID=146311&tstart=25
https://forums.aws.amazon.com/thread.jspa?threadID=161903&tstart=25
https://forums.aws.amazon.com/thread.jspa?threadID=158794&tstart=50
https://forums.aws.amazon.com/thread.jspa?threadID=155417&tstart=75
https://forums.aws.amazon.com/thread.jspa?threadID=150468&tstart=75
https://forums.aws.amazon.com/thread.jspa?threadID=151833&tstart=75"
Amazon Elasticache	"Elasticache cluster: get and set work, but not delete?
Using an AWS ElastiCache cluster in memcache mode, I've suddenly got a weird issue when trying to delete cached items. Get and Set work just fine -- but when I try to delete an item when connecting to the cluster, I get nothing. It silently fails.

Here's how I'm connecting:

$this->cache = new Memcache;
$this->cache->pconnect($this->memcacheserver);

And getting and setting work just great. But this does nothing:

$this->cache->delete($key);

I look in the EC control panel, and see no delete action taking place, neither a miss nor a hit.

Weirdly, if I connect straight to one of the individual nodes, it DOES work.  Is there something I'm not understanding about how these clusters work?"
Amazon Elasticache	"Export redis data
Hello,

  I want to export the data out of my elasticache cluster. So I did:

  redis-cli -p <elasticache-url> --rdb /tmp/dump.rdb

  However, I don't think the above gets the latest data as I have AOF turned on in elasticache. Caus when I look at /tmp/dump.rdb, it does not seem to have some latest changes. Is there any way I can do a SAVE or BGSAVE and get the file back (or placed into a S3 bucket)? on the redic-cli prompt, SAVE/BGSAVE give errors saying they are invalid commands.

  How do I get a dump.rdb of the complete data on my redis cluster?

thx
jim"
Amazon Elasticache	"Re: Export redis data
Hello,

The BGSAVE/SAVE commands are restricted on ElastiCache as per http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ClientConfig.html. However you can launch an EC2 instance running Redis and configure it as a slave read replica of the primary ElastiCache node and issue the BGSAVE command on it.  For more information please visit the FAQ of ElastiCache -> http://aws.amazon.com/elasticache/faqs/.

Best Regards,
-Dimos C."
Amazon Elasticache	"Re: Export redis data
This seems more work than one should have to do to get a backup of the data. Starting a new instance just to get the data out seems to defeat the purpose of having a managed redis 

Anyways, I figured out a way by reading out all the keyspace and writing it out to a file in the redis protocol and then replaying that file on localhost.

Here is a blogpost if it helps someone else: http://jimmyislive.tumblr.com/post/107077553355/exporting-data-from-aws-redis-elasticache

thx"
Amazon Elasticache	"Re: Export redis data
Thanks, jim4321! That is useful info."
Amazon Elasticache	"Any plans to implement ARN-specific access controls on Elasticache?
Hi!

I'm reading this doc: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/UsingIAM.html

""There's no way in the IAM system to allow or deny access to a specific cache cluster.""

I'm curious if there's any plan to implement that feature?  I'd like to have more control over which user can do what with which cache cluster (like I can with my RDS instances).

Thanks!

gabrielle"
Amazon Elasticache	"Memcached PECL install fails on Ubuntu 14.04 AMI 64
Dear Community,

I have set up an EC2 c3.large with an ElastiCache t2.medium and installed Memcached.
I used the bitnami installer for WordPress.
PHP Version: 5.4.35

I followed this guide (http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Appendix.PHPAutoDiscoverySetup.html#Appendix.PHPAutoDiscoverySetup.InstallingExisting)
 to install the PHP extension PECL, however at Point 4 I get stuck.
I have downloaded the ElastiCache Cluster Client for PHP 5.4 (64 bit Linux).
If I try to install via sudo pecl install <path/file.tgz> I get the message: install failed.
If I try the second alternative via cp <path/amazon-elasticache-cluster-client.so /usr/lib/php5/20121212/ > I get the message: No such file or directory 
I dragged the file into the terminal to get the path, so this should not be the problem right?

Any help would be highly appreciated.
Thank you."
Amazon Elasticache	"memcached 1.4.14
I think I miss something in the configuration

I have 2 nodes t2.medium (test nodes), I insert 80.000 items in this cluster en the distribution in the nodes is quite differened node 1  19.046 items and node 2 65.516 items 

Is there a way to balance this better, I try to add more nodes like 8 but the distribution get worse 

Any command on this are welcome"
Amazon Elasticache	"Free tier with ElastiCache
I would like to test ElastiCache.Redis but the   Free Tier indicates that I get 750 hours of ""micro"" instance usage per month. When I go to set up/configure ElastiCache the smallest node type seems to be ""small"". How would be the best way to build a small test case?

Thank you.

Kevin"
Amazon Elasticache	"Re: Free tier with ElastiCache
Hi Kevin,

Micro nodes do not support Redis Multi-AZ (for more detail please see the Multi-AZ section of the ElastiCache FAQ at http://aws.amazon.com/elasticache/faqs/). When you are creating an ElastiCache for Redis cluster, if you uncheck ""Multi-AZ"", you will see the micro node as one of the options. It is eligible for free tier.

Best,
Dan"
Amazon Elasticache	"ElastiCache and Free-Tier w/EC2 instance
I am currently running a t2.micro instance 24x7 in the free-tier.  

If I create a redis cluster (cache.t2.micro w/555 MB) with replication enabled ( not multi AZ ) is this also free?"
Amazon Elasticache	"Re: ElastiCache and Free-Tier w/EC2 instance
As long as you are using t2.micro instances AND staying under the 15GB aggregated there is no free-tier limit on instances, other than the 750 hours. Hopefully you've realized that 750 hours is one instance 24hoursX31days in a month (if, say March) with 6 hours left over. So if you stand up a second instance using Redis, keeping under all other Free-Tier requirements, you'll need to carefully monitor your over all hours usage.

February is a good month to do this, since we get ""3 days free"" so to speak. (i.e. 24 hours X 28 days = leaves 78 hours extra to run your second instance."
Amazon Elasticache	"Intermittent DNS Problems
Since Thursday of last week, we started to recognize intermittent failures in the ability of our EC2 instances to reach our two ElastiCache instances via their endpoint URL. It would fail once or twice for an hour, twice or thrice for a minute, etc. seemingly at random.

After some troubleshooting, we realized that if we hard-coded the IP address of the ElastiCache instances instead of using the endpoint (and thus skipping DNS), the problems went away. Obviously, hard-coding the IP address is not a long-term solution because we won't get automatic failover.

Below is the dig results between a failure and a success, here is a SERVFAIL failure.
; <<>> DiG 9.8.2rc1-RedHat-9.8.2-0.23.rc1.32.amzn1 <<>> redis1-repl.ymtdpx.ng.0001.apse1.cache.amazonaws.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: SERVFAIL, id: 33342
;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 0
 
;; QUESTION SECTION:
;redis1-repl.ymtdpx.ng.0001.apse1.cache.amazonaws.com. IN A
 
;; Query time: 2134 msec
;; SERVER: 172.31.0.2#53(172.31.0.2)
;; WHEN: Fri Nov 28 11:16:41 2014
;; MSG SIZE  rcvd: 70
 
 
; <<>> DiG 9.8.2rc1-RedHat-9.8.2-0.23.rc1.32.amzn1 <<>> redis1-repl.ymtdpx.ng.0001.apse1.cache.amazonaws.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 10283
;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 0
 
;; QUESTION SECTION:
;redis1-repl.ymtdpx.ng.0001.apse1.cache.amazonaws.com. IN A
 
;; ANSWER SECTION:
redis1-repl.ymtdpx.ng.0001.apse1.cache.amazonaws.com. 57 IN CNAME redis1.ymtdpx.0001.apse1.cache.amazonaws.com.
redis1.ymtdpx.0001.apse1.cache.amazonaws.com. 58 IN A 172.31.5.97
 
;; Query time: 595 msec
;; SERVER: 172.31.0.2#53(172.31.0.2)
;; WHEN: Fri Nov 28 11:16:42 2014
;; MSG SIZE  rcvd: 114


Could someone please take a look at our instance and let us know if there might be a DNS problem?

Thanks
-Wakku"
Amazon Elasticache	"Re: Intermittent DNS Problems
We are also having intermittent DNS trouble recently with ElastiCache. Unfortunately it looks like ElastiCache is suffering from the same DNS problems as RDS, which have remained unfixed for months despite many reports.

Amazon, please can you tell us:

Why these problems are occuring
What is the expected ETA until you can fix these problems


EC and RDS are otherwise great services and are being harmed by these DNS issues."
Amazon Elasticache	"Re: Intermittent DNS Problems
We just started experiencing the same problem since 2014-11-24. Since then, the DNS resolution failure of the ElastiCache endpoint happened between 1 to 6 times each day, and is still happening.

Sample error from the php app:

exception 'Predis\Connection\ConnectionException' with message 'php_network_getaddresses: getaddrinfo failed: No address associated with hostname [tcp://xxx.yyy.0001.apse1.cache.amazonaws.com:6379]'


We are using Amazon DNS for the VPC"
Amazon Elasticache	"Re: Intermittent DNS Problems
Hi there,

We would like to investigate this issue further.

Can you let me know when this started happening to your resources? Additionally, is this still happening since you first reported this? and if so, at what frequency do you encounter this intermittent connection issue?

Thanks so much!"
Amazon Elasticache	"Re: Intermittent DNS Problems
Since we last saw it on last Friday, the problem seems to have disappeared for now.
Could you explain what the problem was?"
Amazon Elasticache	"Re: Intermittent DNS Problems
Nice to hear that, but keep an eye on it. For us, it tends to happen every so often - around once per week at the moment, although we had an incident where it occurred multiple times in the same day."
Amazon Elasticache	"Re: Intermittent DNS Problems
Same thing here. Once or twice a week we're getting 'connection timeout' when trying to connect to ElastiCache from 5 different EC2 instances. Usually it's a huge spike of errors during 20-40 seconds. 

CPU utilization looks weird during that time. See attached file."
Amazon Elasticache	"Re: Intermittent DNS Problems
Hello,

Could you please let us know if you are still experiencing this issue ? 

Best Regards,
Chandra P."
Amazon Elasticache	"Re: Intermittent DNS Problems
Yes.. this is still an issue.  We are still seeing intermittent errors (as of Thu Jan 29 11:00:19 PST 2015) resolving rds and elb hostnames."
Amazon Elasticache	"Redis snapshot encryption
When snapshots are taken of a redis instance (or AOF is enabled and a log is written to disk), is the disk encrypted?  When the snapshot is placed on S3, is server-side encryption used?

If the answer is no to either of these, I'd like to request it as a feature.

If yes, then I'd like to ask to be able to choose the encryption key to use from KMS."
Amazon Elasticache	"Using elasticache - memcache as php session storage issues
We are currently running two EC2 instances as memcache servers, with a home-grown failover process.  We'd like to switch to elasticache for this, but whne we do, users are logged out after 15 minutes.  The change we made was to the session.save_path variable in php.ini and that was it.  The only parameters we've set for our memcached server is the number of connections and the size of cache memory (those instances only run memcached).

I can't find a setting that would explain the 15 minute logout.  The session cookies have the proper 1 week expiration, and no application code was changed.

Suggestions?  An overlooked setting?

Thanks in advance."
Amazon Elasticache	"Elastic Cache Memcache server under load (PHP)
Hello,

Sometimes, usually at peak, we notice the following error on our logs:
47:SERVER HAS FAILED AND IS DISABLED UNTIL TIMED RETRY

We are using the PHP AWS EC interface to connect to the memcache servers.

Any ideas what could be causing the issue? How long the server is disabled for? How to change the retry value?

The cache cluster consists of 2 servers of class m3.xl with cpu usage at peak at around 20%.

Thanks!"
Amazon Elasticache	"How to use Elasticache with PHP?
After installing memcache on my EC2 Linux instance using this:

 :~$ sudo apt-get install memcached php5-memcache


I can immediately do this:
 
    $memcache = new Memcache;
    $memcache->connect('localhost', 11211);
 
    $array_result=$this->db->query(""SELECT * where ....""); // some DB query
    $memcache->set('my_items', $array_result, false, 60*60*24);    

and later can access this cached array like this: 
    $memcache = new Memcache;
    $memcache->connect('localhost', 11211);
    $my_items=$memcache->get('my_items');
    var_dump($my_items);

My question is what is the Elasticache syntax that correlates with memcache's connect(), set(), and get()
 commands? I'm totally confused by the  Elasticache part of the AWS PHP SDK ."
Amazon Elasticache	"Re: How to use Elasticache with PHP?
Hello,

I have reached out to the ElasticCache team to see if they can provide any guidance here.

Regards,

Matt J"
Amazon Elasticache	"Re: How to use Elasticache with PHP?
Update to my question

I created a cache cluster and node but it didn't work to replace localhost with my node endpoint like this:

//$memcache->connect('localhost', 11211);
$memcache->connect('myElasticacheCluster.tvgtaa.0001.use1.cache.amazonaws.com', 11211);  


It also didn't matter whether I used Memcache or Memcached which are both installed on my instance and both functional using 'localhost' as the endpoint.

Might someone please help?

thanks,
tim

Edited by: timothy r. peterson on Sep 11, 2012 5:11 PM

Edited by: timothy r. peterson on Sep 11, 2012 5:15 PM

Edited by: timothy r. peterson on Sep 11, 2012 5:16 PM

Edited by: timothy r. peterson on Sep 11, 2012 5:18 PM"
Amazon Elasticache	"Re: How to use Elasticache with PHP?
Hello,

We believe there might be some confusion surrounding the difference between the php memcache extension (php-memcache) and the ElastiCache part of the AWS SDK.

If I understand correctly, you wish to know how to perform get(), set(), etc, operations using ElastiCache clusters.

For this, all you need to do is replace:

$memcache->connect('localhost', 11211);
With:
$memcache->connect('<elasticache node endpoint address>', <elasticache node endpoint port>);
And perform operations the same way you would with a local memcached instance.

Similarly, to connect to several nodes (in a cluster) the syntax would be:
$memcache->addServer(""<elasticache node endpoint address 1>"", <port>);
$memcache->addServer(""<elasticache node endpoint address 2>"", <port>);
...

The AWS SDK allows the user to manage cache clusters, parameter groups, etc, as you would from the console.

It is not used to directly interact with cache nodes and hence does not have memcache-style get/set operations.

Hope this helps!

Matt J"
Amazon Elasticache	"Re: How to use Elasticache with PHP?
hi Matt,

I tried doing exactly what you said. Please see my updated question (dated Sep 9, 2012 7:36 PM EST). 

Do I need to use connect() or addServer()? Connect() is the memcache syntax but addServer() is the memcache*d* syntax, correct? Can I use either memcache or memcached with Elasticache?

Also if I have 2 nodes do those both need to be connected or can I just connect to one of them?

thanks,
tim

Edited by: timothy r. peterson on Sep 12, 2012 8:30 AM

Edited by: timothy r. peterson on Sep 12, 2012 10:08 AM

Edited by: timothy r. peterson on Sep 12, 2012 10:09 AM"
Amazon Elasticache	"Re: How to use Elasticache with PHP?
Hi Matt and all,

I solved my own problem. It was that my EC security group was not added even though I had selected it when setting up my EC cluster. Once I clicked the button to add it then its status was ""authorized"" and I was able to connect to the EC servers.

Another important point is that one can use Memcache or Memcache*d* with either the EC servers. I was successful with both.

tim"
Amazon Elasticache	"Re: How to use Elasticache with PHP?
Hi There,

We are using different services provided by the AWS on our site like load balancing, Auto scaling, AMIs etc. Recently, we noticed that, AWS provides the Elastic cache support for Redis. In our site, Redis is implemented.

So, we would like to replace existing Redis with the AWS Elastic Cache Redis. For that, we have already created the cluster from AWS console. Also, I having related endpoint & port information with me. On my site, I have downloaded the AWS-SDK-PHP as site is in PHP and it works fine.

Now, I am struct at a place because I could not get any reference for sample code for php with Redis. I can see the code of Memcache.  I am looking for short sample source code by which, I can connect to the Amazon Redis cluster with endpoint & port, and save, edit & delete informationIn a Key-Value pair to the AWS elastic cache.

I have review AWS User Guide, API references as well. But none of place describes about the php sample code for the Redis.

Please reply ASAP and guide me further.

Do let me know if you need any further information.

Thanks,
Ankit."
Amazon Elasticache	"Re: How to use Elasticache with PHP?
Hello,

You can connect to an ElastiCache Redis cluster with any PHP client for Redis. There is no need for a specific client. For example you can use PHPredis -> https://github.com/phpredis/phpredis . The README file contains examples on how to use it. Please note that you need to specify your cluster's endpoint and port on the Connection.

I hope this helps.

Best Regards,
-Dimos

Edited by: Dimos@AWS on Jan 21, 2015 6:56 AM"
Amazon Elasticache	"Elasticache (Redis) in Frankfurt
Hello,

is there an ETA when Elasticache (with Redis) will be available in the Frankfurt region.
We are currently using the Ireland region and would like to move our setup to Frankfurt. The missing Elasticache support for that region is the only thing stopping us at the moment.

kind regards
simon"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
Hi Simon,

We are working on making all services available in the new Frankfurt region. While I don't have a solid ETA on this, I understand that ElastiCache will be made available in eu-central ""soon"".

If you are a Redis user, you may want to build your own EC2 Redis server as a temporary solution. When ElastiCache is available in this region, you can run export your data (i.e. using SAVE/BGSAVE) to S3 and use it to seed your your ElastiCache node so you wouldn't have to start over. All you'd have to do then is switch the end-point in the application to the new source.

I hope this helps!"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
hi Rendy

thanks for your reply. We already have an Elasticache Redis Setup in Ireland and don't want to give up the comfort of it. We will wait then...hopefully ""soon"" is really soon. 

kind regards
Simon"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
Hi

Any news when to expect Elasticache in Frankfurt?"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
Any news on this? We are also waiting for ElastiCache to be implemented, as we can't continue without that."
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
we're also waiting for this, this question is however marked as answered, does that mean nobody is going to read or reply to this ever again :/ ?"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
Also waiting to use Elasticache in eu-central.  Thanks!"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
+1"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
Hi everyone,
We are working on adding ElastiCache support in the Frankfurt region and it will be available within a few weeks. We will notify the forum once the service is live and you can start using it. Thanks for your inquiries and interest in ElastiCache. 
Best,
Dan"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
+1"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
+1"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
Also waiting for this."
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
I'm happy to update that ElastiCache is now fully available in the EU (Frankfurt) Region! Give it a try and please let us know of any feedback or questions.

Best regards,
Dan"
Amazon Elasticache	"Re: Elasticache (Redis) in Frankfurt
That is really good news. Thank you!

fyi: From a customers perspective three month is not ""soon""...."
Amazon Elasticache	"Need advise - Elasticache Farankfurt
Hi

We are about to deploy a a stack that needs Elasticache an we need to have it running in Frankfurt.
As we are working by plans and dead lines so are AWS, can you please tell when Elasicache will be availibel in Frankfurt."
Amazon Elasticache	"Re: Need advise - Elasticache Farankfurt
Hi jontase,
We are working on adding ElastiCache to the Frankfurt region and it will be available within a few weeks. Thanks for your interest in the service.
Best,
Dan"
Amazon Elasticache	"Re: Need advise - Elasticache Farankfurt
Hi, 

as it is now a few weeks later, do you have any news on when to expect Elasticache being available in the Frankfurt region? We're trying to finalize plans for an infrastructure project and it'd be great to know whether using Elasticache would be an option in the Frankfurt region.

Thanks a lot,

Colin Schlueter"
Amazon Elasticache	"Re: Need advise - Elasticache Farankfurt
Hi Colin,

I'm happy to update that ElastiCache is now fully available in the EU (Frankfurt) Region! Give it a try and please let us know of any feedback or questions.

Best regards,
Dan"
Amazon Elasticache	"Versioned URL for CLI tools?
Hello,

On the  Amazon ElastiCache Command Line Toolkit page, the download URL is not versioned:
https://s3.amazonaws.com/elasticache-downloads/AmazonElastiCacheCli-latest.zip

which makes it unsuitable to use in packages managers like  Homebrew. Would it be possible to get a versioned URL, i.e. an URL which explicitly contains the current version?"
Amazon Elasticache	"freeable memory saw graph towards 0 in redis elasticache
In AWS:elasticache our FreeableMemory saws up and down in one hour frequencies but overall the graph is approaching to zero very rapidly. When I look at BytesUsedForCache we are only at about half of the server size. What will happen when freeable memory hits zero? Should be refactoring up to a larger size server very quickly?

thankyou"
Amazon Elasticache	"Re: freeable memory saw graph towards 0 in redis elasticache
has no one else had this problem? I wasn't sure from the documentation when we should be expanding our elastic cache node. thanks"
Amazon Elasticache	"node appears to restart after low memory conditions reached
We have a redis cluster (cache.r3.2xlarge) that we use to cache objects for our website. It is using the default default.redis2.8 parameter group (volatile LRU etc). When the available memory goes down to about 300MB (far below 1% available) free it will stay there for a few minutes and then the cache will empty (all keys gone). 

In the console I can see that ""Cache node 0001 restarted"" is in the events section but there is no more detail. Over the past two weeks this has happened to us 4 times. Is there an issue with volatile LRU or running out of memory that causes the node to be restarted?"
Amazon Elasticache	"Re: node appears to restart after low memory conditions reached
Is there any way to determine why a cache node restarted? I would like to know if this was part of a maintenance routine (it was outside the window) or if there is an issue with low memory conditions."
Amazon Elasticache	"How to connect to Elasticache instance in VPC from EC2 Classic instance?
Hello,

We're migrating our cache instance from an EC2 instance to Elasticache.  We're going to start with a T2.Medium Elasticache instance, which needs to run in a VPC.  My EC2 instances which need to utilize the cache are not in a VPC.  I'm trying to figure out how to allow the EC2 instances to connect to Elasticache.  I read about security groups and VPC security groups and it wasn't clear how I could utilize either to grant access to the cache nodes.

How can I get this to work without having to move my EC2 nodes into the VPC?

Thanks"
Amazon Elasticache	"Re: How to connect to Elasticache instance in VPC from EC2 Classic instance?
Hi 32aonaz,

You might find the following blog post about a new EC2/VPC feature, ClassicLink, meets your need:

https://aws.amazon.com/blogs/aws/classiclink-private-communication-between-classic-ec2-instances-vpc-resources/

ClassicLink allows you to connect EC2 Classic instances to a VPC. 

I have tested this by creating a new VPC and launching ElastiCache (memcached) into my VPC. I was then able to link my VPC to an EC2 instance and successfully connect to my ElastiCache node from EC2 Classic. 

Please be aware, there are some limitations with the use of ClassicLink (particularly around the IP routes defined in your VPC). These are documented in the Getting Started guide:

http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/vpc-classiclink.html#classiclink-limitations

I hope this is helpful. 

Regards,

Alastair"
Amazon Elasticache	"Re: How to connect to Elasticache instance in VPC from EC2 Classic instance?
Hi Alastair,

Thanks for the links to ClassicLink.  This looks very promising.  One question is, can instances launched via autoscale rules automatically be included in the ClassicLink?  We frequently are autoscaling and those EC2 Classic instances will also need to connect to the Elasticache running in a VPC.

Thanks again!"
Amazon Elasticache	"Re: How to connect to Elasticache instance in VPC from EC2 Classic instance?
Never mind.  I found the answer to my autoscale question in the limitations documentation.  ClassicLink doesn't support autoscale at this time, but will in the future."
Amazon Elasticache	"T2.small redis cache node won't snapshot
I'm running ElastiCache in a VPC, running the lates Redis. If I launch a m3.large, I can backup/snapshot/restore as normal, but when I try with a cache.t2.small instance, the console dialogue doesn't offer me the option.

Despite having a running cache node, the snapshot dialogue is empty (screenshot attached).

Any thoughts?"
Amazon Elasticache	"Re: T2.small redis cache node won't snapshot
Hi there,

Snapshot isn't supported with t1 and t2 (general same family) instance type. This is mentioned in this documentation page but I will bring this up to them so they can clarify this a bit better:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingSnapshots.html

I hope this helps!"
Amazon Elasticache	"Re: T2.small redis cache node won't snapshot
Thanks for the update. I can see the documentation refers to t1.micro's not being supported but I can't see the t2 family mentioned. At least, even with ctrl-F I can't find it! Thanks for the clarification though!"
Amazon Elasticache	"Re: T2.small redis cache node won't snapshot
Thanks for pointing this out med-ccare, we will update t2's in that documentation page."
Amazon Elasticache	"Re: T2.small redis cache node won't snapshot
I think the following pages need be updated as well.

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Snapshots.html#Snapshots.Constraints
Backup and restore is not supported on cache.t1.micro cache nodes. All other cache node types are supported.

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html#CacheParameterGroups.Redis.NodeSpecific
t2 instances do not support Redis backup/restore.

The same probably applies for AOF files.

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html#CacheParameterGroups.Redis.AOF
Append-only files (AOF) are not supported for cache.t1.micro nodes.

@ijin"
Amazon Elasticache	"Can we ping the elasticcahe end point
When I create the elasticcahe, the end point is given to us like xxxxxxx.xxxxxxxxxx.xxxxxxxx.cache.amazonaws.com:6379.

Is it possible to do : $ ping xxxxxxx.xxxxxxxxxx.xxxxxxxx.cache.amazonaws.com:6379

I've done telnet to it, and connected via redis-cli. 

But I wasn't to ping the instance where this service is working ..."
Amazon Elasticache	"Re: Can we ping the elasticcahe end point
Hello,

It sounds like what you want to do is confirm that ElastiCache is responding properly?

To do this you would need to set up a script or similar that sends dummy requests to the service to see what responses you get back.

I'm not aware of any scripts that can do exactly what you're looking for I'm afraid, so you would probably need to develop your own.

I hope this helps.

Richard"
Amazon Elasticache	"Re: Can we ping the elasticcahe end point
thnx for the answer, one more question ..is it possible to communicate with elasticache end point, other than from ec2 instances .."
Amazon Elasticache	"Re: Can we ping the elasticcahe end point
Hi there,

ElastiCache nodes are only accessible internally from EC2. It is not accessible from outside AWS environment. As a testing method, you can create an SSH tunnel through an EC2 instance as a proxy, but it's not meant to be used as a production work."
Amazon Elasticache	"Re: Can we ping the elasticcahe end point
Thank you for the response."
Amazon Elasticache	"Question about increasing nodes size with Elasticache Redis
Hi

We are building a new application and some days ago I spinned up a small Elasticache cluster with just 1 t2.micro Redis 2.8 node to be used in our staging environment.

I wanted to test increasing this node capacity (obviously staging won't need it but eventually producion hopefully will) and I see that I cannot create a new node in the cluster (button being disabled in the web GUI)

Is this because it is a micro node? A bug on your side? Some misunderstanding on my side?

And anyway, how is this process supposed to work in production with Elasticache?
Let's say we start with a 8Gb node and at some point this becomes too small. The way I would do it running my own Redis boxes in EC2 would be spinning up a higher node, make it a slave until they catch up and then promote the slave as the new master.

Again, maybe all my doubts come from starting with the smallest cluster of 1 node possible but any clarification would be very much appreciated

Best"
Amazon Elasticache	"Re: Question about increasing nodes size with Elasticache Redis
Hello,

The button is disabled because on ElastiCache for Redis you can only have a single primary node on the cluster and up to 5 read replicas.  However the cache node type of the replicas will be the same as the primary and you cannot change the cache node type of an existing  cluster. In order to scale your cluster you will have to create a new one using a bigger node type and then migrate your application on it. You can also leverage the snapshot feature and restore the contents of the old cluster to the new one (http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingSnapshots.html) .

Best Regards,
-Dimos C"
Amazon Elasticache	"Re: Question about increasing nodes size with Elasticache Redis
Hi Dimos@AWS

Sorry about not replying before, I have been on holidays, hopefully you too! 

Back to the question, this is a bit different to what I expected. I know Elasticache instances are meant to be for caches but Redis is much more than that!

You mention that I could have 5 read replicas but I am not able to even create one. Is this because the way I created the cluster in the first place?

And most importantly, I guess if we want to consider Redis a first-class database citizen we will need to use EC2 instances in order to be able to do things like what I described in my first question, right? 

I know it is impossible to have a 0 downtime with Redis when you need to scale up your cluster but with the procedure I described the downtime will certainly be smaller than using the backup / restore procedure, specially if you have big datasets that you don't want to lose or are constantly being updated (mainly sets, lists, etc...).

You also say that we can only have a primary node in the cluster so if our application needs a client-side sharded Redis cluster we should create more than 1 cluster to allocate that, right?

Maybe you are not allowed to disclose it but I wonder if you have plans to add more Redis specific options to support things like what I am describing in the short term or Elasticache is pretty much to stay as it is now. If this is the case, we will probably end up using EC2 instances not only because of these limitations but also to be able to use the latest Redis 2.8 branch, which has been specially active in the last 6 months fixing lots of nasty bugs.

Again, sorry about the late response and waiting for your final comments"
Amazon Elasticache	"CloudFormation CacheClusterIdentifier missing some documentation
Just been trying to build a AWS::ElastiCache::CacheCluster using CloudFormation... think the documentation is missing some info?
Specifically this page - http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-elasticache-cache-cluster.html

Doesn't mention anywhere that ClusterName is limited to 20 characters, and errors from CloudFormation get reported as CacheClusterIdentifier which makes no sense when compared with the uploaded JSON.

E.g. this works fine if the ""EnvironmentName"" parameter is short, but gives an error saying CacheClusterIdentifier is limited to 20 characters if its too long, which doesn't seem to be documented.
""ExampleCacheCluster"": {
      ""Type"": ""AWS::ElastiCache::CacheCluster"",
      ""Properties"": {
        ""CacheNodeType"": { ""Ref"": ""CacheNodeType"" },
        ""CacheParameterGroupName"": ""default.redis2.8"",
        ""CacheSubnetGroupName"": ""cache-subnet"",
        ""ClusterName"": { ""Fn::Join"": [""-"", [""some-cache"", { ""Ref"": ""EnvironmentName"" } ] ] },
        ""Engine"": ""redis"",
        ""EngineVersion"": ""2.8.6"",
        ""VpcSecurityGroupIds"": [ { ""Ref"": ""CacheSecurityGroup"" } ],
        ""NumCacheNodes"": { ""Ref"": ""NumCacheNodes"" }
      }
    }


The identifier length limit is mentioned in the API docs - http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_CreateCacheCluster.html - but that uses CacheClusterId instead of CacheClusterIdentifier so didn't show up in a search"
Amazon Elasticache	"Re: CloudFormation CacheClusterIdentifier missing some documentation
Hello,

I've flagged this to the people responsible for the documentation.

I'll let you know when I hear back from them.

Richard"
Amazon Elasticache	"Re: CloudFormation CacheClusterIdentifier missing some documentation
Hi,

We've updated the documentation now. Please let us know again should you find anything else that we might have also missed.

You can also give us feedback on any of our documentation pages by clicking on the top right link on any page that says ""Tell us about it...""

Thanks for bringing this up!"
Amazon Elasticache	"Maintenance Window for ElasticCache (Memcache)
Hi

While creating a new cluster, for maintenance, its asking me for a day of week and  time.  So, downtime for Memcache will be minimum one hour every week. Am I getting it correct

Thanks"
Amazon Elasticache	"Re: Maintenance Window for ElasticCache (Memcache)
Hello,

No -- the maintenance window for ElastiCache is simply the time window when maintenance will be run if maintenance is required.

Maintenance is only required on an occasional basis - so you can assume that there will be no downtime during your maintenance window on most weeks.

Richard"
Amazon Elasticache	"ElastiCache Cluster Client
I downloaded the ElastiCache Cluster Client (JAVA) from https://console.aws.amazon.com/elasticache/. Download folder AmazonElastiCacheClusterClient-1.0.1 includes AmazonElastiCacheClusterClient-1.0 <executable jar file>. I try to execute it using the command java -jar AmazonElasticCacheClusterClient-1.o.jar. I keep getting the error 
__no main manifest attribute, in AmazonElastiCacheClusterClient-1.0.jar__

I need to showcase the node auto discovery feature. I need to run this client on one of the ec2 instances after bringing the memcached cluster up.
How can I run the ElastiCache Cluster Client."
Amazon Elasticache	"Re: ElastiCache Cluster Client
Hello,

You can find some example code using the ElastiCache Java client on the following link -> http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html#AutoDiscovery.ModifyAppJava.

I hope this helps. Please let us know if you require any further assistance. 

Best Regards,
-Dimos C."
Amazon Elasticache	"Issue with accessing Elasticache in C using libmemcached 1.0.18
I am using the libMemcached library, 1.0.18, to access my Elasticache node from C. I have an issue where several keys always return empty values using memcached_get(). Accessing the same node in PHP does return the correct values for those keys. Listed below is the simple code used to access the node in C. What am I missing? Thank you.

memc = memcached_create(NULL);
memcached_behavior_set(memc, MEMCACHED_BEHAVIOR_BINARY_PROTOCOL, false);
servers = memcached_server_list_append(NULL, node, port, &rc);
rc = memcached_server_push(memc, servers);

value = memcached_get(memc, key, strlen(key), &size, &flags, &rc);
// value is always an empty string!"
Amazon Elasticache	"Re: Issue with accessing Elasticache in C using libmemcached 1.0.18
PS: I tried to do a get on the faulty key using telnet. The value returned was all mangled. This seemed to indicate an issue with the key value that the server is not liking. But why would it work with php?"
Amazon Elasticache	"Re: Issue with accessing Elasticache in C using libmemcached 1.0.18
I have resolved my issue: It turns out that a value with with a special sequence of characters will cause Elasticache to fail to return that value for a given key. I believe that this should never happen. Hopefully, this issue will be resolved in the near future."
Amazon Elasticache	"Redis cluster suddenly empty
Hi,

Today my Redis ElastiCache store with about 600K keys and about 400 active connection suddenly became empty and disconnected all clients. I found the below cache events happening at the same time. This was not user initiated and is quite scary - can anyone offer an explanation to what may be going on?

Could it be a AWS hardware fault, and since I only have 1 node in my cluster atm it ""failed over"" to an empty node? However, I have automated daily snapshots which would maybe be more natural to use instead starting empty...

I'm attaching the items and connections graphs from the node.

Here are the mentioned cache events:

simon
cache-cluster
Thu Nov 20 16:14:09 GMT+100 2014
Finished recovery for cache nodes 0001

simon
cache-cluster
Thu Nov 20 16:09:57 GMT+100 2014
Recovering cache nodes 0001

Thanks for any clarifications!
Magnus"
Amazon Elasticache	"Re: Redis cluster suddenly empty
Hi there,

I'm sorry for the issue. It does look like there was an issue on the hardware layer that needed to be addressed and unfortunately your node had to be rebooted. While failures are inevitable, there are ways you can architect your environment so that it's failure tolerant.


1. Enabling AOF (Append-Only File) will create a copy of all Redis transactions in the host. Should a node is rebooted, this record will be replayed as the node is started again, restoring the cache node with its most recent data intact.

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html#CacheParameterGroups.Redis.AOF

2. Should the underlying hardware malfunctions and recovery through AOF becomes impossible, a Multi-AZ replication group environment should allow a read-replica be promoted as the new primary with its latest replicated data intact. This is now an automated process that doesn't require any manual interactions.

http://aws.amazon.com/blogs/aws/elasticache-redis-multi-az/

3. Lastly, as an additional safety net, having a regular snapshot schedule can give an extra layer of protection should any of the above methods fail to perform.

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingSnapshots.html

I hope this helps!"
Amazon Elasticache	"Re: Redis cluster suddenly empty
Thanks for the info. I will definitively read  through those guides!"
Amazon Elasticache	"Getting server status failed - Memcache
Hi

I have created an elastic cache cluster, engine - Memcached.  I am not able to store any value to server. When I tried to get server status using following :

PHP Example - 
$memcache->getServerStatus(""testcluster.ylr8hl.cfg.use1.cache.amazonaws.com"", 11211) 

Its giving me 0 in return.  How can I check if there is any issue with my memcached cluster

And the same thing I tried to implement with .NET assemblies, and it also failed. If required, I can give my source code , however, I could not see any issue with my code.

Thanks"
Amazon Elasticache	"Re: Getting server status failed - Memcache
Hi there,

Are you trying to connect to this cluster internally (from within the AWS environment)? This service is only available via instances launched in the EC2 environment and it is not available externally (i.e. from your home/office).

Have you tried running a telnet test? That's a quick way to see if you're instance is able to connect to the node. For example:

$ telnet testcluster.ylr8hl.0001.use1.cache.amazonaws.com 11211


I hope this helps!"
Amazon Elasticache	"Stuck cluster
I started a memcached cluster using a cloudformation template and it seems to be stuck in the 'creating' state. I have hit delete on cloudformation which is now waiting for the elasticache cluster to create so it can delete it.

It been like this for over an hour or so now. Is there anything I can do?"
Amazon Elasticache	"Re: Stuck cluster
never mind, 1 hour 30 mins later it created and cloudformation has now deleted it."
Amazon Elasticache	"Connectivity issues w/ ElastiCache node ""Temporary failure in name resoluti
We're experiencing connectivity issues to our ElastiCache node.
This is the 2nd time today.

Telnet says ""Temporary failure in name resolution""

EDIT: connectivity is sporadic. Problems connecting to RDS instances as well (ping fails)

Any AWS techies out there?

Edited by: sambusak on Nov 12, 2014 4:20 PM"
Amazon Elasticache	"Elasticache - Redis Master and Read Replic Performance
We are leveraging Elasticache for within our application to store key pair values.  We are running Redis version 2.8.6 with Elasticache.  We have created a master and slave configurations (in both our dev and beta environments), with the slave configured as a read replica.  When we configure the Master instance in our application for both master and slave instances, we see great performance.  However, when we enable the slave for read actions from our webapp (ELB Instance), the performance is deteriorated and within our webapp logs we can see requests to the slave that take several seconds to respond (5 - 10 seconds), that we do not encounter when using only the master for reading values (< 1 sec).

We cannot find any problems from the cache events in Elasticache console and we are trying to troubleshoot why we see this delay when slave replica is enabled.  All signs show good heath in aws Elasticache console.

Is there a way we can review the redis logs in elasticache to verify any problem, or do you have any other recommendations on how we can improve performance or identify the root cause of the latency we are observing?

Thank you,
Rob"
Amazon Elasticache	"Cannot connect to Elasticache
Hi,

I have just created a new Elasticache instance with 1 node. Once it booted I created a new Security Group in the same VPC and assigned access from the EC2 Security Group. I then SSHed into my EC2 box and trying to ping the Elasticache node, and got nothing.

I then tried putting the EC2 box and Elasticache in the same Security Group and still nothing. I then  recreated the Elasticache cluster following the online documentation, and nothing.

Is there something special I need to do here?

Thanks,
Nick"
Amazon Elasticache	"Re: Cannot connect to Elasticache
Sorry, duns moment. This was a firewall issue."
Amazon Elasticache	"Re: Cannot connect to Elasticache
I have the same issue. Can you explain what firewall issue is?"
Amazon Elasticache	"Elasticache No Security Groups Available
Hi, 

Im trying to create an Elasticache Memcached cluster using the GUI console, but for some reason I cannot see any of my security groups listed on step 3 : Configure Advanced Settings.

I DO have security groups, and our current infrastructure uses them in the VPC.
Is there a reasonable reason why they wouldnt show for Elasticache

Any suggestions are much appreciated. Cheers

Martin"
Amazon Elasticache	"Re: Elasticache No Security Groups Available
Hi,
ElastiCache only shows VPC security groups which has the same VPC as the cache subnet group you select.
Can you check a few things:
1. In ElastiCache console, go to ""Cache Subnet Groups"" section and check the VPC of your cache subnet group. Let's say the VPC is vpc-123456.
2. In VPC console, go to ""Your VPCs"", make sure vpc-123456 exists.
3. In VPC Console, go to ""Security Groups"", find all the VPC security groups with vpc-123456. Say they are sg-001, sg-002 and sg-003
4. Go back to ElastiCache console, click ""Launch Cache Cluster"" and in Step 3: Configure Advanced Settings select your cache subnet group in ""Cache Subnet Group"" drop down list and see are sg-001, sg-002 and sg-003 there. If not, please let me know.
Thank you.
Qin"
Amazon Elasticache	"Re: Elasticache No Security Groups Available
Hi Qin, thanks for helping

I tried your steps to no avail.

What i have noticed thought, is that the cache subnet group doesnt show my subnet groups, but my vpc id.
I added another subnet to try and get the dropdown to show multiple options but it still shows just the vpc id 
I this the correct behaviour?

Martin"
Amazon Elasticache	"Re: Elasticache No Security Groups Available
Hi,
This issue is related to deleting default VPC and a hot fix was applied to fix the problem. Please check can you see your VPC security groups now.
Qin"
Amazon Elasticache	"My custom VPC isn't showing up while creating cluster
I followed instructions available on AWS docs and also few threads which reported the same due to not creating ""cache subnet group"". 
Have tried creating cache subnet group, but still, only default VPC shows up while creating cluster. 

What could I be possibly missing?

Thanks..."
Amazon Elasticache	"Re: My custom VPC isn't showing up while creating cluster
Hi,
Can you check a few things:
1. In ElastiCache console, go to ""Cache Subnet Groups"" section and check the VPC of your cache subnet group. Let's say the VPC is vpc-123456.
2. In VPC console, go to ""Your VPCs"", make sure vpc-123456 exists.
3. In VPC Console, go to ""Security Groups"", find all the VPC security groups with vpc-123456. Say they are sg-001, sg-002 and sg-003
4. Go back to ElastiCache console, click ""Launch Cache Cluster"" and in Step 3: Configure Advanced Settings select your cache subnet group in ""Cache Subnet Group"" drop down list and see are sg-001, sg-002 and sg-003 there. If not, please let me know.
Thank you.
Qin"
Amazon Elasticache	"Migrating to Multi-AZ
I have an existing ElastiCache replication group that contains two nodes in separate availability zones. I have one node set as the primary and the other node set as a read replica.

With the launch of Multi-AZ support, I see there is now a ""Multi-AZ"" option when modifying this replication group in the AWS Management Console.

My question is, will enabling ""Multi-AZ"" on my existing replication group, simply enable automatic failover of my existing nodes, or will my nodes be destroyed and re-created? Put another way, is this a safe operation or will the data on these nodes be lost?

Thanks, in advance."
Amazon Elasticache	"Re: Migrating to Multi-AZ
Hi there,

Changing your pre-existing cluster to multi-AZ should not purge any of your cache data. Just to be sure, I just did this against my own cluster and nothing was lost.

If for any reason things don't go as planned, enabling AOF could give your data the extra safe guard you need in the event of an unexpected reboot.

I hope this helps!"
Amazon Elasticache	"How to access CPUCreditBalance for T2 cache clusters?
As the title says: ""How to access CPUCreditBalance for T2 cache clusters?""

They are not available in CloudWatch, and they are not in the ElastiCache console either.
The T2's have the highest memory/$ ratio except for te R2's, and I have a relatively low-trafic app that needs a cheep in-memory cache.

I do, however, want to monitor the CPUCreditBalance value to determine the best T2 size and to use in alarms etc. How do I access these? It is possible with RDS.

Erik"
Amazon Elasticache	"ElastiCache Failed, DNS Corrupted?
All of a sudden one of our instances cannot communicate with our ElastiCache node.  

The endpoint now is reporting an very odd entry from the DNS
----
dig a MYCO.ntlrug.cfg.use1.cache.amazonaws.com
MYCO.ntlrug.cfg.use1.cache.amazonaws.com. 60	IN CNAME ec2-23-20-43-33.compute-1.amazonaws.com.
ec2-23-20-43-33.compute-1.amazonaws.com. 169332	IN A 23.20.43.33
----

Check out that TTL and the IP seems odd.  If I try to 'dig' this record on another host, the answer is more reasonable.
---
MYCO.ntlrug.0001.use1.cache.amazonaws.com. 60 IN CNAME ec2-23-20-43-33.compute-1.amazonaws.com.
ec2-23-20-43-33.compute-1.amazonaws.com. 60 IN A 10.159.43.125
---

Both host have the exact same contents of /etc/resolv.conf and /etc/hosts; as follows.





resolv ---





nameserver 172.16.0.23
search ec2.internal
---






/etc/hosts ---





127.0.0.1 localhost
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts
---

Pretty confused how my one host got such an odd entry."
Amazon Elasticache	"Re: ElastiCache Failed, DNS Corrupted?
Update:
The host that was failing for a short moment reported the correct address and was able to connect to the memcached

MYCO.ntlrug.cfg.use1.cache.amazonaws.com. 60	IN CNAME ec2-54-242-66-148.compute-1.amazonaws.com.
ec2-54-242-66-148.compute-1.amazonaws.com. 60 IN A 10.29.207.46


But, after a few minutes it's now back to resolving to the 23.x.x.x address."
Amazon Elasticache	"Re: ElastiCache Failed, DNS Corrupted?
Hi edoceo,
What AWS region are your clusters in?"
Amazon Elasticache	"Is it possible to run my process on AWS elastic-cache instance?
Hi,

Is it possible to run my process on AWS elastic-cache instance? I'd like to upload objects from 
 redis DB to S3, and, if possible, eliminate the network read traffic if I place my process on an external EC2 instance."
Amazon Elasticache	"Re: Is it possible to run my process on AWS elastic-cache instance?
Hi there,

This isn't possible as there's no interactive access to the cache nodes beyond connecting it via the end-points.

With Redis, if you are having a performance issue with reading and writing to your node, may I suggest creating a read replica node? The idea is to make writing new data to the primary node exclusively while the read is done through the replica. This allows effectively reduces on any individual node while providing a fail-over solution.

With Memcached, having more nodes in the cluster will help spread the network communication to multiple nodes, especially if you take advantage of the Auto Discovery client.

Otherwise, you will need to create and manage your own Redis/Memcache in your own EC2 instance that you have full control over."
Amazon Elasticache	"EC2 VPC instance would get ElastiCache connection timeout error somehow
Hi,

I recently ran into a problem: a new EC2 VPC instance launched from AMI image would get ElastiCache connection timeout error somehow.
The problem seems to appear randomly. I have launched more then 10 EC2 VPC instances these days and the connection timeout error only recurred twice (2 instances got the error.)

The timeout error is permanent, and here is the error message in log: ""Redis::CannotConnectError (Timed out connecting to Redis on xxx.cache.amazonaws.com:6379)""

Please help, Thanks!"
Amazon Elasticache	"Re: EC2 VPC instance would get ElastiCache connection timeout error somehow
Hi there,

What you're seeing might be related to the recent maintenance event that took place over the weekend a few days ago. The service has now been back to normal operations.

Are you still seeing this issue, by any chance? If so, could you tell us how to find your cache cluster so we can help figure out what's happening?"
Amazon Elasticache	"Redis cluster stuck in creating state and master_link_status:down
Hi, I've created a read replica in my replication group but it is creating since more than 2 hours. 
This node is a replacement for the other read replica who lost connectivity with master node:

INFO 
#Replication 
role:slave
master_host:<master_node>
master_port:6379
master_link_status:down
master_last_io_seconds_ago:-1
master_sync_in_progress:1
slave_repl_offset:1
repl_sync_enabled:1
master_sync_left_bytes:-1
master_sync_last_io_seconds_ago:1
master_link_down_since_seconds:1411784730
slave_priority:100
slave_read_only:1
connected_slaves:0
master_repl_offset:0
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

I've noticed that the command SLAVEOF is disabled for elasticache Redis nodes. 
There are any way to get it online? 
Thanks in advance.

Edited by: josepeinado on Sep 26, 2014 8:38 PM

Edited by: josepeinado on Sep 26, 2014 9:14 PM"
Amazon Elasticache	"Re: Redis cluster stuck in creating state and master_link_status:down
After 6 hours the read node was created, besides, the node with master_link_status:down was reconnected. All these actions were done automatically, so I guess that these behaviours were related to maintenance AWS happened this past weekend."
Amazon Elasticache	"Re: Redis cluster stuck in creating state and master_link_status:down
Hi there,

You're right that SLAVEOF isn't available in ElastiCache. The reason is because the product is designed with an abstraction to access these things via API calls (i.e. through the console or CLI). Here's a list of commands that are not available to Redis in ElastiCache:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ClientConfig.html#ClientConfig.RestrictedCommands

That being said, if you'd like to create a manual slave, you can certainly do that by installing Redis in an EC2 instance and running that command that points to the Primary Redis node in ElastiCache. That will allow you to run SAVE/BGSAVE and push the data to a location of your own choosing, such as your S3 bucket.

The delay that you're seeing was likely due to the maintenance event that happened over the weekend, but everything should be back to normal now. Let me know if you're still experiencing delays and we'll take a look at that to make sure that the service is back up."
Amazon Elasticache	"No Cache Cluster available to Creating Cache Snapshot
Hi,

I created a new redis cache cluster without specifying an s3 bucket initially and I would now like to setup a regular snapshot.  I can't however select hte cache cluster with the UI.

Should I be able to create a snapshot after the cluster is setup, and if so how?

Thanks,
Julian."
Amazon Elasticache	"Re: No Cache Cluster available to Creating Cache Snapshot
Hi Julian,

You can still do that by going to the Snapshot section in the ElastiCache management console. When you click the ""Create Snapshot"" button, select the name of the cache cluster from the drop-down list. Give your snapshot a name and click ""Create"" when you're ready:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingSnapshots.html#ManagingSnapshots.Manual

As a side note, the S3 Snapshot Location field is there if you have a previous snapshot data that you would like to seed your new cache cluster with. Otherwise, you can leave it blank.

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingSnapshots.html (see ""Seed a Cache Cluster With RDB File Data"", about 85% down)

I hope this is helpful!"
Amazon Elasticache	"Redis cluster became inaccessible from after the system-reboot of 28.09.14
During last night's AWS maintenance window, amongst others of our servers, two of our PHP servers
were rebooted. It is imperative for them to have fast and reliable access to our Redis Cluster.
The Cluster is comprised of 1 Master node and 3 Read Replicas.

Since I took all steps required for this operation, everything went smoothly (took out the affected PHP nodes from the cluster, saw them being rebooted, all good).

However after these two servers went back online, the other servers that were left in the PHP cluster, started having problems accessing the Redis Cluster.

I then started investigating the Elasticache Redis Cluster and saw some very weird problems (see screenshots):
1. some of the nodes from both our two Redis Clusters were restarted *
2. some of the nodes have fallen out of the availability zone
3. then, after one hour away since #1 took place, some other Redis nodes were restarted as well.

this did not happen in the Redis Cluster's designated maintenance window, nor was announced by AWS


Still, after more than one hour since this fiasco started, I was unable to get the other PHP nodes to connect to the Redis cluster.
Quite interestingly, only the two servers that were rebooted by AWS were now able to connect to the Redis Cluster.

I could connect from the problematic servers, but when I issued the command ""keys *"" on the redis-cli, it just hung indefinitely. Issuing the same command on the servers that were able to work with the Redis Cluster, just went through fine and showed me all the keys in the cluster.

Interesting fact: when I issued the ""FLUSHALL"" command on the redis-cli, from a server that couldn't use the Redis Cluster, and right after that, issued the command ""keys *"" numerous times, quickly one after another, I got to see how new keys were being added, and then all the sudden, one last ""keys *"" command hanged again indefinitely making the PHP node not able to use the Redis Cluster.

I then tried rebooting the troublesome PHP servers from their CL. They went down, but never up. Please keep in mind that these servers were not rebooted by AWS, as they were out of the scope of the maintenance window for their system-reboot.
I tried rebooting them from AWS Management Console and AWS API. Still nothing.
I then stopped them via AWS MC. I detached their root EBS-backed storages, attached it to another random instance, mounted, unmounted, re-attached them to their original instances and started the instances via AWS MC.
They booted up nicely, and what do you think: they were able to access the Redis Cluster just fine.
Proceeded with the automated re-provisioning through awesome Ansible, deployed my APP, put them back in the PHP cluster and went to bed. What a night.

Hopefully I didn't forget any aspects whatsoever. I can provide timestamps of all facts and in-depth details if anyone would be interest (AZs, defined maintenance intervals, software versions, etc.)

All the best,

Dan V.

Edited by: dvaida on Sep 28, 2014 3:32 AM

Edited by: dvaida on Sep 28, 2014 3:32 AM"
Amazon Elasticache	"Re: Redis cluster became inaccessible from after the system-reboot of 28.09.14
Hi dvaida,

I'm truly sorry for the concern and inconvenience this has caused you. Could you kindly provide the instance ids of the instances that were left in the PHP cluster that were having connection issues?

Once I have this information I'll take a look and see if I can determine why they were having troubles connecting to your Redis Cluster.

I look forward to hearing back from you!"
Amazon Elasticache	"Re: Redis cluster became inaccessible from after the system-reboot of 28.09.14
Sure, here they are:
i-0d75ec4e
i-fa3847b9
i-07311245
Thanks."
Amazon Elasticache	"Re: Redis cluster became inaccessible from after the system-reboot of 28.09.14
Hi,

Thanks for the info. I'm going to send you a PM shortly.

Cheers,"
Amazon Elasticache	"AmazonRDS and ElastiCache
Friends,

I want create an ElastiCache cluster and want to bind it with my exisntg java based web application's amazon RDS.  So Here are my questions:

1) How can I create an ElastiCache for existing amazon RDS and cache as much as data possible that is in DB?
2) What cache is suitable in my case Memcache or Radis?
3) Whenever RDS is updated would ElastiCache will be updated automatically? or Do i need to take some steps?
4) I could not find any example to retirve the data from ElastiCache using java. For example i want to access list of transactions performed by users in past 24 hours. How would i get this data?

Please provide your opinioun or any other best solutoin that i can make use to incase the app performence. 

Regards,
MP."
Amazon Elasticache	"Memcache logs piling up in Application server, Non stop.
Hello,

I am implemented Elastic Memcahce in Java and deployed on Jboss application server with the below code, When i deployed on AWS, some how getting non stop loggers as below which eating my server log size. Can some one please help me is something need do settings.

		String configEndpoint = ""approdnode.axw63773.cfg.usw2.cache.amazonaws.com"";
		Integer clusterPort = 11211;
		MemcachedClient client = new MemcachedClient(new InetSocketAddress(configEndpoint, clusterPort));
		client.set(""key1"", 1000, ""Madhu"");
		System.out.println(""----Get From Cache-----""+client.get(""key1""));
		client.shutdown();

Application server Logs:
10:09:13,600 ERROR stderr (pool-2045-thread-1) 2014-09-16 10:09:13.600 INFO net.spy.memcached.ConfigurationPoller:  Endpoint to use for configuration access in this poll NodeEndPoint - HostName:aptestnode.axw939.0001.usw2.cache.amazonaws.com IpAddress:10.187.1.87 Port:11211
10:09:13,675 ERROR stderr (pool-2047-thread-1) 2014-09-16 10:09:13.675 INFO net.spy.memcached.ConfigurationPoller:  Starting configuration poller.
10:09:13,679 ERROR stderr (pool-2047-thread-1) 2014-09-16 10:09:13.678 INFO net.spy.memcached.ConfigurationPoller:  Endpoint to use for configuration access in this poll NodeEndPoint - HostName:aptestnode.axw939.0001.usw2.cache.amazonaws.com IpAddress:10.187.1.87 Port:11211
10:09:13,947 ERROR stderr (pool-2054-thread-1) 2014-09-16 10:09:13.947 INFO net.spy.memcached.ConfigurationPoller:  Starting configuration poller.
10:09:13,950 ERROR stderr (pool-2054-thread-1) 2014-09-16 10:09:13.950 INFO net.spy.memcached.ConfigurationPoller:  Endpoint to use for configuration access in this poll NodeEndPoint - HostName:aptestnode.axw939.0001.usw2.cache.amazonaws.com IpAddress:10.187.1.87 Port:11211
10:09:14,250 ERROR stderr (pool-2062-thread-1) 2014-09-16 10:09:14.249 INFO net.spy.memcached.ConfigurationPoller:  Starting configuration poller.
10:09:14,253 ERROR stderr (pool-2062-thread-1) 2014-09-16 10:09:14.253 INFO net.spy.memcached.ConfigurationPoller:  Endpoint to use for configuration access in this poll NodeEndPoint - HostName:aptestnode.axw939.0001.usw2.cache.amazonaws.com IpAddress:10.187.1.87 Port:11211
10:09:15,650 ERROR stderr (pool-297-thread-1) 2014-09-16 10:09:15.650 INFO net.spy.memcached.ConfigurationPoller:  Starting configuration poller.
10:09:15,654 ERROR stderr (pool-298-thread-1) 2014-09-16 10:09:15.654 INFO net.spy.memcached.ConfigurationPoller:  Starting configuration poller.
10:09:15,657 ERROR stderr (pool-298-thread-1) 2014-09-16 10:09:15.657 INFO net.spy.memcached.ConfigurationPoller:  Endpoint to use for configuration access in this poll NodeEndPoint - HostName:aptestnode.axw939.0001.usw2.cache.amazonaws.com IpAddress:10.187.1.87 Port:11211
10:09:15,663 ERROR stderr (pool-297-thread-1) 2014-09-16 10:09:15.663 INFO net.spy.memcached.ConfigurationPoller:  Endpoint to use for configuration access in this poll NodeEndPoint - HostName:aptestnode.axw939.0001.usw2.cache.amazonaws.com IpAddress:10.187.1.87 Port:11211
10:09:16,091 ERROR stderr (pool-2555-thread-1) 2014-09-16 10:09:16.091 INFO net.spy.memcached.ConfigurationPoller:  Starting configuration poller.
10:09:16,095 ERROR stderr (pool-2555-thread-1) 2014-09-16 10:09:16.095 INFO net.spy.memcached.ConfigurationPoller:  Endpoint to use for configuration access in this poll NodeEndPoint - HostName:aptestnode.axw939.0001.usw2.cache.amazonaws.com IpAddress:10.187.1.87 Port:11211
10:09:16,101 ERROR stderr (pool-2556-thread-1) 2014-09-16 10:09:16.101 INFO net.spy.memcached.ConfigurationPoller:  Starting configuration poller."
Amazon Elasticache	"Elasti-Cache Performance Issues since 20:10 UTC on the 11th September
Is there currently a performance problem with the Elasti-Cache servers (Ireland) which started around 20:10 UTC on the 11th September (yesterday)?

I manage a AWS hosted solutions which has been running fine for the last 18 months with a average latency through the ELB to my EC2 machines of between 0.17 and 0.23 seconds.  However since this this time, the latency has gone went crazy.

I have managed to traced the problem to Elasti-Cache.  When I disable Elasti-cache from being used the latency drops back to to the levels I use to receive before Elasti-cache was introduced to improve performance.

I have attached four images from the ELB monitor showing latency.

The first, two-weeks.JPG, showsthe previous two weeks which is the normal trend I would expect. There was a spike a couple of days ago due to an issue with the EC2 boxes though that was fixed and everything returned to the expected figures until today.

The 2nd image (today.JPG) shows the problem starting at the time I mention. You can see that it keeps spiking there on after.

recentt.JPG  shows the last couple of hours with the drop at around 14:08 UTC being when I turned off the use of Elasticachhe.  I then dropped the cluster completely (it was an old M1.large cluster with 2 nodes). I created a new cluster (R3.large) with two nodes and re-populated it with a sample of data (probably 25% of what was on the old instances). I then turned support for the Elasti-cache back on and the latency immediately spiked again until I turned it back off around 14:40 UTC (you'll see the drop which then returns to flatline at the levels I would expect.

The final image, last-night.JPG, shows the latency upto the beginning of the spike.  No changes had to made to the hardware or software within 4 hours nor did the number of inbound requests increase.  Load on the RDS' that are used to populate the Elasti-Cache also remained consistent with previous levels, the only difference was the response time of the servers.

At the moment I can run without Elasti-Cache being enabled but I was hoping to find out why the performance of them suddenly dropped well beyond levels acceptable to my application"
Amazon Elasticache	"Re: Elasti-Cache Performance Issues since 20:10 UTC on the 11th September
Any thoughts? I've now kept the use of ElastiCache off since Friday and everything is as it should be which proves that the Elasti-Cache usage is the problem.  I still want to use it though only if the latency connecting to the Elasti-cache servers go back to previous levels and not the end of last week where it's unusable.

To give you an idea, I have a PHP script which use to take 60 seconds to run to populate the Elasti-cache server. As of the end of last week that script now takes 500 seconds to run.  The script has not changed nor has the data increased more than 2% so there is no reason for the unexpected performance loss

Edited by: stevemapes on Sep 15, 2014 1:51 AM"
Amazon Elasticache	"Re: Elasti-Cache Performance Issues since 20:10 UTC on the 11th September
As a further update, having deleted the new R3 Cache Cluster and created another 2 node R3 cluster I am able to connect and read/write again with the only difference being the nodes names.  Response times are back as they were before last week and my 60 second script is now back at around the same time.

Below is a simple test script I had which was working on the original M1 Cache cluster, failed (without error) replacement R4 cluster and then worked on the 2nd new R3 cache cluster.  The only difference was the name of the nodes. Names were treble checked no errors were generated, I have error reporting on all, so I am still at a loss as to why the original cluster suddenly ran so slow or why the replacement fresh build also failed to set/get correctly.  From the Elasti-cache webstats it did look like data was being written and connections were being established.

<?php
$servers = array(
            0 => array(
                'endpoint' => 'CACHE_NAME.STUFF.0001.euw1.cache.amazonaws.com',
                'port' => 11211,
                'weight' => 0,
            ),
            1 => array(
                'endpoint' => 'CACHE_NAME.STUFF.0001.euw1.cache.amazonaws.com',
                'port' => 11211,
                'weight' => 0,
            ),
);

$memcached = new Memcached();
$memcached->addServers($servers);

$obj = new stdClass();
$obj->name = 'Steve';
$memcached->set('Test1', 'Hello', 60);
$memcached->set('Test2', $obj, 60);

var_dump( $memcached->get('Test1') );
echo ""\n"";
var_dump( $memcached->get('Test2') );
echo ""\nEND\n"";

?>

Whilst my problem is now resolved I am not going to mark this thread as resolved as I would still like to know why it happened and whether it will do again.  Killing clusters for a few days is not an acceptable solution."
Amazon Elasticache	"Migrating from t1.micro to t2.micro cluster
There doesn't appear to be a way add t2 nodes to an existing cluster, allowing them to sync, then removing the t1 nodes.

I'd also like to avoid having to change my configuration endpoint address, because that's in various places in my code. It wouldn't be impossible to update, but...

So, without changing the endpoint address, how can I either add t2 nodes to an existing cluster, or create a new cluster with the same configuration endpoint address as the existing one?

Thanks."
Amazon Elasticache	"Re: Migrating from t1.micro to t2.micro cluster
Hi,

We have passed on your question to our service team and will post the answer on this forum thread.

Kind regards
Tony"
Amazon Elasticache	"Re: Migrating from t1.micro to t2.micro cluster
Hello,

Our service team has confirmed that either of those things are not possible. That means we cannot add t2.micro nodes to a t1.micro cluster nor can recreate a cluster with the same configuration endpoint as it is randomly assigned when the cluster is created.

The best course of action unfortunately is to create a new t2.micro cluster and switch to using the new configuration endpoint.

Kind regards
Tony"
Amazon Elasticache	"Re: Migrating from t1.micro to t2.micro cluster
Not the answer I was looking for, but definitive."
Amazon Elasticache	"When T2 istances will be available?
Easy question:
When T2 istances will be available?

thanks"
Amazon Elasticache	"Re: When T2 istances will be available?
+1"
Amazon Elasticache	"Re: When T2 istances will be available?
They are available now, but I don't see a way to buy reserved cache nodes for them yet."
Amazon Elasticache	"Re: When T2 istances will be available?
correct!"
Amazon Elasticache	"Elasticache Session Issue
Hello,

I am using Elasticache(to cache php sessions) along with ElasticBean Stalk, which appears to be working, at least most of the time. The issue is that some sessions will last seconds and kick me out of the php application, while some will last until its actually supposed to time out (15min). The problem happens really erratically and is extremely annoying.

-Thanks."
Amazon Elasticache	"Creating snapshot using boto.elasticache
Hi,

Is there an option to create snapshots using boto.elasticache?
i didn't find 

Thanks,

Robi"
Amazon Elasticache	"Elasticache timeouts only on t1.micro
We are using a t1.micro instance running memcached 1.4 for session management between two servers. The servers run Ubunutu 12.04 TLS, apache and PHP. We are using native PHP sessions, and are seeing intermittent memcached connection errors, though both the application servers and elasticache node are very lightly loaded (<5% CPU).  There doesn’t appear to be network or memory pressure, either.

We were able to reproduce the issue, using a separate t1.micro elasticache/memcached instance and a dedicated application server. We used a simple php script, which opens a memcached connection, writes a value, reads a value, and closes the connection. When we do this very fast, everything works as expected. When we space the connections out to every 1.5 seconds, we see intermittent failures. In addition, when we tested against a m3.xlarge elasticache/memcached instance, we no longer saw connection issue.

Has anyone else experienced similar problems running t1.micro elasticache nodes? Is there a workaround? The node doesn’t look resource constrained, and I’d rather not upgrade if I don’t have to."
Amazon Elasticache	"Re: Elasticache timeouts only on t1.micro
We're getting the same issue.

PHP errors:
PHP Warning:  Unknown: Key cannot be empty in Unknown on line 0, referer: ****
Tue Aug 26 20:04:08.323079 2014 :error pid 23090 client 10.65.62.129:16022 PHP Warning:  Unknown: Failed to write session data (memcache). Please verify that the current setting of session.save_path is correct (****) in Unknown on line 0, referer: ****

(snipped at ***)"
Amazon Elasticache	"Elasticache node not evicting
We recently setup a new cache cluster with 1 m1.large cache node and change our configs to have our servers to start using it.

We're not seeing any of our cache items being evicted, which is causing our node to start swapping and degrading performance. In total, our items are taking up just over 9gb (7.5ish gb + 1.5gb swap). We do have items being reclaimed, but none evicted.

My understanding of how memcache works is that if it runs out of space, it starts evicting the LRU item. Am I missing something or some config?

We're using the default memcached config

Edited by: Benny Wong on Mar 17, 2014 2:37 PM"
Amazon Elasticache	"Re: Elasticache node not evicting
I think we may have found the issue. The node was not reporting it's unused memory, which leads me to believe that it didn't know it was hitting swap and thus not evicting anything: http://cl.ly/image/0X020i0x3h3w

Has anyone else seen this before? AWS can you confirm that this is the issue?"
Amazon Elasticache	"Re: Elasticache node not evicting
Hi Benny

Did AWS get back to you on this issue? We're seeing something similar but on a Redis instance.

Thanks

Tahir"
Amazon Elasticache	"Incorrect reporting of FreeableMemory for Elasticache Redis instance
Hi

The Cloudwatch graphs are showing a very low value for the 'FreeableMemory' metric - 1.1 GB (1,185,607,680 bytes) although memory usage as per the 'INFO' command on redis-cli and 'BytesUsedForCache' metric is very low.

redis-cli INFO output:
# Memory
used_memory:7008928
used_memory_human:6.68M
used_memory_rss:316116992
used_memory_peak:973830952
used_memory_peak_human:928.72M
used_memory_lua:33792
mem_fragmentation_ratio:45.10
mem_allocator:jemalloc-3.2.0
 
# Stats
total_connections_received:1425
total_commands_processed:2663671
instantaneous_ops_per_sec:81
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:3280
evicted_keys:0
keyspace_hits:2910797
keyspace_misses:52446
pubsub_channels:0
pubsub_patterns:3
latest_fork_usec:1802
 
# Keyspace
db0:keys=1135,expires=1134,avg_ttl=1237182941
db1:keys=814,expires=814,avg_ttl=7775655833
db2:keys=23,expires=21,avg_ttl=86084677
db4:keys=2,expires=0,avg_ttl=0
db8:keys=2,expires=0,avg_ttl=0

The 'BytesUsedForCache' metric is showing the expected value of 6.6 MB.

The above numbers were generated shortly after a FLUSHALL command.

The instance type is 'cache.m3.medium', running Redis 2.8.6, and the expected value for the FreeableMemory metric is around 2.6 GB. 

Any idea what the issue could be?

Thanks in advance

Tahir

Edited by: tahirsharif_tbh on Sep 2, 2014 5:30 AM
fixed typo"
Amazon Elasticache	"Re: Incorrect reporting of FreeableMemory for Elasticache Redis instance
Hi Tahir,

These two metrics measure different things. Here's how these metrics are defined:

BytesUsedForCache[1] - The total number of bytes allocated by Redis.
FreeableMemory[2] -  The amount of free memory available on the host. 

What's not being accounted for here is the amount of memory consumed by the operating system. What you can do is predefine that amount of memory so you can simplify your calculations. The parameter name that you're looking for is this:

reserved-memory[3] - The amount of memory, in bytes, reserved for non-cache usage.

I hope this helps!

Link(s):
1. http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.Redis.html
2. http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.HostLevel.html
3. http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html"
Amazon Elasticache	"Re: Incorrect reporting of FreeableMemory for Elasticache Redis instance
Hi Rendy

Thanks for the response.

I realise they are very different metrics but ultimately the numbers don't add up.

The reserved memory has been set to set to 104 MB (104,857,600 bytes). Currently, 304,924,232 bytes is the value for BytesUsedForCache and 1,659,087,530 bytes for FreeableMemory.

That leaves a deficit of around 650 MB. I can't believe that the OS, even if the reserved-memory was not set, could be this high.

Almost two weeks ago, the FreeableMemory was 2,716,577,79 bytes - after a reboot and flush - but has not returned to that level despite repeating the reboot and flush multiple times.

So the question remains - is there a issue with cloudwatch reporting or is some unknown process eating memory? 

Tahir"
Amazon Elasticache	"Change Engine Reserved Instance
Hello,

I bought a cache cluster reserved for memcache, however now I'm using redis, I can just remove the cluster and create a memcache and redis will continue with reservation?

Att;"
Amazon Elasticache	"Elastic Beanstalk + Cluster Client for PHP installation problems.
I'm having trouble getting the Cluster Client for PHP installed on my elastic beanstalk instance.  

First off, here's my environment.  

64bit Amazon Linux 2014.02 v1.0.1 running PHP 5.5

Here are the .ebextensions commands I'm executing:

The first file:

files:
    ""/tmp/latest-64bit"" :
        mode: ""000777""
        owner: ec2-user
        group: ec2-user
        source: http://elasticache-downloads.s3.amazonaws.com/ClusterClient/PHP-5.5/latest-64bit


The second file:

commands:
    03install:
        command: ""yum -y update""
    03install:
        command: ""yum -y install gcc-c++ php php-pear""
    04install:
        command: ""yum -y remove php-pecl-memcached""
    05install:
        command: ""pecl install /tmp/latest-64bit""
    06install:
        command: 'echo ""extension=amazon-elasticache-cluster-client.so"" | sudo tee /etc/php.d/memcached.ini'


But I get the following error in my log file:

2014-05-17 11:47:09,789 [INFO] (25524 MainThread) [directoryHooksExecutor.py-29] [root directoryHooksExecutor info] Output from script: PHP Warning:  PHP Startup: memcached: Unable to initialize module
Module compiled with module API=20100525
PHP    compiled with module API=20121212
These options need to match
 in Unknown on line 0
PHP Warning:  PHP Startup: memcached: Unable to initialize module
Module compiled with module API=20100525
PHP    compiled with module API=20121212
These options need to match
 in Unknown on line 0
PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib64/php/5.5/modules/memcached.so' - /usr/lib64/php/5.5/modules/memcached.so: cannot open shared object file: No such file or directory in Unknown on line 0
Using configuration value for DocumentRoot: /public_html


I believe that's the error when using the wrong version of Cluster Client for the Environment, but I believe I'm using the correct one.  

Anyways, thanks for any help getting this straightened out."
Amazon Elasticache	"Re: Elastic Beanstalk + Cluster Client for PHP installation problems.
Hi there,

Looks like some dependencies are not met or installed using the command ""yum -y install gcc-c++ php php-pear"". Are you able to run this command manually on the instance and does it install everything correctly?
sudo yum -y install gcc-c++ php php-pear

If you are running php version 5.5 which can be determined by running ""php -v"" then the cluster client you've chosen is of the right version. Please see if fixing any possible dependency errors on the above command will resolve the issue. Otherwise, kindly send us the full beanstalk config files and any logs related to yum and cfn-*.log so we can troubleshoot further.

Kind regards
Said S"
Amazon Elasticache	"Re: Elastic Beanstalk + Cluster Client for PHP installation problems.
Yeah, tried that and it didn't change anything.  

Basically what I'd love to get is just a list of all the commands I need to put in the .ebextensions files to get the Elasticache Client for PHP working in the 64bit Amazon Linux 2014.03 v1.0.3 running PHP 5.5 environment.  I've tried a bunch of different combinations but nothing seems to get it working.   I can install and get it working fine in ubuntu or on a regular ec2 Amazon linux box, but I can't get it working properly in EB."
Amazon Elasticache	"Re: Elastic Beanstalk + Cluster Client for PHP installation problems.
Here's my latest attempt:

files:
    ""/tmp/latest-64bit"" :
        mode: ""000777""
        owner: ec2-user
        group: ec2-user
        source: http://elasticache-downloads.s3.amazonaws.com/ClusterClient/PHP-5.5/latest-64bit
commands:
    01install:
        command: ""yum -y update""
container_commands:
    02install:
        command: ""yum -y remove php-pecl-memcached""
    03install:
        command: ""tar -xvf /tmp/latest-64bit -C /tmp""
    04install:
        command: ""cp /tmp/AmazonElastiCacheClusterClient-1.0.0/amazon-elasticache-cluster-client.so /usr/lib64/php/5.5/modules/amazon-elasticache-cluster-client.so""
    05install:
        command: ""touch /etc/php.d/memcached.ini""
    06install:
        command: 'echo ""extension=/usr/lib64/php/5.5/modules/amazon-elasticache-cluster-client.so"" >> /etc/php.d/memcached.ini'"
Amazon Elasticache	"Re: Elastic Beanstalk + Cluster Client for PHP installation problems.
Should I add an additional command:

07install:
        command: 'echo ""extension=/usr/lib64/php/5.5/modules/amazon-elasticache-cluster-client.so"" >> /etc/php-5.5.d/memcached.ini'"
Amazon Elasticache	"Re: Elastic Beanstalk + Cluster Client for PHP installation problems.
I've got it to pretty much work like this
commands:
  21elasti_dependencies:
    command: ""yum -y install gcc-c++ php-pear""
  22elasti_remove existing memcached:
    command: ""yum -y remove php-pecl-memcached""
  23elasti_install:
    command: ""pecl install /tmp/latest-64bit""
  99retart_server: 
    command: service httpd restart
    cwd: /tmp
files:
  ""/tmp/latest-64bit"" :
    mode: ""000777""
    owner: ec2-user
    group: ec2-user
    source: http://elasticache-downloads.s3.amazonaws.com/ClusterClient/PHP-5.5/latest-64bit


But actually it doesnt because it requires a dependency not available on CentOS 6:
PHP Warning:  PHP Startup: Unable to load dynamic library '/usr/lib64/php/5.5/modules/amazon-elasticache-cluster-client.so' - /lib64/libc.so.6: version `GLIBC_2.14' not found (required by /usr/lib64/php/5.5/modules/amazon-elasticache-cluster-client.so) in Unknown on line 0


Why is GLIBC_2.14 a dependency when it's difficult to get anything beyond GLIBC 2.12 on CentOS?"
Amazon Elasticache	"Re: Elastic Beanstalk + Cluster Client for PHP installation problems.
Same problem on an elastic beanstalk php 5.5 instance....
The cache client package just has a precompiled .so and stuff in it:
-rwxrwxr-x 1 ec2-user ec2-user 1197136 May  3 01:06 amazon-elasticache-cluster-client.so
-rw-r--r-- 1 ec2-user ec2-user     171 May  3 01:06 INSTALL
-rw-r--r-- 1 ec2-user ec2-user    8838 May  3 01:06 LICENSE
-rw-r--r-- 1 ec2-user ec2-user    6695 May  3 01:06 memcached-api.php
-rw-r--r-- 1 ec2-user ec2-user    2144 May  3 01:06 memcached.ini
-rw-r--r-- 1 ec2-user ec2-user     847 May  3 01:06 README.markdown

all the 'install' is doing is copying the .so to '/usr/lib64/php/5.5/modules/amazon-elasticache-cluster-client.so' 
... the easy workaround is to just gunzip and tar x the file, and copy it yourself, and edit the etc/php.d/  ini file manually."
Amazon Elasticache	"Can I access ElastiCache from outside Ec2 ?
The documentation talks of granting access to Ec2 User group.
Can I telnet to ElastiCache from outside Ec2 (i.e. outside AWS) ?

Thanks."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
Not currently.

http://aws.amazon.com/elasticache/faqs/#Can_I_access_Amazon_ElastiCache_from_outside_AWS

-Michael"
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
This is a huge thing for us as we'd love the ability to access this server outside of the EC2 cloud. Kind of a deal breaker not being able to test outside of it."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
Could you please describe your use case for accessing ElastiCache from outside AWS? Is it primarily for testing or you intend to use the service from outside AWS for production use cases (given the latency considerations)? 

Thanks,
Pavan"
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
From my experience, small amounts of network latency can kill the benefits that memcache can provide, and so its a valid point why you want to use ElasticCache from outside AWS.

It would depend on the app and hows its using the cache, but in most circumstances I think latency needs to be absolutely minimal."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
I hope that AWS never opens up access to ElastiCache outside of EC2.  Memcached requires almost no configuration to run locally for development/testing/integration.  I am fine not dealing with the additional security configuration to block traffic from external IPs to the ElastiCache nodes."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
We have many clients that are not in the EC2 cloud (and many that prefer to stay at their own servers) but still use many of your services like simpleDB, and S3. Caching is still something we need to do and managing our own cluster that we created is simply irritating and not cost effective for us. The latency is not a deal breaker - we thrive on AWS making sure our simpleDB and S3 files are up and doesn't require out internal management. Its really why we use your services.

I also think many people would take the latency for the ease of use and peace of mind of uptime and cluster management. The pay for what you use business model for your cloud technologies is also another plus. 

I can understand not wanting to put your ElastiCache service out of the EC2 cloud due its latency giving you bad press, but I think the users using this service understand the network connection timeframes.


tldr; we'd love it and pay for it."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
Not testing but problem diagnosis. I want to be able to read what's in the cache from an outside server...

Why limit it? As far as I can see, this is the first and only major AWS service that requires EC2 to use (I'll not count EBS here, as that's not really a service).

Why the restriction?"
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
Yow, this is really old but I've hit the same issue.  I'm developing a new app and want to test the caching from my laptop and I'm finding it a real problem to diagnose issues as

1)  The error reporting on elastic beanstalk php instances is broken

2) Trying to find out what errors are occurring from my laptop appears to be impossible.

Please fix."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
any update on this? 

It would certainly be useful to have access to memcache on my laptop for testing purposes."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
any update on this? 

It would certainly be useful to have access to memcache on my laptop for testing purposes. +1"
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
I'm curious about this too.  I'm wondering how to do development and local testing before publishing my application to EC2 if I can't access ElastiCache from my development environment (aka my laptop)."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
Elastic Cache clusters can only be accessed within the EC2 network, but this is a problem for our app as well so we are going to try putting an ELB in front of our cache cluster to see if that will allow us to control access to our cache cluster to include some calls outside the EC2 network. 

If that doesn't work we could try an EC2 instance which could act as a proxy.  Has anybody else tried this?  I can post our finding after we try it."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
I've just run into the same issue. Tried to run unit tests on local dev machine and ...fail. While there are definitely ways around this (local redis instance, mock objects, EC2 proxy etc.) it would be nice to be able to access the Elasticache clusters outside of EC2 for testing."
Amazon Elasticache	"Re: Can I access ElastiCache from outside Ec2 ?
Unit tests should mock outside resources. It should be fairly simple to mock out elasticache with just a simple hashmap based key/value store."
Amazon Elasticache	"What are possible cluster status values?
The docs is lacking information: http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_CacheCluster.html

What are the possible values for CacheClusterStatus?

""creating, available, etc."" just doesn't cut it."
Amazon Elasticache	"Re: What are possible cluster status values?
Hello, 

I have taken a look at all API and SDK documentation for you regarding the possible status' that cache cluster can be in, but all of them return the same description of ""creating, available, etc.""

I agree with you that this is not sufficient, and as a result I have raised it with the Elasticache developers to get the possible values for you, and to also have the documentation updated to reflect the list of available status'.

Once we have some more information for you, we will post it in this thread.

Please let us know if you need anything else at all."
Amazon Elasticache	"Re: What are possible cluster status values?
Hello, 

I have an update from the team: 
The current complete list of statuses are:

available, creating, deleted, deleting, modifying, rebooting cache cluster nodes, incompatible-network, restore-failed, and snapshotting

The incompatible-network status is used manually by an operator if there is an issue which causes the cache cluster to be stuck in one of the above statuses. You should then be notified by Elasticache. We apologize that this was not documented and should be soon. 

Best, 
Matt"
Amazon Elasticache	"CloudFormation errors when deploy web applicatioin with Elastic Beanstalk
Dear AWS Community,

Want to deploy, provision a web application with Elastic Beanstalk service, but CloudFormation events show below errors.  

Refer to one of the errors ""Use of cache security groups is not permitted in this API version for your account"", and then want to create Cache Security Group from ElastiCache, but can't see the ""Cache Security Group"" option in the ElastiCache console.

It is much appreciated if anyone can help with why there are below errors, how to resolve them, and how to make the Elastic Beanstalk service sucessfully deploy, provision the web application?

By the way, my account is the one year free tier one.
*************************************************************************************************
 	15:35:31 UTC+1200 	UPDATE_ROLLBACK_COMPLETE_CLEANUP_IN_PROGRESS 	AWS::CloudFormation::Stack 	awseb-e-kz7m6f6ifa-stack 	
	15:35:26 UTC+1200 	UPDATE_COMPLETE 	AWS::CloudFormation::WaitConditionHandle 	AWSEBBeanstalkMetadata 	
	15:35:22 UTC+1200 	UPDATE_ROLLBACK_IN_PROGRESS 	AWS::CloudFormation::Stack 	awseb-e-kz7m6f6ifa-stack 	The following resource(s) failed to create: MyElastiCache, MyCacheSecurityGroupIngress.
	15:35:21 UTC+1200 	CREATE_FAILED 	AWS::ElastiCache::SecurityGroupIngress 	MyCacheSecurityGroupIngress 	Resource creation cancelled
	15:35:20 UTC+1200 	CREATE_FAILED 	AWS::ElastiCache::CacheCluster 	MyElastiCache 	Use of cache security groups is not permitted in this API version for your account.

Edited by: stevenwume on Aug 17, 2014 4:33 AM"
Amazon Elasticache	"Re: CloudFormation errors when deploy web applicatioin with Elastic Beanstalk
Hello Steven,

Are you deploying your application on VPC or EC2. Please note that this type of security group is only applicable to Classic instances and not VPC. The following page explains this:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheSecurityGroup.html

""Cache security groups are only applicable to cache clusters that are not running in an Amazon Virtual Private Cloud environment (VPC).""

Regards"
Amazon Elasticache	"Re: CloudFormation errors when deploy web applicatioin with Elastic Beanstalk
Dear AWS Community,

There is one default VPC in each region. When I deploy the application to EC2 instance through Elastic Beanstalk, the service automatically put the EC2 instance in the VPC and that's why get those error under CloudFormation events.

If delete the default VPC in the region, then deploy the application through Elastic Beanstalk again, could solve the problem?

Otherwise how to solve this problem?

Thanks."
Amazon Elasticache	"Re: CloudFormation errors when deploy web applicatioin with Elastic Beanstalk
Hi,
Deleting your default VPC won't fix the problem. By default, new customers can't use EC2 classic anymore, and they will have a default VPC created.
What is possible in EC2 classic is possible in VPC, which is more secure and gives you much more control over the networking configuration of your infrastructure.
Please find here a comparison between EC2 classic and VPC:

http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-vpc.html

ElastiCache is fully integrated with Amazon Virtual Private Cloud as explained here:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ElastiCacheAndVPC.html

Please find here how to create the required components here:

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.html

I hope this helps. Have a nice day!"
Amazon Elasticache	"Re: CloudFormation errors when deploy web applicatioin with Elastic Beanstalk
answered

Edited by: stevenwume on Aug 18, 2014 8:15 PM"
Amazon Elasticache	"Unable to create Elasticache - Get an error about cache security groups
I was trying to provision a new memcached server via ansible 

    - name: AWS | Create Redis
      local_action:
        module: elasticache
        region: sa-east-1
        name: ""test-please-delete""
        state: present
        engine: memcached
        cache_engine_version: 1.4.14
        node_type: cache.m1.small
        num_nodes: 1
        cache_port: 11211
        cache_security_groups:
           - default
        zone: sa-east-1a


When I ran it I get the error "" Use of cache security groups is not permitted in this API version for your account."" This seems to only occur in Sau Paolo Region. Doing this in US East for example works fine.

Any ideas on where I should diagnose this?

Edited by: shihoonl on Aug 15, 2014 3:14 PM"
Amazon Elasticache	"Redis Service Cutting In and Out
I have a redis node in ElastiCache that will accept requests normally, but every so often the node cannot be reached. I have important things being stored in there for queued jobs and can't afford the occasional request to miss.

Is there anything I can do to improve the reliability of the node?

This is the error message I am receiving:

getaddrinfo: Name or service not known

I don't understand why this is working 99 times out of 100."
Amazon Elasticache	"REST API for ElastiCache Redis endpoint
I am newbie to the aws elasticache, looking for rest api's to set/get the cache elements in redis endpoint cache node. 

Just wondering are there any REST API's for it ?

Edited by: abhiman on Aug 14, 2014 12:15 AM"
Amazon Elasticache	"Node.js Auto Discovery of new Cache-Nodes
Hello,

We are currently running our own memcached instances.  We would like to migrate to ElastiCache, due to its ability to easily add cache nodes to the cache-cluster, etc.  However, based on my research, for a Node.js environment there is no way to add cache nodes and have those nodes become available automatically to the Node.js memcached client.  For Java and PHP, there is the ElastiCache Cluster Client that seems to do exactly what we want.  However I don’t see that client available for Node.js.

Is there any built in way to handle changes to the ElastiCache cluster automatically from Node.js using the Amazon AWS SDK?  Or is this node module the only thing that will do what I’m thinking of?

https://www.npmjs.org/package/ee-elasticache-autodiscovery

Thank you for any information you can provide."
Amazon Elasticache	"Issue with installing php cache client on Elastic Beanstalk
Hi there,

I am having issues getting the beanstalk client to install as part of an ebextension. I can manually install it fine via terminal, but that doesn't work well for scaling/auto delete, etc.

This is my ebextension:

commands:
    02install:
        command: 'pecl install http://elasticache-downloads.s3.amazonaws.com/ClusterClient/PHP-5.5/latest-64bit'
    03install:
        command: 'echo ""extension=amazon-elasticache-cluster-client.so"" | sudo tee /etc/php.d/memcached.ini'
    04install:
        command: '/etc/init.d/apache restart'

I get this error: 

Instance: i-8b69cbb5 Module: AWSEBAutoScalingGroup ConfigSet: null Command failed on instance. Return code: 1 Output: Error occurred during build: Command 03install failed .

I've tried various other peoples ebextensions with no luck, they seem to be out of date, or using a diff base AMI type (we're on 64bit Amazon Linux 2014.03 v1.0.3 running PHP 5.5).

Thanks!"
Amazon Elasticache	"Re: Issue with installing php cache client on Elastic Beanstalk
Got this working based on the final comment here: https://forums.aws.amazon.com/message.jspa?messageID=551958"
Amazon Elasticache	"undefined symbol: executor_globals in Unknown on line 0
Hi
We have a custom compiled version of PHP.
We are getting the following error while trying to use the amazon extension with this setup

Starting php-fpm: 06-Jul-2014 06:04:31 NOTICE: PHP message: PHP Warning:  PHP Startup: Unable to load dynamic library '/opt/php/5.3.28/zts/no-debug/lib/php/extensions/no-debug-zts-20090626/amazon-elasticache-cluster-client.so' - /opt/php/5.3.28/zts/no-debug/lib/php/extensions/no-debug-zts-20090626/amazon-elasticache-cluster-client.so: undefined symbol: executor_globals in Unknown on line 0

I believe we will need to recompile the module using our environment to get this to work properly but amazon does not provide the source code of the extension

what do we do?"
Amazon Elasticache	"Create Redis node and attach to a non default VPC
I'm trying to create a Redis node, but in the configuration window, I'm not able to select a VPC I created. All I see is the default VPC. For that reason the subnets are also only the ones that belong to the default VPC.

Is there anything else I need to do in order to get my custom VPC listed, so I can attach an ElastiCache node to it?"
Amazon Elasticache	"Re: Create Redis node and attach to a non default VPC
Hi,

Looks like you haven't yet created a cache subnet group. Please create one by specifying the new VPC and its subnets then it will appear in the list. Here are documents for your reference:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheSubnetGroups.html
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.CreatingSubnetGroup.html

Regards
Said S"
Amazon Elasticache	"Cache consistency when adding/removing nodes with Auto Discovery
I understand the Auto Discovery features allow the clients to retrieve the currently available nodes so we don't need to hard code the nodes' addresses in our config, but what would happen when we add or remove node(s) from the cluster? 

Do you employ some kind of locking in the clients? Because if the clients get/flush the node member list via the configuration endpoint at different time, there will be chance of cache inconsistency you can't avoid, how are they normally solved with ElastiCache?"
Amazon Elasticache	"Re: Cache consistency when adding/removing nodes with Auto Discovery
Hi there,

from our documentation here:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html

When you increase the number of nodes in a cache cluster, the new nodes register themselves with the configuration endpoint and with all of the other nodes. When you remove nodes from the cache cluster, the departing nodes deregister themselves. In both cases, all of the other nodes in the cluster are updated with the latest cache node metadata.


The AutoDiscovery process is documented further here:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.HowAutoDiscoveryWorks.html

I hope that those pages can help answer your query.

Thanks
Iain"
Amazon Elasticache	"Re: Cache consistency when adding/removing nodes with Auto Discovery
Hi,

I've read the link you provided. The issue is the clients pull the configuration endpoint once per minute, so there will be chance that clients seeing different list of nodes at a very short period of time.

i.e. what would happen when a new cache node is just provisioned, client A get the latest list but client B still using the old list, so a given key might hashed into different cache nodes and cause cache inconsistency."
Amazon Elasticache	"Re: Cache consistency when adding/removing nodes with Auto Discovery
Hi there,

You are correct that there can exist a brief period of time where a client may not have the latest (most fresh) list of cache nodes available. The issue is that DNS propagation can take sometime and predicting that time period is fairly difficult. So we need to have a balance between having consistent reliability versus getting false positives due to latency, network disruptions, or delayed response.

My advice is for you is to prepare your front end clients for this situation so they can adapt to this, for example, maybe by creating a centralized place for more sensitive information (i.e. DynamoDB) to live to make sure that all of your clients will always have that same information at all times while leaving the rest in ElastiCache's care.

I hope this clarifies things for you."
Amazon Elasticache	"DescribeSnapshots: Documentation is wrong
http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_DescribeSnapshots.html

Under SnapshotSource, it says the options are ""manual"" or ""automated"". However, in reality, the API wants ""user"" or ""system""."
Amazon Elasticache	"Re: DescribeSnapshots: Documentation is wrong
Furthermore, DescribeSnapshots wants user/system on input for source, but it sends back manual/automated for source in it's response.

Why the difference???"
Amazon Elasticache	"Re: DescribeSnapshots: Documentation is wrong
Hi there,

Thanks for letting us know about this. We've gone ahead and updated our documentation accordingly. Those changes should be reflected in the next documentation deployment."
Amazon Elasticache	"restore-failed, but cluster is still displayed in the table 2 weeks later
A couple of weeks ago, a restore of a cluster failed.  I tried to delete it, but the little spinning icon to the left of the cluster on the Cache Clusters page is still spinning.  How can I go about removing it?  (the spinning icon makes it so I can't select the checkbox to try to Delete it from the console).
Thanks,
Mike"
Amazon Elasticache	"Re: restore-failed, but cluster is still displayed in the table 2 weeks later
turns out you can click on the spinning icon, and that will ""select"" the cluster so you can delete it."
Amazon Elasticache	"Timeout with ElasticCache
I have several timeout like this on the app,  app (ec2) and Elascticache are in Sao - Paulo, RDS too.
(2014-06-30 15:08:36.155+0000) ERROR xxxxxx caasase.asas.memcache.Memcache - Timeout
net.spy.memcached.OperationTimeoutException: Timeout waiting for value: waited 2,500 ms. Node status: Connection Status { xxx-xxx.xxxxcom/xx.xxx.xxx.xx:xxxxx active: true, authed: true, last read: 2,706 ms ago }
I have connectivity if I do telnet from command line.

any idea to check or improve configuration?"
Amazon Elasticache	"Re: Timeout with ElasticCache
We too are getting a lot of intermittent timeouts with elasticache today. The cluster is in N. Virginia."
Amazon Elasticache	"How works num_threads ?
Hi:

Whats mean that elascticache have 4 threads (using xlarge) and what is the relationship about new connections (input, output) or if i need more nodes en mi cluster"
Amazon Elasticache	"Upgrading AMI software - how to keep existing configuration
Saved configurations cannot be used if I want to create a new environment but set a newer AMI. I do not want to lose all my existing configuration and new AMIs are released every few months. What is the easiest way to keep up?"
Amazon Elasticache	"Re: Upgrading AMI software - how to keep existing configuration
Sorry wrong forum"
Amazon Elasticache	"What is the best way to use ElastiCache when I use RDS MultiAZ?
I'm currently using RDS MultiAZ on my project, and I was hoping to use ElastiCache to improve the speed of my queries. However I noticed that on ElastiCache I have to define which zone I'm interesting in using.

Just to check if I got it right: MultiAZ means that I have 2 database servers on 2 zones (I'm using South America region): on zone A I have a read and write server (Master) and on zone B I have a read server (Slave). If for any reason zone A goes down, zone B becomes the Master until Zone A returns.

Now how do use ElastiCache (I'm using Memcache) in this case? I can't create a cache cluster with a single endpoint to connect, and 2 nodes (one in each zone). I need to have 1 cache cluster for each zone, and 2 codes for my application so they'll connect to the correct zone?

Thanks!"
Amazon Elasticache	"Default behavior when it full space
What is default behavior when cache is 100% used,? discard old data or what?"
Amazon Elasticache	"Re: Default behavior when it full space
Hi there,

You can adjust the behavior to however you want it to be by modifying the specific cache engine you're using:

Redis: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html
Memcached: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Memcached.html

In Redis, look for a parameter called ""maxmemory-policy"" and in Memcached, look for a parameter called ""error_on_memory_exhausted"".

Keep an eye on your swap usage too, because when there's no more memory available, the cache cluster will have no choice but to start using the local storage and that will affect performance.

I hope this clears things up for you."
Amazon Elasticache	"Policy Option elasticache:CreateSnapshot
Hello guys , How are you?

Today I tried create a new policy to some user that need a create snapshot of elasticache, but in policy generator didnt have this option, I wrote a custon policy and works very well, is a good action to add this policy in generator.

Thanks guys."
Amazon Elasticache	"Elasticache Cluster Client for PHP 5.5?
It appears that the most recent version of PHP supported by the Cluster Client is 5.4.  Is there an ETA for support for PHP 5.5?  Or any thought that the 5.4 client should work with php 5.5?"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
Also looking for this answer. Could we get the source? The Java version is on github."
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
Anyone have any info on this? Will the 5.4 client work with 5.5?

Edit: Tried it out and no, it doesn't work. It produces the following error:

PHP Warning:  PHP Startup: memcached: Unable to initialize module
Module compiled with module API=20100525
PHP    compiled with module API=20121212
These options need to match
 in Unknown on line 0

Edited by: Brad on Jan 7, 2014 11:25 AM"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
PHP 5.5 has been out for quite a while now, is there any news on this?

Thanks,

Steve"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
The 5.4 version definitely doesn't work.  +1 to get this functional from AWS Elasticache team"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
This is having a profound effect on our ability to upgrade our servers to PHP 5.5.  We are considering reverting to a non-AWS implementation of Memcached for this reason.  This extension should have been updated already.  Please provide us with a status update ASAP."
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
Hi everyone,

Thanks for the feature request. As you have observed, Elasticache currently supply clients for PHP 5.3 and 5.4. 

I have passed this thread onto the team. I cannot provide any details on when or if we might implement support for PHP 5.5, but our road map is driven by customer requests like this. 

Please keep an eye on the ""What's New"" page (http://aws.amazon.com/about-aws/whats-new/) for information on updates to our services.

Regards,

Alastair"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
+1 request for the PHP 5.5 client plugin. Ubuntu 14 LTS comes out next week and aptitude installs php 5.5 by default."
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
+1

Pretty disappointed this is not already updated to be honest."
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
+1 Please support PHP 5.5.

Ubuntu 12.04 LTS comes with PHP 5.3, some libraries don't work with that old version.
Ubuntu 14.04 LTS comes with PHP 5.5, which is not compatible with Elasticache.
-> We had to use phpbrew and compile our own PHP 5.4 build. This is not a good solution."
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
I hope it will release as soon as possible

I need it for publishing my game !! I need

Edited by: seanmoon on Apr 23, 2014 3:46 PM"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
About time to have PHP 5.5 supported for Elastic Cache.We are not able to upgrade to 5.5 because of this reason.

I also hope that the end of life for 5.3 will not happen in a short while as some servers are still on that.

Please get this 5.5 upgrade ASAP"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
Hi everyone,

Earlier today we released the Memcached Auto Discovery client for PHP 5.5. Please follow these steps for guidance on downloading the client. For more information about Auto Discovery please click here.

Our roadmap is driven by customer requests such as this one; please keep updating us about your needs so we could best address them.

Sincerely,

The ElastiCache Team"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
Hi Dan,

Thanks for the PHP 5.5 client!

I am not sure if this was like this already with earlier versions, but I just saw that the new client doesn't come with support for igbinary or json compiled in. Would it be possible to provide a client with support for this enabled?

igbinary seems to produce smaller output than the php serializer, and also is faster. Moreover, igbinary is the default serializer (if available) for the vanilla memcached pecl module - and we'd want to be able to seamlessly swap one out for the other, if we have to.

json seems to be a good idea to have around for interoperability with other, non-PHP environments.

Looking forward to your reply
Gottfried

(For now we'll stick with PHP 5.5, the vanilla memcached module, and a manually maintained list of cache nodes, since I can't afford to reset the cache at this point.)"
Amazon Elasticache	"Re: Elasticache Cluster Client for PHP 5.5?
Thank, you had some issues getting it running on Fidora20 as it required libsasl2.so.2.
However copied that over from previous and is running fine."
Amazon Elasticache	"Is it possible to download a redis snapshot from S3?
I have created a redis snapshot in elasticache. I understand that the snapshots are stored in S3, but I don't see my snapshot in S3 via the AWS Console, nor do I see any discussion of this in the FAQ.

Is it possible to download a redis snapshot from S3? If so, where do I look to find it?

John"
Amazon Elasticache	"Re: Is it possible to download a redis snapshot from S3?
Hello John,

Unfortunately Elasticache stores the snapshots in a bucket that is only accessible when you manage the snapshot from the Elasticache console.

This means that you would be unable to download the snapshot directly from S3 as you first thought.

Let us know if you need anything else at all."
Amazon Elasticache	"Problems while opening ElasticCache Dashboard
Following appears is console log while opening https://console.aws.amazon.com/elasticache/home?region=us-east-1

""Uncaught java.lang.IllegalArgumentException: No region found with identifier of  ""

The dashboard does not render at all. A quick fix will be really helpful in this regard.

Thank You."
Amazon Elasticache	"Re: Problems while opening ElasticCache Dashboard
Hello,

Thank you for posting to the AWS Forums. 

I was unable to duplicate this error with FireFox 24.5, Internet Explorer 11, or Chrome 34.0. Can you please try clearing your cookies and local cache and login again? If that doesn't work do you get the same error in a different browser? What browser / version are you getting this error on? 

Regards,
Nick"
Amazon Elasticache	"Re: Problems while opening ElasticCache Dashboard
Hey, after clearing the cache and cookies its working now. I am using Chrome v 34.0.1847.137 on Mac OS X 10.9.

Thanks."
Amazon Elasticache	"Re: Problems while opening ElasticCache Dashboard
Hello,

We are glad the issue is resolved. 

Regards,

Marcin"
Amazon Elasticache	"I wrote a python client for elasticache auto discovery
Here is the project home address:

https://github.com/yupeng820921/elasticache_pyclient

Welcome to try it and give me feedback on the github or here."
Amazon Elasticache	"Re: I wrote a python client for elasticache auto discovery
That's great, will check it out, thanks yupeng820921!!"
Amazon Elasticache	"Create instance from another instance using image
Hello, I create a new image, starting from a current instance, 
was alright even connect, it is giving this error message, someone could help me where can I configure this?

##############

Event-channel device installed.
 
netfront: Initialising virtual ethernet driver.
 
mice: PS/2 mouse device common for all mice
 
md: md driver 0.90.3 MAX_MD_DEVS=256, MD_SB_DISKS=27
 
md: bitmap version 4.39
 
NET: Registered protocol family 2
 
Registering block device major 8
 
IP route cache hash table entries: 65536 (order: 6, 262144 bytes)
 
TCP established hash table entries: 262144 (order: 9, 2097152 bytes)
 
TCP bind hash table entries: 65536 (order: 7, 524288 bytes)
 
TCP: Hash tables configured (established 262144 bind 65536)
 
TCP reno registered
 
TCP bic registered
 
NET: Registered protocol family 1
 
NET: Registered protocol family 17
 
NET: Registered protocol family 15
 
Using IPI No-Shortcut mode
 
XENBUS: Timeout connecting to devices!
 
md: Autodetecting RAID arrays.
 
md: autorun ...
 
md: ... autorun DONE.
 
EXT3-fs: sda1: couldn't mount because of unsupported optional features (240).
 
EXT2-fs: sda1: couldn't mount because of unsupported optional features (244).
 
Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(8,1)"
Amazon Elasticache	"Re: Create instance from another instance using image
Hi tuliox,
This kind of error usually points to a problem with the root file system definition in the /etc/fstab file.  A typical entry for this file system for an Amazon Linux instance looks like this:
LABEL=/     /           ext4    defaults,noatime  1   1

You can mount the root volume from the this instance to a working one and mount it to /dev/sdf and check the configuration file before returning it to the original instance.  More information about this process can be found here: 
http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-detaching-volume.html
http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-attaching-volume.html
http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-using-volumes.html#using-ebs-volume-linux

Please let me know if you have any other questions."
Amazon Elasticache	"Re: Create instance from another instance using image
sorry but I could not understand, could you tell me what I should do more specifically?"
Amazon Elasticache	"Cannot connect to ElastiCache from EC2 instance.
I just created a new ElasticCache node: redis.ymtdpx.0001.apse1.cache.amazonaws.com
I cannot access it from my EC2 instance which was created by Elastic Beanstalk automatically.

I already setup the security groups properly.
It should allow all instances in my ""default"" EC2 security group to access.
But somehow it's just not working.

Can you please tell me how to fix?

Thanks"
Amazon Elasticache	"Connection failures
Several times over the past few months I've had a machine suddenly unable to connect to elasticache. Troubleshooting, I've tried to telnet out to the elasticache node from the affected machine, but the attempt only timed out.  

I believe this must have something to do with total number of connections because of what follows.  What happens is the machine unable to connect to elasticache will crash.  This then triggers autoscaling to replace it another machine, during which time the cluster is under high cpu load.  This then triggers autoscaling to increase the total number of machines.  After this (more connections), all of the elasticache connections start failing.  

However the total connections never shows over 1,000 and Amazon parameters shows 10,000 as the max.  Is there any way to tell if I am over the connection limit or not, and is this the expected behaviour when max connections are exceeded (timeout instead of connection denied)?"
Amazon Elasticache	"Bug in console when launching cluster prevents launch.
When launching a cluster there is a bug that can prevent launching the cluster.

If you do not select t1.micro as your instance type before pressing continue you are presented with some options, including automatic backups.

If you select t1.micro first you are not presented with this option.

If you do not select t1.micro, hit the review screen and realize you have the wrong node type and click previous to change the node type, upon clicking continue again the automated backups option is gone (as it should be with the t1.micro) however attempting to launch the t1.micro results in the error message as shown in the attached screenshot."
Amazon Elasticache	"Re: Bug in console when launching cluster prevents launch.
Thank you for pointing that out Matthew, we will take a look."
Amazon Elasticache	"How to use enyim memcached client with amazon elasticache in c#
I have created a cache cluster on Amazon ElastiCache. It has given me an endpoint address.
Now I want to store the data in Amazon ElastiCache. For that I am making use of enyim memcached client.

The server gives an error as;

Type initializer for Enyim.Caching.Memcached.ServerPool threw an error

My config looks like this;

    <enyim.com>
        <memcached>
          <servers>
            <!-- put your own server(s) here-->
            <add address=""<MyendPointAddress"" port=""11211"" />
          </servers>
          <socketPool minPoolSize=""10"" maxPoolSize=""100""
          connectionTimeout=""00:01:10"" deadTimeout=""00:05:00"" />
        </memcached>
      </enyim.com>

In C# I have written something like this;

    using (MemcachedClient client = new MemcachedClient())
                {
                    client.Store(Enyim.Caching.Memcached.StoreMode.Add, key, value);
                    var l = client.Get(key);
                }

When I use local host, the code doesn't throw any error, but doesn't store anything."
Amazon Elasticache	"Re: How to use enyim memcached client with amazon elasticache in c#
Did you ever solve this? I am just not configuring use with ElastiCache and having similar issues. Thanks."
Amazon Elasticache	"Upgrade of Redis cluster from 2.6 -> 2.8 clears all cache data?
I was attempting to upgrade an Elasticache Redis cluster from 2.6 to 2.8 and saw this troubling message. I can't find anything in the documentation indicating that there would be data loss from a major version upgrade. Is this correct?

Screenshot"
Amazon Elasticache	"Re: Upgrade of Redis cluster from 2.6 -> 2.8 clears all cache data?
Hello,

Cache data is indeed lost when you change cluster version.

However, the data will of course be rebuilt as your application is used.

Richard"
Amazon Elasticache	"Redis Clusters stuck in creating state
I've got several redis clusters stuck in the creating state for more than 4 hours. What should I do?"
Amazon Elasticache	"Re: Redis Clusters stuck in creating state
Hello, 

I am researching this issue. Could I get a list of the clusters that are stuck in the creating state?

Thank you, 
Chris"
Amazon Elasticache	"Re: Redis Clusters stuck in creating state
I see they are now in restore-failed mode. They seemed to go into recovery mode immediately from creation. The only unusual thing I did for these is set the databases parameter in the cache parameters groups really high.

Unfortunately I can't seem to find any sort of ID to identify these clusters in the web console or the cli.

@ChrisC I have PM'd you my account number if that helps. I have deleted all but 1 of them (redis-cluster)"
Amazon Elasticache	"Random connection failure to Elasticache from only one EC2 instance
I have several machines within an Autoscaling group all connecting to Elasticache.  Randomly, one of the machines will fail to connect.  If I SSH into the machine and try telneting to the Elasticache node (by CNAME or by its 10.x.x.x ip) the connection times out, while other EC2 instances continue to work.  

All instances are started from  the same Launch Configuration, so they are all in the correct security groups.  After failure occurs, that instance is unable to connect to Elasticache without restarting.  All other network connections on the machine work.   

What is happening??"
Amazon Elasticache	"Redis replication group - can't add read replica
Hi there,

Basically, I'm trying to create a REDIS replication group and everything is fine up until I add a read replica, that part fail for some reason. 
I'm following this doc here.

Here is what I am doing:
1. Create cache subnet group
2. Create cache cluster (id => redis master)
3. Create cache replication group (add redis master as primary)
4. Create cache cluster (id => redis replica)
5. Add read replica to replication group >> failure, error message is: ""Cache cluster already exists""

I also tried to add the read replica from the replication group GUI (just by specifying a cache cluster ID that doesn't exist) hoping it would create a new redis cache cluster >> failure, error message is: ""Engine does not support snapshotting. Snapshot window parameter should not be specified.""

I tried to use the rest API along with the CLI tools and I get the same outcome/errors. Hopefully it's a user problem and is just a matter of clarifying how it is supposed to be done.

Any help is much appreciated. 
Cheers, Raimana.

Edited by: Raimana on Apr 3, 2014 3:22 PM"
Amazon Elasticache	"Re: Redis replication group - can't add read replica
If that can help here is my cache cluster config (I'm in a VPC):
cache_cluster_id = ""Redis-Master-Test"", 
num_cache_nodes = 1, 
cache_node_type = ""cache.t1.micro"", 
engine = ""redis"", 
engine_version = ""2.6.13"", 
cache_subnet_group_name = ""someCacheSubGroup"", 
security_group_ids = [""someSecGroupId""],
preferred_availability_zone = ""ap-southeast-2a"",
preferred_maintenance_window = ""tue:01:00-tue:02:00"",
auto_minor_version_upgrade = True"
Amazon Elasticache	"Re: Redis replication group - can't add read replica
Has any one ever succeeded in adding a redis read replica to a replication group? Am I the very first one to try that?

If anyone ever managed to add a read replica please let me know, at least I'd know it's not a bug 

Edit:
I should ask the question the other way around maybe: is there anyone having the same problem?

What's the point of having a replication group if only a primary redis cluster (with a single node) can be added...

Edited by: Raimana on Apr 6, 2014 11:20 PM"
Amazon Elasticache	"Re: Redis replication group - can't add read replica
Bump.  I am also having this very weird issue when trying to add a read replica to an existing replication group (as far as I understand this is the ONLY way to add a read replica to a replication group).

What's the deal?  Is this thing broken?"
Amazon Elasticache	"Re: Redis replication group - can't add read replica
I answered my own question:

Basically I was assuming (as it seems was the original poster) that I needed to create the read replica myself.  This is not the case.

Instead you should specify the name of a NEW read replica that you want to create and it will do the actual creation for you."
Amazon Elasticache	"Re: Redis replication group - can't add read replica
Thanks for taking the time to share your experience.

I also tried that way (i.e. adding a new read replica from the replication group view) but no joy, the error I am getting is: Engine does not support snapshotting. Snapshot window parameter should not be specified

I haven't configured any snapshot window but somehow it complains about this? I will try from another region see if it makes any difference..."
Amazon Elasticache	"Re: Redis replication group - can't add read replica
Argh I think I found what the issue is.

I've been using micro instances and just tried to replicate this with small instances, following the exact same steps as I did before but that time it worked.

So is this expected? Looks like you must use at least small instances to create a replication group? 

I'd really like to hear from the DEV team, at least to confirm whether or not this is the expected behavior."
Amazon Elasticache	"Re: Redis replication group - can't add read replica
Ah nice the doc has been updated  

See note about AOF: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Replication.html

That was the issue...

Edited by: Raimana on Apr 14, 2014 11:20 PM"
Amazon Elasticache	"Re: Redis replication group - can't add read replica
Hello

Apologies for the late response. Yes you are correct, the documentation has since been updated and the 'Note' added.

Our apologies again for the delay.

Hope this answers your questions.

Regards
Parker

Edited by: Parker@AWS on Apr 15, 2014 10:35 AM"
Amazon Elasticache	"Redis ElastiCache instance stopped reporting metrics
I just noticed that my ElastiCache instance has stopped reporting metrics as of a few days ago. I tried rebooting it and that didn't help.

I only have one cluster with one node. What information do I need to provide to get this fixed?

Thanks!"
Amazon Elasticache	"Re: Redis ElastiCache instance stopped reporting metrics
Hi there!

I'm going to fire this up to the engineering team to investigate further, and we'll reply back as soon as we hear more.

Thanks
Iain"
Amazon Elasticache	"Re: Redis ElastiCache instance stopped reporting metrics
Hi,

If you check again now you should see the metrics again. I am still waiting on the details about what happened, but that information is currently unavailable. I will update you again here as soon as possible. Please let us know if you have any problems seeing them now.

Edited by: julianh-aws on Apr 2, 2014 8:44 PM"
Amazon Elasticache	"Re: Redis ElastiCache instance stopped reporting metrics
Thanks! I'm getting metrics again."
Amazon Elasticache	"Re: Redis ElastiCache instance stopped reporting metrics
Hello,

Thank you for confirming that you are receiving the metrics again.

Our team confirmed that there was a problem on their side which was causing the metrics not to be reported properly, however they are working on a fix to this issue.

Please let us know if this happens again.

Regards,
Troy W"
Amazon Elasticache	"redis cache with s3 snapshot
Hi,

I saved redis dump.rdb file in a S3 bucket but when I am trying to create a new redis cache I put the location of the file in S3 Snapshot Location in the creation wizard but I get the message:
Object or bucket does not exist for S3 object: https://s3.amazonaws.com/xxxxx/dump.rdb
the file is  granted public access

What am I doing wrong

rgds,

Solution:
I must just put the path to the file: xxxxxx/dump.rdb

thx

Edited by: melb001 on Apr 12, 2014 7:42 AM"
Amazon Elasticache	"See the effective maxclients
Hello,

I'm trying to determine the effective value for maxclients in my m1.small redis elasticache node.

We have it set to the default of 65000 and typically are much lower than that around 100 or so.

I've read this description of how the redis config startup can adjust the number of maxclients based on the file descriptors
http://redis.io/topics/clients

So I have connected to my node through redis-cli and tried to look at the actual number of maxclient using the command CONFIG GET *

http://redis.io/commands/config-get

And I get a response (error) ERR unknown command 'CONFIG'


This thread indicates that amazon may have shadowed the CONFIG command?
https://groups.google.com/forum/#!msg/redis-db/8jza0vndY5g/ENt1zv7xl88J

So is it possible to use the CONFIG command for looking at the values in the redis node?

What is the effective max number of connections for the various redis node sizes?"
Amazon Elasticache	"Redis Elasticache cluster was shutdown and all data was deleted
On April 3rd, I've noticed that all of my Redis data was deleted.

This is what I found in the cache event tab:

prod-redis-bites1
cache-cluster
Thu Apr 03 13:04:03 GMT+300 2014
Finished recovery for cache nodes 0001

prod-redis-bites1
cache-cluster
Thu Apr 03 13:00:08 GMT+300 2014
Recovering cache nodes 0001

What was that? How do I prevent it from happening again?

Thanks in advance"
Amazon Elasticache	"ElastiCache API rate limit (Throttling error)
tl;dr version:
What is the approximate API request rate allowed for DescribeCacheClusters before throttling kicks in?  I don't see it listed in the limits section for the service.  Is this a limit that can be increased or are we better off bumping max_retries in the AWS SDK client?  Thank you!

long version:
Our config management software uses aws-sdk for Ruby to ask the ElastiCache API for a list of cache cluster endpoints and fills these values into a config file template.  This works fine when the config management software runs in daemon mode, as the ElastiCache API requests are somewhat random, but when all instances converge config simultaneously in parallel (such as during a code deploy) we're catching AWS::ElastiCache::Errors::Throttling intermittently.

It looks like the SDK's default settings retry Throttling errors 3 times, but they're still bubbling up.  Just trying to get a feel for what the ElastiCache API request limit for DescribeCacheCluster might be before increasing the max_retries value on the client side.

Thanks for the help.

Edit: I can't seem to reproduce this behavior at the moment though it was happening consistently earlier today.  Here are some example logs:

10.9.138.40    2014-03-20T09:06:27+00:00 FATAL: AWS::ElastiCache::Errors::Throttling: Rate exceeded
10.124.15.86   2014-03-20T09:06:28+00:00 FATAL: AWS::ElastiCache::Errors::Throttling: Rate exceeded
10.87.9.165    2014-03-20T09:06:28+00:00 FATAL: AWS::ElastiCache::Errors::Throttling: Rate exceeded
10.124.78.4    2014-03-20T09:06:29+00:00 FATAL: AWS::ElastiCache::Errors::Throttling: Rate exceeded
10.116.246.163 2014-03-20T09:06:30+00:00 FATAL: AWS::ElastiCache::Errors::Throttling: Rate exceeded
10.114.147.85  2014-03-20T09:06:30+00:00 FATAL: AWS::ElastiCache::Errors::Throttling: Rate exceeded
10.85.126.103  2014-03-20T09:06:30+00:00 FATAL: AWS::ElastiCache::Errors::Throttling: Rate exceeded

Edited by: rhenning_nt on Mar 20, 2014 7:27 AM"
Amazon Elasticache	"Re: ElastiCache API rate limit (Throttling error)
Hello,

Unfortunately, we do not have publicly available information on throttling limits.

Our first recommendation would be to increase the number of retires.  Based on what you've described, it sounds like you make a burst of requests around the time of a deployment, and retrying in those situations will be the best solution.

If this does not work for you, please let us know more about your use case.  Specifically, are you in fact making a burst of requests around the time of a deployment?  How many requests per second do you make during this period of time versus a non-burst period?

Regards,

Matt R."
Amazon Elasticache	"Re: ElastiCache API rate limit (Throttling error)
OK, we'll just bump the retry limits and see if that gets around the issue.  If we experience it again we'll follow up with request rate info.  Thanks."
Amazon Elasticache	"Elasticache Redis 2.8.6 notify-keyspace-events not settable
We are trying to use the events triggered from Redis and we need to configure the parameter ""notify-keyspace-events"" but is not enabled.

Inside ""Cache Parameter Groups"" if you click ""Edit parameters"" on a Parameter Group, all the Settings are fine except ""notify-keyspace-events"" that doesn't have a input box to enter the new value.

How can i set this parameter?"
Amazon Elasticache	"Re: Elasticache Redis 2.8.6 notify-keyspace-events not settable
Hi,

We are currently investigating the issue you are seeing and we will update as soon as we have news.

Can you please confirm the name and version of your Redis cluster?

Regards,
Valentin R."
Amazon Elasticache	"Re: Elasticache Redis 2.8.6 notify-keyspace-events not settable
Thanks for the reply,

this are some details of the cluster:

Cache Cluster ID:	redis-cache
Engine:	redis
Version:	2.8.6"
Amazon Elasticache	"Re: Elasticache Redis 2.8.6 notify-keyspace-events not settable
Hello,

Redis2.8 only parameters are currently not modifiable via web console. Thanks for reporting this. We have raised it to the attention of web console team and they are currently taking a look at it.
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html

However it is possible to modify these parameters via the latest version of AWS CLI which is AmazonElastiCacheCli-1.9.001

#How to use AWS CLI tool:
http://docs.aws.amazon.com/AmazonElastiCache/latest/CommandLineReference/StartCLI.html"
Amazon Elasticache	"Unable to connect to Redis from EC2 Instance/Application
I'm transitioning from Memcached (which was working fine) to Redis on the AWS platform.  

I just created a new ElasticCache cluster: rediscluster.mfqlxx.0001.usw2.cache.amazonaws.com and am unable to access it from my EC2 instance or web application.  

I opened up all of the ports within my SG and it still doesn't appear to work. As background, I'm using a Windows server instance and have no issues connecting to it. 

 Can you please tell me how to fix?"
Amazon Elasticache	"Upload .rdb dump file
I have a dump file (local.rdb) that I would like to upload to my cache node, is this possible?"
Amazon Elasticache	"Change Engine Reserved Instance
Hello,

I bought a cache cluster reserved for memcache, however now I'm using redis, I can just remove the cluster and create a memcache and redis will continue with reservation?

Att;"
Amazon Elasticache	"Re: Change Engine Reserved Instance
Hello,

Please reach out to our billing team who will be able to assist you.

https://aws.amazon.com/support/createCase

Richard"
Amazon Elasticache	"Re: Change Engine Reserved Instance
Ok, thanks"
Amazon Elasticache	"when will AWS support multi-node redis clusters?
Redis support is kind of just a toy right now because you can't scale it out horizontally. Is there a rough ETA for when it will support multi-node clusters?

I'm asking because I have a new feature in our app that uses Redis (leaderboards) and I need to know if I should setup my own Redis cluster in EC2 or if I should just stay on Elasticache, scale vertically for now, and wait for multi-node support."
Amazon Elasticache	"Re: when will AWS support multi-node redis clusters?
Hi foxcubgames,

Unfortunately we can't comment on our roadmap, but we appreciate your feedback regarding your need for multi-node cluster support.

Redis is indeed a great fit for creating leaderboards and is widely used for that use case. But could you please elaborate on why would you need horizontal scale out to achieve that functionality?

Thanks,

Dan"
Amazon Elasticache	"Re: when will AWS support multi-node redis clusters?
Hi Dan, thanks for getting back to me.

When we need to scale up, instead of taking down my single node and replacing it with a larger node, it would be easier to just add additional nodes.

Isn't that the benefit of using something like Redis that supports multiple nodes?"
Amazon Elasticache	"Re: when will AWS support multi-node redis clusters?
Yes, that is the benefit of scaling out; however Redis currently doesn't support sharding natively. You would need to do that in the application level."
Amazon Elasticache	"Re: when will AWS support multi-node redis clusters?
Ok, sounds like I need to read up more on Redis clusters then. Thanks =)"
Amazon Elasticache	"Does the AWS Elasticache PHP client use consistent hashing?
I have read in the docs that the Java client for Elasticache has a consistent hashing implementation, but I have not seen any specific mention of the PHP client also having this feature. There is also no source code available for the PHP client, so I haven't been able to verify this myself.

We are running Drupal using Elasticache with multiple nodes discovered via autodiscovery (using the AWS PHP memcached client) and I am getting behavior that indicates that the PHP client does not use consistent hashing. Before I spend anymore time debugging this, I thought I would ask if it is actually supposed to.

Drupal is very sensitive to scenarios where it expects a key that it just wrote to be available for reading immediately and it is loading stale data when I have multiple nodes in the Elasticache cluster. If I go to a single node, everything starts working fine.

Any confirmation one way or another here would be a big help.

Thanks,
Justin"
Amazon Elasticache	"Re: Does the AWS Elasticache PHP client use consistent hashing?
Hello,

Thanks for your patience while we were looking into this issue.  We asked the Elasticache team for their guidance.  They responded with the following.

The client object would likely use modulo hashing by default, though you can certainly configure your PHP memcached client object to distribute keys via consistent hashing.  Below is some sample code that may help:

$m = new Memcached();
$m->setOption(Memcached::OPT_DISTRIBUTION, Memcached::DISTRIBUTION_CONSISTENT);

Please give this a try and let us know if you have any additional questions.

Regards,

Matt R."
Amazon Elasticache	"Elasticache Redis with very frequent writes (task status updates)
Hi,
We are currently experimenting with using Redis for status updates on long running jobs in our app. This involves a single key per job which is updated by a worker, so it involves frequent writes (in fact reads and writes are likely to be equally balanced). Rather than setting up a dedicated instance to host Redis (which we would need to provision and presumably cluster) we were looking to use Elasticache instead.

It's not clear that Elasticache suits this use case, however. Our status updates are ephemeral, specific to a single client running that job, and disappear after the job is finished. It seems that Elasticache is mainly used to support situations in which data is persisted to a db, but simultaneously cached for fast reads. Is this right? Or does Elasticache look like a good fit for what we want to do?

Thanks,
Chris

Edited by: sea-of-cortez on Feb 14, 2014 1:31 PM"
Amazon Elasticache	"Re: Elasticache Redis with very frequent writes (task status updates)
Anyone?"
Amazon Elasticache	"Sudden timeouts during high load
Hello,

we have issue when running our load tests on ElastiCache. Issue seems common to different amazon instances. We have few servers with jedis pools. Every server creates some load on Redis. Load from all servers is ~30-40k TPS. mostly this is just ""GET"" requests. All jedis pools has been setup with aggressive timeouts. The socket timeout for Redis is 50ms configured in the Jedis connection.

But from time to time we getting:
redis.clients.jedis.exceptions.JedisConnectionException : java.net.SocketTimeoutException
      at redis.clients.jedis.Connection.connect(Connection.java:134)
      at redis.clients.jedis.BinaryClient.connect(BinaryClient.java:69)


while server is still up and running and next requests are ok.

Here some info that may help:

Right now we using Amazon ElastiCache service on cache.m2.xlarge instance. 
All persistence is turned off:

# Persistence
loading:0
rdb_changes_since_last_save:273926035
rdb_bgsave_in_progress:0
rdb_last_save_time:1391595182
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:0
rdb_current_bgsave_time_sec:-1
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok


Our performance metrics (within servers code) shows that average response time from redis is < 1ms (this is from 1 server):
             count = 1389167
         mean rate = 314.84 calls/second
     1-minute rate = 759.36 calls/second
     5-minute rate = 613.73 calls/second
    15-minute rate = 453.61 calls/second
               min = 0.04 milliseconds
               max = 44.18 milliseconds
              mean = 0.44 milliseconds
            median = 0.32 milliseconds
              75% <= 0.83 milliseconds
              95% <= 5.94 milliseconds
              98% <= 10.55 milliseconds
              99% <= 14.96 milliseconds
            99.9% <= 44.09 milliseconds


Latency very close to what we have in our Server metrics. So look like network not a problem.
redis-cli --latency
min: 0, max: 15, avg: 0.33 (17558 samples)


But what is very interesting is:
SLOWLOG GET
 1) 1) (integer) 36
    2) (integer) 1391709993
    3) (integer) 10835
    4) 1) ""GET""
       2) ""2ads10percent_ihgydxhzfodzscqmovif""
 2) 1) (integer) 35
    2) (integer) 1391709950
    3) (integer) 34155
    4) 1) ""GET""
       2) ""2ads10percent_rmywqesssitmfksetzvj""
 3) 1) (integer) 34
    2) (integer) 1391709830
    3) (integer) 34863
    4) 1) ""GET""
       2) ""2ads10percent_tteeoomiimcgdzcocuqs""
 4) 1) (integer) 33
    2) (integer) 1391709710
    3) (integer) 35754
    4) 1) ""GET""
       2) ""2ads10percent_txewdysvbluimspsirgo""
5) 1) (integer) 32
    2) (integer) 1391709566
    3) (integer) 30654
    4) 1) ""SADD""
       2) ""288:1391706000000""
       3) ""2ads10percent_conlonuorzbzlplinmum""
       4) ""2ads10percent_oqtlcyhnbmefudzwzzmb""


Here comment from Salvatore regarding this log:
Redis is single threaded, so the SLOWLOG is reporting that the Redis instance took 34 milliseconds to execute the GET. This means that the Redis process was stopped in the middle of the computation by the kernel, out of its control, while it was not doing any syscall.

This means that there are two possibilities:
A) There are swapped out pages that when accessed need to be loaded. You can verify this as explained in the ""latency"" page at redis.io, unless that in this case you can't since it is Amazon business.
B) The Hypervisor is not giving the VM the ability to run in a decent way for some reason.
There are people here that are much more expert than me and can comment about why an EC2 instance should stop in the middle of a computation for 50 milliseconds.

Can you advise?"
Amazon Elasticache	"Very uneven CPU load
Background: Online MMORPG, a few thousand logged in. Currently around 20 c1.medium instances in one autoscale group. 1 Elasticache-cluster with 3 m1.small nodes. Elasticache is handling sessions + ingame caching/settings. PHP 5.3.28 (fpm-fcgi) + Nginx 1.4.4, memcache 2.2.6 via PECL. Not using the aws cluster client.

We have used this setup for over a year and it have worked fine. Now suddenly one of the elasticache nodes spikes 100% load, the other 2 nodes are only at ~15% CPU load, causing players to be logged out. Number of connections are almost identical. But for some reason the heavy loaded node receives far more data. We have tried to setup a new cluster to no avail, same thing happens. We even tried Apache 2.4 + PHP 5.5, same effect. We cannot think of any changes made that can cause this. Any help appreciated."
Amazon Elasticache	"Re: Very uneven CPU load
We found the problem in the code."
Amazon Elasticache	"ElastiCache (setup before VPC support) - want to now connect from VPC
I have an elasticache node from 2011 - I've recently started moving instances from EC2 to inside our VPC. I don't seem to be able to connect to my elasticache node any longer from within the VPC. Do I need to create an elasticcache node in the VPC for it to work?"
Amazon Elasticache	"Re: ElastiCache (setup before VPC support) - want to now connect from VPC
Hi,

ElastiCache cache nodes deployed outside a VPC are assigned an external IP address (to which the endpoint/DNS Name resolves), which provides connectivity from Amazon Elastic Compute Cloud (EC2) instances.  

Since you have migrated to VPC, you need to:

1.  create a Cache Subnet Group, http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.CreatingSubnetGroup.html
2. create a Cache Cluster, http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.CreatingCacheCluster.html
3. and the connect to your cluster in VPC, http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.Connecting.html

If you are still experiencing issues after this, let us know.


Ashley"
Amazon Elasticache	"Redis S3 Permissions for Snapshots
I get the following error when launching my redis cluster:
""No permission to access S3 object""

What user do I need to grant permissions for the S3 bucket?"
Amazon Elasticache	"Re: Redis S3 Permissions for Snapshots
Hi,

You would need to set Permissions on your Snapshot file. You must grant read access on the snapshot in Amazon S3 so that ElastiCache can access it.

To grant read access on the snapshot file follow these steps:

1. Sign in to the AWS Management Console and open the Amazon S3 console at https://console.aws.amazon.com/s3/.

2. Click All Buckets, and then click the name of the Amazon S3 bucket that contains your snapshot file.

3. Click the name of your snapshot file, and then select Properties from the Actions drop-down menu.

4. Click Permissions, and then click Add more permissions. In the Grantee field, type the following email address:

    aws-scs-s3-readonly@amazon.com

    Click Open/Download, and then click Save.

    Note: The aws-scs-s3-readonly account is used exclusively for customers uploading Redis snapshot data from Amazon S3.


Ashley."
Amazon Elasticache	"migration to elasticache service
hi Amazon!

we want to migrate our celery based queues from mongo to elasticache redis

so in relation to it we have a couple of questions:

1) is elasticache good just for cache or it's good for queues too?
2) if will do replication group setup - in case of master fail will the read member be automatically promoted to master?
3) if the read member of replication group is promoted to master, will it automatically receive the master's endpoint name, or we'll then need to make changes into our application configuration so it will point to new master?
4)  about storage size - I haven't found any configuration for storage size, does it mean that it's infinitive?

thanks

Edited by: vovan11 on Feb 3, 2014 7:00 AM"
Amazon Elasticache	"Re: migration to elasticache service
amazon could you please reply?

thanks"
Amazon Elasticache	"JavaScript library for Amazon ElastiCache
I would like to develop a client side mashup which will consume multiple APIs, process data and cache results in the cloud for other users, all using JavaScript. Will this be possible with ElastiCache?"
Amazon Elasticache	"Re: JavaScript library for Amazon ElastiCache
As far as I know, there is no way to talk to Memcached or Redis in ElastiCache directly from JavaScript. The AWS SDK for JavaScript in the Browser does however support the DynamoDB database service if that can help."
Amazon Elasticache	"Adding ""other"" accounts to ElastiCache security groups - keeps revoking
We run a few accounts (based on internal departments) with consolidated billing. So I am trying to let the servers of one account use the elasticache instance of the main/parent account. When trying to add a secondary account and one of its EC2 security groups to the Cache Security Group, I am able to add, but the value soon turns to ""Revoking"" and is removed.

I am getting the same results using the GUI and the CLI. Here's my cli call:

aws elasticache authorize-cache-security-group-ingress --cache-security-group-name wfe_security --ec2-security-group-name web-server --ec2-security-group-owner-id 987654321000


And when I describe-cache-security-groups a moment later, I get this:

{
        ""Status"": ""revoking"", 
        ""EC2SecurityGroupName"": ""web-server"", 
        ""EC2SecurityGroupOwnerId"": ""987654321000""
}


My EC2 instances in the ""other"" account, and its security group, are within a VPC. Is that a deal-breaker that I'm not seeing in the documentation? I have open server egress in the EC2 security group, so those instances should be able to reach the EC node, but I'm thinking some internal check is not validating.

Edited by: mageen on Jan 27, 2014 9:51 AM"
Amazon Elasticache	"Re: Adding ""other"" accounts to ElastiCache security groups - keeps revoking
I see now that this is not possible from within a VPC, after enough searching these forums.

https://forums.aws.amazon.com/thread.jspa?messageID=382550&#382550

Would love to see it as a new feature sometime soon, either to spin up an instance from within a VPC, or to see VPC-to-ElastiCache connectivity."
Amazon Elasticache	"Sporadic ElastiCache performance (latency)
Hi all,

We're using ElastiCache as a low latency cache in front of RDS and a couple of external API calls.

We don't have high throughput on EC2 (maybe 2-5qps), but we are aiming for consistent performance. Ideally 1-5ms with 99% percentile max around 10ms. 

Our non ec2 workloads currently run our own Memcache and have a 99th percentile of 4ms on throughputs of 4,000qps. 

ElastiCache seems to work well 75% of the time and very poorly for 25% of the time. I'm not sure whether it's DNS (some people suggest using the nodes IP address, but that's not a good idea for failover) or the node? We've rebooted the cache node a few times but doesn't seem to help.

I've added a graph of our performance for the last 3 hours which shows the kind of variation we're getting.

Does anyone have any suggestions how we can get consistent performance from ElastiCache?"
Amazon Elasticache	"Re: Sporadic ElastiCache performance (latency)
Hello, 

I am sorry to here you are having a latency issue with ElastiCache.
Unfortunately I was not able to find your account.
Can you send a PM  with your account and Elasticache information?

Regards, 

Mike P."
Amazon Elasticache	"Creating Elastic Cache connection pool is taking long time
Creating Elastic Cache connection pool is taking long time. It takes 2 seconds to create one connection. Im using the amazon auto discovery java client with cluster end point. i need to access 1000 keys per second. Any suggestions on pool size configuration and means for making the connection pool to get created will be highly appreciated.

for (int i = 0; i < POOLSIZE; i++) 
{
  MemcachedClient c = new MemcachedClient(new InetSocketAddress(ENDPOINT, ClusterPort));  
  m = c;
}


Avinash"
Amazon Elasticache	"Re: Creating Elastic Cache connection pool is taking long time
I'm having a similar issue. Every so often it will take 5 seconds (almost exactly.. every time this happens) to create a connection."
Amazon Elasticache	"Re: Creating Elastic Cache connection pool is taking long time
I found out this was a problem with the client rather than the server. Adding more clients to my web tier (rather than increasing the size of my Elasticache pool) was what solved the problem."
Amazon Elasticache	"Ways to connect to VPC Redis?
Hi,

I've sent a new Redis node running on VPC, but unable to connect to from outside via any external tool. Only EC2 machines in same VPC work.

Is there any way to do it properly?

Thanks."
Amazon Elasticache	"Re: Ways to connect to VPC Redis?
Hello,

Unfortunately, it is not possible to connect to an ElastiCache instance from an external location. As per FAQ:

""Amazon ElastiCache Nodes, deployed within a VPC, can never be accessed from the Internet or from EC2 Instances outside the VPC.""

Reference: http://aws.amazon.com/elasticache/faqs/#general-security

Regards,
Szymon"
Amazon Elasticache	"Elasticache memcached swap usuage
Hi Team,

I need some explanation on how the swap work on memcached. We have recently moved our Apps to use Elasticache to act as an disturbed cache shared by our server and it was working fine for a couple of days. Then i start to notice the swap started to build up even i have free memory available. I have tried to reboot the cache server, however the swap usage didn't get reset.

The whole point of running memached is to have all cache reside in the memory, not swap, as to my understanding this will significantly degrade performance. Can someone explain how this work and what i need to avoid for my cache to start swapping.

Also is there an option available that i have lock all cache in memory so NOTHING go to swap?

Your help will be much appreciated.

Regards,
Gavy"
Amazon Elasticache	"Re: Elasticache memcached swap usuage
Any help would be greatly appreciated. Thanks!"
Amazon Elasticache	"Re: Elasticache memcached swap usuage
Hello,

Can you clarify whether the swap usage is growing continuously or perhaps it stabilized at a certain level?

In general, as long as the swap usage is not growing indefinitely, you have free space in the memcached slabs (see ""stats slabs"" memcached command) and you are not observing any application slowness, you need not be worried.

Please feel free to share more details about the swap utilization growth and the memcached memory utilization so that the community could take a closer look.

Regards,
Szymon"
Amazon Elasticache	"How to View Objects in ElasticCache
i have put some objects into ElasticCache so i am trying to see where i can view the added objects in Amazon AWS console, 

any help is greatly appreciated 

regards
DP"
Amazon Elasticache	"Re: How to View Objects in ElasticCache
Hello,

The ElastiCache web console does not provide visibility into the cache's contents.

To see the objects in a cache, telnet to the cache node on the service (typically 11211 for Memcached/ElastiCache) and run commands against the node directly.

To list the objects in a slab, for example, you can run the command:
stats cachedump id count

To show the first 50 keys in slab 3, the command would be:
stats cachedump 3 50

If the key is known, the 'get' command may be used, such as:
get keyname"
Amazon Elasticache	"Lots of Audit failure messages in Event log, brute force attack?
I can see lots of Audit failure messages in our windows instance event log. Is this a brute-force attack? What action could be taken if it is so
Thanks and regards
Philip"
Amazon Elasticache	"Re: Lots of Audit failure messages in Event log, brute force attack?
Changed the security policy using ec2 console limiting rdp access from our ip address. Hope this should prevent further attacks. Earlier rdp access was allowed from any ip address.
Philip"
Amazon Elasticache	"Redis elasticache at 100% CPU constantly
Hi,

Our redis cache instance has been pegged at 100% for the past couple of days. Could please someone help us knowing why? The load hasn't changed and neither the access pattern.

How can we debug this case?

Thanks,
Arif Amirani"
Amazon Elasticache	"Re: Redis elasticache at 100% CPU constantly
Apparently we had deployed a new feature that used zrange that reverted to have the CPU go back to normal.

Has anyone faced issues with zrange queries on Elasticache?"
Amazon Elasticache	"Some keys/values aren't pushed
Hello all,

I have a job which flush the elasticache, wait at least 30 seconds and then pushes 3.170 millions (unique key)/values with an expire date of 30 days.
After the push is finished, I only have 1.58 million items in elasticache, almost exactly the HALF of items I orginaly pushed.

I tried to push slower, tried to do a get right after each set, ... but it doesn't change anything, i still have missing items (not always the same BTW).

Does anyone have an idea ? I use a m1.small but it doesn't seem to be full ... 

Thank you for your help,
Nelson.

Edited by: nelsou on Jan 4, 2014 2:28 AM"
Amazon Elasticache	"Re: Some keys/values aren't pushed
Hello,

Here's a couple of things I would suggest to consider in such situation:

1. Were all the objects successfully inserted into memcached? You can try to compute the number of successful/failed requests based on the return status of memcached set command.
2. Are you using multi-node cache cluster? Perhaps you are using a two-node cluster, your software writes objects to both of them but selects from only one node?
3. Is there free memory in appropriate memory slabs? Internally, memcached stores data in ""slab classes"" of different sizes, which are separated from each other in terms of item eviction. While the memcached server may have free memory, there may be no free space in some of the slabs.

Memcached has useful commands such as ""STATS"", ""STATS ITEMS"" and ""STATS SLABS"" which may help you diagnose memory utilization. The commands and their output is described here: https://github.com/memcached/memcached/blob/master/doc/protocol.txt

Also, I have found an article which explains memcached memory architecture very nicely, you may find it very useful: http://work.tinou.com/2011/04/memcached-for-dummies.html

Regards,
Szymon"
Amazon Elasticache	"Re: Some keys/values aren't pushed
Hello Szymon,

You were right, slabs were all full. I installed a bigger elasticache and it works like a charm. Thx you for your link, it very interesting.

Nelson."
Amazon Elasticache	"Elasticache Clusters have stopped working
Late last night, I started getting alerts that Elasticache was rebooting nodes. The issue continued all night, and this morning, nothing is in the cache, and consequently all of the sites are gummed up.

I added nodes, and no change. I also built a new cluster, and that one is exhibiting the same issue.

I now suspect my app, but we have not made any changes over the last couple of years. This has run fine the entire time.

What causes the nodes to be rebooted automatically? Could it be something the app is trying to store (maybe something too large?).

My two clusters are:

rg-live.ttpi8h.cfg.use1.cache.amazonaws.com:11211
rg2-live.ttpi8h.cfg.use1.cache.amazonaws.com:11211

Thanks for working on Christmas.

Edited by: cajund on Dec 25, 2013 12:11 PM"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Here's the CloudWatch graph from the lat 90 minutes. There are two clusters here with 2 nodes each.

Thanks,"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hi,

I've sent this thread to the ElastiCache team to look into.  We hope to have an answer for you as soon as possible.

-Vinay"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hi there cajund,

We have had the ElastiCache team look deeper into this for you, however they have noticed that you have now deleted the instances in question, so they were unable to do a deep investigation as to what happened from our side.

They have been able to see the timeline of where your cache nodes were being continuously replaced but they are unfortunately not able to find out why. They have suggested that you examine your usage pattern and see if there have been any changes that could affect the stability of memcached.

Please post back to this thread if this issue re-occurs for you.

Best regards,
Phil P"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hi,

Thanks for getting back to me.

We had to reboot a number of times to resolve the issue. It was never deleted, but we had to take action as our sites were not serving pages.

Here's what we learned so far. The parameter group setting 'max_item_size' was set to 100,000,000. This was within the range for the setting, but for some reason, with the setting this high, the nodes would reboot after about 5 or 10 minutes. This was consistent between the old and the new clusters.

We dropped this setting to 50,000,000 (on rg-live2) and the rebooting stopped. However, we are seeing a lot of memory being used on the cluster. The other cluster, (rg-live) has this parameter set at 2Mb and it seems to be using less memory.

Right now, we are making the assumption that we simply ran out of memory and that caused the nodes to reboot. However, the higher setting has been the case for many months (about 6 or 7), and there have not been any changes in usage patterns. If anything, the rebooting started at a particularly low time of traffic (Christmas Eve) - a more unlikely time to see problems.

We are not sure how to proceed. We aren't able to use the full range of max_item_size, and in the event that we need to set it higher, what should we do? Should we move up to a larger instance class?

Thanks again."
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hi there cajund,

Whilst we unable to say for certain, however if you think you are hitting a memory bottleneck then it may be worth trying the next size up in instance class to see if that helps avoid the issue moving forwards.

Please post back if you continue to experience these issues so we can try to take a deeper look from this side for you.

Best regards,
Phil P"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
I can make the issue happen again by simply moving the setting back to the original value, but the problem is that the site performance depends on these cache servers functioning. So, if I revert the setting, how long do you need to see it in action? I don't want this to be an issue for very long.

Thanks."
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hi cajund,

Thanks for this and apologies I didn't realize that you are able to easily reproduce this issue.

I'll pass your comments back through to our service team to review and we will post back with additional information around this and if we need you to change the setting back to the original value.

We will post back to this thread when we have more information for you.

Best regards,
Phil P"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hello,

The problem looks to be the high max_item_size parameter. With this configuration option, the memcached slab allocator allocates contiguous pages of 100MB or 50MB to break down into smaller chunks.

Setting the parameter to be so high on a cache.m1.small can easily cause memory issues (and in this case, rebooting). We generally don't suggest setting the max_item_size parameter to be over 1MB, but if that is needed, then I suggest moving to an instance class with more memory.

Rob."
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Thanks for the reply.

Just one more question. We have had this setting in place for a very long time (more than 6 months). Any ideas as to why it started acting up recently? Was there a software upgrade or something to initiate these reboots? It seems illogical that a setting that was causing the memory and reboot issues would take such a long time to manifest a problem.

Thanks again."
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hi there cajund,

We have had the ElastiCache team review your question and they have come back with the following:
The date/time when the reboots started occurring do not correlate to any routine maintenance or upgrade on our end. We intend to recreate this issue so that we can understand it better, but that may not match what actually occurred in the customer's case. Short of a fairly recent change to the behavior of the customer's application, I am not sure why the cache nodes would start acting up 6 months later.+

Unfortunately there isn't much else we can suggest around this at this stage other than what has previously been advised.

Best regards,
Phil P"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Thanks Phil P,

If they are interested in seeing this in action, please ask them to reach out to me directly and we can coordinate a time when I can recreate the scenario. Because I have two clusters, I can have one of them cycle for a while during their testing.

Thanks again, and Happy New Year to all of you at AWS!"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hello,

I've just passed that offer across to the team - thanks 

Richard"
Amazon Elasticache	"Re: Elasticache Clusters have stopped working
Hello cajund,

I've sent you a PM with the findings from the ElastiCache Team.

Regards,
Peter"
Amazon Elasticache	"ElastiCache implementation using .net
Hi,

I want to implement ElastiCache in .net web application. Wanted to store query result data in ElastiCache. to implement this I m not finding any .net code/configuration. 

using ADO .net framework for DB(MSSQL server) operations. I have created  ElastiCache cluster through AWS console.

please help me on this ....

thank you......"
Amazon Elasticache	"EC2 Instance error Still waiting for meta-data accessibility
HI,
My instance id is i-7af29d2c ,i am getting error ""Still waiting for meta-data accessibility""
Not able to start instance.

Thanks,
Tuhin"
Amazon Elasticache	"Re: EC2 Instance error Still waiting for meta-data accessibility
Hello

The main reason why this may have occurred is that a static IP outside the range of your VPC subnet was assigned. Please attach a second ENI to the instance which will allow the instance to contact the meta-data service, allowing you access to the instance to fix the broken setting.

More info: http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html#create_eni

If this does not resolve, please let us know and we can look into the issue further. Any additional details such as whether the instance was accessible before or configurations on the instance will all be helpful.

Regards, 
Monique B"
Amazon Elasticache	"Re: EC2 Instance error Still waiting for meta-data accessibility
HI,
How is this static IP assigned?
I have not changed any setting.

Thanks,
Tuhin"
Amazon Elasticache	"Re: EC2 Instance error Still waiting for meta-data accessibility
Hello,

We provide your instances in a VPC with private (static) IP addresses upon launch of the instance. 

http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-ip-addressing.html

I see that instance is currently stopped. Were you able to complete the steps outlined by Monique?

Best regards,

Bryan"
Amazon Elasticache	"Elasticache best option to quickly write tracking data from EC2 instances?
Hi Folks.

I have a need, which is that of being able to quickly store tracking data, large volumes of very small atomic strings, generated by EC2 instances -- to somewhere -- to eventually ferry it into Redshift.

This is an assumption of mine of course, all I know is that the connect-and-write routine for all of these write events is too great if writing directly from EC2 to Redshift.  Amazon SQS is too slow, and its alternatives like RabbitMQ look like a pain to set up (also have read about disappearing messages on RabbitMQ).

How would you solve this?  Any experience in writing to memcached?  Any insights into how it'd be best pulled and written from there?

Thanks for your insights.  At the early planning phases here."
Amazon Elasticache	"Re: Elasticache best option to quickly write tracking data from EC2 instances?
You could look into the recently announced Amazon Kinesis service. My limited preview application is still pending, so I don't really know that much about it yet, but it sounds like it could be worth investigating."
Amazon Elasticache	"Re: Elasticache best option to quickly write tracking data from EC2 instances?
Hi,

Thank you for posting this interesting question.

Examples of AWS-based solutions that come to my mind:

1. Amazon Kinesis: not yet available in all regions but that's probably exactly what you are looking for.
2. EC2 instances behind ELB, running some simple code that would just save request for further processing.

I had to solve similar challenge a couple of years ago and here's what I did:

I used Nginx as front-end, with Drizzle module, which logged requests directly in MySQL table (MEMORY). That means all requests were handled directly in Nginx, without executing any scripts. MySQL table was asynchronously processed every few minutes.

I remember that it was able to log somewhere between 30 and 40k requests per second on a quad-core laptop.

You would have to do quite a bit of research and coding to get similar solution up and running so perhaps you might just want to give Kinesis a try.

Regards,
Szymon"
Amazon Elasticache	"Scaling up a redis elasticache replication group
Hello,

I've been trying to change our primary redis elasticache replication group from using medium instances to using large ones. I expected to be able to select instance size when adding a read slave to the replication group, then be able to promote that instance to primary in order to have zero downtime.
However it seems I'm not able to select instance size either through the web interface or the CLI tools (can't pass any additional parameters when creating a cache cluster that belongs to a replication group).

How can I scale up my redis elasticache cluster?"
Amazon Elasticache	"Re: Scaling up a redis elasticache replication group
I too would like to know the answer to this. We're just starting to consider ElastiCache and could not find an answer to this."
Amazon Elasticache	"Re: Scaling up a redis elasticache replication group
Hello,

Unfortunately ElastiCache doesn't yet support modifying node sizes. What you can do in Redis is:

1. Create EC2-based redis instance.
2. Attach the EC2-based instance as replication slave to ElastiCache Instance.
3. Create RDB snapshot file on EC2-based slave and upload it to S3.
4. Create new ElastiCache Redis instance of the desired size and seed it using the RDB snapshot file.

Reference:
http://aws.amazon.com/elasticache/faqs/#rf4
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingCacheClusters.html#ManagingCacheClusters.SeedingRedis

This will not give you zero downtime but that's what is currently possible. We are planning to add support of creating RDB snapshots directly from ElastiCache nodes.

Please note that - by design - caches are meant to act as ""helpers"" and shouldn't be used in a way which would make them a critical dependency in an application. Cache should always be optional and an application should be able to work without it (it may work slower but shouldn't fail).

If you need persistent, fast and scalable key=>value database, you might want to consider using Amazon DynamoDB.

Regard,
Szymon"
Amazon Elasticache	"can access standalone elastic cache ?
can we access standalone elastic cache service like RDS ? I have one elastic cache cluster running and trying from last couple of days to connect but keep getting timeout error so just wondering if we can access it without EC2 instance, colleague of mine sent me below thread,

https://forums.aws.amazon.com/thread.jspa?threadID=74827&tstart=0

Edited by: gnanesh on Dec 13, 2013 6:25 PM"
Amazon Elasticache	"Re: can access standalone elastic cache ?
At this point there is no access to ElastiCache from outside of EC2 network. 
http://aws.amazon.com/elasticache/faqs/#Can_I_access_Amazon_ElastiCache_from_outside_AWS

Could you elaborate on your use case for connecting to ElastiCache from outside of EC2, considering the latency implications? Your feedback would be very valuable."
Amazon Elasticache	"Re: can access standalone elastic cache ?
well we were trying to test elastic cache directly"
Amazon Elasticache	"Re: can access standalone elastic cache ?
Hi,

Please consider testing ElastiCache cluster from within the EC2 network, using an EC2 instance as a client machine.

Please note that accessing ElastiCache from the outside would mean that the latencies between client and the cache cluster would be unacceptably high. Therefore, it would defeat the purpose of using fast, in-memory cache.

Regards,
Szymon"
Amazon Elasticache	"AppFabric on ElastiCache
Hi,

Does AWS has any plans for supporting Microsoft AppFabric on ElastiCache? It should be very helpful for .NET users.

Best,
Kerem

Edited by: krmdmrr on Dec 15, 2013 1:07 AM"
Amazon Elasticache	"Re: AppFabric on ElastiCache
Hello,

Thanks for the feature request. I have passed it on to the ElastiCache team. 

I cannot provide specific guidance on whether we will implement such a feature, but our road map is driven by customer requests like this. If anyone else out there is looking for such a feature, please feel free to +1 this thread. 

Thanks for the input!

Regards,

Alastair"
Amazon Elasticache	"Re: AppFabric on ElastiCache
Thanks Alastair."
Amazon Elasticache	"""Recovering cache nodes""
On 2013-12-01 2:56 UTC we saw a message in our ElastiCache console ""Recovering cache nodes 0001"" / ""Finished recovery for cache nodes 0001"". What does this message indicate?"
Amazon Elasticache	"Re: ""Recovering cache nodes""
Hello,

Thank you for posting. The message you're seeing indicates that ElastiCache detected an issue with one of your cache notes and automatic recovery was performed.

Amazon ElastiCache recovers nodes that are considered unhealthy due to software/hardware issues. The procedure is fully automatic and there is no action required on your end.

Please take a look at the following FAQ entry for more information:
http://aws.amazon.com/elasticache/faqs/#mcc4

I hope this clarifies the event, please feel free to respond in this thread if you have any further questions."
Amazon Elasticache	"Node Outage
I recently experienced a random node outage. Here's what I know:

redisdb   cache-cluster   Sat Nov 30 00:59:01 GMT-500 2013   Finished recovery for cache nodes 0001
redisdb   cache-cluster   Sat Nov 30 00:55:08 GMT-500 2013   Recovering cache nodes 0001

Can anyone shed any light on why this happened? I'm new to AWS. Is this something I should expect to happen on a regular basis? Is there anyway I can get more warning?"
Amazon Elasticache	"Re: Node Outage
Hello,

Apologize for the inconvenience caused. 

Elasticache is a managed service and hence we monitor the health of cache nodes. When we detect any failure in terms of underlying host or application, we initiate recovery which at times provisions new nodes.

This does not happen always but also cannot say that would never happen. 

In order to get notified during such events, you can setup SNS alerts. More details could be found here : http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ElastiCacheSNS.html

Thanks,
Vivek"
Amazon Elasticache	"Node outage
Hi,

What may have caused this?

sessions  cache-cluster  Tue Nov 12 10:42:59 GMT+000 2013  Finished recovery for cache nodes 0001
sessions  cache-cluster  Tue Nov 12 10:37:49 GMT+000 2013  Recovering cache nodes 0001

As we were using it for session handling, attempts to communicate with it while the node was offline was causing our web services to segfault (a weird PHP bug it seems).

The node in question is sessions.gwkf6h.0001.euw1.cache.amazonaws.com.

Thanks,
Dan"
Amazon Elasticache	"Re: Node outage
Hi,

We are investigating the issue with your cache node, and will get back to you with our findings.

Thanks,
Mukesh"
Amazon Elasticache	"Re: Node outage
I experienced a similar outage on one of my nodes.  Any update?"
Amazon Elasticache	"DNS lookup incorrect?
One of our services stopped communicating to ElasticCache this morning. After investigation one server now resolves to our ElasticCache instance with one IP, while the other server that is working resolves ElasticCache to a different IP.

Both servers appear to be using the same DNS servers for the lookup but they return different results! nslookup returns different IPs for the same ElasticCache DNS entry. What is going on here?"
Amazon Elasticache	"Re: DNS lookup incorrect?
Hello,

Sounds like a DNS caching issue. Can you give me the name and region of your Elasticache and I'll take a look?

Richard"
Amazon Elasticache	"elasticache redis java client?
We are planing to use redis elasticache in our java app. I am wondering if there is a java client I can use, instead of using the REST API directly?

Thanks."
Amazon Elasticache	"Re: elasticache redis java client?
Jedis has worked great for us. 

https://github.com/xetorthio/jedis

If you are using spring, then you can use the caching annotations. 

Thanks,
Brian H"
Amazon Elasticache	"Why is Elasticache Security Group resolving to private 172.*.*. subnet
I am trying to connect to a redis node via the command line. I specifically added my ip address to the Security Group to allow inbound traffic over port 6379 and I'm not able to connect. 

I opened it up to allow all ip's access and was able to connect. Once connected I checked the list of connections and noticed the my ip address was resolving to a 172 private subnet address.

This is in a VPC and I connect via a VPN Gateway. I would think it should be resolving my ip address? Has anyone had this problem? I can't open it up to allow 172 networks to connect. 

Can someone from AWS offer an explanation and an acceptable workaround?"
Amazon Elasticache	"Re: Why is Elasticache Security Group resolving to private 172.*.*. subnet
Hello,

As you are connecting via a VPN connection your IP Address is updated and you are then seen as part of that specific subnet hence your IP Address becomes a 172.x.x.x.

For your Elasticache Node to be available to an instance or resource within a VPC you need to create a Cache Subnet Groups within the AWS Elasticache Console. You need to create the Cache Subnet Group first and then provision your Elasticache Node selecting the Cache Subnet Group during this process.

Best Regards,

Davin G."
Amazon Elasticache	"Re: Why is Elasticache Security Group resolving to private 172.*.*. subnet
Thanks Davin,

 I realize that is why it's resolving to the private subnet address. But I don't think it should be. I should be seen as my ip address. How can I restrict access it to it when it resolves to a 172 network? I need to be able to restrict access based on our known organizational ip's.

And, I do have a cache subnet. As I stated, I am able to connect when I open the port to all ip's.
I don't have a connection problem from other resources in the VPC. The problem is I need to connect to it via the command line to help trouble shoot issues, monitor, etc. 

For a workaround I installed the redis-cli tools on a server in the vpc that I can access. But I do believe there is a bug in how it's resolving my address.

Thanks,
Brian H

Edited by: rai2013 on Nov 20, 2013 3:54 PM"
Amazon Elasticache	"Re: Why is Elasticache Security Group resolving to private 172.*.*. subnet
Hello,

The entire reason for using a VPN is so that your connection is local to the subnet and you are seen as a local resource for access to those resources within the VPC/Subnet.

If this is a site-to-site VPN then you will need to check the configuration of your connection. I suspect that your organizations subnet/routing details are not being populated within your VPC and potentially the connection may be being natted instead so then the natted address is being seen as the source address. I would suggest checking the network configuration, depending on the device used by your company we do have documentation available to assist, initially I would suggest starting with the following:

http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_VPN.html

Best Regards,

Davin G."
Amazon Elasticache	"Re: Why is Elasticache Security Group resolving to private 172.*.*. subnet
Thanks Davin,
 That makes sense and something I can track down.

Brian H

Edited by: rai2013 on Nov 21, 2013 8:11 AM"
Amazon Elasticache	"Elasticache (Redis) FreeableMemory dropping fast
Why is the FreeableMemory dropping so quickly on our elasticache redis instance? 

When we log into redis, and look at the 'info' command, it shows 11.96M used, with a peak of 27.43M but the freeable memory is dropping at a rate of over 500M/day, and we will be out of free memory within a week? All other metrics on this instance looks fine. Our slave instance of redis shows this same behavior.

What consumes this 'freeable' memory if its not redis? How can we get this memory back? 

Any help/advice would be much appreciated."
Amazon Elasticache	"Re: Elasticache (Redis) FreeableMemory dropping fast
Hi, 

We have sent you a private message to obtain more information on your ElastiCache cluster.

Thanks,
Mukesh"
Amazon Elasticache	"Re: Elasticache (Redis) FreeableMemory dropping fast
I responded to your message. FreeableMemory is still dropping, now below 900M, with no changes in redis usage. Please help."
Amazon Elasticache	"Re: Elasticache (Redis) FreeableMemory dropping fast
In case this happens to others, the answer is that the memory was being consumed by OS cache, and it will be given back when needed. They've said there is 'no cause for concern here'."
Amazon Elasticache	"Can't create new memcached cluster @ ap-northeast-1a
Hi,

I attempted to create new memcached cluster @ ap-northeast-1a.

But the following error occured(with or without VPC):
cache.m1.small (VPC) is not currently supported in the availability zone ap-northeast-1a. Retry the launch with no availability zone or target: ap-northeast-1b, ap-northeast-1c.

cache.m1.small is not currently supported in the availability zone ap-northeast-1a. Retry the launch with no availability zone or target: ap-northeast-1b, ap-northeast-1c.

Using the same configuration, I can create cluster @ ap-northeast-1b or ap-northeast-1c.
It seems all AWS services are operating normally on service health dashboard.
What may have caused this?"
Amazon Elasticache	"ElasticCache Redis + PHP + BeanStalk possible?
Hi guys,
Its possible work with ElasticCache with Redis engine + BeanStalk + PHP app in BeanStalk?
If its possible, where i can find info about PHP working with Elasticache Redis ( reading and writing on it )?

Best regards."
Amazon Elasticache	"Re: ElasticCache Redis + PHP + BeanStalk possible?
byrondinho,

Thank you for your interest in Amazon ElastiCache.  There should be no problem with using a PHP application in AWS Elastic Beanstalk with an Amazon ElastiCache for Redis node.  There is some information about using AWS Elastic Beanstalk with Amazon ElastiCache  here.  Just make sure that the ElastiCache node you create is a Redis node.  You should be able to use any standard PHP Redis client with ElastiCache for Redis.  Using a PHP Redis client with ElastiCache for Redis will work the same as if you were connecting to Redis on your own server.  See your specific Redis client's documentation for how to read and write, etc.

Sincerely,
Tony"
Amazon Elasticache	"Re: ElasticCache Redis + PHP + BeanStalk possible?
Hey Tony that's GREAT.

Except there is no phpredis client installed on the php5.4-64bit beanstalk by default.

And I've spent the last day and a half trying to get it to install with igbinary support.

And it still won't work.

Why isn't the redis client built into the beanstalk ami by default?  This is beyond infuriating as my luck customizing beanstalks is roughly nil.  Nothing seems to work.  What gives? I have cached the source from github on an s3 bucket and have the following script in .ebextensions:

files:
  ""/tmp/phpredis.zip"":
    mode: ""000644""
    owner: root
    group: root
    source: http://mys3bucket/phpredis.zip

container_commands:
  01_installigbinary:
    command: ""sudo pecl install igbinary""
    ignoreErrors: true
  02_unzipphpredis:
    command: ""unzip phpredis.zip""
    cwd: ""/tmp""
    ignoreErrors: true
  03_phpizeredis:
    command: ""phpize""
    cwd: ""/tmp/phpredis-master""
  04_configureredis:
    command: ""./configure --enable-redis-igbinary""
    cwd: ""/tmp/phpredis-master""
  05_makeredis:
    command: ""sudo make install""
    cwd: ""/tmp/phpredis-master""

Also, these commands work fine if I ssh to the beanstalk instance and run them from the shell.  But not as part of the deploy script.

Edited by: lastuntakennickname on Nov 8, 2013 11:32 AM"
Amazon Elasticache	"Re: ElasticCache Redis + PHP + BeanStalk possible?
And I solved it.

Item 1 - get an s3 bucket, download the zip from https://github.com/nicolasff/phpredis/archive/master.zip and stick it on your S3 bucket - call it phpredis.zip.   This gives you a stable version that you can grab fast.

Item 2 - create a file called phpredis.conf in .ebextensions and put the following in it

files:
  ""/tmp/phpredis.zip"":
    mode: ""000644""
    owner: root
    group: root
    source: http://mybucket/path/to/phpredis.zip

container_commands:
  01_installigbinary:
    command: ""pecl install igbinary""
    ignoreErrors: true
  02_unzipphpredis:
    command: ""unzip phpredis.zip""
    cwd: ""/tmp""
    ignoreErrors: true
  03_phpizeredis:
    command: ""phpize""
    cwd: ""/tmp/phpredis-master""
  04_configureredis:
    command: ""./configure --enable-redis-igbinary &> /tmp/phpredis.log""
    cwd: ""/tmp/phpredis-master""
  05_makeredis:
    command: ""make install &> /tmp/phpredis.log""
    cwd: ""/tmp/phpredis-master""
  06_cleanup:
    command: ""rm -rf phpredis*""
    cwd: ""/tmp""
    ignoreError: true
  07_updatephp:
    command: ""echo 'extension=redis.so' > /etc/php.d/redis.ini""
  08_bounceapache:
    command: ""apachectl restart""
    ignoreError: true

Save, add to git repo, do aws.push, pray.

But really this should be installed on the server as part of the base install.  This took a day and a half to get right."
Amazon Elasticache	"Elasticache Security Group Issue
Currently my elasticache security groups are not allowing me to add any of my EC2 instances. In fact they don't even show up as an option anymore. 

previously I was able to add a few EC2 security groups to older elasticache security groups, and those are still showing authorized. 

Has any one else experienced this kind of issue? Initially I thought it may be a browser compatibility problem, but I have logged in via multiple browsers on multiple machines."
Amazon Elasticache	"images caching
Hello everybody,

Is it a good idea to use elasticache to cache images ? is there a 1Mb limit for the objecs I can cache ? 

thank you  a lot"
Amazon Elasticache	"Re: images caching
That is a good question. My initial reaction is ""no"", but some more information is required to give you a complete answer. Where are these images being stored and how do you intend to use them?"
Amazon Elasticache	"Re: images caching
Where are these images being stored

on a mongodb database

how do you intend to use them?

instead of getting image from database i prefer to use memcache"
Amazon Elasticache	"Re: images caching
The size limit appears to be configurable in ElastiCache. I believe the ""max_item_size"" parameter group option corresponds to what's being described under ""Configurable maximum item size"" on https://code.google.com/p/memcached/wiki/ReleaseNotes142. As there is a recommendation against increasing the limit, it seems like what you really need is input from someone who have done this successfully.

If you are somehow serving these images to users, CloudFront would probably be a much better choice. But I guess your use case might as well involve something else entirely."
Amazon Elasticache	"Re: images caching
I didn't find when change this parametre on the elasticcache interface 

I have only config_size_max but it 's not modifiable"
Amazon Elasticache	"Re: images caching
It sounds like you are on the first page, which displays 1 - 10 of currently 41 items. You can navigate to the next page in the upper right corner of the table. You'll need to create your own parameter group to change the value, though."
Amazon Elasticache	"AWS API inconsistent when creating a redis read replica
The create-cache-cluster has the following required parameters:

CacheClusterId
CacheNodeType
Engine
NumCacheNodes


Source: CreateCacheCluster

However, when attempting to create a read-only replica, only the following should be passed:

CacheClusterId
ReplicationGroupId


Source: Adding a Read Replica to a Replication Group

The problem is that the SDK developers have implemented the required parameters (correctly), which prevents calling the method without specifying the additional (required) parameters.

This results in, ""A client error (InvalidParameterCombination) occurred: Cannot specify additional cache cluster parameters when creating a replica cluster"".

I initially proposed an alias be added to an sdk, however, it was pointed out that the underlying API should probably be made more clear.  Pull Request on aws-sdk-rugy"
Amazon Elasticache	"Re: AWS API inconsistent when creating a redis read replica
Hello,

The SDK has already been updated and those parameters are now optional.

More details could be found here : http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_CreateCacheCluster.html

Please let us know if you have any questions.

Thanks,
Vivek"
Amazon Elasticache	"cannot add aws accountid
While adding securrity group..
Add valid AWS accountId and valid security group name, which is in the account..
But nothing happens zip zero..

Default aws account works fine, but nothing else..

What gives.."
Amazon Elasticache	"Re: cannot add aws accountid
Hi myawsdude,

Kindly confirm the following:

1)Is the Security group you wish to add within the same region?
2)Can you provide us with the Instance ID you wish to provide access to Elasticache(Which belongs to the other account)?
3)Please also provide the Elasticache ID.

Regards,

Coenraad

Edited by: Coenraad@AWS on Oct 26, 2013 3:09 AM"
Amazon Elasticache	"Re: cannot add aws accountid
1)Is the Security group you wish to add within the same region?
yes, all in Sydney, tried several..
All are in ap-southeast-2b 

2)Can you provide us with the Instance ID you wish to provide access to Elasticache(Which belongs to the other account)?

Can only add security groups to the screen, but one of the instances in the group i was trying is i-3c983301..
At one try it did attempt to add, but then just does nothing, i.e console does absolutely nothing, and no messages, errors or anything... just brain dead..

3)Please also provide the Elasticache ID.
I have deleted, as gave up after many tries, and nothing..
But logs should be in my account..

I must be able to use across multiple accounts, otherwise the service is unusable.."
Amazon Elasticache	"Re: cannot add aws accountid
Hello,

I'm sorry for the difficulty you've been facing.

The issue here is that in a VPC, Security Groups must be identified by ID, not by name.  In addition, you can only reference other Security Group IDs from the same VPC, not other VPCs in your account, VPCs from other accounts, or any groups from EC2 Classic.

That is why you receive the ""EC2 security group smsf365 owned by 126610524135 does not exist"" error.

For example, specify sg-97eff2fb rather than smsf365.
This is different than the behavior in EC2 Classic you may be accustomed to.

One solution is to add rules for the Source IP addresses from which you wish to allow traffic.

For more information about Security Groups in VPC, please review this guide:
http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_SecurityGroups.html#VPC_Security_Group_Differences

For more information about VPC by Default and which regions you might have it:
http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/default-vpc.html
https://forums.aws.amazon.com/ann.jspa?annID=1875

Best regards,

Benjamin R.

Edited by: BenjaminR@AWS on Oct 31, 2013 2:51 PM"
Amazon Elasticache	"Re: cannot add aws accountid
See email, tried Ids as well as name still does not work..

It really cannot be this hard, to simply use a basic memcached service in AWS.."
Amazon Elasticache	"Re: cannot add aws accountid
""In addition, you can only reference other Security Group IDs from the same VPC""

If I understand this correctly, this is brain dead, the idea of a memcached server is to provide common caching to resources..
I can understand if the elastic cache is inside the VPN, but it is not.."
Amazon Elasticache	"Elasticache Redis backups on S3
The docs are mentioning S3 RDB backups for redis instances will be available ""soon"". Is there any timeframe for that?

We are currently having issues with getting our data out of Elasticache since none of the EC2 instances seem to be powerful enough to create a new slave out of a running CacheCluster node. The only thing we're getting is an endless loop of

Slave -> please give me data
Master -> here you are, all my data in a batch
Slave -> I'm done initializing the database, what now?
Master -> You're too far behind, start from the beginning

Right now, it is impossible to create a running slave of an Elasticache instance. Even if there is literally zero traffic on the master node the slave isn't going to reach a consistent state.

Any help on the issue described would be well appreciated. Thanks!"
Amazon Elasticache	"Re: Elasticache Redis backups on S3
Hi,

We have sent you a private message to obtain information about your ElastiCache Cluster that will help us investigate the problem.

Thanks,
Mukesh"
Amazon Elasticache	"how to use ""Cache Node Auto Discovery""
If I want to use the ""Cache Node Auto Discovery"", what I can do?"
Amazon Elasticache	"Re: how to use ""Cache Node Auto Discovery""
Hi,

Thanks for considering ElastiCache.

Please follow the guidance available in the ElastiCache documentation: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html

Thanks,
Mukesh"
Amazon Elasticache	"Elastic cache performance problem?
Hi,

Since 6:15 GMT, we are experiencing delayed times in our elastic cache nodes.

We are suddenly seeing times increase from 28ms to 90ms.

We have already restarted the node but delays remain.

Is there an issue with aws elastic cache or some kind of change?

-S.

Edited by: spyroslam on Oct 29, 2013 2:17 AM"
Amazon Elasticache	"Re: Elastic cache performance problem?
Hello,

Sorry to hear that your running into problems with your cache cluster.

We have sent you a private message to obtain additional information for your ElastiCache cluster to investigate this issue.

Thanks,
Mukesh"
Amazon Elasticache	"Amazon Redis
Hello ,

After a while of running with Redis in DEV environment I decided to upgrade my production to amazon redis .

I configure my self 2 cluster and one replication group which include the two nodes ( one on each zone )

I also allow AOF on my replication group .

And from now I am planning to use the replication group CNAME .

My question is , Who is responsible for the fail over between the two instances ... , how much time it takes and in which cases ?

I understand the process that if the master is terminated ,,, ( I am not sure who is going to terminated it ) , what about all the other cases ? EBS problems , network problems , Zone issues ?

I sow that there is an option of making my instance Primary , so do I need to write a code which consider those decisions ?

Thanks ."
Amazon Elasticache	"Re: Amazon Redis
Hi eprhzv,

Thank you for using ElastiCache for Redis.  Your questions all seem to relate to figuring out a high availability (HA) strategy.  To answer your questions, let me start by explaining two concepts related to HA in ElastiCache.  First, if the ElastiCache service detects that a node has become unhealthy, it will replace that node with a healthy one.  The new node seamlessly takes the place of the old node; it has the same endpoint, the same name, the same configuration, etc.  In the specific case of a Redis replication group, if there is at least one healthy node in your replication group then the new node will sync its data from one of the healthy nodes before coming online.  Second, in a Redis replication group you can promote a read replica cluster to be the new primary cluster of the replication group.  The cluster which had been the primary will become a read replica.  In a replication group, there is a special endpoint called the Primary Endpoint which will be updated to always point to the primary node.

To answer your question about responsibility, the ElastiCache service will automatically perform replacements when needed, but currently it will not automatically failover to a read replica. Users can promote a read replica to be a master through the ElastiCache console, the CLI or the APIs.

Finally regarding how long failing over to a new master will take, it could vary widely based on a number of factors including the instance types, how much data is in the cache nodes, whether they are in the same AZ, etc.  Generally the longest parts of the operation tend to be getting the read replicas in sync with the new master, and the DNS propagation of endpoint changes.

Sincerely,

Tony"
Amazon Elasticache	"How fast items inserted into ElastiCache are available for retrieval?
Does ElastiCache have ""eventual consistency"" like DynamoDB and ColudSearch do?

When I insert an item into ElastiCache, it is expected another client would be able to retrieve it from the cache right the way (<< 1 second). Is it possible? Or it will be like DynamoDB and ColudSearch, that the item will be available from 0 to 20 seconds?

Thanks."
Amazon Elasticache	"Re: How fast items inserted into ElastiCache are available for retrieval?
Hello Samguo,

Elasticache does not have a 'eventual consistency' requirement, the only delay you may encounter is the update of read-replica's or nodes after the update of the read-write node with a large object or volume of data. If you have a number of additional nodes or read-replica's then this information may take additional time to update but this should literally be seconds as opposed to minutes.

If however you only have a single node then once you have uploaded the information into that node it is available immediately for any client to access.

Best Regards,

Davin G."
Amazon Elasticache	"Re: How fast items inserted into ElastiCache are available for retrieval?
Thanks Davin for the info. Just trying to understand how it works, I have these followup questions. 

Say I  write my object (small, several KBs at most) to my ElasticCache. I think it would land itself to the read-write node? Lets call it node A. There might be other read-only nodes that are replicas? Lets call them B and C.

So after my initial write, it would immediately available on node A? If at that time a client makes a read request to that object, where would that request land, A, B or C? Is it possible the object is available at A, but not B or C yet, and the read request lands on B or C, hence miss it?

Thanks again for your help!"
Amazon Elasticache	"Re: How fast items inserted into ElastiCache are available for retrieval?
Hi samguo,

Thanks for the follow up questions.  When you write data to ElastiCache, you write it to a specific endpoint.  The node that the data is written to depends on the endpoint that you use.  Each node has it's own end point, and the replication group has an additional endpoint called the primary endpoint which always points to the primary (read/write) node.  You can read more about the primary endpoint here.  

Generally there is no uncertainty about which node a read or write will land on, because you have to direct the read or write at a specific endpoint.  When you use client software to access ElastiCache, it might hide some of the details of which endpoint you are using for a specific read or write.  Please see your specific client's documentation to see how it manages endpoints.

In your example, you have a primary node A and two read replicas B and C in a replication group.  Node A is the only node which will accept writes.  As soon as you write the object to node A, it is immediately available on node A and can be read from there.  Nodes B and C will replicate the object.  There is some delay between when the object is written to the primary (node A) and when it is available on the read replicas (nodes B and C).  In ElastiCache, this delay is constantly measured and displayed on the management console and published in CloudWatch as the ""ReplicationLag"" metric.  You can read more about that  here

I hope this answers your questions.

Sincerely,

Tony"
Amazon Elasticache	"Re: How fast items inserted into ElastiCache are available for retrieval?
Thank you Tony for the response. It totally cleared things up for me!"
Amazon Elasticache	"any success at using the rdb file to boostrap a redis cluster?
Hey all,

Has anyone had success using a redis rdb file to bootstrap a cluster? (note it must be provided at creation time, not later) Did you do this for more than one database?

I have a rdb file that contains more than one database. When a cluster launches the keysets are always empty. I don't know of any logs or error messages for the cluster.

The rdb file is public (acl-public)."
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
okay, I've figured this out. If you enable AOF in a parameter group and launch a Redis cluster, it ignores the RDB on startup.

This is true in actual redis (not just AWS Redis(tm)), but it's possible to work around it.

Hmmm. I expect this will become a FAQ."
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
I'm not able to import my data.  How did you do it?

I tried appendonly=yes and appendonly=no. Neither work.

I'm using cache.m1.small 

I don't think it's a permissions problem, and the dump.rdb works fine on a stand-alone redis box.

David

Edited by: davidlutzz on Sep 11, 2013 12:15 AM"
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
David, what are you using a path to the rdb file? Also, what are the permissions? Make sure it's public ACL or dig out the elasticache IAM account magic."
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
Some further info.  I want the data I have to persist.

If I use the default parameter group the data imports fine.

However the default param group has appendonly=no So if the primary node ever reboots I lose my data. Having a replica won't help me, it'll lose the data when the primary comes up.

If I use a custom parameter group with appendonly=yes I can't import the data in the first place.

And I can't replicate in to the cluster to bootstrap it in the first place either.  I have to use the rdb import.  

Can't see a way around this issue.  I have a ticket open..."
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
good news David- you can change the configured group after launch. I think that's a decent workaround. See the screenshot.

Edited by: Ted Timmons on Sep 12, 2013 11:08 PM"
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
Thank you Ted!

It worked.  Yes this will get me up and running.

In summary:


bootstrap cluster with default parameters
create replication group
modify replication group to new parameter group with appendonly=yes    
profit


Now my cluster is seeded with data and I can reboot nodes without it disappearing.

Thanks again.
David"
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
Did you ever manage to get the RDB snapshot to work with a non-default parameter group? I played around with it a bit and never did. It seems like you must use the default parameter group in order to get the RDB snapshot to populate redis properly. Using a custom parameter group with the exact same values doesn't work. This seems like a huge issue. Can someone from Amazon confirm this bug?"
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
Hi,

Thank you for bringing the non-default parameter group issue to our attention.  We are actively investigating this and will update the thread when we have more information to share.

Thanks,
Tony

Edited by: Tony@AWS on Sep 17, 2013 1:00 PM"
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
I saw the same thing.  An identical copy of default doesn't work. Only the actual default parameter group works.  For importing.

David"
Amazon Elasticache	"Re: any success at using the rdb file to boostrap a redis cluster?
The problems identified in this thread are now fixed and deployed in all regions.

•	You can create a Redis cluster with an RDB seed file and use a custom (non-default) parameter group.
•	You can have AOF enabled while using an RDB seed file.

You no longer have to use the work around of enabling OAF after creating the cluster.

Thanks to everyone who helped find these issues and give feedback.

Sincerely,

Tony"
Amazon Elasticache	"Elasticache - command line tools: problems
hi!

I'm trying to run some commands on ElastiCache (redis) but returns or error or nothing appears:

root @ ip-** - *** - *** - *** bin # ElastiCache-describe-cache-clusters session
ElastiCache-describe-cache-clusters: Could not find the resource you requested: CacheCluster not found: session+
AWSRequestId: 556decc9-2ac8-11e3-8311-4b385af44c1+a


I am using version AmazonElastiCacheCli-1.9.000.

How to proceed?"
Amazon Elasticache	"Re: Elasticache - command line tools: problems
rmsysadmin,

Thank you for using ElastiCache.  I have some suggestions regarding your problem.  First, make sure everything is initialized properly, as described in this  AWS documentation.  Specifically, make sure the environment variables JAVA_HOME, AWS_ELASTICACHE_HOME, and AWS_CREDENTIAL_FILE are set properly.

In regards to the “CacheCluster not found” error message, I have a few suggestions for troubleshooting the problem.  You can try running the command without the name of a cluster to see all clusters in the region “./elasticache-describe-cache-clusters”.  This might help if the cluster you are expecting isn’t there, but some other clusters are there.

Another possibility is your request might not be going to the region that you are expecting.  You can specify the region using the --url parameter, or the AWS_ELASTICACHE_URL environment variable.  If you do not provide either one, then the request will default to us-east-1.  You can debug this by using “--show-request”.  Here’s an example, in a Linux shell:

prompt] ./elasticache-describe-cache-clusters --show-request

https://elasticache.us-east-1.amazonaws.com/?ShowCacheNodeInfo=false&MaxRecords=100&...

CACHECLUSTER  examplecluster  https://console.aws.amazon.com/elasticache/home#client-download:  cache.m1.xlarge  redis  creating  1  us-east-1b  2.6.13
      CACHESECURITYGROUP  default  active
      CACHEPARAMETERGROUP  default.redis2.6  in-syn

The first thing in the displayed request is the URL, which in this case is “https://elasticache.us-east-1.amazonaws.com”.  If I want to use, for example, region eu-west-1 instead, I can add “--url https://elasticache.eu-west-1.amazonaws.com” to the command, or I can run the command “export AWS_ELASTICACHE_URL=https://elasticache.eu-west-1.amazonaws.com” so that I don’t have to include the url parameter for every CLI command.

There is also some additional  AWS documentation for the ElastiCache CLI .  I hope this helps with your problem.  If not, please post an update and I will gladly continue helping.

Sincerely,

Tony"
Amazon Elasticache	"Re: Elasticache - command line tools: problems
Hi,

detailing

If I type:

prompt]# java -version
java version ""1.6.0_24""
OpenJDK Runtime Environment (IcedTea6 1.11.11.90) (amazon-62.1.11.11.90.55.amzn1-x86_64)
OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode)

In my .bash_profile I have:

export AWS_ELASTICACHE_HOME=/opt/aws/AmazonElastiCacheCli-1.9.000
export AWS_CREDENTIAL_FILE=/opt/aws/AmazonElastiCacheCli-1.9.000/credential-file-path.template
export AWS_ELASTICACHE_URL=https://ec2.sa-east-1.amazonaws.com
export PATH=$PATH:$AWS_ELASTICACHE_HOME/bin

prompt]# elasticache-version
Amazon ElastiCache CLI version 1.9.000 (API 2013-06-15)

prompt]# elasticache-describe-events
elasticache-describe-events:  Malformed input-The action DescribeEvents is not valid for this web service.
Usage:....

other

prompt]# elasticache-describe-events --headers
elasticache-describe-events:  Malformed input-The action DescribeEvents is not valid for this web service.
Usage:....


I do not know what's wrong

att"
Amazon Elasticache	"Re: Elasticache - command line tools: problems
Hi again rmsysadmin,

Thanks for the details.  For AWS_ELASTICACHE_URL you should use https://elasticache.sa-east-1.amazonaws.com instead of https://ec2.sa-east-1.amazonaws.com.  Let me know if that fixes your problem.

Sincerely,

Tony"
Amazon Elasticache	"Redis Read Replicas and Endpoints
Good day/evening folks,

I'm planning on migrating to ElastiCache (redis) instead of using redis on EC2 instances. I have few questions. 

1. Firstly, I'm using master-slave technique for persistency (slave has AOF enabled). Do I need to enable AOF in the replication group to achieve the same persistency? Or is the failover enough to provide HA?

2. My applications are designed to use only one redis endpoint. I don't want to change much of the design to adapt to elasticache. If I point to the main endpoint of the replication group for read and write, does it resolve to different endpoints (read-replica for read commands, and primary for write commands)? Or does it only resolve to the primary one only?

Many thanks."
Amazon Elasticache	"Re: Redis Read Replicas and Endpoints
Hi ruelp,

Thank you for your interest in ElastiCache for Redis.  To answer your questions:

1. For high availability, you do not need AOF.  If you fail over by promoting a read replica to be the primary, it will maintain all of its data.  The other cache clusters will then sync from the new primary.

If you want to also use AOF for more durable persistence, then you would enable AOF for the replication group.

2. In addition to an endpoint for each cache cluster node, ElastiCache for Redis supports a Primary Endpoint which always points to the primary cache cluster.  It will not resolve to the read replicas for read commands.  You will need to use the read replica endpoints directly for that.  You might be interested in this documentation about the Primary Endpoint.  You might also be interested in documentation on configuring clients to work with ElastiCache.

I hope this addresses your questions.

Sincerely,

Tony"
Amazon Elasticache	"How to upload/migrate redis(.rdb) file to Elasticache Redis?
Hi,

I did several researches about it and have not found a way for it;

can be migrated the file (. rdb) from a server on AWS for ElastiCache?

att"
Amazon Elasticache	"Re: How to upload/migrate redis(.rdb) file to Elasticache Redis?
Have you seen the step by step instructions in the documentation?

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingCacheClusters.html#ManagingCacheClusters.SeedingRedis"
Amazon Elasticache	"Re: How to upload/migrate redis(.rdb) file to Elasticache Redis?
Now I've seen.

thank you!"
Amazon Elasticache	"AWS CLI + Elasticache Subnet Group
I'm trying to create all a elasticache subnet group using CLI.

This is the command

aws elasticache create-cache-subnet-group --cache-subnet-group-name my-group --cache-subnet-group-description ""my subnet group"" --subnet-ids ""subnet-aaaaa,subnet-bbbbb""


and this is the response

A client error (InvalidParameterValue) occurred: Some input subnets in :[subnet-aaaaa,subnet-bbbbb] are invalid.


If I use the same command, with just one subnet, it works ok, it doesn't matter if it's subnet-aaaaa or subnet-bbbbb

Anyone out there who knows how to write this subnet list param?

Thanks a lot!

Edited by: odacremolbap on Sep 30, 2013 10:42 AM"
Amazon Elasticache	"Re: AWS CLI + Elasticache Subnet Group
OK, it worked.

I removed the quotes, and substitued the comma for an space.

aws elasticache create-cache-subnet-group --cache-subnet-group-name my-group --cache-subnet-group-description ""my subnet group"" --subnet-ids subnet-aaaaa subnet-bbbbb"
Amazon Elasticache	"ElastiCache testing on localhost?
I understand that normally you cannot use ElastiCache outside of EC2, but does this even include from my laptop to do testing?

I absolutely abhor having to push code every time I need to test a new caching feature I'm trying to implement."
Amazon Elasticache	"Re: ElastiCache testing on localhost?
ElastiCache can only be accessed from EC2 instances.  If you need to be able to do local testing, simply install the memcached daemon on your laptop and test against localhost.  Being that the goal of using memcached is fast performance, the round trip time from your laptop to ElastiCache would probably be detrimental to your testing.

The main difference with using ElastiCache compared to the memcached daemon on your laptop is parameter tuning (ignoring the obvious differences in CPU and memory).  Many of the parameters that would be appropriate for testing on your laptop will need different settings for a production server."
Amazon Elasticache	"Re: ElastiCache testing on localhost?
Any plan on allowing direct IP access now that redis is part of ElastiCache? I'm storing real data in redis (not just for caching) and not being able to access it from my local dev environment is creating quite a bit of friction for me. Thanks."
Amazon Elasticache	"Strange behavior when trying to retrieve data from elasticache
This past Saturday I encountered a situation where something happened to the data that I had stored in my elasticache instance.  When data was queried, it seemed like just an empty object was being returned. The issue started at about 10 am EST on Saturday, Sept 7, and persisted until the next day when I found out about it. The eventual fix for the issue was to send a flush command to elasticache.  After flushing everything, normal operation resumed on my site.  I checked the error logs on my app servers and wasn't able to find anything that would indicate it had caused the cached data to go bad.  I also looked at the monitoring for the instance and couldn't find anything strange there either.

Would someone be able to take a look at the logs on the elasticache instance that had the problem to see if there's something to indicate what might have happened to the cached data?  The instance in question is the target production instance.  Feel free to send me a PM if I need to give the exact endpoint.

Thanks!

Edited by: Zaknaphein on Sep 9, 2013 1:13 PM

Edited by: Zaknaphein on Sep 9, 2013 1:19 PM"
Amazon Elasticache	"Re: Strange behavior when trying to retrieve data from elasticache
Hi,

We are reaching out to you directly to get information about your Elasticache cluster.

Thanks,
Mukesh"
Amazon Elasticache	"Re: Strange behavior when trying to retrieve data from elasticache
Hello,

I apologize for the delay.  I have forwarded the details to the Elasticache team.
I will update you if they can provide any additional details.

Regards, 

Mike P."
Amazon Elasticache	"Re: Strange behavior when trying to retrieve data from elasticache
Hello,

We took a look at your cache node and did not see anything abnormal at this time. If this happens again please let us know as soon as possible and please provide a timestamp with timezone.

Regards,

Matt J"
Amazon Elasticache	"Cannot connect to elasticache from EC2 instances.
I just created a new ElasticCache cluster: jobs2careers.pnuura.cfg.use1.cache.amazonaws.com

I cannot access it from my EC2 instances.

I already setup the security groups properly.  It should allow all instances in my ""default"" EC2 security group to access.  But somehow it's just not working.

Can you please tell me how to fix?

Thanks"
Amazon Elasticache	"Re: Cannot connect to elasticache from EC2 instances.
Hi bruce_rds,

Thanks for the post.  I am currently looking at your setup.  I will follow up on this thread or with a PM.

Thanks,

Tony"
Amazon Elasticache	"PHP HighCPU loop Maximum execution time of 30 seconds exceeded
Dear Amazon,

I'm seeing very high CPU usage after ""yum update""'ing php54 on a AWS small instance

The apache logs tell me
PHP HighCPU loop Maximum execution time of 30 seconds exceeded in [myfile] line 27


Which only has:
  $memcache->set($key, array(...), $ttl);


Is there an implemementation bug in the AmazonElastiCacheClusterClient-1.0.1-php54/amazon-elasticache-cluster-client.so ?

php -v
PHP 5.4.19 (cli) (built: Sep  3 2013 23:19:23) 
Copyright (c) 1997-2013 The PHP Group
Zend Engine v2.4.0, Copyright (c) 1998-2013 Zend Technologies"
Amazon Elasticache	"Re: PHP HighCPU loop Maximum execution time of 30 seconds exceeded
Not sure if it's Amazon's php module or php54 - but the fix was to make $key=hash('md5',$key) when $key contains a space."
Amazon Elasticache	"Redis Replication Group failover behavior
In the docs, it says

""Replication groups can guard against potential data loss if a primary cache cluster is unexpectedly terminated. After ElastiCache provisions a new primary node, the Redis cache engine on that node immediately synchronizes itself with one of the surviving read replicas in the replication group. When the synchronization is complete, the result is a warm Redis cache. The primary will then begin accepting write requests, and automatically propagating those writes to the read replicas.""

This reads like ""replace"" on master failure, not ""promote slave/replica"" on master failure behavior.

If I manually promote a slave (replica), I'd expect clients to failover to using the new master instance within ~60sec (the DNS TTL).  

However, from the above doc, it sounds like if the master fails for some reason (* How exactly does ElastiCache detect master failures??? *), then clients would have to wait for a new replacement instance to spin up, download the db data from a replica, then load this data into memory.  This strikes me as a potential outage duration significantly longer than 60sec, especially for big datasets.

My interest here is the new Redis-based offering in terms of HA and failure modes."
Amazon Elasticache	"Re: Redis Replication Group failover behavior
No response from the EC Redis team?  Understanding HA and failover dynamics is pretty critical to any real-world deployment."
Amazon Elasticache	"Re: Redis Replication Group failover behavior
Hi,

Thank you for your interest in the new ElastiCache for Redis offering.   When ElastiCache detects  an unresponsive  primary or read replica node, it is replaced; the node is brought up warmed up with cache data from another node in the same replication group. Alternatively, if you see performance or other issues with a primary node you can manually promote a read replica to take its place, this can be done through the console, command line or the APIs. 

Manually promoting a read replica may result in a somewhat shorter outage then if the node is replaced.  Hopefully this answers your question about HA and failover.

Thanks,
Tony"
Amazon Elasticache	"Elasticache cluster stuck in rebooting
Hello,

My cache cluster was not responding so I tried rebooting it and has been stuck in rebooting state for a while now.

Please let me know if there's any way to get it running again.

Thanks"
Amazon Elasticache	"Re: Elasticache cluster stuck in rebooting
Hi,

Thanks for bringing this to our notice. We have investigated your cluster, and the issue should be resolved.

Thanks,
Mukesh"
Amazon Elasticache	"Multiple ElastiCache node crashes in last 5 days
We've had two ElastiCache nodes fail in the last five days. This is after having been live with ElastiCache for many months with no previous failures. Has something happened that has made ElastiCache less reliable or less available? Is there anything I could be doing to prevent these failures?"
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Hello,

I was unable to identify your account. Could you please provide an instance id on the account so we can look into it more?"
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Thanks for the response. One of our instance IDs is i-fcef2498. Let me know if you need any more info."
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Hello,

Thank your for the information, we are looking into this and we will get back to you shortly.

Regards,
BlessM"
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Hi, any update? Just want to make sure this doesn't get dropped."
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Hi there matthewklein,

Our service team has investigated this issue for you and they have found that this was caused by issues with the underlying physical host.

We can see that the the cache node has been replaced and that you should not be experiencing any further problems with this.

Please post back to this thread if you continue to see problems with your cache nodes.

Best regards,
Phil P"
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Thanks for looking into this and for the information you've provided. It's helpful to know that this isn't anything that our apps or infrastructure caused. Could you please answer the questions in my original posting though?"
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Hello,

We are not clear about the questions you are referring too and would be glad if you could explicitly mention here. 

As stated by my peer engineer, the issue was caused mainly due to underlying host failure which we have replaced. Since ElastiCache is a managed service, you would have to contact AWS Support if you experience any issues and we would be glad to investigate it for you.

Thanks."
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
OK, thanks. Here was the original background:

We've had two ElastiCache nodes fail in the last five days. This is after having been live with ElastiCache for many months with no previous failures. 

And my original questions:

Has something happened that has made ElastiCache less reliable or less available? Is there anything I could be doing to prevent these failures?

Matt"
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
Hi Matt,

No, there have been no changes to the service which would affect its reliability.

As with all cloud services, resources can occasionally fail. Losing two nodes over a five day period is unusual but not unheard of.

There is nothing that you can do to prevent this sort of failure from happening. Your service should be designed in such a way that it can cope with the loss of individual components without failing outright.

I hope this helps.

Richard"
Amazon Elasticache	"Re: Multiple ElastiCache node crashes in last 5 days
OK, understood. Thanks for the response."
Amazon Elasticache	"Fatal error: Undefined class constant 'OPT_CLIENT_MODE' in php elasticache
Currently the connection from my ec2- amazon ami instance to elasticache does not work

I attempt to connect and fail with
$server_endpoint = ""lolololo.olol.olol.cache.amazonaws.com"";
$server_port = 11211;
$dynamic_client = new Memcached();
$dynamic_client->setOption(Memcached::OPT_CLIENT_MODE, Memcached::DYNAMIC_CLIENT_MODE); 
// it fails on previous line
// Fatal error: Undefined class constant 'OPT_CLIENT_MODE' in
$dynamic_client->addServer($server_endpoint, $server_port);
$dynamic_client->set('key', 'value', 60);


Steps i took 

sudo yum install gcc-c++ php php-pear


sudo pecl install myplaceontheweb.com/assets/AmazonElastiCacheClusterClient-1.0.1-PHP53-64bit.tgz


sudo yum install php-devel


from root: add
extension=memcached.so
extension=amazon-elasticache-cluster-client.so
to /etc/php.d/memcached.ini


php info says memcached is an installed part of php, i have rebooted the server after doing all of this.
sudo find . -type f -name 'amazon*.so'

yeilds ./usr/lib64/php/modules/amazon-elasticache-cluster-client.so and it doesn't work by direct linking as an extension either

Is there anything obvious i am doing wrong? can anyone suggest a fix?"
Amazon Elasticache	"Re: Fatal error: Undefined class constant 'OPT_CLIENT_MODE' in php elasticache
also on stack overflow: http://stackoverflow.com/questions/18626478/fatal-error-undefined-class-constant-opt-client-mode-in"
Amazon Elasticache	"Re: Fatal error: Undefined class constant 'OPT_CLIENT_MODE' in php elasticache
Hi,

This error was most likely caused by a previous installation of memcache extension conflicting with the ElastiCache Auto Discovery client installation. We recommend removing the earlier memcache installation.

Thanks,
Mukesh"
Amazon Elasticache	"ElastiCache command line interface doe note support proxy?
We use proxy server in our company. I tried to run below command and got timed out error:
elasticache-describe-cache-clusters --headers

elasticache-describe-cache-clusters:  Couldn't reach the service (reason: Connection timed out: connect) - please

I've set up proxy environment variables as below:
-Dhttps.proxyHost=proxy.xxx.com -Dhttps.proxyPort=8080

and EC2 command line tools work, but not this ElastiCache one.

I saw that in CloudWatch command line interface page it says CloudWatch  cli does not support proxy. I did not see the same on ElastiCache page. Does it support proxy?

Thanks"
Amazon Elasticache	"Re: ElastiCache command line interface doe note support proxy?
Hi,

The ElastiCache Command Line Interface does not support access through a proxy.

Thanks,
Mukesh"
Amazon Elasticache	"Redis Auto Discovery support
Does the new Redis-based ElastiCache offering support node Auto Discovery yet?

The docs make it sound like auto-discovery is memcached only, although supporting this via a redis GET or CONFIG GET command doesn't sound terribly hard..."
Amazon Elasticache	"Re: Redis Auto Discovery support
Hi,

At this time Auto Discovery support is available only for the Memcached engine.

Thanks,
Mukesh"
Amazon Elasticache	"Persistence option ""appendonly yes"" doesn't work on Redis engine
Hi, just found that ""appendonly yes"" option in parameters group does not affect cluster settings. $redis->info() method returns ['aof_enabled'] = 0
, also after reboot keys were lost.

Edited by: NowakSebastian on Sep 5, 2013 3:09 PM"
Amazon Elasticache	"Re: Persistence option ""appendonly yes"" doesn't work on Redis engine
Hi,

Thanks for trying out Amazon ElastiCache for Redis. 

The ability to enable AOF is supported in all cache instance types except cache.t1.micros. This information was missing in the ElastiCache documentation, which has now been updated http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.Redis.html.

Please let us know if you are unable to set the appendonly parameter in cache instance types other than cache.t1.micro.

Thanks,
Mukesh"
Amazon Elasticache	"Re: Persistence option ""appendonly yes"" doesn't work on Redis engine
I confirm, that on m1.small AOF is working fine. I've tested on micro so that was a reason of my question. Thank You."
Amazon Elasticache	"S3 permission error when launching redis cluster
When I specify a RDB snapshot in S3 for a cluster, I get the following error:

""InvalidParameterValue: No permission to access S3 object""

The account I am launching the cluster with has permission to access the snapshot. Any idea what I'm doing wrong? Am I missing a critical step or setting?"
Amazon Elasticache	"Re: S3 permission error when launching redis cluster
Hi, 

Thanks for trying ElastiCache for Redis. 

The  ElastiCache account aws-scs-s3-readonly@amazon.com requires read access to the S3 bucket holding the snapshot file.  More information on granting permissions to the S3 bucket can be found in the ElastiCache documentation  at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingCacheClusters.html#ManagingCacheClusters.SeedingRedis

Thanks,
Mukesh"
Amazon Elasticache	"Cannot see ""Cache Security Groups"" in EU (Ireland)
Hi,

when I go to 
https://console.aws.amazon.com/elasticache/home?region=us-east-1#security-groups:names= 
I can see ""Cache Security Groups"". 

As soon as I switch to 
https://console.aws.amazon.com/elasticache/home?region=eu-west-1#security-groups:names=
I get the following message

""Use of cache security groups is not permitted in this API version for your account.""

This forum thread reports a similar problem 
https://forums.aws.amazon.com/thread.jspa?messageID=468757
The reason stated was the default VPC residing in a different region.

The problem is my default VPC is in EU-West-1, not in US-East-1.

Please advise!
Thank you and best regards."
Amazon Elasticache	"Re: Cannot see ""Cache Security Groups"" in EU (Ireland)
Hi,

It looks like your account is setup for VPC by default in EU Region, but not in US East Region. In EU Region, please use VPC Security Groups to manage the access to your ElastiCache clusters. 

More information can be found in the ElastiCache documentation: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ManagingVPC.html

Thanks,
Mukesh"
Amazon Elasticache	"Does the Redis engine use multiple cores?
Hi there,

We use several Redis instances on EC2 and we're considering migrating to ElastiCache now that it supports Redis.

However, I'd like to know if you implementation is able to take advantage of multiple cores. Usually, Redis uses only a single core and you need to shard your data into several redis instances in order to use multiple cores (or another similar approach).

Thanks in advance."
Amazon Elasticache	"Re: Does the Redis engine use multiple cores?
Judging by the current documentation, a Redis ElastiCache node only runs one Redis process (which is single threaded).

See Cache Node Considerations for Redis.

""Redis is single-threaded, so multiple processor cores will not provide improved performance. However, choosing a cache node type with a faster processor speed can significantly improve throughput."""
Amazon Elasticache	"CheckedOperationTimeoutException while getting an item from cache
Hi:


Using spymemcached client 2.9.1 
EC2 and cache cluster are both in US_EAST_1 region
Connection to the cache cluster is successful
Keep getting the above exception whenever getting an item from cache.


Any idea why it is happening?"
Amazon Elasticache	"Re: CheckedOperationTimeoutException while getting an item from cache
Hello,

I sent you a PM for getting more information."
Amazon Elasticache	"Feature Request: Redis as an Alternative ElastiCache Engine
Shortly after ElastiCache launched two years ago, there was an email survey that indicated AWS was thinking about adding a Redis engine as an alternative to the Memcached engine (similar to how RDS supports MySQL alongside Oracle and SQL Server). I really hope this is something AWS is currently working on. If not, please consider this a feature request. Thanks!"
Amazon Elasticache	"Re: Feature Request: Redis as an Alternative ElastiCache Engine
ElastiCache now supports Redis: http://aws.typepad.com/aws/2013/09/amazon-elasticache-now-with-a-dash-of-redis.html 

Good timing!"
Amazon Elasticache	"What is the reliability and uptime of elasticache?
Hi,

We deployed elasticache on a cluster in production Friday and have already experienced two node failures this weekend outside of our maintenance windows. We weren't even pushing them all that hard.

So, 3 days of uptime, two outages. Is this typical? Those of you using elasticache, are your nodes dying daily?"
Amazon Elasticache	"Re: What is the reliability and uptime of elasticache?
I've been running ElastiCache for a few months now and haven't had a node fail.  You may want to contact AWS support and have them see if something is going on behind the scenes that is causing your node failures.

You may also try different instance types to see if that affects your stability (I doubt it, but it can't hurt to try)."
Amazon Elasticache	"Re: What is the reliability and uptime of elasticache?
We will be glad to look into your issue. As this is an account related question, we have sent you an email to obtain more information."
Amazon Elasticache	"Re: What is the reliability and uptime of elasticache?
Thanks for the feedback. We're working with Amazon people to figure out what happened.

We are meeting tomorrow morning to decide whether or not we want to keep using ElastiCache or if we should just spin up our own memcached instances."
Amazon Elasticache	"Re: What is the reliability and uptime of elasticache?
We experienced two node failures in the last five days, after being live with ElastiCache for many months without a single node failure before that. Any further update from Amazon about what may be going on?"
Amazon Elasticache	"Where to find ""cache security groups"" options to setup access?
Hello,

We created an Elasitcache cluster about a month back and in its settings it shows our ""default"" VPC has access to it. We kind of assumed that all is well - till today. When we tried to access cache and realized that our EC2 instances cannot access cache at all. We looked at the cache cluster history and realized the cache node was unused!

Looked at the document again and found this ""Authorize Access"" page:
http://docs.aws.amazon.com/AmazonElastiCache/latest/GettingStartedGuide/AuthorizeAccess.html

However, there is no "" Cache Security Groups"" available for us to select. Where can we find it? On the ElastiCache console, the only options under ""Navigation"" are:

 ›  Cache Clusters
 ›  Reserved Cache Nodes
 ›  Cache Parameter Groups
 ›  Cache Subnet Groups
 ›  Cache Events
 ›  Download ElastiCache Cluster Client

Please let us know how to setup access to the cache for our instances. Because of all this, we lost money for one month of no-use.

Thanks"
Amazon Elasticache	"Re: Where to find ""cache security groups"" options to setup access?
Hello,

Thank you for letting us know that you are not seeing Cache Security Groups. 

We are looking into for you."
Amazon Elasticache	"Re: Where to find ""cache security groups"" options to setup access?
Hello,

The reason you do not see a ""Cache Security Groups"" option is that you are a VPC-by-default customer. That is, we create a VPC for you automatically, and the cache cluster that you launched is running in that VPC.

In order to access your cache cluster, you'll have to launch your EC2 instances into that VPC too.

In the ElastiCache console, go to Cache Clusters and click the name of your cache cluster. Look for VPC Security Group(s), and take note of the VPC security group that you see there. (It will likely say ""default (active)"".)

Now go to the EC2 management console. Click Launch Instance.


On the ""Create a New Instance"" page, select the Quick Launch Wizard.
Choose an existing key pair, or create a new one.
Choose ""Amazon Linux AMI"" (the default).


Follow the wizard and launch an instance into your default VPC.
In the Security Settings section, select the security group named ""default"". This is the default security group for your VPC.

Click the Save Details button when you're done, and then click Launch.

You won't be able to log in to your new EC2 instance until it is in the ""running"" state and all status checks have passed. When this happens, the hostname for your instance will be displayed (such as ""ec2-54-208-17-183.compute-1.amazonaws.com"").

While your EC2 instance is launching, go to Security Groups. In the list of security groups, find the group named ""default"" that has your VPC ID associated with it. In the lower pane of the window, click the Inbound tab. You will want to add a rule that allows traffic between your application EC2 instances and cache cluster. In the Create a new rule drop-down, choose Custom TPC rule. Enter the cache cluster port (11211 if you are using the default port). Leave the ""Source"" field at 0.0.0.0/0. (This will allow connections to the clusters from anywhere within your default VPC, so you'll probably want to lock this down later.) Click Add Rule, then Apply Rule Changes.

Now applications running on your EC2 instances that use the default security group in your default VPC would be able to communicate with the ElastiCache cluster that uses the default security group in your default VPC.

You can verify this by logging on to your application EC2 instances and invoking telnet on the cache node endpoint. Please see http://docs.aws.amazon.com/AmazonElastiCache/latest/GettingStartedGuide/ConnectToCacheNode.html for instructions on how to connect to your cache node using telnet.

Regards,

Matt J"
Amazon Elasticache	"Re: Where to find ""cache security groups"" options to setup access?
Thanks Matt, yes, that was the problem. We use Opsworks and for some reason, the EC2 instances in OpsWorks are not automatically set to default VPC security.

Kindly put this information in the documentation (the link I had sent earlier) so that VPC users find it useful in the future."
Amazon Elasticache	"Pricing unavailable for Chennai, Mumbai
What is the pricing for India (Chennai, Mumbai)? Thank you."
Amazon Elasticache	"Re: Pricing unavailable for Chennai, Mumbai
Hi arjunkirpal

Amazon ElastiCache currently supports endpoints in the following AWS Regions: US East (Northern Virginia), US West (Northern California), US West (Oregon), EU (Ireland), Asia Pacific (Singapore), Asia Pacific (Tokyo), South America (Sao Paulo), 

For information regarding the pricing model for ElastiCache, please see the ElastiCache pricing page:

http://aws.amazon.com/elasticache/pricing/.

You may also find the AWS Simple Monthly Calculator to be beneficial:

http://calculator.s3.amazonaws.com/calc5.html(S3)"
Amazon Elasticache	"Unable to access to AWS EC2
Hi!

I'm trying to access to EC2 through Management Console but the system shows this message :
""Thank you for signing up for Amazon EC2. Your subscription is being processed.

We will send you an email when you can begin using this service. For most customers this takes only a few minutes, but if additional account verification is required, then processing can take several hours.

Until your subscription is ready, you can learn more about the AWS Management Console.""

I've been waiting for a week, but the problem still persists.
How can I resolve this issue?

Thanks to all in advance.
Regards"
Amazon Elasticache	"Re: Unable to access to AWS EC2
Hi,

I had a quick look at your account and I can see that it has not been verified yet. It appears that you still need to supply valid credit card details before the activation will be complete. 

Please get in touch with our Billing & Accounts team. They will be able to assist you further with this. See: http://aws.amazon.com/contact-us/

Regards,
Prieur"
Amazon Elasticache	"Auto Discovery not working
I have been trying to get autodiscory to work all day with no luck. 

the following code 

 MemcachedClient client = new MemcachedClient(AddrUtil.getAddresses(
		        		connection
		        		));


produces the following exception for all the nodes:


2013-01-03 00:22:01.202 INFO net.spy.memcached.MemcachedConnection:  Reconnection due to exception handling a memcached operation on {QA sa=/xxxx:11211, #Rops=1, #Wops=0, #iq=0, topRop=Cmd: config get Types:  clusterExp: 0, topWop=null, toWrite=0, interested=1}. This may be due to an authentication failure.
OperationException: GENERAL
	at net.spy.memcached.protocol.BaseOperationImpl.handleError(BaseOperationImpl.java:161)
	at net.spy.memcached.protocol.ascii.OperationImpl.readFromBuffer(OperationImpl.java:151)
	at net.spy.memcached.MemcachedConnection.handleReads(MemcachedConnection.java:667)
	at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:584)
	at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:337)
	at net.spy.memcached.MemcachedConnection.run(MemcachedConnection.java:1073)
2013-01-03 00:22:01.203 WARN net.spy.memcached.MemcachedConnection:  Closing, and reopening {QA sa=/xxxx:11211, #Rops=1, #Wops=0, #iq=0, topRop=Cmd: config get Types:  clusterExp: 0, topWop=null, toWrit}
 
 
 



It seems to connect after that, but I wonder what is going on?

Second issue

the following code is what I really want to use, but it totally fails

//override is daemon so this doesn't block system exiting.
		BinaryConnectionFactory factory = new BinaryConnectionFactory(ClientMode.Dynamic, DefaultConnectionFactory.DEFAULT_OP_QUEUE_LEN, 
				DefaultConnectionFactory.DEFAULT_READ_BUFFER_SIZE, DefaultHashAlgorithm.KETAMA_HASH) {
			
				@Override
				public boolean isDaemon() {
					return true;
				}
				
				@Override
				public FailureMode getFailureMode() {
					return FailureMode.Redistribute;
				}
				
				@Override
				public int getTimeoutExceptionThreshold() {
					return 10;
				}
				
				@Override
				public long getOperationTimeout() {
					return 2*1000; 
				}
				
				@Override
				public NodeLocator createLocator(List<MemcachedNode> nodes) {
				    return new KetamaNodeLocator(nodes, getHashAlg());
				}
		};
 
MemcachedClient client = new MemcachedClient(
			        factory,
			        AddrUtil.getAddresses(
			        		connection
			        		));
 


throws this when I try to issue an op

java.lang.IllegalStateException: Client is not initialized
	at net.spy.memcached.MemcachedClient.checkState(MemcachedClient.java:1623)
	at net.spy.memcached.MemcachedClient.enqueueOperation(MemcachedClient.java:1617)
	at net.spy.memcached.MemcachedClient.asyncStore(MemcachedClient.java:474)
	at net.spy.memcached.MemcachedClient.set(MemcachedClient.java:905)
...



Thanks for any help,
Dustin"
Amazon Elasticache	"Re: Auto Discovery not working
Hello, 

1) Can you try telnet to the elasticache node to ensure connectivity from client host? Please ensure that the elasticache cluster is setup with correct security group authorization to allow access from the client host.
2) Can you share the elasticache cluster id and the region? If you are in VPC, please make sure that the client is also running in the same VPC."
Amazon Elasticache	"Re: Auto Discovery not working
Security rules are set up properly.  Connecting to the cluster works fine with the standard spymemcached client.  

Also, it appears the ketama hashing is broken in your customized spymemcached.  (The same code in the aws client with ClientMode.Static vs Standard spymemcache client gives different hashing).

thanks!
Dustin"
Amazon Elasticache	"Re: Auto Discovery not working
i solve this problem.

here in your code:
new BinaryConnectionFactory(*ClientMode.Dynamic*,

if you use ClientMode.Dynamic, you must use the elsticache, not memcached.
because normal memcached doesn't have autodiscovery ."
Amazon Elasticache	"Re: Auto Discovery not working
Has there been an update to this?  I just tried the auto-discovery client today (after having been happily using straight spymemcached for elasticache access for months) and I got the ""client is not initialized"" error as well.  Since plain vanilla spymemcached works seamlessly with our set-up, I believe this is not a permission set-up issue (e.g., we're using the same ec2 security group that has been and continues to be able to access the elasticache cluster we've been testing against).

Thanks for any help."
Amazon Elasticache	"Re: Auto Discovery not working
Please make sure that your application has been updated to point to the ElastiCache configuration endpoint. More information can be found at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html"
Amazon Elasticache	"Re: Auto Discovery not working
In a local development and test environment using memcached, how would you suggest implementing the Cluster Client without having to change any code to be able to connect? We want to avoid any massive changes prior to builds that we push to our EC2 instances."
Amazon Elasticache	"Failed connecting during high concurrency
I have created a subnet for elasticache in our vpc (10.0.4.0/24) and given it a security group that allows it to communicate with the instances in our public subnet.

Now when I create an instance in the public subnet and give it an EIP so that I can SSH into it, everything appears to work correctly with regards to ElastiCache. It connects and is able to SET and GET without problem. However, When I remove the EIP and put it behind the public ELB the latency increases to roughly whatever timeout I set.

Removing it from the ELB and attaching the EIP again, I can see the logs have mostly these two errors:

2013/08/19 21:32:48 crit 759#0: *28468 connect() to 10.0.4.220:11211 failed (99: Cannot assign requested address), client: 10.0.0.233, server: , request: ""POST 

2013/08/20 16:52:12 error 777#0: *739530 lua tcp socket connect timed out, client: 10.0.0.233, server: , request: ""POST 

Are these what I should expect to see when the cache is overloaded, meaning I need more/bigger cache instances, or does this imply some other problem that only happens at load or behind ELBs, or something else?

Also I am using a small instance now and it seems to max out around 15k GETs and SETs per minute. Is that a max I am hitting or does that mean there is a problem somewhere else?

Edited by: jameskmarlowe on Aug 22, 2013 10:37 AM"
Amazon Elasticache	"Elastic Cache
Hi,

Need to understand some point regarding Elastic Cache.

We are currently  using elastic cache with memcache caching.  how can i test and check some points:

1. average set/gets 
2. how many times we hit maxconns 
3. check listen_disabled_num for each memcache instance 
4. want to know if the machine on which there is memcache, if it is swapping memory? 

Thanks

Soni Pandey
09654514825"
Amazon Elasticache	"CacheSecurityGroupIngress was not found
I'm seeing this in the Cloudformation events, creating an AWS::ElastiCache::SecurityGroupIngress:

2013-05-03 15:25:20 UTC+1 | AWS::ElastiCache::SecurityGroupIngress | MemcacheWordPress1SecurityGroupIngress | vpc-foundation-5-memcachewordpress1securitygroupingress-800728kmvodz | CREATE_FAILED CacheSecurityGroupIngress was not found.

My template is like this:


    ""MemcacheWordPress1SecurityGroup"": {
      ""Type"": ""AWS::ElastiCache::SecurityGroup"",
      ""Properties"": {
        ""Description""  : ""Memcache SecurityGroup for the WordPress1 designation (WordPress1 is example.com).""
      }
    },
 
    ""MemcacheWordPress1SecurityGroupIngress"": {
      ""Type"": ""AWS::ElastiCache::SecurityGroupIngress"",
      ""Properties"": {
        ""CacheSecurityGroupName""  : { ""Ref"" : ""MemcacheWordPress1SecurityGroup"" },
        ""EC2SecurityGroupName""    : { ""Ref"" : ""WordPress1SecurityGroup"" }
      }        
    },
 


This is in a VPC. What is it looking for?"
Amazon Elasticache	"Re: CacheSecurityGroupIngress was not found
Please forward us your CloudFormation Stack ID and we'll take an in depth look (you may PM it to me if you don't want to post it publicly).

Also, is this template made from scratch or are you following an existing template?"
Amazon Elasticache	"Re: CacheSecurityGroupIngress was not found
Here's a a complete cloudformation template which illustrates my problem. This creates a single memcache instance for a short while before roll-back initiates.


{
  ""AWSTemplateFormatVersion"" : ""2010-09-09"",
 
  ""Description"" : ""ElastiCache tests"",
 
  ""Parameters"" : {
 
    ""AvailabilityZone1"" : {
      ""Description"" : ""AZ#1 First Availability Zone"",
      ""Type"" : ""String"",
      ""Default"" : ""us-east-1b"",
      ""AllowedValues"" : [ 
        ""us-east-1b"", 
        ""us-east-1c"", 
        ""us-east-1d"" 
      ],
      ""ConstraintDescription"" : ""must be a US-EAST-1 VPC AZ.""
    },
 
    ""ElasticacheNodeType"" : {
      ""Description"" : ""Elasticache (Memcache) Cache node type"",
      ""Type"" : ""String"",
      ""Default"" : ""cache.t1.micro"",
      ""AllowedValues"" : [ 
        ""cache.t1.micro"", 
        ""cache.m1.small"", 
        ""cache.m1.medium"", 
        ""cache.m1.large"", 
        ""cache.m3.xlarge"", 
        ""cache.m3.2xlarge"", 
        ""cache.m2.xlarge"", 
        ""cache.m2.2xlarge"", 
        ""cache.m2.4xlarge"", 
        ""cache.c1.xlarge"" 
      ],
      ""ConstraintDescription"" : ""must be a valid cache node type ref http://aws.amazon.com/elasticache/""
    },
 
    ""WordPress1MemcacheNodesPerAZ"" : {
      ""Description"" : ""Number of Elasticache nodes per availability zone for the WordPress1 cluster (example.com)"",
      ""Type"" : ""Number"",
      ""Default"" : ""1"",
      ""MinValue"": ""1"",
      ""MaxValue"": ""10"",
      ""ConstraintDescription"" : ""must be between 1 and 10.""
    },
 
    ""MemcacheMaintenanceWindow"" : {
      ""Description"" : ""Time during which maintenance is preferred (UTC) (at least 30 mins)"",
      ""Type"" : ""String"",
      ""Default"" : ""Mon:09:00-Mon:12:00"",
      ""ConstraintDescription"": ""Time during which maintenance is preferred (UTC) format is ddd:hh24:mi-ddd:hh24:mi""
    }
 
  },
 
  ""Mappings"" : {
 
    ""XXXSubnetConfig"" : {
 
      ""VPC""           : { ""CIDR"" : ""10.30.0.0/16"" },
 
      ""Public1""       : { ""CIDR"" : ""10.30.11.0/24"" },
      ""Public2""       : { ""CIDR"" : ""10.30.21.0/24"" },
 
      ""Memcache1""     : { ""CIDR"" : ""10.30.12.0/24"" },
      ""Memcache2""     : { ""CIDR"" : ""10.30.23.0/24"" },
 
      ""DB1""           : { ""CIDR"" : ""10.30.13.0/24"" },
      ""DB2""           : { ""CIDR"" : ""10.30.23.0/24"" },
      ""DB3""           : { ""CIDR"" : ""10.30.23.0/24"" },
 
      ""Splunk1""       : { ""CIDR"" : ""10.30.14.0/24"" },
      ""Splunk2""       : { ""CIDR"" : ""10.30.24.0/24"" },
 
      ""WordPress1AZ1"" : { ""CIDR"" : ""10.30.15.0/24"" },
      ""WordPress1AZ2"" : { ""CIDR"" : ""10.30.25.0/24"" },
 
      ""WordPress2AZ1"" : { ""CIDR"" : ""10.30.16.0/24"" },
      ""WordPress2AZ2"" : { ""CIDR"" : ""10.30.26.0/24"" }
    }
 
  },
 
  ""Resources"" : {
 
    ""VPC"" : {
      ""Type"" : ""AWS::EC2::VPC"",
      ""Properties"" : {
        ""CidrBlock"" : { ""Fn::FindInMap"" : [ ""XXXSubnetConfig"", ""VPC"", ""CIDR"" ]},
        ""Tags"" : [
          { ""Key"" : ""Application"", ""Value"" : { ""Ref"" : ""AWS::StackId"" } },
          { ""Key"" : ""Name"", ""Value"" : ""XXX"" }
        ]
      }
    },
 
    ""WordPress1AZ1Subnet"" : {
      ""Type"" : ""AWS::EC2::Subnet"",
      ""Properties"" : {
        ""AvailabilityZone"" : { ""Ref"" : ""AvailabilityZone1"" },
        ""VpcId"" : { ""Ref"" : ""VPC"" },
        ""CidrBlock"" : { ""Fn::FindInMap"" : [ ""XXXSubnetConfig"", ""WordPress1AZ1"", ""CIDR"" ]},
        ""Tags"" : [
          { ""Key"" : ""Application"", ""Value"" : { ""Ref"" : ""AWS::StackId"" } },
          { ""Key"" : ""Designation"", ""Value"" : ""WordPress1"" },
          { ""Key"" : ""AZ"", ""Value"" : ""1"" },
          { ""Key"" : ""Name"", ""Value"" : ""wordpress-1-az-1"" }
        ]
      }
    },
 
    ""WordPress1AZ1RouteTable"" : {
      ""Type"" : ""AWS::EC2::RouteTable"",
      ""Properties"" : {
        ""VpcId"" : { ""Ref"" : ""VPC"" },
        ""Tags"" : [
          { ""Key"" : ""Application"", ""Value"" : { ""Ref"" : ""AWS::StackId"" } },
          { ""Key"" : ""Designation"", ""Value"" : ""WordPress1"" },
          { ""Key"" : ""AZ"", ""Value"" : ""1"" },
          { ""Key"" : ""Name"", ""Value"" : ""wordpress-1-az-1"" }
        ]
      }
    },
 
    ""WordPress1AZ1SubnetRouteTableAssociation"" : {
      ""Type"" : ""AWS::EC2::SubnetRouteTableAssociation"",
      ""Properties"" : {
        ""SubnetId"" : { ""Ref"" : ""WordPress1AZ1Subnet"" },
        ""RouteTableId"" : { ""Ref"" : ""WordPress1AZ1RouteTable"" }
      }
    },
 
    ""PrivateNetworkAcl"" : {
      ""Type"" : ""AWS::EC2::NetworkAcl"",
      ""Properties"" : {
        ""VpcId"" : { ""Ref"" : ""VPC"" },
        ""Tags"" : [
          { ""Key"" : ""Application"", ""Value"" : { ""Ref"" : ""AWS::StackId"" } },
          { ""Key"" : ""Network"", ""Value"" : ""Private"" },
          { ""Key"" : ""Name"", ""Value"" : ""Private-ACL"" }
        ]
      }
    },
 
    ""InboundPrivateNetworkAclEntry"" : {
      ""Type"" : ""AWS::EC2::NetworkAclEntry"",
      ""Properties"" : {
        ""NetworkAclId"" : { ""Ref"" : ""PrivateNetworkAcl"" },
        ""RuleNumber"" : ""100"",
        ""Protocol"" : ""6"",
        ""RuleAction"" : ""allow"",
        ""Egress"" : ""false"",
        ""CidrBlock"" : ""0.0.0.0/0"",
        ""PortRange"" : { ""From"" : ""0"", ""To"" : ""65535"" }
      }
    },
 
    ""OutBoundPrivateNetworkAclEntry"" : {
      ""Type"" : ""AWS::EC2::NetworkAclEntry"",
      ""Properties"" : {
        ""NetworkAclId"" : { ""Ref"" : ""PrivateNetworkAcl"" },
        ""RuleNumber"" : ""100"",
        ""Protocol"" : ""6"",
        ""RuleAction"" : ""allow"",
        ""Egress"" : ""true"",
        ""CidrBlock"" : ""0.0.0.0/0"",
        ""PortRange"" : { ""From"" : ""0"", ""To"" : ""65535"" }
      }
    },
 
    ""WordPress1AZ1SubnetNetworkAclAssociation"" : {
      ""Type"" : ""AWS::EC2::SubnetNetworkAclAssociation"",
      ""Properties"" : {
        ""SubnetId"" : { ""Ref"" : ""WordPress1AZ1Subnet"" },
        ""NetworkAclId"" : { ""Ref"" : ""PrivateNetworkAcl"" }
      }
    },
 
 
    ""Memcache1Subnet"" : {
      ""Type"" : ""AWS::EC2::Subnet"",
      ""Properties"" : {
        ""AvailabilityZone"" : { ""Ref"" : ""AvailabilityZone1"" },
        ""VpcId"" : { ""Ref"" : ""VPC"" },
        ""CidrBlock"" : { ""Fn::FindInMap"" : [ ""XXXSubnetConfig"", ""Memcache1"", ""CIDR"" ]},
        ""Tags"" : [
          { ""Key"" : ""Application"", ""Value"" : { ""Ref"" : ""AWS::StackId"" } },
          { ""Key"" : ""Network"", ""Value"" : ""Memcache"" },
          { ""Key"" : ""AZ"", ""Value"" : ""1"" },
          { ""Key"" : ""Name"", ""Value"" : ""memcache-1"" }
        ]
      }
    },
 
    ""Memcache1RouteTable"" : {
      ""Type"" : ""AWS::EC2::RouteTable"",
      ""Properties"" : {
        ""VpcId"" : { ""Ref"" : ""VPC"" },
        ""Tags"" : [
          { ""Key"" : ""Application"", ""Value"" : { ""Ref"" : ""AWS::StackId"" } },
          { ""Key"" : ""Network"", ""Value"" : ""Memcache"" },
          { ""Key"" : ""AZ"", ""Value"" : ""1"" },
          { ""Key"" : ""Name"", ""Value"" : ""memcache-1"" }
        ]
      }
    },
 
    ""Memcache1SubnetRouteTableAssociation"" : {
      ""Type"" : ""AWS::EC2::SubnetRouteTableAssociation"",
      ""Properties"" : {
        ""SubnetId"" : { ""Ref"" : ""Memcache1Subnet"" },
        ""RouteTableId"" : { ""Ref"" : ""Memcache1RouteTable"" }
      }
    },
 
    ""MemcacheNetworkAcl"" : {
      ""Type"" : ""AWS::EC2::NetworkAcl"",
      ""Properties"" : {
        ""VpcId"" : { ""Ref"" : ""VPC"" },
        ""Tags"" : [
          { ""Key"" : ""Application"", ""Value"" : { ""Ref"" : ""AWS::StackId"" } },
          { ""Key"" : ""Network"", ""Value"" : ""Memcache"" },
          { ""Key"" : ""Name"", ""Value"" : ""Memcache-ACL"" }
        ]
      }
    },
 
    ""InboundMemcacheMemcacheNetworkAclEntry"" : {
      ""Type"" : ""AWS::EC2::NetworkAclEntry"",
      ""Properties"" : {
        ""NetworkAclId"" : { ""Ref"" : ""MemcacheNetworkAcl"" },
        ""RuleNumber"" : ""100"",
        ""Protocol"" : ""6"",
        ""RuleAction"" : ""allow"",
        ""Egress"" : ""false"",
        ""CidrBlock"" : { ""Fn::FindInMap"" : [ ""XXXSubnetConfig"", ""VPC"", ""CIDR"" ]},
        ""PortRange"" : { ""From"" : ""11211"", ""To"" : ""11211"" }
      }
    },
 
    ""Memcache1SubnetNetworkAclAssociation"" : {
      ""Type"" : ""AWS::EC2::SubnetNetworkAclAssociation"",
      ""Properties"" : {
        ""SubnetId"" : { ""Ref"" : ""Memcache1Subnet"" },
        ""NetworkAclId"" : { ""Ref"" : ""MemcacheNetworkAcl"" }
      }
    },
 
    ""WordPressMemcacheParameterGroup"" : {
      ""Type"": ""AWS::ElastiCache::ParameterGroup"",
      ""Properties"": {
        ""CacheParameterGroupFamily"" : ""memcached1.4"",
        ""Description"" : ""Parameters for Memcache for the WordPress1 cluster"",
        ""Properties"" : { 
          ""cas_disabled"" : ""1""
        }
      }
    }, 
 
    ""Memcache1WordPress1Cluster"" : {
      ""Type"" : ""AWS::ElastiCache::CacheCluster"",
      ""Properties"" : {
        ""CacheNodeType"" : { ""Ref"" : ""ElasticacheNodeType"" },
        ""CacheParameterGroupName"" : { ""Ref"" : ""WordPressMemcacheParameterGroup"" },
        ""CacheSecurityGroupNames"" : [
          { ""Ref"": ""MemcacheWordPress1SecurityGroup"" }
        ],
        ""Engine"" : ""memcached"",
        ""NumCacheNodes"" : { ""Ref"": ""WordPress1MemcacheNodesPerAZ"" },
        ""Port"" : 11211,
        ""PreferredAvailabilityZone"" : { ""Ref"" : ""AvailabilityZone1"" },
        ""PreferredMaintenanceWindow"" : { ""Ref"" : ""MemcacheMaintenanceWindow"" }
      }
    },
 
    ""MemcacheWordPress1SecurityGroup"": {
      ""Type"": ""AWS::ElastiCache::SecurityGroup"",
      ""Properties"": {
        ""Description""  : ""Memcache SecurityGroup for the WordPress1 designation (WordPress1 is example.com).""
      }
    },
 
    ""MemcacheWordPress1SecurityGroupIngress"": {
      ""Type"": ""AWS::ElastiCache::SecurityGroupIngress"",
      ""Properties"": {
        ""CacheSecurityGroupName""  : { ""Ref"" : ""MemcacheWordPress1SecurityGroup"" },
        ""EC2SecurityGroupName""    : { ""Ref"" : ""WordPress1SecurityGroup"" }
      }        
    },
 
    ""WordPress1SecurityGroup"" : {
      ""Type"" : ""AWS::EC2::SecurityGroup"",
      ""Properties"" : {
        ""GroupDescription"" : ""SecurityGroup for WordPress1 web servers (example.com) in all AZs. Allows SSH access from Bastion and port 80 from ELBs and Bastion"",
        ""VpcId"" : { ""Ref"" : ""VPC"" }
      }      
    },      
 
    ""WordPress1SecurityGroupIngressHTTPELB"" : {
      ""Type"": ""AWS::EC2::SecurityGroupIngress"",
      ""Properties"" : {
        ""GroupId"": { ""Ref"": ""WordPress1SecurityGroup"" },
        ""IpProtocol"" : ""tcp"", 
        ""FromPort"" : ""80"", 
        ""ToPort"" : ""80"", 
        ""SourceSecurityGroupId"" : { ""Ref"": ""CanHTTPAccessWordPress1SecurityGroup"" }
      }
    },
 
   ""CanHTTPAccessWordPress1SecurityGroup"" : {
      ""Type"" : ""AWS::EC2::SecurityGroup"",
      ""Properties"" : {
        ""GroupDescription"" : ""SecurityGroup for HTTP-accessors to WordPress1 (example.com) in all AZs. Designed for ELBs"",
        ""VpcId"" : { ""Ref"" : ""VPC"" }
      }      
    }
 
  },
 
  ""Outputs"" : {
 
    ""AZs"" : {
      ""Description"" : ""Availability Zones"",
      ""Value"" :  { ""Fn::Join"" : [ """",  [{ ""Ref"" : ""AvailabilityZone1""} ]]}
    },
 
    ""WordPress1"" : {
      ""Description"" : ""WordPress1 example.com"",
      ""Value"" :  { ""Fn::Join"" : [ """",  [
 
        ""SecurityGroup "",
        { ""Ref"" : ""WordPress1SecurityGroup"" }, 
 
        "" Subnets #1 "",
        { ""Fn::FindInMap"" : [ ""XXXSubnetConfig"", ""WordPress1AZ1"", ""CIDR"" ] },  
        "" "",
        { ""Ref"" : ""WordPress1AZ1Subnet"" },
 
        "" ELB SG is "",
        { ""Ref"" : ""CanHTTPAccessWordPress1SecurityGroup"" }
       
      ] ] }
    }
 
  }
 
}"
Amazon Elasticache	"Re: CacheSecurityGroupIngress was not found
arn:aws:cloudformation:us-east-1:367030791159:stack/memcache-test-1/9759b140-b42a-11e2-bd1a-5081c366858d

It was created from existing working templates."
Amazon Elasticache	"Re: CacheSecurityGroupIngress was not found
Thank you.  We'll start going over this."
Amazon Elasticache	"Re: CacheSecurityGroupIngress was not found
Hi,

I am a ElastiCache Service Team member.  CloudFormation currently does not support Elasticache in VPC. Also, cache security groups are not used in VPC setup.  

Here are some more links that might be helpful.

FAQ: http://aws.amazon.com/elasticache/faqs/#Cache_Security_Group_VPC
UserGuide: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithVPC.html
API reference: http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/API_CreateCacheSecurityGroup.html"
Amazon Elasticache	"Re: CacheSecurityGroupIngress was not found
Thanks. I'll handle Elasticache in VPC using an API script, then.

Would it be safe to set up the subnet, routing table and ACL in CloudFormation and leave the API calls to deal with the set up of AWS::ElastiCache::CacheCluster and AWS::ElastiCache::ParameterGroup?

No problems about security groups. Relying on network topology for security should be adequate in VPC.

Edit: re  Cache Security Group VPC I'll have a go with VPC security groups (better than relying on the network topology alone)

Edited by: rstaveley3 on May 3, 2013 2:02 PM

Edited by: rstaveley3 on May 3, 2013 2:14 PM"
Amazon Elasticache	"Re: CacheSecurityGroupIngress was not found
I highly do appreciate if this gets implemented.

Or even provide a good documentation for the workaround.

Thanks"
Amazon Elasticache	"Horrible DNS lookup times for ElastiCache
We recently created an ElastiCache cluster. Here is the DNS name:

stg-cache-1a.paumyo.cfg.usw1.cache.amazonaws.com

When doing a DNS lookup, the first attempt nearly always fails because of a 10 second timeout. The second attempt fails about 50% of the time, and the 3rd attempt finally succeeds. This tells me it is taking our public DNS server nearly 30 seconds to query the IP address before finally caching it. I can reproduce this in our VPC, from our corporate office, our non-AWS production environment, and from a hosted server at DreamHost. In fact, the only place I can get consistent DNS resolution is from a public EC2 instance using Amazon's DNS servers directly. This has made ElastiCache within our VPC unusable. Any suggestions?

$ time host stg-cache-1a.paumyo.cfg.usw1.cache.amazonaws.com
;; connection timed out; no servers could be reached

real	0m10.220s
user	0m0.005s
sys	0m0.003s

$ time host stg-cache-1a.paumyo.cfg.usw1.cache.amazonaws.com
stg-cache-1a.paumyo.cfg.usw1.cache.amazonaws.com has address 172.24.225.55
;; connection timed out; no servers could be reached
;; connection timed out; no servers could be reached

real	0m21.164s
user	0m0.004s
sys	0m0.003s

$ time host stg-cache-1a.paumyo.cfg.usw1.cache.amazonaws.com
stg-cache-1a.paumyo.cfg.usw1.cache.amazonaws.com has address 172.24.225.55

real	0m0.401s
user	0m0.005s
sys	0m0.003s"
Amazon Elasticache	"Re: Horrible DNS lookup times for ElastiCache
I should note that each of the environments we tested are using different DNS servers. It seems like all DNS servers except Amazon's are very, very slow when querying this domain."
Amazon Elasticache	"Re: Horrible DNS lookup times for ElastiCache
Amazon ElastiCache Nodes, deployed in a VPC, can only be accessed from EC2 Instances within the same VPC. Also, the EC2 instances and ElastiCache Nodes need to be in the same VPC Security Group."
Amazon Elasticache	"Re: Horrible DNS lookup times for ElastiCache
Removed this comment as it was incorrect.

Edited by: mlerch223 on May 8, 2013 12:38 AM"
Amazon Elasticache	"Re: Horrible DNS lookup times for ElastiCache
Found the issue here to be having a VPC with a subnet of 172.16.0.0/16. I believe this is overlapping with the Amazon Magic DNS entry, it is failing the initial set of lookup servers before finally hitting one that doesn't overlap.

All of the locations that were having this issue are networks interconnected with VPNs and all route 172.16.0.0 traffic to one of our VPCs.

Long story short, if 172.16.0.23 overlaps with a VPC or subnet on your network, forward lookups to a DNS server not part of the network.

Edited by: mlerch223 on May 8, 2013 12:24 AM"
Amazon Elasticache	"Re: Horrible DNS lookup times for ElastiCache
Mukesh - thank you for the feedback. This isn't a security or routing issue. Once the hostname resolves to an IP address, or if you use the IP address directly, everything works perfectly. The issue is that the hostname was taking so long to resolve that the memcache client libraries were timing out. I left a note above regarding the issue. I am not sure if AWS can do anything to resolve this, but it appears there is an incompatibility with having a VPC with a 172.16.0.0/16 subnet associated."
Amazon Elasticache	"Re: Horrible DNS lookup times for ElastiCache
I am in a 10 network, and I have been seeing this problem sporadically.  It's common for 5+ second lookups on the Elasticache nodes, and worse I get errors stating that the name is invalid.   I have TCP dumps where the VPC DNS is returning ""NXDomain"" on cache nodes.  

As far as I can tell, direct IP access works, but I am looking for answers as well."
Amazon Elasticache	"Difference between memcached extension in PECL (for PHP) and Amazon's own
I feel like there isn't enough documentation on how:

[] the memcached extension in PECL (for PHP)
    and
[] Amazon's own memcached extension of PHP

actually differ?

Q1 If I change from the PECL one to the Amazon one, will things that used to work with the PECL one still continue to work?

Q2 What exactly is the Amazon one adding to the PECL one?

Q3 Is the Amazon one compatible at the method call level with the PECL one?

This isn't clear to me and I feel it is quite important to know so could somebody with the knowledge please give me some insights?

Thanks


Daniel"
Amazon Elasticache	"Elastic Chache or AppFabric 1.1 for Windows Server
Is it OK to install “AppFabric 1.1 for Windows Server” (http://msdn.microsoft.com/en-US/windowsserver/ee695849.aspx  on my EC2 instance with IIS 8 and use it instead of Elastic Chache ? 
If any one can share his/her experience, I would be obliged.
Thanks"
Amazon Elasticache	"Failed to initialize storage module memcache
I am trying install memcache for php session management.

PHP FATAL error: session_start(): Failed to initialize storage module memcache

Here is what i did

step 1 
yum install memcache

step 2
pecl install memcache

step 3 
Changed php ini setting
session.save_handler = memcache
session.save_path=""amazonnode:11211?persistent=1&weight=1&timeout=1&retry_interval=15""

step 4
restart apache 
start memcache 

Then nothing works 

can anyone offer some advice

Edited by: chrismarkovic on Jul 25, 2013 8:26 AM"
Amazon Elasticache	"Re: Failed to initialize storage module memcache
Hi,

Thanks for your post.  There is a detailed guide for this install on the following blog:

http://jonathanhui.com/install-configure-memcached-ec2-amazon-linux

Let me know if you have seen this and which step you are getting stuck on.

Kind regards,
John G."
Amazon Elasticache	"ElastiCache Auto discover not working
Hi,

I have created Elasticache with 2 nodes  and turn on auto-discovery with the ElastiCache Cluster Client in my code and included jar file.

Even there are 2 elastic nodes running in my EC cluster and in my code it pointed to Confignode, but my application will only discover node-1 and will not get the node-2 information.

Below is my code and i have downloaded and included jar file as well.
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html

""testad.igj2gr.cfg.usw1.cache.amazonaws.com"" is my cluster config endpoint and having 2 nodes in it.

Could you please suggest, am I missing anything in configuration in my client side application code.
===========================================================
package com.tenxn.live.service;

import java.io.IOException;
import java.net.InetSocketAddress;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.Future;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

import net.spy.memcached.MemcachedClient;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public void init() {
		try {
		String configEndpoint = ""testad.igj2gr.cfg.usw1.cache.amazonaws.com"";
	        Integer clusterPort = 11211;

	        memcachedClient = new MemcachedClient(new InetSocketAddress(configEndpoint, clusterPort));       
	        // The client will connect to the other cache nodes automatically

	        // Store a data item for an hour.  The client will decide which cache host will store this item. 
	        memcachedClient.set(""theKey"", 3600, ""This is the data value"");


		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public Future<Boolean> set(String key, String value) {
		LOGGER.debug(""Key = {} and value = {}."", key, value);
		Future<Boolean> futureResult= memcachedClient.set(key, EXPIRE_NEVER, value);
		return futureResult;
	}
==============================================

When i delete node-1, getting below error, even though node-2 presents in EC cluster.
Memcached.internal.CheckedOperationTimeoutException: Timed out waiting for operation - failing node: 
testad.igj2gr.cfg.usw1.cache.amazonaws.com/10.172.239.45:11211
        at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:160)
        at net.spy.memcached.internal.GetFuture.get(GetFuture.java:62)
        at com.tenxns.live.service.MemCacheManager.get(MemCacheManager.java:139)
        at com.tenxns.live.service.MemCacheManager.get(MemCacheManager.java:91)
        at com.tenxns.live.service.HealthCheckService.computeCacheStatus(HealthCheckService.java:44)
        at com.tenxns.live.service.HealthCheckService.computeLiveEngineHealthCheck(HealthCheckService.java:92)
        at sun.reflect.GeneratedMethodAccessor46.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.springframework.scheduling.support.ScheduledMethodRunnable.run(ScheduledMethodRunnable.java:64)
        at 
org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:53)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)
        at 
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)
        at 
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
2013-07-19 01:29:27.956 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for dummyKey.
2013-07-19 01:29:28.635 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for chess_2013060614.
2013-07-19 01:29:28.637 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for chess_2013060614_650553.
2013-07-19 01:29:28.638 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for chess_2013060614_VERSION.
2013-07-19 01:29:28.639 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for chess.


98 INFO net.spy.memcached.MemcachedConnection:  Reconnecting due to failure to connect to {QA 
sa=testad.igj2gr.cfg.usw1.cache.amazonaws.com/10.172.239.45:11211, #Rops=0, #Wops=1022, #iq=0, topRop=null, topWop=Cmd: set 
Key: chess_2013060614_650496 Flags: 0 Exp: 0 Data Length: 1844, toWrite=0, interested=0}
java.net.ConnectException: Connection timed out
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:567)
        at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:399)
        at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:247)
        at net.spy.memcached.MemcachedConnection.run(MemcachedConnection.java:915)
2013-07-19 01:32:04.498 WARN net.spy.memcached.MemcachedConnection:  Closing, and reopening {QA 
sa=testad.igj2gr.cfg.usw1.cache.amazonaws.com/10.172.239.45:11211, #Rops=0, #Wops=1022, #iq=0, topRop=null, topWop=Cmd: set 
Key: chess_2013060614_650496 Flags: 0 Exp: 0 Data Length: 1844, toWrite=0, interested=0}, attempt 8.
19 Jul 2013 01:32:05,025 INFO :Thread-7 com.tenxns.live.model.bundle.datamessage.BundleDataMessage - Sequence Number 
Missing - newInstance = {""PH"":true}


ched.MemcachedConnection:  Could not redistribute to another node, retrying primary node for UFC_4343.
2013-07-19 01:37:50.790 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for UFC_4343_00063.
2013-07-19 01:37:50.791 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for UFC_4343_VERSION.
19 Jul 2013 01:37:50,806 INFO :Thread-4 com.tenxns.live.service.UpdateBundleServiceImpl - Writing Replay Bundle to File: 
'/opt/apache-tomcat-6.0.35/ReplayBundles/UFC_4343_REPLAY.json'
2013-07-19 01:37:50.807 WARN net.spy.memcached.MemcachedConnection:  Could not redistribute to another node, retrying primary 
node for UFC.



2013-07-19 01:39:43.516 INFO net.spy.memcached.MemcachedConnection:  Reconnecting due to failure to connect to {QA 
sa=testad.igj2gr.cfg.usw1.cache.amazonaws.com/10.172.239.45:11211, #Rops=0, #Wops=3226, #iq=0, topRop=null, topWop=Cmd: set 
Key: chess_2013060614_650496 Flags: 0 Exp: 0 Data Length: 1844, toWrite=0, interested=0}
java.net.ConnectException: Connection timed out
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:567)
        at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:399)
        at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:247)
        at net.spy.memcached.MemcachedConnection.run(MemcachedConnection.java:915)
2013-07-19 01:39:43.516 WARN net.spy.memcached.MemcachedConnection:  Closing, and reopening {QA 
sa=testad.igj2gr.cfg.usw1.cache.amazonaws.com/10.172.239.45:11211, #Rops=0, #Wops=3226, #iq=0, topRop=null, topWop=Cmd: set 
Key: chess_2013060614_650496 Flags: 0 Exp: 0 Data Length: 1844, toWrite=0, interested=0}, attempt 17.





2013-07-19 01:45:40.529 INFO net.spy.memcached.MemcachedConnection:  Connection state changed for sun.nio.ch.SelectionKeyImpl@bf09592
2013-07-19 01:45:40.530 INFO net.spy.memcached.MemcachedConnection:  Reconnecting due to failure to connect to {QA sa=testad.igj2gr.cfg.usw1.cache.amazonaws.com/10.172.239.45:11211, #Rops=0, #Wops=4935, #iq=0, topRop=null, topWop=Cmd: set Key: chess_2013060614_650496 Flags: 0 Exp: 0 Data Length: 1844, toWrite=0, interested=0}
java.net.ConnectException: Connection timed out
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:567)
        at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:399)
        at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:247)
        at net.spy.memcached.MemcachedConnection.run(MemcachedConnection.java:915)

======================================="
Amazon Elasticache	"ElastiCache Metrics: When do I expand the cluster size?
Hello,

I am comfortably running a cluster of ElastiCache instances.

1. What are the parameters on which I can figure out that I need more/less capacity? This would help in auto-scaling the cluster size based on usage throughout the day.

2. Are there any benchmarks for ElastiCache that I can compare my metrics with?

Thank you,
Rajat"
Amazon Elasticache	"Re: ElastiCache Metrics: When do I expand the cluster size?
We recommend that you monitor the CPU utilization, memory usage and Cache Hit Rate of your ElastiCache Cluster through the Amazon CloudWatch Metrics to decide the appropriate cluster size that meets your requirements. 

More information can be found at: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/ChooseACacheNodeType.html"
Amazon Elasticache	"Using ElastiCache in a VPC created through CloudFormation
We are currently migrating our CloudFormation-based architecture that contains two ElastiCache clusters to sit inside a VPC, in order to make use of AWS Direct Connect.

I understand it is currently not possible to create an ElastiCache cluster inside a VPC using CloudFormation, nor is it possible to pre-create an ElastiCache cluster and set-up the required security group rules in the CloudFormation template.

Is there currently an officially recommended work-around for using ElastiCache with CloudFromation/VPC?

Is there a timeline for when ElastiCache with VPC might be available in CloudFormation?

This is a critical requirement for us and will significantly reduce our benefit of using CloudFormation until it is available.

Thanks,

Robert"
Amazon Elasticache	"not getting best performance for application after creating elasti cache
hi All,
i am having application developed in magento. in order to get the best performance of application we launched Elasticache.

i have done follwoing steps:-
1) We launched the cache cluster with four cache nodes of m1.small type.
2) Then integrated cache security group with EC2 security group for which cache mechanism should work.
3) Then we copied the cache clusters node end point and put it into our configuration file.
4) Downloaded the elasti cache cluster client for PHP on ec2 server and installed.
5) After this we got one sample PHP code to integrate with Amazon Elasticache. The reference link is:- http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html#AutoDiscovery.ModifyAppPHP

But we are not sure how to and where to integrate this code inside our application. I have attached that code here clusterClient.php

Please help me to get the better performance with Elasti cache.

Thanks,
Swapnil"
Amazon Elasticache	"Cache Security Groups not shown
Hi...
I'm trying to use elasticache with mi ec2, but I can't see the option ""Cache Security Groups"" on the left menu to authorize access from it. I'm working on Sao Paulo region, the funny thing is that if I change the region to N. Virgina, the Cache Security Groups is visible (Only on that region, I tried the others and it is not visible).

I also tried copying the hashtag ""#security-groups:names="" from N.Virginia to Sao Paulo and it show this: ""Use of cache security groups is not permitted in this API version for your account."".

Could you please help me with this?

Thanks a lot!"
Amazon Elasticache	"Re: Cache Security Groups not shown
Hello,

We will have a look at this for your account."
Amazon Elasticache	"Re: Cache Security Groups not shown
Any news on this? 
Is there any other way to create cache security groups without using the console?
Thanks!

Edited by: jmontesr on Jul 13, 2013 1:37 PM"
Amazon Elasticache	"Re: Cache Security Groups not shown
Hi there jmontesr,

Our Service Team have reviewed this issue for you, and have identified that your account is setup for VPC by default in the Sao Paulo region, but not for the US East region.

This means you must manage and maintain your security groups for all of your AWS resources in the Sao Paulo region via the VPC Console. More information on maintaining your VPC Security Groups can be found here:
http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_SecurityGroups.html

I hope this information helps point you in the right direction.

Best regards,
Phil P"
Amazon Elasticache	"Re: Cache Security Groups not shown
I don't understand why is this the reason for the Cache Security Groups menu option not being visible from the elasticache console?

I checked my security groups and all are in Sao Paulo.

Edited by: jmontesr on Jul 15, 2013 5:59 PM

Edited by: jmontesr on Jul 15, 2013 7:06 PM"
Amazon Elasticache	"Re: Cache Security Groups not shown
Hi jmontesr,

All Security Group configuration for most services that are in a VPC, must be managed through the VPC Management Console. More information specific to ElastiCache Security Groups in a VPC can be found here:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithVPC.CreatingVPC.html

As such you will not be able to access the Cache Security Groups menu from within the ElastiCache console for the Sao Paulo region.

And here is some information on using ElastiCache in a VPC:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithVPC.html

I hope this information helps.

Best regards,
Phil P"
Amazon Elasticache	"Re: Cache Security Groups not shown
Yep... I got confused with the documentation.
Thanks a lot!"
Amazon Elasticache	"Can I use ElastiCache for acquiring and updating a tally number?
I'm investigating adding a simple service that acquires, increments, or resets a tally number in a storage mechanism.  I'm thinking about using either a database or ElastiCache for this storage.

The basic requirements are:
1. Multiple apps must be able to simultaneously acquire, increment (+1), or occasionally reset the tally
2. If multiple applications acquire the tally simultaneously, they all receive the same value.
3. If multiple applications increment the tally simultaneously, the sum of the requests is the result.  (i.e. 5 apps = an increment of 5).  (FIFO queue-like)
5. The update, retrieval, and reset of the tally value does not have to occur in real-time, but must be very fast (max 50 ms, lower is better).
6. App deployments with occur in EC2 using auto-scaling, in the same region, and across two availability zones.
7. Apps will receive traffic from a front-end load balancer.  The traffic each app receives may trigger an event to acquire and/or modify the tally.

Using the database, we could use stored procedures to act as the single pipe for these requests, but I'm concerned about its capacity under heavy traffic.  ElastiCache is an option, but the following comments from this page also concern me:

""ElastiCache nodes are not peer aware.""

""The idea behind the consistent hashing algorithm is to hash both objects and cache nodes using the same hash function and consistently maps objects to the same cache node, as much as possible.""

To paraphrase, an update to one node does not automatically propagate to the other nodes.   The system makes the best guess of where that data lies, but it is not guaranteed to guess correctly (a cache miss).

I am curious to hear from others who have more experience with ElastiCache on this problem.

Is ElastiCache unusable for a running a tally that is updated by multiple applications?

Edited by: sporcina on Feb 16, 2013 12:11 PM

Edited by: sporcina on Feb 16, 2013 12:15 PM"
Amazon Elasticache	"Re: Can I use ElastiCache for acquiring and updating a tally number?
<bump>  Has anyone implemented web service throttling in EC2 with multiple app/web stacks?"
Amazon Elasticache	"Re: Can I use ElastiCache for acquiring and updating a tally number?
Have you found a solution to your problem? I have similar requirements and haven't come across any definite solution.

Thanks
JoAWS"
Amazon Elasticache	"ElastiCache with multiple
Hi, I have a VPC setup with two cache clusters each with 1 cache node. Since the suport for multi AZ is not as yet available for cache, I have two queries around the setup:

1) On using memcached protocol and creating memcached client with the two nodes, specifying redundancy as 2 alone, replicates the keys on nodes in both clusters?
2) Upon save, which cluster is the key stored? Is the key still replicated on the other cluster?
3) Is consistent hashing needed or redundancy parameter obviates it?

Reference: https://npmjs.org/package/memcached"
Amazon Elasticache	"Re: ElastiCache with multiple
Hello,

Replication isn't a part of the memcached protol itself. These sorts of features must be implemented on the client-end.

In order to provide more guidance regarding your questions, can you provide information about the client library you are using and any relevant information about your use-case?

Cheers,
Jeff D."
Amazon Elasticache	"PHP Session Issues / Probably Environmental?
Ok - here's the issue, I have php, httpd, and mysql all installed on my ec2 instance. 

I have one file which is used to set $_SESSION variables, a snippet it below:
session_start();
<DB LOGIC> // works fine, I debugged this

//if username exists
if(mysql_num_rows($result)>0)
{
	//compare the password
	if(strcmp($row,$pass)==0)
	{
		$userid = $row[0];
		$_SESSION=$userid;
		$_SESSION=$username;
		$_SESSION = time();
        }
....


I have another file with the code below which outputs the session_id, session_file, and size correctly; however - the nothing is getting spit out for the $_SESSION object itself (like userid, username, etc)?
session_start();

echo 'session id: ', session_id(), ""\n"";

$sessionfile = ini_get('session.save_path') . '/' . 'sess_'.session_id();
echo 'session file: ', $sessionfile, ' ';
if ( file_exists($sessionfile) ) {
    echo 'size: ', filesize($sessionfile), ""\n"";
    echo '# ', file_get_contents($sessionfile), ' #';
}
else {
    echo ' does not exist';
}

var_dump($_SESSION);
echo ""</pre>\n"";

**********
So I'm completely stuck at this point? This code works fine locally, and was working just great on another host - so I'm pretty sure I have some sort of environmental issue; however - I can't find anything that works.

FYI - apache has read/write permissions on /var/lib/php/session

*To see the full php.ini, go to http://casinobitco.in/secure/tim-session.php"
Amazon Elasticache	"ElastiCache and Elastic Beanstalk Zero Downtime
We'd like to use the Zero Downtime approach to deployments for Elastic Beanstalk. Everything is automated through our build process.

However our blocker for full continuous deployment is that the new cloned Beanstalk's EC2 security group needs to be manually added to our ElastiCache cluster's authorized security groups.

What are our options for doing this at deploy time e.g. after the new Beanstalk environment has been created but before the Environment URLs have been swapped?"
Amazon Elasticache	"Re: ElastiCache and Elastic Beanstalk Zero Downtime
Hello,

Two questions:
Are you launching a new ElastiCache cluster with each new BeanStalk environment?  If so please review this document: http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-environment-resources-elasticache.html as I believe it directly addresses your needs.

If you are not - is there a reason you aren't just re-using the same security group on the new Beanstalk environment? 

If you cannot reuse the security group (or you don't want to) you can use either the CLI tools and/or the API to automate adding the security group - directions to setup the CLI are available here: http://docs.aws.amazon.com/AmazonElastiCache/latest/CommandLineReference/StartCLI.html

The specific CLI command that you would use to grant access is here: http://docs.aws.amazon.com/AmazonElastiCache/latest/CommandLineReference/CLIReference-cmd-AuthorizeCacheSecurityGroupIngress.html

Here is a link to the API reference: http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/Welcome.html

Regards, 
David S."
Amazon Elasticache	"Re: ElastiCache and Elastic Beanstalk Zero Downtime
No, we are not creating a new cluster with each new environment. We have profile-specific environments (prod, qa, dev) and have equivalent clusters for each. 

For a manual Zero Downtime deployment, we create a new EB Environment through the AWS EB Console and, as far as I can tell, that creates a new EC2 Security Group even if you reuse the configuration from the environment you are replacing.

Is there a way to use the same security group on the new Beanstalk environment?

If not, it sounds like we'd have to run some custom CLI script to identify the new Environment, get its EC2 Security Group and then add that the appropriate ElastiCache cluster, correct?"
Amazon Elasticache	"Re: ElastiCache and Elastic Beanstalk Zero Downtime
Hello,

If you are working in a VPC then yes you can re-use an existing security group.

If not then you would have to use the CLI commands as you posited in your previous response.

Regards,
David S."
Amazon Elasticache	"CheckedOperationTimeoutException using AmazonElastiCacheClusterClient-1.0
Hi,

My Elasticache cluster is failing randomly and it's causing my whole environment to crash.
I keep getting CheckedOperationTimeoutException after some time of operation.
I'm running with 3 seconds of timeout which is way too much for a cache server.
Here's my server log:

net.spy.memcached.internal.CheckedOperationTimeoutException: Timed out waiting for operation - failing node: /10.248.X.X:11211
        at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:93)
        at net.spy.memcached.internal.GetFuture.get(GetFuture.java:62)
        at com.xxxxxxxxxxx.MemcachedService.get(MemcachedService.java:274)

I'm using AmazonElastiCacheClusterClient-1.0 library.

My environment is running in Sydney, I have a ElasticBeanstalk environment connected to a RDS db and the cache cluster.

Any ideas of what's causing this issue?"
Amazon Elasticache	"Re: CheckedOperationTimeoutException using AmazonElastiCacheClusterClient-1.0
Hello,
I sent you a PM for getting more information."
Amazon Elasticache	"Re: CheckedOperationTimeoutException using AmazonElastiCacheClusterClient-1.0
Hello Phil,
I can see that now the ElastiCache slice that timed out is no more part of the cluster (there is only one slice now). Are you still experiencing this issues? Do you have additional more recent timestamps?

Reviewing also the CloudWatch metrics of your application server i-b74fc18b, I can see that in the latest week maxed out the cpu between 2013-07-05T01:10UTC and 2013-07-05T09:00UTC, can you check the application server logs to see what was was happening?

Regards,
Federico"
Amazon Elasticache	"What is the best way to scale ElastiCache?
Hi,

We are using ElstiCache with memcached .net client. given .net client doesn't support auto discovery for nodes neither Amazon has .net client for auto discovery.

so with that, i am using cluster with single node and using node endpoint as i can't use cluster endpoint.

I don't see an option to scale or upgrade my cache node? Is there any other way to go about this?

Thank you in advance!

-Sanjay"
Amazon Elasticache	"Re: What is the best way to scale ElastiCache?
Hello Sanjay,

Thank you for contacting us via this forum posting.  Unfortunately ElastiCache does not currently support dynamically changing the cache node type for a cache cluster after it has been created. If you wish to change the Node Type of a cache cluster, you will need to set up a new cache cluster with the desired Node Type, and migrate your application to that cache cluster.  Please see our documentation around this which only supports scaling out the cluster by adding additional nodes:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithCacheClusters.html#ScalingCacheCluster

Best Regards,

Declan"
Amazon Elasticache	"ElastiCache cluster with ec2 replica
Is it possible have a cluster with EC2 slaves for read?

I want to write to the cluster of ElastiCache and read the data on the slaves of E2C.

How I can do this?

Thanks."
Amazon Elasticache	"Re: ElastiCache cluster with ec2 replica
Hello,

Thanks for your interest in ElastiCache.  The service does not support master-slave replication. All nodes in a cluster allow read and write operations from the client application, and work independent of the other nodes.

-Mukesh"
Amazon Elasticache	"ElastiCache Cluster Client for Java 1.0.1 source code
It looks like version 1.0.1 of the Amazon ElastiCache Cluster Client for Java has been released. Would it be possible for the AWS team to publish the updated source code to the ElastiCache Cluster Client GitHub repository? Thanks!"
Amazon Elasticache	"Re: ElastiCache Cluster Client for Java 1.0.1 source code
Hi, 

Thank you for posting on the forums. I have contacted the ElastiCache engineers on your behalf and will post an update once I hear back from them. 

Kind regards,
Morgan"
Amazon Elasticache	"Re: ElastiCache Cluster Client for Java 1.0.1 source code
Hi, 

Apologies for the delay in posting an update here. As you may have seen, we did release the source code to GitHub last month. 

Hopefully this helps. 

Kind regards,
Morgan"
Amazon Elasticache	"ElastiCache Cluster Client source code
Where is the source code to the ElastiCache Cluster Client?  The site on github (https://github.com/amazonwebservices/aws-elasticache-cluster-client-memcached-for-java) is out of date and the last commit was on Nov 28, 2012.  I have switch from spymemcached to this client and it works great.  However, sometimes it is hard to debug when without the source code.

Is this still open source code?"
Amazon Elasticache	"Re: ElastiCache Cluster Client source code
I'm also interested in this too.

I am endeavouring to extend the spy driver to allow me to reconcile a SNS node replacement method with hash compute data.

I have a scenario where if I lose a cache node I can recompute the member target for a given set of keys on the basis of state still in a client process.  This computation of keys allows me to, using a fast non network dependent operation compute if I've lost any data and force that data's state in the cache to be refreshed. i.e. did this key compute to the node I've lost.

This is all possible with the spy driver as I have the source but I can't replicate this behaviour with elasticache as I haven't got the source.

Short of writing my own auto discovery logic which is unfortunately going to be my next step.  I'm moving an existing application using couchbase into AWS.

Cheers,
Max"
Amazon Elasticache	"Cache Subnet Group default routing to NAT
Should Cache Subnet Groups in a VPC have private subnets, which have default routing to a NAT in a public subnet for egress to AWS, or do ElastiCache cluster instances cater for that themselves (...or is it not needed anyhow)?

I want to know whether the subnets need adding to a Route Table that provides default routing via a NAT (PAT) instance, or whether I can keep it with no egress."
Amazon Elasticache	"Re: Cache Subnet Group default routing to NAT
ElastiCache does not require Internet access in any form. You can use whatever subnets you want, but you don't really need anything more than the standard route table entry covering the local VPC network."
Amazon Elasticache	"No VPC security groups listed when I try to create an ElastiCache cluster
I have a VPC up and running (vpc-b4868bd8) and can see the security groups in it, which I created.

However, when I try to create an ElastiCache cluster in the VPC using the console, I see no VPC security groups listed and am unable to proceed.

Any suggestions?"
Amazon Elasticache	"Re: No VPC security groups listed when I try to create an ElastiCache cluster
Could you please confirm that you have created subnets in your VPC and associated the appropriate subnets to a cache security group. You will need to carry out these two steps before creating an ElastiCache cluster in your VPC.

More information on creating ElastiCache clusters in a VPC can be found here: 

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithCacheSubnetGroups.html
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithVPC.html"
Amazon Elasticache	"Re: No VPC security groups listed when I try to create an ElastiCache cluster
It all works fine from boto, though."
Amazon Elasticache	"Re: No VPC security groups listed when I try to create an ElastiCache cluster
Yes, confirmed. 

I'll try setting up a separate test VPC to see if I can reproduce this with the console to confirm it wasn't a transient problem with that VPC.

I have a working solution for this using boto now, which means the heat is off, but it would be good to be able to use the console for this too."
Amazon Elasticache	"Re: No VPC security groups listed when I try to create an ElastiCache cluster
I've not reproduced this problem since running into it. I believe it was something inherent in one particular VPC, but having deleted the VPC concerned, I'll write it off as a quirk.

There are oddities about ElastiCache in VPC. I notice that deleting a VPC and its subnets does not delete associated Cache Subnet Groups in ElastiCache. I've flagged this in the console, but the same issue is in the API.

I've no doubt these will all be addressed as and when ElastiCache+VPC gains its place in CloudFormation."
Amazon Elasticache	"Get Miss Count
What does the get miss count indicate?

Does it mean, that my site tried to find something that was not there yet, or does it mean that elaticache is failing to return vales when i expect them to.

Reason I am asking this is that I run a site that is currently on a stand alone server, and the session management works great, but since i have moved over to AWS I have been having reports of things not working, and it comes down to the fact that it seems to be not always be giving back the values from the session.

I have the session set to use memcache in the .htaccess file, is it possible that that .htaccess isnt always been read for some reason? or is my issue more likely be the elasticache miss rate being high, the miss rate is about 20% of the hit rate."
Amazon Elasticache	"Re: Get Miss Count
A ""get miss"" means that the requested key wasn't found. In short, what you asked for was not present at that time. This is perfectly normal and 20% wouldn't necessarily indicate that there is something to be worried about. If you are unable to find a key that you expect to be present, that is a bit troubling though. If you have a sufficient expiration time, this should not happen unless it is evicted due to memory pressure (look at the ""Evictions"" metric). I'm not familiar with how things work on the .htaccess side though."
Amazon Elasticache	"What is the maximum number of simultaneous connections?
Hi

What is the maximum number of simultaneous connections to an elasticache instance? I believe the value is 65000 but I would like to be 100% sure.

Also - this value is independent of the elasticache instance size, yes? 

Thanks!
-Eric"
Amazon Elasticache	"Re: What is the maximum number of simultaneous connections?
Hi Eric,

It sounds to be like you are referring to the ""max_simultaneous_connections"" Memcached parameter.  If so, the default value of that and other Memcached parameters supported by Amazon ElastiCache are listed here:

http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.html

Kind Regards,
-Cindy"
Amazon Elasticache	"Re: What is the maximum number of simultaneous connections?
Great thanks! Per those docs it says the value is 10,000."
Amazon Elasticache	"Re: What is the maximum number of simultaneous connections?
Bearing in mind this value can be tuned (e.g. via AWS::ElastiCache::ParameterGroup in Cloudformation), I was wondering what range max_simultaneous_connections can sensibly be set to to provision for persistent Memcache connections.

Presumably it depends on the node type?

        ""cache.t1.micro"", 
        ""cache.m1.small"", 
        ""cache.m1.medium"", 
        ""cache.m1.large"", 
        ""cache.m3.xlarge"", 
        ""cache.m3.2xlarge"", 
        ""cache.m2.xlarge"", 
        ""cache.m2.2xlarge"", 
        ""cache.m2.4xlarge"", 
        ""cache.c1.xlarge""  

10,000 seems generous compared with the 1024 you get in a default Memcache installation. I was wondering if this is the ""sweet spot"" or if it is worth tweaking for the right node type? 

What's the system limit for this (e.g. ulimit -a)?

--------8<--------
Edit:

Just seen this rdturned from my Cloudformation script:

The parameter max_simultaneous_connections cannot be modified.

It looks like it is immutable. I guess that makes plannig easier.

Edited by: rstaveley3 on May 2, 2013 11:18 PM"
Amazon Elasticache	"ElastiCache Cluster Client backwards compatibility with spymemcached
I'm trying to switch from spymemcached to the ElastiCache Cluster Client.  We create 1 WAR file that we use for production on AWS and for testing on our internal servers and developer workstations.  These servers and developer workstations have internal memcached daemons installed, and our configuration files point to these daemons when testing.

The problem we have is that when we switch to the ElastiCache Cluster Client jar, it always expects the memcached servers to be an ElastiCache cluster.

Is there a way to turn off auto-discovery with the  ElastiCache Cluster Client so we can use that jar in both the production and test environments?"
Amazon Elasticache	"Re: ElastiCache Cluster Client backwards compatibility with spymemcached
Yes, ElastiCache Cluster Client is backwards compatible with Spymemcached. To use the Cluster Client with non ElastiCache instances of Memcached, the client should be configured in ""Static"" mode.

When creating the MemcachedClient object, initialize it with multiple server endpoints, as described in the ElastiCache documentation http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.Manual.html. 

Below is a code sample.


import java.io.IOException;
import java.net.InetSocketAddress;
import java.util.ArrayList;
import java.util.List;

import net.spy.memcached.ClientMode;
import net.spy.memcached.ConnectionFactory;
import net.spy.memcached.MemcachedClient;
import net.spy.memcached.DefaultConnectionFactory;

public class static_sample {

    public static void main(String[] args) throws IOException {
        String node1 = ""mycluster.amazonaws.com"";
        Integer clusterPort = 11211;

        // Initialize a static client without using auto-discovery
        List<InetSocketAddress> cluster = new ArrayList<InetSocketAddress>();
        cluster.add(new InetSocketAddress(node1, clusterPort));
        ConnectionFactory cf = new DefaultConnectionFactory(ClientMode.Static);
        MemcachedClient client = new MemcachedClient(cf, cluster);

        // Store a data item for an hour.  The client will decide which cache host will store this item.
        client.set(""theKey"", 3600, ""This is the data value"");
    }
}

Edited by: OmerZ@AWS on Apr 24, 2013 8:31 AM"
Amazon Elasticache	"Re: ElastiCache Cluster Client backwards compatibility with spymemcached
OK thanks, now I see why I could not find my problem.  It turns out that I am using the Spring MemcachedClientFactoryBean.java bean factory.  It currently does not have a setter method for ClientMode.  I had to copy the source from the spymemcache git repository and I added the method.  Now everything works correctly.

MemcachedClientFactoryBean needs to have the ""setClientMode"" property added to work correctly.  Where is the latest source of your fork?  The one I found (https://github.com/amazonwebservices/aws-elasticache-cluster-client-memcached-for-java) is not up to date.

Is that the correct source repository?  I was a real pain debugging without walking into the source.  I could create a pull request with the changes if you can point me to the source and I would like to add the source jar to my maven artifacts for debugging purposes.

Thanks again."
Amazon Elasticache	"Re: ElastiCache Cluster Client backwards compatibility with spymemcached
New problem. I'm getting this continuously in my logs when running the client against a local memcached instance instead of on AWS:

2013-04-25 11:44:46.331 WARN net.spy.memcached.ConfigurationPoller:  The configuration is null in the server localhost
2013-04-25 11:44:46.331 WARN net.spy.memcached.ConfigurationPoller:  Number of consecutive poller errors is 25. Number of minutes since the last successful polling is 0

Is there another configuration parameter that needs to be set to fix this or turn it off?
I am setting clientMode to Static."
Amazon Elasticache	"How to size ElastiCache instance?
I've just deployed a new process using ElastiCache and I think I'm running into a load issue.  After a fair amount of data is loaded in, I start getting null results back for some of the older data (that has not yet expired).  I'm assuming this is caused by too much data being stored in the cache and it starts droping the oldest data.  Is this a correct assumption?

I'm also not sure how the sizing of the cluster and number of nodes impacts the amount of data the cache can hold.

I've got a cache.m2.xlarge cluster with 8 nodes.  Does this mean I can store 14.6 GB of data that's replicated to all nodes?  Or do I have 8 * 14.6 GB worth of data available?  (Or is it somewhere in between?)  How can I determine the max amount of data I have available?

Thanks!"
Amazon Elasticache	"Re: How to size ElastiCache instance?
In this case, you get the advertised memory per node * 8. There is no replication going on.

If you open up the cache cluster in the Management Console and browse to the ""Nodes"" tab, you will find very detailed information about the current state of your nodes there. Simply select a node from the list and you will see a large number of metrics. This data can hopefully give you some clues as to what is happening. For more information, please see CloudWatch Metrics with ElastiCache in the ElastiCache documentation."
Amazon Elasticache	"How can I develop my application with ElastiCache?
I am developing a web application.

Recently, I knew about AWS ElastiCache.  So, I decided to replace ehcache with this service for my application. 

But I recognized there is a big problem. I cannot connect to ElastiCache cache cluster and nodes on my desktop. Usually, I develop, run and test my application with local tomcat server. But when I applied ElastiCache configurations on my app then my application always threw exceptions(""Client is not initialized"") . So I cannot develop my application on my desktop PC anymore.

Is there any easy way to develop on my computer instead of deploying my application on EC2 server just for testing?"
Amazon Elasticache	"Re: How can I develop my application with ElastiCache?
Unfortunately, ElastiCache is currently not accessible from outside of AWS. I'm personally using a local memcached server during development. The application knows where it is running and can automatically initiate a client with the right settings. Binary connections don't work on my desktop for some reason, which isn't ideal, but apart from that the application doesn't really care about whether it is talking to my local memcached or ElastiCache."
Amazon Elasticache	"Elastic Cache Activity
Team,

I have used elastic cache for the website, please let me know how can we know about the activity.

How can we know it is working with website or not.

Thanks
Ashok"
Amazon Elasticache	"Re: Elastic Cache Activity
You might want to have a look at the CloudWatch metrics for your cache instance(s). Open up the ElastiCache section of the Management Console, go to ""Cache Clusters"", and  hit the ""X nodes"" link. You will now see a list containing your ElastiCache instance(s). When you select an entry, the CloudWatch data is displayed below. There is a ""Time Range"" dropdown in the upper right corner. Get Commands, Set Commands, and Current Items might be of special interest. You can probably expect to see some data there."
Amazon Elasticache	"Re: Elastic Cache Activity
Hello Ashok.

From the Management Console, under ElastiCache, select ""Cache Clusters"". Then navigate to the ""Nodes"" tab. Choose a particular node from the list and a number of activity graphs will be displayed below.

Additionally, you can run performance tests against your website to ensure you are receiving the expected performance increase.

Thanks.
Brandon"
Amazon Elasticache	"Elasticache and VPC
Hello,

How can I configure servers in a VPC to work with elasticache cluster?"
Amazon Elasticache	"Re: Elasticache and VPC
Unfortunately, this doesn't seem to be supported. At the moment, access can be granted based on the security group only. The cache node DNS name resolves to an internal IP address when used within EC2. When using VPC, it resolves to the public IP address instead. The request can not be made using the internal network and therefore a source security group check will fail. In this case, a VPC instance is seen as an external server. Accessing ElastiCache from outside of EC2 is not currently supported."
Amazon Elasticache	"Re: Elasticache and VPC
ElastiCache Clusters are only accessible from EC2 Instances running in an EC2 security group, see http://aws.amazon.com/elasticache/faqs/#Can_I_access_Amazon_ElastiCache_from_outside_AWS for details.  Due to the differences between EC2 security groups and VPC security groups, it is currently not possible to access an ElastiCache Cluster from within VPC.  See http://docs.amazonwebservices.com/AmazonVPC/latest/UserGuide/index.html?VPC_SecurityGroups.html#VPC_Security_Group_Differences for the differences between EC2 security groups and VPC security groups."
Amazon Elasticache	"Re: Elasticache and VPC
Do you know if and when it's going to be supported?"
Amazon Elasticache	"Re: Elasticache and VPC
Any workaround for this?"
Amazon Elasticache	"Re: Elasticache and VPC
+1 - was considering making the jump from AppFabric to ElastiCache, but all our instances run in a VPC ..."
Amazon Elasticache	"Re: Elasticache and VPC
Any update on this now that it's March 2012? This seems like a big limitation of VPCs. Many websites use a public/private VPC setup with their web servers in the public VPC and the databases in the private VPC. Most web applications are now using memcached/elasticache for web server performance. 

Is there a way to get around this by having the web servers in EC2 and the database servers in a single private VPC? The setup would just need the public EC2 web server to have access to the VPC. Any issues with this design?"
Amazon Elasticache	"Re: Elasticache and VPC
We want to use ElastiCache from VPS too. It will be great to have this feature available ASAP."
Amazon Elasticache	"Re: Elasticache and VPC
I'm surprised about this! I was just about to deploy an elasticache instance for our VPC/VPN. Currently it points to our production memcached server, but to improve latency, I was about to throw the switch on VPC caching. I can't believe Amazon. Or maybe I can. This is typical of my entire design history with AWS. They introduce a cool new feature, but it doesn't work with any of their other services for at least a year (sometimes two). Do us a favor and implement this now, otherwise I'm going to move on to another provider solution."
Amazon Elasticache	"Re: Elasticache and VPC
Hi Everyone,

I'm a member of the ElastiCache team and we hear your feedback about VPC support loud and clear. We would love some input on how to prioritize this. If you're open to a discussion about your requirements, please email us at elasticache-forums@amazon.com and we'll get in touch to schedule a conversation.

Thank you for taking the time to share your thoughts -- your input helps us improve the service so that it better meets your needs.

Sincerely,

Rahul"
Amazon Elasticache	"Re: Elasticache and VPC
Requirement #1: Instances in VPCs should be able to use the ElastiCache service.

done"
Amazon Elasticache	"Re: Elasticache and VPC
Exactly as above:

Requirement #1: Instances in VPCs should be able to use the ElastiCache service.

While AWS supports DNS within VPC ( domain-name-servers = AmazonProvidedDNS ) ElastiCache host is translated to appropriate IP address.
In ElastiCache Security Group there is option to add EC2 security group, but no option to add VPC security group. I thing it's the only thing which prevent from using this service.

# host ht.XXX.0001.use1.cache.amazonaws.com
ht.XXX.0001.use1.cache.amazonaws.com is an alias for ec2-50-19-43-YYY.compute-1.amazonaws.com.
ec2-50-19-43-YYY.compute-1.amazonaws.com has address 50.19.43.209
# ping 50.19.43.YYY -c1
PING 50.19.43.YYY (50.19.43.YYY) 56(84) bytes of data.
64 bytes from 50.19.43.YYY: icmp_req=1 ttl=60 time=0.997 ms
 
--- 50.19.43.YYY ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.997/0.997/0.997/0.000 ms
# telnet ht.XXX.0001.use1.cache.amazonaws.com 11211
Trying 50.19.43.YYY...
telnet: Unable to connect to remote host: Connection timed out

XXX, and YYY changed."
Amazon Elasticache	"Re: Elasticache and VPC
bump!

Hello,

Any new information about that? Is this feature being considered to implement?

Best regards,
CSG"
Amazon Elasticache	"Re: Elasticache and VPC
Is there any progress regarding this issue?"
Amazon Elasticache	"Re: Elasticache and VPC
I tested the ElasticCache independently with one EC2 instance and was excited about that feature and the abilities it provide.

Spent one day to implement everything correctly with VPC, EC2 and RDS as DB instance and now while coming to define the connection to the ElasticCache cluster i surprised to discover that problem - i have nothing to do but not use that great feature, I have to increase my instance type to one with more memory and use memcached locally on my EC2 machine, very silly to have that feature stand on the shelf without the ability to work with it!,
I have to use VPC in order to have multiple sites with multiple Elastic IPs assign to it, does anyone know any workaround??

Can AWS develop team give us estimation for integration of the VPC into the ElasticCache like they have with the RDS?!?!?!?

Jonathan"
Amazon Elasticache	"Re: Elasticache and VPC
Please implement Elasticache in VPC."
Amazon Elasticache	"Re: Elasticache and VPC
Any updates on this item?

I want to take advantage of having multiple EIP's bound to my VPC instance, but I need to be able to tie into my ElastiCache cluster. Any chance we can get an ETA on this item?"
Amazon Elasticache	"Re: Elasticache and VPC
Any update on this from Amazon? This is a feature that we're looking for to build up our VPC."
Amazon Elasticache	"Re: Elasticache and VPC
Any update from AWS?  
+1 for ElastiCache with VPC

Edited by: gregshin on Aug 21, 2012 8:59 PM

Edited by: gregshin on Aug 21, 2012 9:00 PM"
Amazon Elasticache	"Re: Elasticache and VPC
I too got excited about using it in a VPC.

Here is my usage if this helps.

At least 1 ElastiCache Cluster providing internal data caching for internal web services (private subnet). Probably 2-4 nodes. Mainly fairly static lookup data.

Type of data primarily fairly small, simple .Net Data Transfer Objects.

At least 1 ElastiCache Cluster providing data caching for public WebAPI (public subnet). Probably 10-20 nodes.

Type of data includes larger more complex .Net Data Transfer Objects. E.g. pre-loaded customer data containing results of recent qualification processing. Publishing this data results in significant traffic spikes. Also includes data access by our vendors via WebAPI for customer lookup, configuration data changes etc.

I can't give too much away at the moment, but I hope this helps accelerate this support.

Support of ElastiCache is critical for our future plans.

Mike..."
Amazon Elasticache	"Re: Elasticache and VPC
Meant to post this to you Rahul so you might see this response to the initial poster as well 

.....

I too got excited about using it in a VPC.

Here is my usage if this helps.

At least 1 ElastiCache Cluster providing internal data caching for internal web services (private subnet). Probably 2-4 nodes. Mainly fairly static lookup data.

Type of data primarily fairly small, simple .Net Data Transfer Objects.

At least 1 ElastiCache Cluster providing data caching for public WebAPI (public subnet). Probably 10-20 nodes.

Type of data includes larger more complex .Net Data Transfer Objects. E.g. pre-loaded customer data containing results of recent qualification processing. Publishing this data results in significant traffic spikes. Also includes data access by our vendors via WebAPI for customer lookup, configuration data changes etc.

I can't give too much away at the moment, but I hope this helps accelerate this support.

Support of ElastiCache is critical for our future plans.

Mike..."
Amazon Elasticache	"Re: Elasticache and VPC
bump"
Amazon Elasticache	"Re: Elasticache and VPC
Hello,

     We also need to access ElastiCache from VPC.
     Is this issue included in the roadmap ?

     If yes, do you have an idea when it could be available ?

Regards"
Amazon Elasticache	"Re: Elasticache and VPC
Hi Rahul,

It would be great to see ElastiCache implemented much like RDS on a VPC subnet. This would be an incredibly awesome feature. Create a EC-VPC Subnet, manage Related Groups, -> Attach to VPC (maybe some availability stuff here). Then go ahead and manage Elasticache clusters selecting the EC-VPC and cluster related options as normal.

Thanks,
-Jon"
Amazon Elasticache	"Re: Elasticache and VPC
I'd just like to give a +1 to this request.  We have a VPC infrastructure that could greatly benefit from access to ElastiCache and I would love to provide this feature to our developers."
Amazon Elasticache	"Cloudwatch Metrics are incosistently available
I have a few groups of Elasticache instances running, some with multiple nodes. When I go to the cloudwatch metrics, each group has a different subset of metrics available, despite them being all basically the same configuration and size. I've found the other forum threads and tried their solutions, but:
1) It's not related to the 5000 metric limit, I can filter down and still see the same behavior
2) From the command line I get the same results as well

The whole point of this for me is to set an alarm when free memory drops less than 10%, which I can do for some of my cache clusters. Are there any other limitations to this I need to be aware of? I know that not all metrics are available until they've become 'interesting' in some way, is that related? Thanks!!"
Amazon Elasticache	"adding elasticache node - says it is working but data isn't being updated
Hi,

We recently decided to add a node to our elasticache cluster.

The single m1 node we had has worked fine for several months and we have been using memcached for many years prior to moving to elasticache.

This weekend we saw the m1 node start to strain under the load and CPU started to rise close to 100%.

Having seen the issue we decided that as elasticahe says it allows for on touch addition of another node that we would try it.

We added a second node

it seemed to work

but when our staff added content the changed content was not immediately updated and available it was as if there was a lag between the node being written to and the read from the node.

Has anyone seen this and does anyone know why it happens?

We had assumed that elasticache's nodes are a memcached pool with the data being spread around is that not the case?

If it isn't a pool and the data is copied from one node to another what is the latencies and how do we stop betting old data?

ANy ideas would be gratefully received.

ALan

Edited by: Mr Neil Wilkes on Mar 12, 2013 8:26 AM"
Amazon Elasticache	"Re: adding elasticache node - says it is working but data isn't being updated
Hi Neil,

Please check your email, I have opened outbound case 90070541 for your issue. We need more information, like the region of the elasticache cluster, and the elasticache cluster ID and any other identifying information that you can provide. Let us see if we can figure out what is happening to your new node."
Amazon Elasticache	"How to solve ""unable to create new native thread"" error?
Hi. I'm trying to test my cache cluster sending like 50 user requests per second.
After few minutes (sometimes even less) the ElastiCache server gives me the error ""unable to create new native thread"".
Monitoring my cache cluster, i can see that the ""current connections"" statistic raises up during my test, and when it reaches the top the test throws me that error.
I'm working in Java with spymemcached library, like this example:
https://code.google.com/p/spymemcached/wiki/Examples.
Do i have to do something explicit to close my connection after a request?
Any help will be appreciated.
Thanks."
Amazon Elasticache	"the aws memcached client can support annotation?
i am working web-poject with java language and already use cache, ehcache
(ehcache supports annotation. such as '@Cacheable @CacheEvict, ....')
recently, i knew ElastiCache (wow, its amazing!)
now i will change memcached client lib to elastic memcached client lib supported by amazon.
i read all docs.aws.amazon realated with annotation, but i can not found about annotation
usually, how to develop cache in java code with amazon memcached client?
just in service layer`s get() set() ?


ywbest.lee@samsung.com"
Amazon Elasticache	"PHP client: random failures with DYNAMIC_CLIENT_MODE enabled?
Has anyone else had problems with the PHP client + DYNAMIC_CLIENT_MODE?

I'm using 32 bit, PHP 5.3.

Basically, I'd say somewhere ~50% of the time, this sequence:
$memcache = new Memcached();
$memcache->setOption(Memcached::OPT_CLIENT_MODE, Memcached::DYNAMIC_CLIENT_MODE)
$memcache->addServer($host, $port);

Results in a $memcache object which fails for all calls, and returns result code/message of 20/""NO SERVERS DEFINED"".

I've checked, and addServer returns true, and I'm passing in a valid $host/$port (as again, it does work ~50% of the time)."
Amazon Elasticache	"Re: PHP client: random failures with DYNAMIC_CLIENT_MODE enabled?
I was using ElasticCache server 1.4.5, when I upgraded to 1.4.14 the problem went away.  This doesn't reassure me (why does the client break sometimes when talking to 1.4.5?  could there be a regression in 1.4.x where x > 14?)."
Amazon Elasticache	"Can't telnet into node
Hi,

I am having trouble telnet'ing in to a newly-created elasticache node.  I have tried telnet from EC2 and from my dev machine.

I have mapped the cluster to an EC2 security group which has all TCP ports open for 0.0.0.0/0.

I can ping the node.

Private message me for specific details.

Thanks!
E-Mad"
Amazon Elasticache	"Re: Can't telnet into node
Hi,

Sorry to hear you are having problems with your node.

Can you pm me your account number and we can take a look for you.

Regards,

Stephen"
Amazon Elasticache	"ElasticCache instances not reachable
Hello,

We are having an issue with our ElasticCache instances. It was working fine for several months until yesterday.
We can't established any connection to them. Using telnet or php.
We have tried to launching another instance but after a while it would also go down. We have tried rebooting them with no success.

Here is what we get when trying to connect with telnet
telnet: Unable to connect to remote host: Connection timed out

Pinging works though.
Our ElasticCache Security Group is open to EC2 connections.

We are having similar issues with our RDS instances : https://forums.aws.amazon.com/thread.jspa?threadID=117733

Those problems are serious, we are hoping that someone from Amazon can have a look at it.

Thank you for your help!"
Amazon Elasticache	"Re: ElasticCache instances not reachable
Hello,

I understand you're having issues connecting to your Elasticache nodes. Could you please post (or private message, if you're concerned about exposing information) the impacted Cache nodes and an example instance ID from which you're trying to connect?

Thanks!"
Amazon Elasticache	"Re: ElasticCache instances not reachable
Thanks, I sent you a private message with the details."
Amazon Elasticache	"Which spymemcached version does the ElastiCacheClusterClient-1.0 based on
ElastiCacheClusterClient of Amazon is based on spymemcached,  which version does it based on?"
Amazon Elasticache	"Re: Which spymemcached version does the ElastiCacheClusterClient-1.0 based on
The license file in the associated GitHub repository appears to indicate that ElastiCacheClusterClient-1.0.0 is derived from spymemcached 2.8.1."
Amazon Elasticache	"PHP Sessions & ElastiCache - Intermittent Performance Problems
Hello,

I'm running a cluster of ElastiCache nodes and in my php.ini  I have set the session handler as memcacheD with the entire list of nodes put in.

Recently, we have noticed that in our PHP scripts, a session_start() can take up to 30 seconds to complete! However, if we run a script that connects to each individual node, then it is really fast.

Has anyone else faced this issue? Any recommended solutions?

Thank you,
Rajat"
Amazon Elasticache	"Re: PHP Sessions & ElastiCache - Intermittent Performance Problems
Yes I am facing a similary issue, I have a Yii setup which takes a long time to resolve elasticache.

I even tried putting both  (elasticache & ec2 instances) in the same data center.

For now I have put a cache deamon on localhost which is lightening fast!!"
Amazon Elasticache	"Re: PHP Sessions & ElastiCache - Intermittent Performance Problems
We have started using DynamoDB for session management. Reasonably cheap and good performance in comparison to ElastiCache."
Amazon Elasticache	"Unable to Connect Using AWS Client to ElastiCashe
I have been trying all afternoon and I must be missing something simple.  I cannot connect to the cache I have setup. I continue to get the following error, even though it resolves the IP address.

2013-02-18 16:23:12.587 INFO net.spy.memcached.MemcachedConnection:  Reconnecting {QA sa=/54.234.40.79:11211, #Rops=0, #Wops=164, #iq=0, topRop=null, topWop=Cmd: config get Types:  clusterExp: 0, toWrite=0, interested=0}
2013-02-18 16:24:15.702 INFO net.spy.memcached.MemcachedConnection:  Connection state changed for sun.nio.ch.SelectionKeyImpl@5df7b6e1
2013-02-18 16:24:15.703 INFO net.spy.memcached.MemcachedConnection:  Reconnecting due to failure to connect to {QA sa=/54.234.40.79:11211, #Rops=0, #Wops=185, #iq=0, topRop=null, topWop=Cmd: config get Types:  clusterExp: 0, toWrite=0, interested=0}
java.net.ConnectException: Connection timed out
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:692)
	at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:573)
	at net.spy.memcached.MemcachedConnection.handleIO(MemcachedConnection.java:337)
	at net.spy.memcached.MemcachedConnection.run(MemcachedConnection.java:1073)
2013-02-18 16:24:15.704 WARN net.spy.memcached.MemcachedConnection:  Closing, and reopening {QA sa=/54.234.40.79:11211, #Rops=0, #Wops=185, #iq=0, topRop=null, topWop=Cmd: config get Types:  clusterExp: 0, toWrite=0, interested=0}, attempt 7."
Amazon Elasticache	"Re: Unable to Connect Using AWS Client to ElastiCashe
Hi,

You need to authorize access to the cache cluster. You do this by granting an EC2 Security Group access to a cache security group. The EC2 Security Group grants access to Amazon EC2 instances, and in turn the cache security group grants access to the Amazon EC2 instances that are authorized for the EC2 Security Group.

Here is the documentation for your reference
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithSecurityGroups.html

Provide us your cache cluster name for further investigation. 

Regards,
Jyothsna.Y"
Amazon Elasticache	"Re: Unable to Connect Using AWS Client to ElastiCashe
Thanks, I deployed and set the security group to my application group and everything is now working. Thanks."
Amazon Elasticache	"Auto Scaling elastic cache
We had the need to use elastic cache, and I needed to scale as demand and I really couldn't find anything online so I slapped together some shell scripts with mysql to do the job and thought I would share with the community.  I had one cluster called Test, and would call these shell scripts as often as I needed to scale.  Use at your own risk....

Database nodes
mysql> desc node;
+----------+--------------+------+-----+---------+----------------+
| Field    | Type         | Null | Key | Default | Extra          |
+----------+--------------+------+-----+---------+----------------+
| id       | mediumint(9) | NO   | PRI | NULL    | auto_increment |
| node     | mediumint(9) | YES  |     | NULL    |                |
| memory   | double       | NO   |     | NULL    |                |
| datetime | datetime     | YES  |     | NULL    |                |
| cluster  | varchar(10)  | NO   |     | NULL    |                |
+----------+--------------+------+-----+---------+----------------+

checkNodesMemTest.sh
#!/bin/bash
DATE=$(date +""%Y%m%d-%T"")
dbHost=127.0.0.1
dbUser=*****
dbPassword=******
result=`mysql -h $dbHost --user=$dbUser --password=$dbPassword ecache --skip-column-names -e ""SELECT ROUND(Sum(memory)) as mySum FROM node where cluster = 'test' and datetime > NOW() - INTERVAL 30 MINUTE""`
items=$(echo $result | tr "" "" ""\n"") 
for item in $items
do
     	if ; then
              echo ""exiting""
	      echo ""$items""
	exit
    fi
        if  $items -ge 200 ; then 
             echo ""$items total memory all systems go""    
        else
    result1=`mysql -h $dbHost --user=$dbUser --password=$dbPassword ecache --skip-column-names -e ""SELECT nodes from cluster where clusterName = 'test'""`
    #echo ""$result1""
    NODE=$(($result1 + 1))
    #echo $NODE
    echo ""$items MB Low memory, adding node 000$NODE"" 
    #ADDNODE=`elasticache-modify-cache-cluster test --apply-immediately --region us-west-1 --num-cache-nodes $NODE`
    #UPDATE=`mysql -h $dbHost --user=$dbUser --password=$dbPassword ecache --skip-column-names -e ""update cluster set nodes = '$NODE' where clusterName = 'test'""`
fi
Done

getNodeStatusTest.sh
#!/bin/bash
CLUSTER=test
#for NODES in $GETNODE; do
for line in `elasticache-describe-cache-clusters $CLUSTER --show-cache-node-info  --region us-west-1 | grep CACHENOD | cut -c 1-23 | tr -d ' ' | tr -d 'CACHENODE' | uniq`
do
    echo $line 

MEMORY=`mon-get-stats UnusedMemory ""--dimensions=CacheClusterId=test,CacheNodeId=$line"" --statistics=Average --namespace=AWS/ElastiCache --period=300 | tail -1 | cut -c 20-36 | tr -d ' '`
echo $MEMORY
MB=`echo $MEMORY | awk '{printf ""%.2f\n"",$1/1048576}'`
echo ""$MB""
checknode=$(mysql -u ***** -p'*****' -s -N <<QUERY_INPUT
use ecache;
insert into node (cluster,node, memory, datetime) VALUES ('$CLUSTER','$line','$MB',now());
QUERY_INPUT
)
Done

RemoveNode.sh 
dbHost=127.0.0.1
dbUser=****
dbPassword=****
CLUSTER=test
result=`mysql -h $dbHost --user=$dbUser --password=$dbPassword ecache --skip-column-names -e ""SELECT ROUND(Sum(memory)) as mySum FROM node where cluster = 'test' and datetime > NOW() - INTERVAL 1 HOUR""`
items=$(echo $result | tr "" "" ""\n"")
if  $items -le 700 ; then 
    echo ""$items MB Memory is at optimal level""    
    else
    result2=`mysql -h $dbHost --user=$dbUser --password=$dbPassword ecache --skip-column-names -e ""select nodes from cluster order by nodes desc limit 1""`
    nodeNum=$(($result2 - 1))
    yanknode=`elasticache-modify-cache-cluster $CLUSTER --region us-west-1 --num-cache-nodes $nodeNum --nodes-to-remove --apply-immediately 000$result2`
    echo `""$items MB MAX memory exceeded, removing node 000$result2""`
fi

Cheers"
Amazon Elasticache	"How do I query for the ElastiCache configuration endpoint?
I am adding ElastiCache to an Elastic Beanstalk application using Elastic Beanstalk Resources.

Elastic beanstalk provides me access to the CacheCluster ID that it creates.  How can I turn this CacheCluster ID into the Configuration Endpoint so that my django application can use memcached?

Thanks"
Amazon Elasticache	"Re: How do I query for the ElastiCache configuration endpoint?
see https://forums.aws.amazon.com/thread.jspa?threadID=117131"
Amazon Elasticache	"Continue to get expiring trial email months later
I gave ElastiCache a trial run for a month before I purchased some instances back late last year. About once a month I get emails telling me my trial is about to expire, trouble is it expired months ago. How can I get these email to stop? The account number in question is 954141151207.

Thanks

Robert"
Amazon Elasticache	"Re: Continue to get expiring trial email months later
Robert, We will look into this. I will contact you on the email we have on file. Thank you."
Amazon Elasticache	"Auto Discovery Client For PHP: general questions
I'm struggling to find pretty basic info about the autodiscovery PHP lib.  All the high level info is out there, but its hard to make an investment in time and $ without knowing some pretty critical details.  In short, I use http://pecl.php.net/package/memcached v 2.1.0 today and want to know if I would need to make code changes if I went with the autodiscovery .so.

Where can I find API docs for the auto discovery client for PHP?   It says it supports the memcached protocol, but I want to know exactly what PHP methods it exposes. Is the source for autodiscovery PHP lib anywhere? I do not see it in github (the java version is though).

Does autodiscovery PHP lib support http://pecl.php.net/package/igbinary? http://pecl.php.net/package/memcached does.

""The client program refreshes its list of cache node hostnames and IP addresses once per minute. This polling interval can be adjusted if necessary."" How do you tune this in the autodiscovery PHP lib?

How do you emulate the autodiscovery PHP .so in development? Since you cant connect to elasticache from outside of ec2... Providing source + api docs OR docs stating that php autodiscovery library version X.Y is functionally equivalent to PECL memcached ver 2.x.x

I know I can add autodiscovery to my library with http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.ConfigCommand.html , however I would prefer to use yours if possible.

Edited by: ryanp_doapps on Jan 10, 2013 12:24 PM"
Amazon Elasticache	"Re: Auto Discovery Client For PHP: general questions
Thanks for your interest in using the PHP auto-discovery client. This client is built on top of PECL memcached v2.1.0 so all features in v2.1.0 including igBinary should be fully supported; this means that there should be no code changes on your side.

The PHP auto-discovery client does not introduce any new API besides new behavior flags to enable/disable auto-discovery via the PHP setOption() method. To know how to use this, please refer to sample code available at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html

Tuning the periodic polling interval is an advanced feature of the PHP auto-discovery client. After enabling dynamic client, you will need to set the interval option for the memcached object. For example, doing the following in PHP will set the interval to 20 seconds:
$memcache_object->setOption(Memcached::OPT_DYNAMIC_POLLING_INTERVAL_SECS, 20) 

In order to make use of the auto-discovery capable PHP memcached extension, you will need to download and install the PHP client artifact and integrate it with your local PHP environment. Please follow the install instructions available at http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Appendix.PHPAutoDiscoverySetup.html. The information provided in our AWS documentation page should get you started in using the PHP client. We are also in the process of releasing the source code for the Amazon ElastiCache Cluster Client for PHP, please check this forum for details when it is released. 

Thanks again for your interest in Amazon ElastiCache Auto Discovery. Please let us know if you have more questions."
Amazon Elasticache	"Re: Auto Discovery Client For PHP: general questions
Thank you for the reply. That helps ease my concerns quite a bit.  I will report back here with my findings on igBinary support with your SO.  I will also eagerly await the release of the source, as having clear communication on interface support as well as communication version updates is a necessity for me to use it in production.

As I was not sure about the inner workings, I went ahead and solved the problem another way. So for those that do not want to use the AWS PECL extension, I have made the following project: https://github.com/rynop/aecad-for-php .  It allows complete abstraction from elasticache and auto-discovery, while giving all the same benefits. It leverages APC which is updated async. via a cron job."
Amazon Elasticache	"Re: Auto Discovery Client For PHP: general questions
igbinary is not linked in with your .so for Ubuntu 12.04 64 bit.  It has to be linked in at configure time:
phpize
./configure --enable-memcached-igbinary
make
make install

Below is the output of your SO and one of the PECL memcached v2.1.0 with '--enable-memcached-igbinary' on the same box in AWS.  I don't see how I can enable igbinary support without the source (need the ability to build the amazon-elasticache-cluster-client.so so I can enable igbinary)

output of php -i with your so:
memcached

memcached support => enabled
Version => 2.1.0
libmemcached version => 1.0.4
Session support => yes
igbinary support => no
json support => no

Directive => Local Value => Master Value
memcached.compression_factor => 1.3 => 1.3
memcached.compression_threshold => 2000 => 2000
memcached.compression_type => fastlz => fastlz
memcached.serializer => php => php
memcached.sess_binary => 0 => 0
memcached.sess_consistent_hash => 0 => 0
memcached.sess_lock_wait => 150000 => 150000
memcached.sess_locking => 1 => 1
memcached.sess_number_of_replicas => 0 => 0
memcached.sess_prefix => memc.sess.key. => memc.sess.key.
memcached.sess_randomize_replica_read => 0 => 0

Output of php -i with memcached built with '--enable-memcached-igbinary':
memcached

memcached support => enabled
Version => 2.1.0
libmemcached version => 1.0.15
Session support => yes
igbinary support => yes
json support => no

Directive => Local Value => Master Value
memcached.compression_factor => 1.3 => 1.3
memcached.compression_threshold => 2000 => 2000
memcached.compression_type => fastlz => fastlz
memcached.serializer => igbinary => igbinary
memcached.sess_binary => 0 => 0
memcached.sess_lock_wait => 150000 => 150000
memcached.sess_locking => 1 => 1
memcached.sess_prefix => memc.sess.key. => memc.sess.key.

Any ideas? Why the hold up on the release of the source? Is your legal department slowing it down?"
Amazon Elasticache	"Re: Auto Discovery Client For PHP: general questions
yes the '.so' needs igbinary support added to it - this is a big limitation.... when will this be added?"
Amazon Elasticache	"elasticache igbinary support
I'm trying to get Memcached::SERIALIZER_IGBINARY to work but currently can only get Memcached::SERIALIZER_PHP to work.

Below is my phpinfo() output for memcached

memcached

memcached support   enabled
Version 2.1.0
libmemcached version    1.0.4
Session support yes
igbinary support    no
json support    no

I'm using an AWS Linux AMI and have memcached/elasticache working successfully.

How can I get igbinary support enabled?

Does this have to happen at memcached installation time? I have memcached already working so is there a way I can add this support in now?

thank you"
Amazon Elasticache	"Memcached::setOption(): invalid serializer provided
I'm getting the error Memcached::setOption(): invalid serializer provided for this line:

$this->memcached->setOption(Memcached::OPT_SERIALIZER, Memcached::SERIALIZER_IGBINARY);

Is part of this small scripts:

<?php

class elasticache {

	public $memcached;					// Max Expiry 2592000 - 30 Days.

  function __construct() {
    $this->memcached = new Memcached();

		$this->memcached->setOption(Memcached::OPT_COMPRESSION, TRUE);
		$this->memcached->setOption(Memcached::OPT_COMPRESSION_TYPE, Memcached::COMPRESSION_ZLIB);

		$this->memcached->setOption(Memcached::OPT_DISTRIBUTION, Memcached::DISTRIBUTION_CONSISTENT);
		$this->memcached->setOption(Memcached::OPT_LIBKETAMA_COMPATIBLE, TRUE);

		$this->memcached->setOption(Memcached::OPT_SERIALIZER, Memcached::SERIALIZER_IGBINARY);
		$this->memcached->setOption(Memcached::OPT_BINARY_PROTOCOL, TRUE);		

    $this->memcached->setOption(Memcached::OPT_CLIENT_MODE, Memcached::DYNAMIC_CLIENT_MODE);
		$this->memcached->setOption(Memcached::OPT_DYNAMIC_POLLING_INTERVAL_SECS, 60);

    $this->memcached->addServer('blahblahblah.expalp.cfg.apse1.cache.amazonaws.com', 11211);
  }

}

?>

I'm using the default AWS Linux AMI and elasticache is working - only saw this error when I enabled php errors to be seen.

Any advice on why I'm getting this error and what can be done to fix it?

thank you

Edited by: adamaustralia on Feb 14, 2013 1:32 PM

Edited by: adamaustralia on Feb 14, 2013 1:33 PM

Edited by: adamaustralia on Feb 14, 2013 1:33 PM"
Amazon Elasticache	"Auto Discovery Client For PHP 5.4 (Wrong PHP API version)
Had a problem using EC3 (Elasticache Cluster Client) for PHP on both Ubuntu 12.10 and the new Raring nightlies because the packaged version of PHP5 has been upgraded to use the 2010 PHP API.

root@vagrant-ubuntu-raring-64:~# php -v
PHP Warning:  PHP Startup: memcached: Unable to initialize module
Module compiled with module API=20090626
PHP    compiled with module API=20100525
These options need to match
 in Unknown on line 0
PHP 5.4.9-4ubuntu1 (cli) (built: Dec  5 2012 04:23:59)
Copyright (c) 1997-2012 The PHP Group
Zend Engine v2.4.0, Copyright (c) 1998-2012 Zend Technologies


Any chance the source code for EC3 PHP will be released anytime soon so we can roll our own? (Also be good for compiling against igbinary for that support too)

Edited by: strayerror on Feb 13, 2013 6:46 AM"
Amazon Elasticache	"CheckedOperationTimeoutException and don`t reconnect
We have a problem with spymemcached 2.8.1.

Operations start to time out randomly. It  spikes the cpu and we need to restart our app because it never recovers.

We have a stack trace like this:

Caused by: net.spy.memcached.internal.CheckedOperationTimeoutException: Timed out waiting for operation - failing node: xxxxxxx.yyyyy.0001.use1.cache.amazonaws.com/11.11.111.111:11211
at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:65)
at net.spy.memcached.internal.GetFuture.get(GetFuture.java:37)
at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:1135)

Does anybody know how to fix this without using another client ?

Edited by: mikkkk on Jan 8, 2013 6:49 AM"
Amazon Elasticache	"Re: CheckedOperationTimeoutException and don`t reconnect
It does the same thing with the Amazon Elasti Cache Cluster Client. Does anybody have a solution for this ?"
Amazon Elasticache	"Re: CheckedOperationTimeoutException and don`t reconnect
Hello.

Generally, intermittent connection errors like this tend to indicate that a slice has gone bad.

Please replace the node that you referenced as: xxxxxxx.yyyyy.0001.use1.cache.amazonaws.com/11.11.111.111:11211

Once you have spawned a replacement node and changed the endpoints in your client application, please test your cache cluster again.

Please let me know if there is anything else I can help you with.
Brandon"
Amazon Elasticache	"Re: CheckedOperationTimeoutException and don`t reconnect
We are having similar problems.

For us it seems like its mainly coming from 1 EC2 instance. Is it possible some EC2 instances have bad/slower network connectivity? We are using eu-west-1c for the ElastiCache cluster and instances.

Any help would be appreciated,

 Clive"
Amazon Elasticache	"Trouble establishing telnet connection to cache node
I have tried a bunch of different things, nothing has seemed to work. I have already read a few other posts on this forum about people having a similar problem. 

I have an EC2 instance (actually 2) with the security group quick-start-1 (with no additional ports open). I have added quick-start-1 to the default cache security group. I try to telnet, and I try to connect through PHP and nothing has worked.

Please help!

Thank you,
Costas"
Amazon Elasticache	"Re: Trouble establishing telnet connection to cache node
A dozen or so posts down there is a thread about a similar problem. I tried a couple of things recommended in the thread.

I tried adding port 11211 and the security group id (of quick-start-1) as the source to quick-start-1.

And I tried a telnet connection to the cfg endpoint. 

Neither worked. This might sound dumb, but should I open up port 23? I am not completely sure how these security groups work.

-Costa"
Amazon Elasticache	"Re: Trouble establishing telnet connection to cache node
I'm surprised and a little scared that there are zero responses here. The instructions provided by Amazon make it seem very straightforward to setup everything properly to execute the telnet test.

I can ping but I cannot establish a telnet connection.

-Costa"
Amazon Elasticache	"Re: Trouble establishing telnet connection to cache node
Hello Costa.

I have looked into your account and see no resources (elasticache or otherwise) associated with your AWS ID. If you would like us to look into your individual resources could you please provide us the AWS account ID you used to create them?

Generally speaking all that you need to do to access the cache cluster is to add the security group associated with the EC2 instance that you are trying to connect from as a valid source into the cache security group of your cache cluster. Opening port 11211 isn't necessary as any traffic from an authorized EC2 instance should be allowed into the cache cluster if you have configured the security groups correctly. 

Some steps for you to try:

Look at your existing EC2 Security Groups, that are already assigned to the servers > Copy name > Created a Cache Security Group > Paste Security Group Name, my account ID Save/Assign.

As you are able to ping but not telnet, could you post the IP address that you are pinging and confirm that the IP is internal (10.x.x.x) and not external.

Please provide the requested information and perform the above steps and I'll be happy to continue to provide support.

Brandon"
Amazon Elasticache	"Re: Trouble establishing telnet connection to cache node
The machine I was pinging and attempting to telnet from is in a different aws account than the one I created the cache node in. I had no idea. Everything is working as expected now.

-Costa

Edited by: mrfreeskier on Feb 6, 2013 8:08 PM"
Amazon Elasticache	"Re: Trouble establishing telnet connection to cache node
Hello,

I'm glad you've managed to sort things out. Let me know if you need anything else.

Richard"
Amazon Elasticache	"Touch is not supported for ASCII protocol
Hello,

I am using the AmazonElastiCacheClusterClient-1.0.jar to connect to my cluster.  However when I call the touch method touch(""MyKey"", 120); I get the following error:

""Touch is not supported for ASCII protocol""

Is there something I am doing wrong in this process?

Thanks

Jason"
Amazon Elasticache	"ElastiCache Swap Usage
Why are ElastiCache nodes at some points reporting to be using swap space?

The node in question is showing to have more than 150MB of unused memory as well as approx 100MB freeable memory.

Shouldn't ElastiCache automatically evict the oldest items instead of using any swap space?

One other thing we noticed is that CloudWatch from time to time is reporting that ElastiCache nodes are reporting insufficient data on their CPU load:


State Change:               OK -> INSUFFICIENT_DATA
Reason for State Change:    Insufficient Data: 3 datapoints were unknown.
Timestamp:                  Monday 12 November, 2012 12:13:05 UTC


The node in question is located in EU-West and has an average CPU load of <= 5%.

How come that CloudWatch is frequently (sometimes daily) reporting to have insufficient data?

Thanks
Marcel"
Amazon Elasticache	"Re: ElastiCache Swap Usage
Does anyone know the answer to this. Suddenly afteer about 4 months of usage our Elaticache has started showing that it is swapping why?

And more importantly is it something we should be worried about and should we be rescalling the cache?"
Amazon Elasticache	"Re: ElastiCache Swap Usage
hi,

if you give me the Elasticache node I can investigate further on this.
PM me if you don't want it made public."
Amazon Elasticache	"Feature request: add a memcached proxy
It's very cool to see that AWS is working on a caching service!

ElastiCache isn't transparently elastic.  I can add and remove nodes from a cluster, but this is not transparent to my application.  I'll still need to add and remove nodes from my application's configuration files as the nodes within an ElastiCache cluster change (and this, ironically, requires me to clear a key in memcached).

I think a huge added benefit would be to allow consumers of ElastiCache to just use a proxy URL that will handle key hashing and and adding and removing nodes from a cluster, similar to how  moxi proxy works.  It would add a small amount of latency to each request, but most people don't seem to notice when using moxi proxy.

Using a proxy, my app would only need to know one URL (e.g. cluster-name.proxy.x).  I'm sure you could come up with a cost effective way to implement this (multiple customer proxies/server and possibly leverage ELB code), and it would make a huge case for ElastiCache adoption.

-Michael"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1
Exactly what I would expect from an ElastiCache service."
Amazon Elasticache	"Re: Feature request: add a memcached proxy
Thanks for your feedback. We will note your interest in this functionality for our future roadmap planing.

-Pavan"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1 this would be enormous and simply things greatly from a middle-ware perspective."
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1, please add this capability to your ElastiCache service."
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1, this would be perfect."
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1 

I would so very much love this!"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1 for this 

(eagerly awaiting ElastiCache in eu-west!)"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1 This is the only thing keeping us from adding an elasticache cluster to our mix"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1, please add this feature."
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1 This would be great to have. Is there any recommendations for doing this with an EC2 instance?"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
It won't be easy. You could use a memcache proxy like Moxi and install it on each of the front end boxes that you wish to talk to memcached. The boxes simply point to localhost 127.0.0.1 and Moxi does the rest. Of course, you have to configure Moxi to know where the different memcached servers are. This will be the tricky part. Moxi has a management channel but determining when boxes come in or go out of service then updating all Moxi's will be tough. I'd imagine a combination of cloud metrics with SNS might do the trick."
Amazon Elasticache	"Re: Feature request: add a memcached proxy
merrix143243 wrote:
Moxi has a management channel but determining when boxes come in or go out of service then updating all Moxi's will be tough. I'd imagine a combination of cloud metrics with SNS might do the trick.

I've been working with couchbase on determining the right configuration for moxi to poll a static json config via HTTP here in the membase forums: http://couchbase.org/forums/thread/moxi-s3-elasticache

This would allow dynamic reconfiguration of a local moxi server without having to bake-your-own config system with SNS, etc. I think it's close, but still waiting to hear back from couchbase.

Tony"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
badass - will follow"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
an update would be appreciated"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
Any luck on getting moxi proxy to work with elasticache?  Even with a static config file?  I haven't tried it yet, but it sounds like it isn't working??"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
We haven't had any luck doing this manually - was hoping that AWS was working on something..."
Amazon Elasticache	"Re: Feature request: add a memcached proxy
Thank you all for your suggestions on this thread. We really appreciate your feedback and use it to help us prioritize service improvements that benefit our customers most. 

I would love to speak with you directly about your requirements. If you're open to this, please PM me.

Rahul"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
Checkout twemproxy by twitter guys

https://github.com/twitter/twemproxy"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1  Any update on this?"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
+1"
Amazon Elasticache	"Re: Feature request: add a memcached proxy
Please take a look at ElastiCache Auto Discovery which we launched last year: 

http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.html

Auto Discovery solves the issue of a single cluster name without incurring the latency and throughput overheads of a proxy. 

Let us know about your experience.

Thanks"
Amazon Elasticache	"PHP Memcached Set returns Code: 47 Message: SERVER HAS FAILED AND IS DISABL
Code: 47 Message: SERVER HAS FAILED AND IS DISABLED UNTIL TIMED RETRY

I think I'm building my connection right.  I try a couple gets - these return null and result message NOT FOUND.  So far so good.  Then I try to put something in the cache and I get the above result.

My code to build the connection is

            $mcache = new Memcached($dynamoCacheId);
            //echo '<h1>'.$cluster->CacheClusterId.'</h1>';
            $servers = $mcache->getServerList();
            if(empty($servers))
            {
                $mcache->setOption(Memcached::OPT_DISTRIBUTION,Memcached::DISTRIBUTION_CONSISTENT);
                $mcache->setOption(Memcached::OPT_LIBKETAMA_COMPATIBLE,true);
                $cache = $aws->get('v1.elasticache');
                $opts = array('ShowCacheNodeInfo' => true, 'CacheClusterId' => $dynamoCacheId);
                $items = $cache->describe_cache_clusters($opts);
                $clusters = $items->body->DescribeCacheClustersResult->CacheClusters->CacheCluster;
                $available = array();
                foreach($clusters as $i => $cluster)
                {
                    if($i == 0)
                    {
                        foreach($clusters->CacheNodes as $j => $node)
                        {
                            $endpoint = $node->CacheNode->Endpoint;
                            $address = $endpoint->Address;
                            $port = intval($endpoint->Port);
                            $available[] = array($address,$port,0);
                        }
                    }
                }

                $mcache->addServers($available);"
Amazon Elasticache	"Unable to connect to cache instances - despite open security settings
More info - I have created an EC2 security group that allows connections from anywhere on any port using any protocol and added it to the cache cluster security group.  

I have attempted to telnet to the one node in the cache cluster on the designated port.  The connection always fails.  So I'm stuck.  How is this supposed to work?"
Amazon Elasticache	"Re: Unable to connect to cache instances - despite open security settings
Apparently memcached is the only amazon service that cannot be accessed outside the datacenter.  To develop for it one must run their own memcached locally."
Amazon Elasticache	"Autodiscovery Issue Of Clusters
cluster-1 has two nodes, cluster-2 has only one node. 
If I use cluster-1, two nodes of the cluster-1 are used. The code I use is:
MemcachedClient client = new MemcachedClient(new InetSocketAddress(""cluster-1.fnjyzo.cfg.use1.cache.amazonaws.com"",11211));


If there are 2 clusters, the auto discovery didn’t work , only one node of the cluster-1 is used. The code I use is:
List<InetSocketAddress> addrs = new ArrayList<InetSocketAddress>();
addrs.add(new InetSocketAddress(""cluster-1.fnjyzo.cfg.use1.cache.amazonaws.com"",11211));
addrs.add(new InetSocketAddress(""cluster-2.fnjyzo.cfg.use1.cache.amazonaws.com"",11211));
MemcachedClient client = new MemcachedClient(addrs);


if i use 2 clients, the autodiscovery didn't work too. The code:
List<MemcachedClient> awsClusterList = new ArrayList<MemcachedClient>();
MemcachedClient cluster1 = new MemcachedClient(new InetSocketAddress(""cluster-1.fnjyzo.cfg.use1.cache.amazonaws.com"",11211));
MemcachedClient cluster2 = new MemcachedClient(new InetSocketAddress(""cluster-2.fnjyzo.cfg.use1.cache.amazonaws.com"",11211));
awsClusterList.add(cluster1 );
awsClusterList.add(cluster2 );

for(int i =0; i < 1000, i++){
      awsClusterList.set(key,exp,value);
.......

}"
Amazon Elasticache	"ElastiCache for PHP session management
Hello,

I'm attempting to use Amazon ElastiCache to handle PHP sessions. Is there a way to configure PHP sessions on EC2 instances to use ElastiCache without significant performance degradation?

(I run a load balanced environment and sessions must be centralized in one location. I can use a database as well, but that's a different topic...)

In order to test this out I set up a Cache Cluster (cache.m1.small) with a single node in the same availability zone as my EC2 instance. (us-east-1b).

I verified that I can connect from my EC2 instance by telneting to my cache. 
telnet mycache.o3sylr.0001.use1.cache.amazonaws.com

So all is well in terms of security and access.

However, when I configure PHP to use this memcached instance as the session storage my website becomes excruciatingly slow. The /etc/php.ini setup is as follows.

session.save_handler = memcached
session.save_path = ""mycache.o3sylr.0001.use1.cache.amazonaws.com:11211""

If i switch back to file storage all is well. 

Any ideas?

Edited by: msblend on Jun 8, 2012 4:10 PM

Edited by: msblend on Jun 8, 2012 4:10 PM"
Amazon Elasticache	"Re: ElastiCache for PHP session management
Could this be an issue with DNS?

Is there a way to access ElastiCache with an internal IP to reduce lookup and routing times?"
Amazon Elasticache	"Re: ElastiCache for PHP session management
Ok, I verified that it is a DNS issue. When I change...

session.save_path = ""mycache.o3sylr.0001.use1.cache.amazonaws.com:11211""

to...

session.save_path = ""10.211.3.181:11211""

The session handling is lightning fast. However, I don't believe Amazon recommend accessing their servers with an IP. We are supposed to use the DNS name of the end point.

So, my question has transformed into...

What do I need to do to make sure ElistiCache can be accessed using the proper DNS name without degrading performance?"
Amazon Elasticache	"Re: ElastiCache for PHP session management
Update

The issue seems to have been resolved on its own. It appears that the DNS records needed some time to propagate across the entire architecture. Seems to be working fine at this point."
Amazon Elasticache	"Re: ElastiCache for PHP session management
How are you handling memcached backed sessions when a node fails? There is a PHP autodiscovery lib from aws now, but that wont work with a list of servers in the .ini.

Also how do you handle maintenance window (when your servers are down)?"
Amazon Elasticache	"Re: ElastiCache for PHP session management
Hey,

I'm working on the points you have listed above.

I've added the elasticache configuration endpoint to php.ini path and that seems to work - I just not sure if that means its using one node only or which ever is live (eg: auto discovery factor).

Also did you find a solution for the maintenance window?

thx
Adam

Edited by: adamaustralia on Jan 20, 2013 1:18 AM

Edited by: adamaustralia on Jan 20, 2013 1:18 AM"
Amazon Elasticache	"Cache node recovery Jan 10 2013 EU-West
On Thu Jan 10 22:50:29 GMT+100 2013 several of our cache nodes in EU-West started to show the following events (example of one node):

Thu Jan 10 22:50:29 GMT+100 2013 Recovering cache nodes 0001
Thu Jan 10 22:53:37 GMT+100 2013 Finished recovery for cache nodes 0001

After which an SNS-Notifcation was sent:

ElastiCache:CacheNodeReplaceComplete : our-cache-name-here

Since there is nothing reported on the AWS status page and there was no maintenance scheduled for these nodes, I assume they died due to a fault in the underlying hardware or AWS infrastructure.

Can we please get a feedback on why those nodes got replaced or what was causing the error? I can provide node-ID's in a PM.

Please also let us know how the uptime of a ElastiCache node can be measured? We didn't find such CloudWatch metric.

Thanks & Regards
Marcel"
Amazon Elasticache	"Can I update a value in Elasticache using the REST api?
I want to increment a running tally stored in ElastiCache.  It would appear that my only option to accomplish this in my mule/java environment is to use the ElastiCache Cluster Client, though I believe it does not provide all the capabilities I need.  I was wondering if the REST api supports updates as well as queries, but I can't seem to find the appropriate documentation on the subject.

Does the ElastiCache REST API also support HTTP PUT's or just GET's?  Is there another option I should explore?

Edited by: sporcina on Jan 9, 2013 11:03 PM"
Amazon Elasticache	"can't telnet to cache cluster
So not sure but for some reason I can't seem to connect to my cache cluster from one of my ec2 instances.
ec2 security grp = default = TCP: 0 - 65535  , sg-2fd40847 (default)
cache security grp = default => to ec2 default, authorized
cluster security group = default 

telnet

ssh kh-test.9vpp9v.cfg.use1.cache.amazonaws.com:11211 
ssh: Could not resolve hostname kh-test.9vpp9v.cfg.use1.cache.amazonaws.com:11211: Name or service not known

what am I doing wrong. When I looked at the FAQ on security groups, it is so vague and subjective."
Amazon Elasticache	"Re: can't telnet to cache cluster
What happens if you run ""telnet kh-test.9vpp9v.cfg.use1.cache.amazonaws.com 11211""?"
Amazon Elasticache	"Re: can't telnet to cache cluster
telnet kh-test.9vpp9v.cfg.use1.cache.amazonaws.com 11211
Trying 10.116.69.211...

its stuck at that position and eventually times out...

Edited by: Yankees Rule on Jan 4, 2013 11:49 AM"
Amazon Elasticache	"Re: can't telnet to cache cluster
All you need is an entry in the cache security group with the AWS account and EC2 security group where your instance is running. Based on your description, it sounds like you have that in place already. Screenshots showing both security groups might be helpful, or you can simply wait for an AWS representative to stop by as they can access your configuration details."
Amazon Elasticache	"Re: can't telnet to cache cluster
thx for the prompt response. Thats what I have, attached images. I am sure i am missing a simple config somewhere...

also, do you happen to know whats the 'sg-xxx' in the source of the 'default' security group...

Edited by: Yankees Rule on Jan 4, 2013 12:13 PM"
Amazon Elasticache	"Re: can't telnet to cache cluster
That is a reference to the same ""default"" security group. It essentially means that EC2 instances sharing that security group will be allowed to talk to each other. Based on these screenshots, things look just fine. It would however be interesting to see which EC2 security group id is being used by ElastiCache. Can you perhaps figure out if that matches ""sg-2fd40847""? I'm not sure if you will be able to see that in the cache security group right now, but it should at least be visible in the dropdown if you remove the current entry. Or do you have other instances running who are actually able to talk to ElastiCache?

Edited by: D. Svanlund on Jan 4, 2013 9:24 PM"
Amazon Elasticache	"Re: can't telnet to cache cluster
I resolved the issue. I think its my understanding of the security groups to begin with. 
so my ec2 instance had a custom security group, that group didn't have any policy for port 11211. so i added 11211 with the security group id itself, so any instances that share the sec-group can communicate. in other words, instead of using typical IP addresses or ranges, I used the group id itself
i updated the cache cluster to use that same ec2 group and now i can communicate between two instances..and its blazingly fast.

sorry if that was sorta dumb, but didn't know that u could use group ID as policy

Edited by: Yankees Rule on Jan 4, 2013 12:36 PM"
Amazon Elasticache	"Re: can't telnet to cache cluster
yes you're right, 'D. Svanlund'. My cluster instance wasn't using the same security group as the one used by my ec2 instance. the docs don't really dwell into custom security groups how-to's but thats fine.

thanks for your help"
Amazon Elasticache	"60 day ElasticCache Trial available for micro instances?
Hi there,

The 60-day trial for Amazon ElasticCache is said to be available for a small instance. I guess this offer pre-dates the announcement of micro cache instances. Thus, I'm in doubt: does the micro, which is a cheaper instance, also comes with a free trial? If not, can I still be eligible for a small instance trial given that I already launched a micro instance?

Thanks.,"
Amazon Elasticache	"Re: 60 day ElasticCache Trial available for micro instances?
Hello,

Unfortunately the ElastiCache Free Trial Program does not currently cover our Micro Cache Nodes, but based on your account history, I see that you are eligible for the 60-day free trial for our Small Cache Nodes:

http://aws.amazon.com/elasticache/free-trial/faqs/

For information on pricing for your Micro Cache Node Type, I recommend reviewing the following page:

http://aws.amazon.com/elasticache/pricing/

Don't hesitate to follow up with us if you have any other questions or concerns.

-Liz"
Amazon Elasticache	"Can I share a single cluster between different applications?
Sorry for the stupid question: if I have several websites, for example Wordpress blogs with Total Cache plugin, can I use a single Elasticache cluster without any risk of conflicts?
Is there any risk of key duplication, for example if 2 sites run the same query (but on different databases)?

Thanks,

Luigi"
Amazon Elasticache	"Re: Can I share a single cluster between different applications?
Hello ggclemente -

Thank you for your post.
We will get back to you regarding you question.

Regards,
Imtiaz"
Amazon Elasticache	"Re: Can I share a single cluster between different applications?
Hello, 

You will need to ensure that you have unique key names for each set of values (e.g. for each site you're using).

A common way to do this is to use a namespace for your keys. The cache client you're using may have support for this. Otherwise, you can simply combine your key with a unique prefix for each site."
Amazon Elasticache	"Asia Pacific (Sydney) - when?
Hey guys,

Happy new year to you all.

Sadly, ElastiCache is not available in Asia Pacific (Sydney). What are the plans here?

Cheers,
Piotr"
Amazon Elasticache	"Re: Asia Pacific (Sydney) - when?
Hi
Thanks for contacting AWS Forums.
Unfortunately we do not have a timeline as yet that we can give you for when elasticache will be available in (Sydney).
Please continue follow the blogs on aws.typepad.com for any updates on future product releases."
Amazon Elasticache	"Re: Asia Pacific (Sydney) - when?
Hi
I was informed by a member of the Elasticache/RDS service team that we intended to have Sydney Support for Elasticache within a 2-3 month time frame.
I hope this helps out."
Amazon Elasticache	"delete
delete

Edited by: dplatform on Dec 27, 2012 9:52 PM"
Amazon Elasticache	"VPC & Elastic Cache: Nogo? Or misconfiguration.
I have followed the instructions for creating a cache cluster inside an Existing VPC, and, oddly enough, my webserver cannot seem to connect to the cache.

The documentation I used for this procedure:
http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/WorkingWithVPC.html

Here's what I have in my setup:


VPC, with 1 public subnet, and 2 private subnets.
On the public subnet, I run a pair of hosts with webservers on them.
Both VPC webservers use the same vpc security group, vpc-www
I have created the Elastic Cache subnet, per the documentaiton. I have called it vpc-elasticache

during creation of the subnet, I clicked 'add all the subnets'. 


I clicked Launch Cache Cluster

I filled out the obvious inputs, and, in the Cache Subnet Group, I chose my VPC, 'vpc-elasticache'
I also chose the same AZ that my webservers run in, in this case, east-1d
On the next screen, I selected the security group of my webserver, 'www'




I waited a few minutes as the cache cluster was launched. Then, from my www server, I created a quickee php script to connect to the cache server. The script was run, and, it fails to connect to the cache server. 

I have verified the following:

on the 'My Cache Clusters' screen, the Cache Subnet Group value is set to vpc-elasticache
on the 'My Cache Clusters' screen, the VPC Security Group(s): value is set to vpc-www, which is the sg used by my webservers.


NOTE: Unsure of which 'endpoint' to use in my PHP memcache connect function, I have tried both:
Configuration Endpoint: vpc-ecache-cluster-1.9aofpq.cfg.use1.cache.amazonaws.com
and vpc-ecache-cluster-1.9aofpq.0001.use1.cache.amazonaws.com
Although my instinct tells me that I should be using the 1st hostname, listed above. But alas, I really don't know which one to use. The documentation lacks direction on this.

Ambiguous Statements in the Prerequisites section of the documentation: 
""A cache subnet group must be defined for your VPC"" ( Was this not done already, in previous step? Or, Is this step done within the VPC Admin UI, and simply not documented? )

I must be missing something obvious here. What's wrong with my setup? More details, I suppose, can be provided if requested."
Amazon Elasticache	"Re: VPC & Elastic Cache: Nogo? Or misconfiguration.
NEVERMIND.

I bollocks-ed up the configuration! I thought so. I misunderstood the security-group assignment part. I re-cycled another sg I was using for my home-spun memcache server, which allowed ingress on port 11211 from vpc-www, and now it connects perfectly. 

My misunderstanding, completely.

VPC + Elastic Cache works perfectly. Thanks Amazon."
Amazon Elasticache	"Re: VPC & Elastic Cache: Nogo? Or misconfiguration.
Thanks for the update and glad that it works properly."
Amazon Elasticache	"How I can access ElastiCache from my VPC?
Hi,
I have one VPC, and in this VPC I have 2 Ec2.
I want access an ElastiCache instance of these EC2s on VPC!
Have any way? How I can access ElastiCache from my VPC?
Thanks"
Amazon Elasticache	"Re: How I can access ElastiCache from my VPC?
As far as I understand, this is not currently supported. ElastiCache is not yet available inside VPC and the current security group functionality makes it impossible to grant access from VPC.

Edited by: D. Svanlund on Sep 19, 2012 6:34 PM"
Amazon Elasticache	"Re: How I can access ElastiCache from my VPC?
Hello,

Unfortunately at this time ElastiCache is not supported from with-in a VPC.

ElastiCache Clusters are only accessible from EC2 Instances running in an EC2 security group, see: http://aws.amazon.com/elasticache/faqs/ for details. 

Due to the differences between EC2 security groups and VPC security groups, it is currently not possible to access an ElastiCache Cluster from within VPC. See http://docs.amazonwebservices.com/AmazonVPC/latest/UserGuide/index.html?VPC_SecurityGroups.html#VPC_Security_Group_Differences for the differences between EC2 security groups and VPC security groups. 

Regards,
David S."
Amazon Elasticache	"Re: How I can access ElastiCache from my VPC?
Please see  ElastiCache VPC Documentation  for details on how to access ElastiCache Clusters from your applications within VPC."
Amazon Elasticache	"Can't create ElastiCache cluster in Ireland region
Hi,

I've tried to create a micro ElastiCache cluster in Ireland 4 times today and the web console seems to be crashing.
Using Firebug I have seen an http request with api/failure on it several times.

I have no problems creating clusters in US regions.

Anyone else experiencing problems with ElastiCache?

Edited by: awmdb on Dec 21, 2012 8:09 AM"
Amazon Elasticache	"Re: Can't create ElastiCache cluster in Ireland region
Hello awmdb.

I'm sorry for the inconvenience you are experiencing today.

If you are still running into this issue please send us the full http response or a screenshot of the console so we can have a better idea of the cause of your issue.

Thanks.
Brandon"
Amazon Elasticache	"Benefits of elasticache
Hello,

I want to use elasticache for my Drupal based web site but I don't know anything about elasticache so that sorry for dumb question.
I know that if I decide to use memcached,  I have to add specific code to my web application to use memcached. 
What if I use elasticache.
If I add elasticache blocks in front of RDS mysql instance without adding any code to my web application, would I get any performance increase or should I add memcached like code?

Kind regards."
Amazon Elasticache	"Re: Benefits of elasticache
In short, ElastiCache will work in just about the same way. You can use existing memcached clients/libraries with ElastiCache as well. From the perspective of your  application, it looks like a normal memcached setup. AWS recently added Auto Discovery which requires a custom client to function, but in general these two options are pretty much equivalent."
Amazon Elasticache	"""subscription is being processed""
I've been trying to enable ElastiCache on my account for at least a week now.  I get the following message when I go to the ElastiCache page in my AWS Console:


Thank you for signing up for Amazon ElastiCache. Your subscription is being processed.

We will send you an email when you can begin using this service. For most customers this takes only a few minutes, but if additional account verification is required, then processing can take several hours.

Until your subscription is ready, you can learn more about the AWS Management Console.


It has said this for at least a week, probably more.  I have not received any emails about beginning service.  What do I need to do to get this started?"
Amazon Elasticache	"Re: ""subscription is being processed""
Hello,

I've taken a look and you should be good to go.
If you have further issues, please utilize this page to contact the billing team:

https://aws.amazon.com/contact-us/

Best regards,

Mike V"
Amazon Elasticache	"A unspeified field in ElastiCache AutoDiscovery response
I read a document from Link: http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/AutoDiscovery.ConfigCommand.html, It said the response of ""CONFIG GET CLUSTER"" command looks like:
configversion\r\n
hostname|ip-address|port hostname|ip-address|port hostname|ip-address|port\r\n


But in my experiment, the configuration node replies:
CONFIG cluster 0 156\r\n
3\n
gal-ca-dcvalfb1rmvv.daugkv.0001.use1.cache.amazonaws.com|10.28.127.133|11211 gal-ca-dcvalfb1rmvv.daugkv.0002.use1.cache.amazonaws.com|10.28.150.149|11211\n
\r\n
END\r\n


May I know what's the ""3\n"" stands for? Thank you.

Edited by: diggecn on Dec 18, 2012 5:46 PM"
Amazon Elasticache	"Performance - when to launch more ElastiCache intances?
Hello together,

I'm wondering what experience people have wrt. performance. We're very satisfied with Elasticache--that's not why I'm writing. I'm writing to get some input on how much such a cache.m1.large 7.5 GB instance can be hammered before a cluster have to be put in place.

We're averaging 30 million bytes read per second - with peaks up to 40 million bytes. It still performs well - with 10 other instances reading from it.

Anyone care to share their experiences with the load that elasticache can handle?"
Amazon Elasticache	"Re: Performance - when to launch more ElastiCache intances?
I think the more important reason to choose a cluster of >4 nodes compared to a single (potent) node   is reliability. ElastiCache nodes can fail like any EC2 Instance can. So if you have a single cache, you have a single point of failure, if you have more of then, you have obviously more points of failure but the impact of one failing will be eased out by the others still remaining available.

But, as a note, I'm now using ElastiCache for almost 2 years in production, currently with 12 nodes, and I just had once 1 single instance in a 4 node cluster failing and automatically being replaced. This is Great stuff! \o/"
Amazon Elasticache	"Benchmarking Elasticache
I am going to benchmark elasticache on a m2.4xlarge instance. 

What's the best tools to use to find out bulk write throughput, latency, write throughput vs concurrency etc..

If you already know of some benchmarking results of Elasticache, please refer them

Thanks"
Amazon Elasticache	"Re: Benchmarking Elasticache
You can try memslap: http://erikwebb.net/blog/benchmarking-memcached-memslap

It's a rather easy to use tool that should give you a good indication as to what the server can handle."
Amazon Elasticache	"Re: Benchmarking Elasticache
I am interested in results of the benchmark. If there are any plans of publishing them on the web, please let me know when they are out.

Thanks
Abinesh"
Amazon Elasticache	"Issue: can't create Cache Cluster
Hi.

I created a Cache Cluster, but the cluster is provisioned for an hour. and it's in ""creating"" so I can't reboot or delete or do any action there.
I tried to create one more cluster but the same thing has happened..

Could you help me?

Makoto

Edited by: makoto_siraisi on Nov 19, 2012 7:21 PM"
Amazon Elasticache	"Re: Issue: can't create Cache Cluster
suddenly the two clusters I created got available at the same time.
One took 2 hours and the another did 40 minutes. What is happening here?

When I waited for this I also checked the ElastiCache Status( http://status.aws.amazon.com/ ) but it was marked green.

Now the clusters are available so I'm gonna using it but if this happens again, it's inconvenient for me..."
Amazon Elasticache	"New version of ElastiCache Command Line Interface
Dear Amazon Web Services Customer,

A new version of the ElastiCache Command Line Interface is now available. It can be downloaded from here.

This version has reliability and security improvements. Please update your tools and systems to use the new version.

Sincerely,

The Amazon ElastiCache Team"
Amazon Elasticache	"Re: New version of ElastiCache Command Line Interface
Hello,

I downloaded the last API and I got an exception:
Exception in thread ""main"" java.lang.NoClassDefFoundError: com/amazon/webservices/Cli
Caused by: java.lang.ClassNotFoundException: com.amazon.webservices.Cli
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: com.amazon.webservices.Cli.  Program will exit.

My environment variables (AWS_ELASTICACHE_HOME, JAVA_HOME and PATH) are OK. Any suggestion?
Regards"
Amazon Elasticache	"How to add a Reserved Cache Node to a Cluster?
I have an existing Cache Cluster and I have a just purchased a Reserved Cache Node. 

Is it possible to create a Cache Cluster with Reserved Nodes?"
Amazon Elasticache	"Re: How to add a Reserved Cache Node to a Cluster?
Hello.

I don't think you should experience any problem creating a Cache Cluster with a reserved node. The following URL describes the process of creating a Cache Cluster from the Management Console:

http://aws.amazon.com/elasticache/faqs/#How_do_I_create_a_Cache_Cluster

If you have any issues in this process please feel free to let us know.

Regards,
Brandon"
Amazon Elasticache	"Re: How to add a Reserved Cache Node to a Cluster?
No, I already have a Cache Cluster.

I just purchased a Reserved Node. How to I add/assign the reserved node to my Cache Cluster?"
Amazon Elasticache	"Poor performance compared with memcache on EC2 instance
Hi lads,

I'm a bit (negatively) shocked after comparing the performance we are getting when we use ElastiCache instead of a vanilla Memcached installed on the same EC2 instance that runs the front-end application (php).

Some results copied from xhprof profiles, on a normal page execution of our app:

Using memcached/EC2 locally: 457 MemcachePool::get -> 47.319ms (wall time)
Using ElastiCache: 302 MemcachePool::get -> 390.908ms (wall time)



Wall time, in this scenario, I guess it means ""time that the get call spends waiting for results from the ElastiCache node"".
In both cases the cache was warm. 
In both cases the amount of memory used by the get calls is around 2.5mb.
In both cases the CPU time consumed is similar (around 100ms)


Is this normal at all? We were expecting worse results due to the network connection/transference, but honestly not a 10 times worse scenario.

Any help would be appreciated, otherwise I reckon we would stick to local memcached services on each front-end node, instead of a ""central"" ElastiCache cluster.

Thanks in advance"
Amazon Elasticache	"Re: Poor performance compared with memcache on EC2 instance
I think you are comparing apples to oranges.

Did you run the ElastiCache cluster on the same region and Availiability zone as your current instance? What instance type was the ElastiCache cluster?

Did you try running a regular EC2 instance of the same type as the ElastiCache cluster type running memcache and run your benchmark there?

What type of instance your front-end machine is?

When you run memcache on your local machine you usually access it with the localhost address which basically never leaves the machine, so it is expected to be faster."
Amazon Elasticache	"Re: Poor performance compared with memcache on EC2 instance
Me too I'm finding ElastiCache performance to be much lower than I expected. My web server is a m1.small, my ElastiCache node is a m1.small too.

My average wall time is 220 ms. Usually the database (RDS m1.small) queries run faster.

UPDATE:
I forgot to say that everything runs in the same region and in the same AZ.

Edited by: matteosp on Nov 5, 2012 1:13 AM"
Amazon Elasticache	"Unable to telnet to ElastiCache Node
Hi,

I launched a ElastiCache cluster on the us-west-1b zone and added my security group to it as the default.
I go to an EC2 instance on the same us-west-1b zone and under the same security group.
Opened a command prompt window and typed this…

telnet <ElasticCache Node endpoint> 112111

…I get a “Could not open connection to the host, on port 11211: Connect failed” message.
The Security Group Inbound I am using is configured like this…

ICMP
Port (Service)	Source		
ALL		0.0.0.0/0

TCP
Port (Service)	Source		
0 - 65535	0.0.0.0/0

UDP
Port (Service)	Source		
0 - 65535	0.0.0.0/0 

What am I doing wrong ? Why this does not work ?

Thanks,
Eduardo."
Amazon Elasticache	"Re: Unable to telnet to ElastiCache Node
Hi teixeie123,

If you are still having issues, kindly email us on elasticache-forums@amazon.com.

Thanks"
Amazon Elasticache	"Re: Unable to telnet to ElastiCache Node
I'm having the same problem, I can't telnet the elastic cache node from windows EC2 instance. I created the port in EC2 security group to allow 11211. I also have the same EC2 security group name as the Cache Security group name. 

Why is it so difficult to setup elastic cache? Why can't amazon just provide a straight forward document and a simple solution."
Amazon Elasticache	"Re: Unable to telnet to ElastiCache Node
Hello,

I am facing the same issue.
Node : cl-cache.z6lghr.0001.apse1.cache.amazonaws.com 

Goutham"
Amazon Elasticache	"Re: Unable to telnet to ElastiCache Node
Yes i agree, whats so difficult with the documentation? UNTIL NOW AND ITS NOT FIXED?"
Amazon Elasticache	"Re: Unable to telnet to ElastiCache Node
Please refer the FAQ:
http://aws.amazon.com/elasticache/faqs/#How_do_I_control_access

Q: How do I control access to Amazon ElastiCache?
Amazon ElastiCache allows you to control access to your Cache Clusters through Cache Security Groups. A Cache Security Group acts like a firewall, controlling network access to your Cache Cluster. By default, network access is turned off to your Cache Clusters. If you want your applications to access your Cache Cluster, you must explicitly enable access from hosts in specific EC2 security groups. This process is called ingress.
To allow network access to your Cache Cluster, create a Cache Security Group and link the desired EC2 security groups (which in turn specify the EC2 instances allowed) to it. The Cache Security Group can be associated with your Cache Cluster at the time of creation, or using the ""Modify"" option on the AWS Management Console.
Please note that IP-range based access control is currently not enabled for Cache Clusters. All clients to a Cache Cluster must be within the EC2 network, and authorized via security groups as described above."
Amazon Elasticache	"ElastiCache not connecting via Telnet after adding CIDR to security group.
I have set up a test ElastiCache account as we are going to migrate our caching solution to it.

The ElastiCache comes with a default cache security group which initially blocks everything.

To this default security group, I add My Dev Security Group. This is a security group with:

Source: My CIDR
Ports: ALL
TCP

However with this added into the default security grop for elasticache i still cant telnet into my end point on port 11211.

Am I missing something? Or is there an issue with elasticache and CIDR in security groups.

Thanks!"
Amazon Elasticache	"Re: ElastiCache not connecting via Telnet after adding CIDR to security group.
I see what the problem is, you cannot connect to elasticache outside of EC2.."
Amazon Elasticache	"Re: ElastiCache not connecting via Telnet after adding CIDR to security group.
So how am i suppose to check if its working? I tried to connect from EC2 Instance but not working too, the documentation is a fail."
Amazon Elasticache	"ElastiCache timeout issues
Hello,

I have been looking at the forums regarding this issue and found one similar post, https://forums.aws.amazon.com/thread.jspa?threadID=76871 , although without any solution.

Our system has been stable for some time, but suddenly we see a lot of timeout errors towards the ElastiCache. Anyone seen anything like this, it started occurring quite unexpectedly and we haven't changed our setup. This is a java implementation.

Oct 12 06:42:33 java.lang.RuntimeException: Exception waiting for value
     at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:924)
     at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:941)
     at com.sonyericsson.amazon.elasticache.ElastiCacheServiceImpl.retrieve(ElastiCacheServiceImpl.java:217)
     at com.sonyericsson.amazon.elasticache.ElastiCacheServiceImpl.retrieve(ElastiCacheServiceImpl.java:226)
     at com.sonyericsson.datacollection.core.dao.cache.elasticache.ElastiCacheAvailabilityWrapper.getElement(ElastiCacheAvailabilityWrapper.java:23)
     at com.sonyericsson.datacollection.core.dao.impl.JdbcAvailabilityDaoImpl.selectAvailability(JdbcAvailabilityDaoImpl.java:138)
     at com.sonyericsson.datacollection.core.business.PersistenceManagerImpl.getAvailability(PersistenceManagerImpl.java:555)
     at com.sonyericsson.datacollection.core.common.aop.TimeOutAlarmInterceptor.invoke(TimeOutAlarmInterceptor.java:34)
     at com.sonyericsson.datacollection.core.common.aop.LoggedInterceptor.invoke(LoggedInterceptor.java:75)
     at com.sonyericsson.datacollection.ws.service.impl.v1.ApplicationServiceImpl.isAppAvailable(ApplicationServiceImpl.java:208)
     at com.sonyericsson.datacollection.ws.resources.validation.ValidateInterceptor.invoke(ValidateInterceptor.java:41)
     at com.sonyericsson.datacollection.core.common.aop.LoggedInterceptor.invoke(LoggedInterceptor.java:75)
     at com.sonyericsson.datacollection.ws.resources.v1.apps.ami.CheckAppAvailabilityResource.isAppAvailable(CheckAppAvailabilityResource.java:60)
     at sun.reflect.GeneratedMethodAccessor29.invoke(Unknown Source)
     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
     at java.lang.reflect.Method.invoke(Method.java:597)
     at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
     at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)
     at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
     at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
     at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
     at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
     at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
     at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)
     at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)
     at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)
     at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)
     at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:416)
     at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)
     at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:708)
     at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
     at com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:263)
     at com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:178)
     at com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)
     at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:62)
     at com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:118)
     at com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:113)
     at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
     at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
     at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
     at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
     at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
     at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
     at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
     at java.lang.Thread.run(Thread.java:662)
     aused by: java.util.concurrent.ExecutionException: net.spy.memcached.internal.CheckedOperationTimeoutException: Operation timed out. - failing node:  omitted
     at net.spy.memcached.internal.OperationFuture.get(OperationFuture.java:78)
     at net.spy.memcached.internal.GetFuture.get(GetFuture.java:37)
     at net.spy.memcached.MemcachedClient.get(MemcachedClient.java:919)
     ... 48 more
     aused by: net.spy.memcached.internal.CheckedOperationTimeoutException: Operation timed out. - failing node: omitted
     ... 51 more

These issues are present on both nodes.

We checked ElastiCache cloudwatch metrics, we are using less than 10% of available cache memory and CPU usage is as usual. We are using default memcached timeout which is 2.5s.

Edited by: mikaelf on Oct 29, 2012 7:18 AM"
Amazon Elasticache	"Re: ElastiCache timeout issues
We also encountered connectivity issues connecting to an Elasticache node today. We had to switch to another node that was working ok.

The frustration here is that there is absolutely nothing showing on the AWS Status page at http://status.aws.amazon.com/"
Amazon Elasticache	"Java: how to connect to my CacheCluster's nodes in order to use memcached?
I follow step by step the starting guide provided by amazon.
I create a cache cluster (only 1 node), create an EC2 instance, authorize the EC2 securtity group to the cache, connect to the instance (SSH), connect from the instance to the cache node and, finally, doing my work with memcached command like set, get, incr.. etc.
This approach works.

Now my question is: is it possible to figure out the same issue from an AWS web application developed in Java?
I'm trying to use spymemcached library to do this, but i don't know how to configure the MemcachedClient to do what i explained before.



List<InetSocketAddress> addrs = new ArrayList<InetSocketAddress>();
for(CacheNode node : cluster.getCacheNodes()) {
  Endpoint endpoint = node.getEndpoint();
  addrs.add(new InetSocketAddress(endpoint.getAddress(), endpoint.getPort()));
}
...
memCache = new MemcachedClient(addrs);



I can tell to the MemcachedClient which are the cluster's nodes. But i don't know how to do the same for the EC2 instance in order to create a connection between the instance and the cluster's node (like in the starting guide), so to use the memcached commands.
Maybe my approach could be wrong.

Do you have an idea? Any help will be greatly appreciated.
My aim is to create a cache service for my AWS web application (to provide set, get, incr functions); so i'll accept even other approaches.

Edited by: liborio7 on Oct 15, 2012 8:09 AM"
Amazon Elasticache	"Why only memcached 1.4.5 (released April 2010)?
memcached is currently up to 1.4.15 and it looks like some valuable updates and fixes  between .5 and .15, including significant performance/throughput gains in 1.4.10 as well as binary protocol and UDP fixes scattered throughout them. 

Any chance of this changing? Seems like even if the upgrade process isn't smooth, we'd at least be able to launch new instances with updated versions.

Cheers,
 - Adrian"
Amazon Elasticache	"Re: Why only memcached 1.4.5 (released April 2010)?
Hello,

I have passed on your input to the Elasticache team for evaluation. I will let you know if I hear back.

Regards,

Matt J"
Amazon Elasticache	"Benchmarking Elasticache with memslap
I am benchmarking Elasticache m2.4xlarge instance running in Amazon AWS cloud using memslap.

memslap is run from a m2.4xlarge Amazon EC2 linux instance. Memslap successfully works with concurrency levels 256, 512 but fails when the concurrency level is 1024.

When I run memslap with concurrency = 1024, I get the following error getaddrinfo(): Name or service not known Initialization failed

How do I tune the EC2 instance to get memslap to work with a higher concurrency level (>1024) ?

ulimit output is unlimited and sysctl -p shows 'fs.file-max = 300000'

-Santhosh"
Amazon Elasticache	"receiving an ""unable to connect to remote host"" on ElastiCache
We are seeing this error:

telnet trvlprt-farecach-dev.lujlz8.0001.use1.cache.amazonaws.com 11211
Trying 23.22.165.225...
telnet: connect to address 23.22.165.225: Operation timed out"
Amazon Elasticache	"Re: receiving an ""unable to connect to remote host"" on ElastiCache
Hello,

I see a large amount of rules on the security group for the instance in question.

Can I ask you please try to bring these down as this may be causing your issues.

Thanks in advance.


Cameron"
Amazon Elasticache	"Re: receiving an ""unable to connect to remote host"" on ElastiCache
Hi Cameron,

Thanks for your reply. I only see a couple of rules associated with the security group:

11211	0.0.0.0/0
0 - 65535	0.0.0.0/0

I initially had only the rule for port 11211 and I added the 0-65535 rule about an hour later. Are you seeing rules other than these?

Patrick"
Amazon Elasticache	"ElastiCache Reserved Nodes
Hello all,
I was wondering if anyone could tell me if reserved nodes maintain 
the same endpoint and port throughout the duration of their ownership regardless if they are open or closed.
Thank you"
Amazon Elasticache	"Re: ElastiCache Reserved Nodes
A reservation does not change the way you work with ElastiCache. It is basically just a billing thing. AWS will see that you have a reservation and apply it to the matching node(s). This happens dynamically as you set up and tear down nodes, which means that a reservation isn't really tied to any particular node. If you are already up and running, you can simply purchase reservations matching the existing setup."
Amazon Elasticache	"Elasticache node failure, will the new node contain the data of old node
I read in Elasticache FAQs that on a node's failure Amazon ElastiCache will repair the Cache Node by acquiring new service resources, and will then redirect the Cache Node's existing DNS name to point to the new service resources. Thus, the DNS name for a Cache Node remains constant, but the IP address of a Cache Node can change over time.

Will the new node contain all the data of the old Elasticache node which failed ?

thanks"
Amazon Elasticache	"Re: Elasticache node failure, will the new node contain the data of old node
No it won't, all cached data are gone.
For real-persistence, please use a database (like simpleDB) instead of cache."
Amazon Elasticache	"Cannot stop instance
Hi,

I've been trying to stop an instance but the stop is not responding and is stuck for more than 10minutes, even with the ""Force stop"" option.

Could you please reboot it?
Instance ID is i-93384ef5

Thanks"
Amazon Elasticache	"Re: Cannot stop instance
Hi,

The instance should be in a stopped state now.

You may need to reattach the EBS volumes if you get an error when starting the instance. If so here are the steps:

1. Click the ""Volumes"" link under ""ELASTIC BLOCK STORAGE"" in the EC2 AWS Console.

2. Note down the device name for each attached EBS volume for the instance.

3. Right-click each EBS volume attached to the instance and click ""Detach Volume"". If the volume still shows attached after a couple of minutes, refresh the page then right-click the volume again and click ""Force Detach"".

4. After detaching the volumes reattach them again to the instance using the same device name - right-click each volume and click ""Attach Volume"". (The root EBS volume should be attached as /dev/sda1)."
Amazon Elasticache	"ec2 Instance is slow... how to find the bottleneck?
Hey all,

I recently created an ec2 instance with a very basic setup: Python/Django/Apache/Mod WSGI/MySQL. I now have the site up and running, but it's still slower than my existing site that also uses a similar setup.

What I'm wondering is how I can try to figure out where the bottleneck is?

I don't think it's the instance size. It's a small instance, but I also tried creating a large instance temporarily with the same setup and it wasn't faster.

I also don't think it's a code slowdown. My site works pretty fast on its current server."
Amazon Elasticache	"Re: ec2 Instance is slow... how to find the bottleneck?
To add to this, I've found that turning KeepAlive on in Apache seems to help. However, after the KeepAlive timeout, seems like it goes back to being slow."
Amazon Elasticache	"unable to connect to my cache instance
Hello,

unable to connect to my cache instance. 
Node : cl-cache.z6lghr.0001.apse1.cache.amazonaws.com

root@commonfloor logs# telnet cl-cache.z6lghr.0001.apse1.cache.amazonaws.com 11211
Trying 10.142.251.53...
telnet: connect to address 10.142.251.53: Connection timed out
telnet: Unable to connect to remote host: Connection timed out

Goutham"
Amazon Elasticache	"elasticache connection issues - php
I am using an elasticache cluster on aws. The details are

Engine: Memcached
Cache Engine Version: 1.4.5
On doing telnet to the node , with node ip-port the memcached server is accessible always. But when trying to connect with PHP , sometimes the memcache object is not getting created at all.

The client uses php-pecl-memcache-3.0.5 for connection.

The code being used is as

$cache = memcache_connect(MEMCACHE_HOST, MEMCACHE_PORT);

What happens is at times, the $cache object is not getting created.

Please guide how could i solve the issue. Thanks."
Amazon Elasticache	"Re: elasticache connection issues - php
I had this same problem and  fixed it by making sure my EC2 security group was actually selected. Meaning, after creating my EC cluster, I had to manually ""add"" my EC2 security group and make sure its status was ""authorized"". 

Here is the link to my post on the AWS forum on this topic.

thanks,
tim

Edited by: timothy r. peterson on Sep 12, 2012 1:22 PM"
Amazon Elasticache	"How to use Elastic Cache on Azure
Hi,

I am using Elastic Cache In my code to cache some data. now I ma uploading my code to Windows azure. Will  this cache work on Azure platform? 

Thanks."
Amazon Elasticache	"Re: How to use Elastic Cache on Azure
Assuming your security group settings for your ElastiCache cluster enables your Azure server access, you should be able to use ElastiCache with Azure."
Amazon Elasticache	"Re: How to use Elastic Cache on Azure
Elasticcache can only be accessed from EC2 instances for now:
Q: How do I control access to Amazon ElastiCache?
Amazon ElastiCache allows you to control access to your Cache Clusters through Cache Security Groups. A Cache Security Group acts like a firewall, controlling network access to your Cache Cluster. By default, network access is turned off to your Cache Clusters. If you want your applications to access your Cache Cluster, you must explicitly enable access from hosts in specific EC2 security groups. This process is called ingress.

To allow network access to your Cache Cluster, create a Cache Security Group and link the desired EC2 security groups (which in turn specify the EC2 instances allowed) to it. The Cache Security Group can be associated with your Cache Cluster at the time of creation, or using the ""Modify"" option on the AWS Management Console.

Please note that IP-range based access control is currently not enabled for Cache Clusters. All clients to a Cache Cluster must be within the EC2 network, and authorized via security groups as described above."
Amazon Elasticache	"Performance issues
Hi all,

I have set an ElastiCache instance on in Ireland  - 1a but the response time was slow from my elastic BS instance which was set up in Ireland - 1c. So I moved the ElastiCache Ireland - 1a instance to Ireland - 1c. Still the response time was very high (22 seconds).

Then I installed memcached over  my elastic BS instance which gave me an response time of half a second. 

What I could have been doing wrong?"
Amazon Elasticache	"Exposing end points in CloudFormation
I created elasticache through a cloudformation template. I associated it with a EC2 instance etc.. I have a endpoint URI. dev-el-XXXXX.ABCDE.0001.use1.cache.amazonaws.com(I see that in the AWS console). Now I am able to get the prefix  of the URI(dev-el-XXXXX) in the ""output"" section of the Cloudformation out put section(This is queryable by BOTO). But I do not know how to get the middle part of the URI i.e.: (ABCDE.0001.use1).  

NO other resources output gives that part AFAIK. I am not creating another stack with the cache so I need to query this separately. 
My only choice is to use the tools or the Query API/ Comandline tools. BUt what I wanted was some how to use my existing Boto tools with CF to get the complete URI. I strongly feel this info should be exposable to CF from elasticache for the sake of working with it easily (Was that not the purpose of cloud formation, or atleast one of the main purposes, viz everything under one roof..). 
Am I missing something or a missing feature?

Edited by: itissid1 on Aug 1, 2012 3:11 PM

Edited by: itissid1 on Aug 1, 2012 3:13 PM"
Amazon Elasticache	"Re: Exposing end points in CloudFormation
Ok so I made this script. Since there is very few threads about the REST API, i am posting a snippet of code I made that is causing the errors  https://gist.github.com/7cd4c90cedf94ba83c92 . Maybe some one can chime in.."
Amazon Elasticache	"Elasticache not available in Oregon zone us-west-2c ?
Hi. We have several EC2 instances now running in Oregon zone us-west-2c.

When I try to create a new Elasticache in this region and zone, I always get the error message:

""cache.m1.small is not currently supported in the availability zone us-west-2c. Retry the launch with no availability zone or target: us-west-2b, us-west-2a.""

I have tried all cache sizes. 

I have 2 questions:

1. When will Elasticache be available on Oregon zone us-west-2c?
2. What are our options - do we just wait, or just set-up n another zone and leave EC2 instances in us-west-2c or move all EC2 instances to a supported zone (us-west-2a or us-west-2b)?

Thanks,
Topper"
Amazon Elasticache	"Re: Elasticache not available in Oregon zone us-west-2c ?
Please note that we currently support us-west-2a and us-west-2b availability zones. You may have your ElastiCache cluster in either of these zones. However, if your EC2 instance is in a different availability zone from your cache cluster, you will incur inter-availability-zone charges from EC2. ElastiCache does not charge data transfer fees. For more information, please see: https://aws.amazon.com/elasticache/pricing/"
Amazon Elasticache	"using Elasticache with Magento Enterprise 1.11.2.0
I've looked at the documentations but never found anything mentioning use of elasticache with magento. is it possible to use it with magento? any documentations available for the implementation?"
Amazon Elasticache	"Using Increment on ElastiCache
Hi All,
I was hoping someone could either point out what I'm doing wrong or confirm some ElastiCache functionality for me (bonus points if it's the latter).  I'm planning on using ElastiCache as a central location to count events from a group of servers.  Essentially anytime an event happens, I want to keep a total count of the events in a central location that I can hit up and look at quickly.  Let's say this event happens an average of 1B times per day.  I'm using BeIT Memcached in a .NET app.  The following represents a very basic version of what I'm looking to do:

(let's assume myCache is configured correctly with all available nodes and that I can connect/add/get without issue)


myCache.Add(""CountOfThingsICareAbout"", 1);
myCache.Increment(""CountOfThingsICareAbout"", 5);
Console.WriteLine(myCache.Get(""CountOfThingsICareAbout""));


It would be awesome if this returned 6.

My theory was that I could add an initial value, call increment by N, and have it add without having to use a Get() then Replace().  What I'm running into is a message back from the cache saying that I can't use increment a non-numeric value.
7/18/2012 3:06:51 PM ERROR BeIT.MemCached.ServerPool - Error in Execute<T>: myCache.z5axhd.0001.use1.cache.amazonaws.com
Server returned CLIENT_ERROR cannot increment or decrement non-numeric value                                                                                                                                                                                                    
   at BeIT.MemCached.PooledSocket.ReadResponse()
   at BeIT.MemCached.MemcachedClient.c__DisplayClass10.<incrementDecrement>b__f(PooledSocket socket)
   at BeIT.MemCached.ServerPool.Execute[T](SocketPool pool, T defaultValue, UseSocket`1 use)


I dug through the BeIT stuff and tried passing through the various numeric types in BeIT.MemCached.SerializedType but nothing seemed to work - I'll probably need to use a long or bigger.  The flags argument is going into the memcached command, but I'm not sure it's being used (or understood) by ElastiCache.  If it helps, the command that BeIT is sending out for adding a new entry with a value of 1 would look like this:


add CountOfThingsICareAbout 11 0 8


This isn't really a deal breaker, but I'd rather be able to make a single call and bump up a cache value rather than doing a get/set routine.  So I guess this is a two part question:

Am I doing something wrong when I store the value into the cache?  If not, does ElastiCache store values in a way that increment/decrement doesn't work?

Thanks in advance!

-Chris

If any AWS folks could use the actual cache cluster ID let me know and I can send it in."
Amazon Elasticache	"Availability Zones and Failover Scenarios
I'm setting up Elasticache, and I had a few questions about Availability Zones and Failover Scenarios:

1) There's a preferred Availability Zone in the config, but the nodes (at least from the management console) don't seem to indicate where they are.  The intended use case here then seems to be to use 1 cluster for a Region.  Is that a fair assumption?  Or ar some people running different clusters for each availability zone they're operating in?

2) Given that we don't seem to know what availability zone nodes are located in, will we still be charged for inter-availability-zone traffic as we read & write to our cache?

3) I have a Cluster of 2 Nodes with a preferred availability zone.  Assuming both my nodes are in the preferred zone, and that zone goes offline, will Elasticache automatically set up 2 new nodes in a non-preferred zone?

4) Do nodes sometimes Die?  Or are host failures being handled behind the scenes by swapping DNS names?

The net of all these questions, is that my app will need a fixed amount of caching space available to operate properly.  If an availability zone goes offline, I'm wondering what I need to do to make sure we recover to our minimum cache-size as quickly as possible.

Thanks"
Amazon Elasticache	"Re: Availability Zones and Failover Scenarios
1) There's a preferred Availability Zone in the config, but the nodes (at least from the management console) don't seem to indicate where they are. The intended use case here then seems to be to use 1 cluster for a Region. Is that a fair assumption? Or ar some people running different clusters for each availability zone they're operating in? 2) Given that we don't seem to know what availability zone nodes are located in, will we still be charged for inter-availability-zone traffic as we read & write to our cache?

1.	All nodes in a particular cluster are in the same availability zone which is the zone you specify with the Preferred Zone setting when you create a cluster. You can see which zone an existing cluster is in by clicking on its name in the console and looking at the Preferred Zone setting.
2.	If your EC2 instance is in a different availability zone from your cache cluster, you will incur inter-availability-zone charges from EC2. ElastiCache does not charge data transfer fees. For more information, please see: https://aws.amazon.com/elasticache/pricing/

3) I have a Cluster of 2 Nodes with a preferred availability zone. Assuming both my nodes are in the preferred zone, and that zone goes offline, will Elasticache automatically set up 2 new nodes in a non-preferred zone?

Currently, if a zone goes offline, ElastiCache does not set up new nodes in any non-preferred zones.

4) Do nodes sometimes Die? Or are host failures being handled behind the scenes by swapping DNS names?

Yes, ElastiCache will recover your nodes in many failure scenarios including host failure or memcached failure. 

5) If an availability zone goes offline, I'm wondering what I need to do to make sure we recover to our minimum cache-size as quickly as possible.

You could launch two cache clusters in different availability zones keeping half of the cache fleet in each AZ."
Amazon Elasticache	"Re: Availability Zones and Failover Scenarios
With these answers above in mind.

Why doesn't Amazon just call the ""preferred zone"" the ""assigned zone?""

""Preferred"" leaves open the possibility that AWS statically assigns the zone, or dynamically assigns the zone, or load-balances the zones, or elastically allocates memcache instances across zones, or all of the above.

If ""preferred"" == ""assigned"" - then shouldn't be represented as such?"
Amazon Elasticache	"Is there a way for Elasticache to save http headers
Elasticache, like any good memcache service, saves off http body responses well. Is there a way to configure Elasticache to save off http header information as well? In our services, we save valuable proprietary information in the http header for various requests, which would get lost if it cannot be saved in Elasticache.

If not, is there a means to request this feature to Amazon tech?"
Amazon Elasticache	"Re: Is there a way for Elasticache to save http headers
ElastiCache is basically memcache and its agnostic to what you eventually save in it.

You can implement a way to take all headers and save it as a specific key or dictionary in ElastiCache and when you read the body from ElasticCache you can read the headers as well.

Some servers, such as Nginx has modules written to it to support a functionality similar to what you require. Take a look at this link.

Apache also has some solution such as this one.

You might want to check these solutions out before implementing your own solution.

Be sure to understand your cache invalidation logic so you won't serve stale data."
Amazon Elasticache	"How does elasticache benefit me?
Hi I have been using elasticache for a while. Once you create a cluster the top level adddress for the cluster is not given to you. You need to access the cluster by specifying the node endpoint address. The benefits of elasticache is that nodes can be added/removed on demand. But each time such addition deletions are made I need to modify the code accessing elasticache  with the node endpoint's details.
Like this if i have to manually add/remove each node in the cluster , and also make changes in my code, what is the point of calling elasticache as a cluster? There should be some top level address assigned to the cluster, so whenever i add/remove nodes i do not have to modify my code's memcache server details. Am I missing out something? If yes, pls guide."
Amazon Elasticache	"Re: How does elasticache benefit me?
Bump.

I am also wondering the same thing. Any help on this is appreciated."
Amazon Elasticache	"Re: How does elasticache benefit me?
Amazon's hand is forced here by the way that memcached works.

Keys are distributed to the nodes in a memcached cluster by a consistent hashing algorithm that is based on the connection string used by the client.

There's a good explanation of this process here: http://dev.mysql.com/doc/refman/5.0/en/ha-memcached-using-hashtypes.html

I suppose they could present the service as a single node that is in reality many nodes, with the client accessing a proxy to the nodes.  I don't know if that would break anything, but it would introduce more latency in a system that only exists to speed things up."
Amazon Elasticache	"Re: How does elasticache benefit me?
adamsb6 said it best -- Elasticache runs memcached, which doesn't support a scenario where changes to your cache size do not require a code change.

Shameless self plug: you should check out MemCachier.  We built MemCachier so cache expansions don't require code changes.  We have a lot of other benefits, too.  Shoot me an email if you want to learn more: alex@memcachier.com"
Amazon Elasticache	"Python for ElastiCache
Hi,

Q1 I am looking for a python module for ElatiCache. I assume any client for memcached can be used. Any suggestions?

Q2 I have a memcache cluster. Does the client accept all node entries or works at the cluster level? If it required the node dns entries then I have to update my code any time I update the cluster.

If PHP has a better solution do let me know.

Regards
Amod"
Amazon Elasticache	"Re: Python for ElastiCache
As far as I know, ElastiCache cluster is just a bunch of memcached servers, so you need to give your memcached client the list of all of your servers and have the client do the relevant load balancing (this is not Membase - or as it is now known - Couchbase).

For Python, you have a couple of options:

pylibmc - which is a wrapper around libmemcached - one of the best and fastest memcached clients there is



python-memcached - a native Python client - very basic, but easy to work with, install and use


If I don't need the speed or the binary protocol (I don't remember if ElastiCache supports the binary protocol) I would use the basic python-memcached."
Amazon Elasticache	"Re: Python for ElastiCache
But the problem survies that I need to keep updating my client with list of nodes when I scale up or down.

I tried python-memcached and it is simple."
Amazon Elasticache	"Re: Python for ElastiCache
Unfortunately, with ElastiCache there is no way of auto updating this list of servers.

You can run Couchbase Server (previously Membase) which provides you with a built-in mechanism to understand changes in cluster topology, however, you'll need to manage the servers and pay for them.

Sorry, but that's just how ElastiCache behaves at the moment."
Amazon Elasticache	"Re: Python for ElastiCache
Hi Amod,

I work on MemCachier, a managed memcache that doesn't require client changes when you add or remove capacity.  You never need to worry about instances, either.  You tell us how much memory you want, and we handle the rest.

We aren't officially available in EC2 yet, but if you're interested we could figure out a way to make MemCachier work for you.  Shoot me an email if you want to learn more: alex -at- memcachier .dot. com

Alex

(I realize advertising in a forum is super lame.  I went ahead with it because MemCachier is very relevant to your question.)"
Amazon Elasticache	"Memcache Cluster: How does it manages nodes
Q1 How does the ElastiCache cluster manages the nodes?

Q2 I assume it does not keep all the data on all the servers and it shards? What is the logic it uses to do this? I need to make sure that when I am using different clients everywhere it follows the same logic and avoid misses.

Q3 How does scaling up and down of nodes affect the data. What care we should take here?

Regards
Amod"
Amazon Elasticache	"Re: Memcache Cluster: How does it manages nodes
Bump!

Can someone please provide some insight on this."
Amazon Elasticache	"Re: Memcache Cluster: How does it manages nodes
Hi Amod,

Many of your questions are dependent on the client library that you use to access memcache.  I'll go through each question:

1) Each memcache server doesn't know about each other memcache server.  The client knows about each node and the client decides which keys to put on which server.

2) Yes.  The client uses a hashing algorithm to decide which key should go on which server.  This is client specific.  Some clients do dumb hashing (hash(key) % len(servers)), while others do consistent hashing, a much more advanced algorithm.

If you're using the same client library and your configured server list is in the same order, you'll be guaranteed that keys will be hashed to the same servers.  However, if you're using different client libraries (perhaps on different languages), you won't have any guarantees that keys will be hashed correctly.

3) Again, this is client library specific.  If the client library uses consistent hashing, scaling the cluster up and down won't hurt hit rates that much.  However, if you're using a less sophisticated client library without consistent hashing, adding or removing servers will greatly impact your cache.

I hope this helps.  Thanks, Amod.

Alex

PS: while I'm here, I'll give a shameless self plug to a service I'm working on, MemCachier.  We aren't available yet in EC2, but I'd love to hear if you think you'd be interested in such a service."
Amazon Elasticache	"What do you have to do to telnet to an ElastiCache Node?
We want to move to Elastic Beanstalk, so we'd like to get Memcached off of our web servers. Unfortunately, we're have a heck of a time getting ElastiCache configured and running with our app.

I'm trying to work with the simplest case to test basic connectivity with no success.


Create a security group mycachetest
Open up tcp 11211 for all 0.0.0.0/0
Create a Cache Cluster on us-east-1b with 1 node
copy the endpoint to my clipboard
ssh to an ec2 instance I have on us-east-1b
telnet copied endpoint 11211


Based on other posts, I would have thought I'd have connected, but the telnet session times out. Its clearly using the internal AWS network since the resolved address from dns is 10...*.

What does a fella have to do to get this working?"
Amazon Elasticache	"Re: What do you have to do to telnet to an ElastiCache Node?
You need to make sure your server is allowed access to the cache cluster. The cache security group is different from the regular EC2 security group.

In the Cache Security group you can give access to a security group from EC2, to which that group will have access to the cluster. 

If, for some reason, you still can't use telnet you can connect with a client and issue the ""stats"" command. A simple client like python-memcache (which is native Python) that you can use in the shell can really help out instead of using telnet."
Amazon Elasticache	"ElastiCache account pending
Hi

We want to try out ElastiCache, and signed up on Thursday, but we still see this: ""Thank you for signing up for Amazon ElastiCache. Your subscription is being processed."" Can someone activate the service?

Thanks."
Amazon Elasticache	"Re: ElastiCache account pending
Hi,

I've checked the account from which this thread was posted and see that ElastiCache has not been signed up for by this account.  Normally if AWS customers receive the error you have described we will see the service as 'pending' on our end but that is not the case.

If you are referring to another account I recommend you contact our account and billing customer service team directly for further assistance.  Just be sure the request is sent from the email address of the account in question.

https://aws-portal.amazon.com/gp/aws/html-forms-controller/contactus/aws-account-and-billing

Best Regards, 
Michelle"
Amazon Elasticache	"Re: ElastiCache account pending
Hi

It's for this account (the one with the e-mail I'm posting this message with), but I've sent a message on the page you provided anyway. Thanks.

Regards"
Amazon Elasticache	"My elastic beanstalk app can no longer connect to my memcached cluster
My elastic beanstalk app can no longer connect to my memcached cluster

this was working, seems to be network problem, the security group, the cluster and everything seems fine. My app just can't resolve the hosts. 

Anyone else seeing this?

I have created a new cluster, deployed new app, rebooted both beanstalk servers and elasticache servers. still no luck."
Amazon Elasticache	"Re: My elastic beanstalk app can no longer connect to my memcached cluster
Ok so I created a new elastic beanstalk application, with the saem app deployed and it's all back to working. Something was corrupted in the old environment, probably since the meltdown of ec2 ealrier in the week. Stil don't exactly know why the memcached endpoints were not DNS resolving. 

Anyway it's fixed."
Amazon Elasticache	"ElastiCache dead?
Hi Folks,

Are you having a problem with ElastiCahce? Mine seemed to have stopped responding:

$ telnet rg-live.ttpi8h.0001.use1.cache.amazonaws.com 11211
Trying 10.64.21.75...
telnet: Unable to connect to remote host: No route to host

I'm going to reboot it, hope you can still investigate what may have happened...

Thanks."
Amazon Elasticache	"Re: ElastiCache dead?
Hi,

I am also having the same issue.

I think there is some connectivity issue with Elastic Cache. Its dead.

I also tried to create new Cache Cluster...But for half-hour...its in the ""Creating"" progress status.

The New Elastic Nodes are never getting created.

-Karthik"
Amazon Elasticache	"Re: ElastiCache dead?
Yea, same here - perpetual rebooting...

There is a note on the EC2 Health dashboard about Virgina instance connectivity. Probably related:

We continue to investigate this issue. We can confirm that there is both impact to volumes and instances in a single AZ in US-EAST-1 Region. We are also experiencing increased error rates and latencies on the EC2 APIs in the US-EAST-1 Region."
Amazon Elasticache	"Re: ElastiCache dead?
We made the dashboard:

Some Cache Clusters in a single AZ in the US-EAST-1 region are currently unavailable. We are also experiencing increased error rates and latencies on the RDS APIs in the US-EAST-1 Region. We are investigating the issue."
Amazon Elasticache	"Re: ElastiCache dead?
Unfortunately, the EC2 and EBS services in the us-east-1 region are experiencing issues. Our engineering teams are working to resolve the issue at the highest priority but we do not yet have an ETA of when this issue should be resolved. We recommend that you monitor the Service Health Dashboard for updates as information becomes available: http://status.aws.amazon.com/"
Amazon Elasticache	"Move to elastic cache
Hi,

I have instances running with the Webuzo Cloud Launcher and I avail of of the benefits of the EC2 environment.

I wish to learn more and in short know more about Elastic cache and as to how to make most of it???"
Amazon Elasticache	"Re: Move to elastic cache
ElastiCache is basically hosted memcache. 

This means that Amazon starts dedicated instances running memcached for you. They also apply update and perform other management tasks for you, so you won't have to.

It allows you to add more servers to the cluster and remove as necessary while still retaining a single entry point in terms of configuration (a specific hostname for your cluster).

It also allows handling the security to make sure only allowed addresses/servers/group can access the servers.

It's not much different than running your own servers for that minus all of the administrative work."
Amazon Elasticache	"How to check elastic cache status
How to check elastic cache status....Like we do for regular memcache....is their any link to do that?"
Amazon Elasticache	"Re: How to check elastic cache status
You can use CloudWatch, AWS monitoring system which provides metrics data on the status of your elasticache cluster or you can use the old fashioned way of connecting with any memcached client and issuing a ""stats"" command."
Amazon Elasticache	"Elasticache still pending for our account?
on our EC2 dashboard, when we try to access Elasticache, we are met with

Thank you for signing up for Amazon ElastiCache. Your subscription is being processed.
We will send you an email when you can begin using this service. For most customers this takes only a few minutes, but if additional account verification is required, then processing can take several hours.


We have been seeing this message for several weeks. Can someone please activate this service on our account?"
Amazon Elasticache	"Re: Elasticache still pending for our account?
Hello jackiecakes,

I apologize for any delay you experienced in using AWS. We've refreshed your account and Elasticache is now active. 

Regards,

Kit B."
Amazon Elasticache	"Re: Elasticache still pending for our account?
I am getting the same thing. It has been about a week now and no emails from AWS and it still says the subscription is being processed."
Amazon Elasticache	"SERVER_ERROR out of memory storing object
Hi ALL,

We are trying to use small instance of Elasticache, but have an error:
""SERVER_ERROR out of memory storing object"". It is strange because according statistics CurrItems is no more than 20,  BytesUsedForCacheItems no more than 50kb.

Thanks."
Amazon Elasticache	"Minor but annoying bug viewing metrics
Hi,

There is a minor bug that I've noticed for months now, but since it doesn't seem to be getting fixed I thought I'd bring it up.

The most convenient way to view a metric of multiple nodes is to select the nodes you are after, and then select the metric you want and the bottom of the screen. 

This loads up in Cloudwatch, however it always loads us-east-1 region, even though the caches selected might be in another region.

Therefore every time you do it, you then need to correctly select the region you want in cloudwatch.

Would be nice if it just went to the correct region first time 

Cheers,
Kelly."
Amazon Elasticache	"5 Second Reads When Getting A Single Key
Is anyone experiencing 5 second reads when reading a single key on us-east-1c between ElasticBeanstalk and ElasticCache right now?"
Amazon Elasticache	"C# .NET developer and ElastiCache
I am a C# .NET developer. I spent some time today trying to see how I can get ElastiCache fit in my .NET application architecture. And I am not getting that comfortable feeling of writing to and reading from ElastiCache from .NET. The memcached .NET APIs available on the Web kind of scare me to use them in production. Does AWS have any plans to upgrade .NET SDK to allow accessing (not managing, which we can do today) ElastiCache sometime soon in future? Without that I am not feeling comfortable using ElastiCache in my .NET app architecture.

Edited by: tntspl on Mar 21, 2012 1:20 PM"
Amazon Elasticache	"Re: C# .NET developer and ElastiCache
Hello,

You are correct that the AWS SDK for .NET currently only provides methods for creating and configuring an ElastiCache Cluster. To answer your question, AWS does not provide a public roadmap. However, in general you would want to use a 3rd party library to add functionality to your application in any language, whether .NET or Java, PHP, Python, etc. 

You can use any .NET memcache library in your application. Is it the 3rd party memcache clients that you are uncomfortable with? A quick search turned up a couple popular ones, Enyim and BeIT:

https://github.com/enyim/EnyimMemcached

http://code.google.com/p/beitmemcached/"
Amazon Elasticache	"Can't add the my EC2 security group
Hi, I'm setting up my ElasticCache, but I can't add my EC2 security group to the Cache Security Groups. 
If I click ""use default"", it offers a security group name with security ID that I doesn't really have, like default(sg-65f22e0d). I have 2 security groups in my EC2, one is default(sg-87e5e8c2) and the other is quicklaunch-1(sg-8de5e8c8).
If I just type in my EC2 security group name it will end up with revoking.

Is it because my EC2 instance is based in the West? Cause I see all the ElasticCache preferred zones are in the East.

Please let me know"
Amazon Elasticache	"Re: Can't add the my EC2 security group
Yes, fixing zone should work. Cheers !!

Edited by: prash_uxm on May 16, 2012 1:36 PM"
Amazon Elasticache	"Elasticache DNS name vs. IP Address (IIS Web.config)
Using EC2 Windows 2008 - Usually with memached, I would have an entry in the enyim.memcached.config section for address, which looks like:

<add address=""127.0.0.1"" port=""11211""/>

With elasticache, I would assume you could do:

<add address=""**elasticachenamehere**.0001.use1.cache.amazonaws.com"" port=""11211"" />

However, I get an error with IIS, saying:

""The value for the property 'address' is not valid. The error is: Invalid address specified: **elasticachenamehere**.0001.use1.cache.amazonaws.com""

Obviously its complaining that I'm using a DNS name instead of an IP address.  I could just set the IP to what the elasticache is currently resolving to, but would that IP ever change?  

Thanks!"
Amazon Elasticache	"Re: Elasticache DNS name vs. IP Address (IIS Web.config)
According to the Enyim client documentation the Memcached configuration supports both IP addresses and hostnames:
""Add each of your memcached server's address and port here. Both IP addresses and host names are supported.""

You might need to upgrade to a newer version, but it should work.

Did you check your security group settings for your ElastiCache? Can your web server connect to the ElastiCache servers? You can test it using ""telnet"" on your Windows machine (login to the Windows machine and run ""telnet elasticache.host.name.xxxx.com 11211"". If it doesn't connect then you have a security group configuration problem."
Amazon Elasticache	"Re: Elasticache DNS name vs. IP Address (IIS Web.config)
Thanks for your reply!

The strange thing is, one of my other websites works with the DNS Host Name no problem.
I can connect to the elasticache via host name no problem with the working project.
Just this new project that I have up and running, and the 1st time I've seen this problem.
I figure it's an IIS configuration issue.  I'll have to start over again.."
Amazon Elasticache	"Re: Elasticache DNS name vs. IP Address (IIS Web.config)
You may have some local DNS issue causing Enyim not to resolve the host names.

Try opening a command line and run a ""ping hostnameofserver"".
If it resolves the hostname to an IP address (it doesn't have to succeed in actually pinging the address) then it should be ok.

If it can't, it might be the source of the problem."
Amazon Elasticache	"Re: Elasticache DNS name vs. IP Address (IIS Web.config)
Yes, it resolves.  I should have added that when I said I have other websites that have the IIS config setting to a host name instead of an IP address, it's actually on the same server as the one that I'm configuring right now (I have a single server that hosts about 20 websites, a few of them are using host name elasticache no problem, and this is the 1st time I've had this problem)"
Amazon Elasticache	"Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
I have been using Memcached for a long time and recently switched to Elasticache, 3 weeks ago. My ec2 instances were moving quite well until this evening when all of a sudden I have hundreds of these ""SOME ERRORS WERE REPORTED"" errors. The full error is 

SomeErrors: error 19 from memcached_get on realdomainhere.use1.cache.amazonaws.com:11211: SOME ERRORS WERE REPORTED

I am using 2 large clustered elasticache instances and have 20 or so EC2 instances accessing them. Not sure what is going on.

Any help would be appreciated."
Amazon Elasticache	"Re: Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
Hi Michael,

I see that one of your Cache Clusters experienced a problem at Apr 18, 2012 2:01:04 AM GMT.  I have asked our engineering team to investigate and will follow up with you on this thread with their findings.

Cheers,
Karen"
Amazon Elasticache	"Re: Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
Thanks, Karen. I will look forward to what they find out."
Amazon Elasticache	"Re: Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
Karen;

Any update on this?

Thanks, Michael"
Amazon Elasticache	"Re: Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
Hi Michael,

The service interruption you experienced was due to a reboot request that was sent to your cluster.

Regards,
Karen"
Amazon Elasticache	"Re: Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
Hi Karen;

I rebooted the cluster as a last ditch effort after about an hour of getting those errors. They persisted, less frequently for another 10-15 minutes after the cluster was back up.

I don't know if this might be related or not, but another error that I consistently get, although not frequently, that I never got when running my own memcached server is a DNS issue:

HostLookupError: error 2 from memcached_get on realdomainname.cache.amazonaws.com:11211: HOSTNAME LOOKUP FAILURE

I would really appreciate any help on this."
Amazon Elasticache	"Re: Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
So this just happened again at about 10 a.m. EDT April 24. I got about 200 of these errors. I did not reboot the cluster. I would really like to know what is going on.

Thanks, Michael"
Amazon Elasticache	"Re: Hundreds of ""SOME ERRORS WERE REPORTED"" suddenly this evening
To anyone searching for a similar issue, I have figured out that this issue was caused by the DNS server that I was querying. For some reason it would fail relatively frequently. Updating my servers' DNS server seems to have fixed this issue."
Amazon Elasticache	"Configuring Memcache - evictions but lots of space
I'm using elasticache, and I need to figure out how to tune it, or otherwise improve the amount of data it's holding (or better my understanding of the metrics).

We're running a set of 2 cache.m2.xlarge. Each node still has ~ 9 Gigs unused as reported by the ""UnusedMemory"" metric, but we're getting Evictions -- a pretty significant number of them. I'm looking for ways to limit the number of evictions as much as possible. 

Even if I find a way in Memcached, are there any configuration params exposed by Amazon to tweak?"
Amazon Elasticache	"Elasticache performance tuning
Hi all,

we currently run our own memcache nodes on EC2
We would love to switch over to elasticache for the cloudwatch metrics and piece of mind of automatic healing/replacement of problematic nodes.

I recently tested out elasticache on our production environment with the default settings and same number/type of nodes in the same AZ like we do on the EC2

I waited for the cache to become ""warm"" but even then the performance was horrible and had to roll back to our EC2 nodes again.

I am sure this means we would need to tweak the default settings to get better performance - probably our caching pattern is not the typical one.

Any metrics we should look into to try and identify what the bottleneck was?

We will obviously increase memcached_connections_overhead, test and measure etc but I was wondering if you have any good tips to point us to the right direction.

By the way our EC2 nodes run memcache without any special configuration (just tweaked the memory and the max connections - both lower than the defaults of elasticache).

thanks in advance

Edited by: webgr on Feb 23, 2012 5:43 AM"
Amazon Elasticache	"Re: Elasticache performance tuning
Contacting you via email to discuss further.

Rahul

Edited by: Rahul@AWS on Feb 27, 2012 1:24 PM"
Amazon Elasticache	"Re: Elasticache performance tuning
Thanks for letting us know this issue is resolved. Please let me know if you continue to have problems.

Rahul"
Amazon Elasticache	"Re: Elasticache performance tuning
Rahul,
Can we also know what was the problem & the solution provided.... I adding Elastic Cache as a layer in my architecture proposal....

Raj"
Amazon Elasticache	"Re: Elasticache performance tuning
I'm interested to hear about the problem and solution too, I've been experimenting with elasticache for my apps"
Amazon Elasticache	"Memcached::cas API call not working, how do we call cas via PHP?
Our PHP application is unable to call the the cas (check and set) function in elastic cache. Seems that your implementation is not compatible with the standard signature since PHP throws:

Message: MemcachePool::cas() expects parameter 3 to be long, string given

The standard signature is: http://www.php.net/manual/en/memcached.cas.php

If the case is that you have your own custom signature of calling cas, PLEASE include your cache interface API in your documentation (the documentation only contains information on managing the nodes, not interfacing with them).

///////////////////////////////////////////////////
// Sample code to replicate error:
///////////////////////////////////////////////////
$memcache = new Memcache();
$memcache->addServer ( MEMCACHE_SERVER );

// set a basic key
$cache->set(""somekey"", ""hello1"");

// get basic key with the cas token
$cas = null;
$val = $cache->get(""somekey"", null, $cas);

if ($val != ""hello1"")
{
     echo ""Failed to get somekey."";
}

$cas_result = $cache->cas($cas, ""somekey"", ""hello2"");
////////////////////////////////////////////

memcached related libs installed on the server:
libmemcached.i686             0.31-1.1.4.amzn1                     @amzn-main   
php-pecl-memcache.i686        3.0.5-3.5.amzn1                      @amzn-main   
php-pecl-memcached.i686       1.0.0-1.1.amzn1                      @amzn-main

Edited by: mssupport on Apr 19, 2012 5:18 AM"
Amazon Elasticache	"Re: Memcached::cas API call not working, how do we call cas via PHP?
Solved.

Removed all client libraries and yum installed: php-pecl-memcached.i686       1.0.0-1.1.amzn1

The time consuming issue was that two libraries were installed:

php-pecl-memcache.i686 3.0.5-3.5.amzn1 @amzn-main
php-pecl-memcached.i686 1.0.0-1.1.amzn1 @amzn-main

and the PHP environment was using memcache instead of memcached. Additionally memcache has an odd or incomplete cas method in it that does not use the standard signature.

In summary, when interfacing with elastic cache via php, use this library (available as a yum package) on your ec2 amazon linux instance:php-pecl-memcached.i686 1.0.0-1.1.amzn1 @amzn-main

Edited by: mssupport on Apr 19, 2012 10:51 PM"
Amazon Elasticache	"Re: Centos based AMI in ec2
Has anybody successfully created Centos Based AMI in EC2? If yes, can you please point me to the documentation / information on how to do it.

Thanks and regards
Shree Unde

Edited by: bunde1 on Apr 17, 2012 10:18 AM"
Amazon Elasticache	"How ElasticCache restore failed node  and what happens in downtime
1.

On the ElasticCache Production Page, it writes that

""
One of the ways to manage data redundancy is to have your application apply all cache writes to Cache Nodes across these Availability Zones. If one or more of your Cache Nodes in the primary Availability Zone fails, you could direct reads to the corresponding Cache Node(s) in the secondary Availability Zone while Amazon ElastiCache restores the Cache Node(s) in the primary Availability Zone.

""

I am wondering how ElastiCache restores the Cache Node?
When the Cache Node is restored,  does the data in the node automatically become the same with the corresponding Node in the secondary Availability Zone?  or it's just a new empty but workable Cache Node, application must synchronize the data itself?

__________________________________________________________________

2.
In the FAQ, its says 
""Your Cache Nodes could incur some downtime during your maintenance window if software patching is scheduled.
""

During the downtime, application can not access the cache node. Is it right?
Are all Nodes incur downtime in the same time or all nodes will be upgraded in the same time? During the downtime, application can not access all the cache node?

Will the data in the memery become invalid after the downtime?

Hoping some could answer the questions."
Amazon Elasticache	"Re: How ElasticCache restore failed node  and what happens in downtime
As far as I know, ElastiCache is basically Amazon Linux instances running memcached.
When restoring a node, it will not update or cache its data. 

If you are using memcache is the regular pattern you will have some ""misses"" in the cache and your application will go to the database, load the data and set it back to memcache, thus updating the cache.

If you have enough instances in your cluster, you will only lose a small part of your cache so your overall application performance would probably not be affected.

In regards to the maintenance window, you can tell AWS to not auto update minor updates (in which case you can control when to apply it). In major updates or critical security patches they will do it for you.

In any case, make sure your code can handle both complete failure an partial failure of the cluster. Memcache is simply cache and your app should be able to work without it. It may not work well without it but it should work."
Amazon Elasticache	"Flush does not appear to have an effect
We have a small 1-node ElastiCache. Setting and Getting items appears to work, but flush does not seem to have an effect.

Symptoms:
  - We call FlushAll() from our client C# code (uses Enyim.Caching)
  - CloudWatch registers a Flush event a couple minutes later
  - BytesUsedForCacheItems does not decrease
  - CurrItems does not decrease
  - FreeableMemory does not increase
  - UnusedMemory does not increase

In other words, apart from the acknowledgement that the flush request was received, it seems that nothing about the cache changes.

What's going on?

-Jordan"
Amazon Elasticache	"Re: Flush does not appear to have an effect
If I'm not mistaken, this is the correct memcache behavior regardless of ElasticCache.

It even appears to be the same behavior on Google AppEngine memcache code (see this link. The last comment by Guido).

You can also reproduce this behavior by running memcached locally, setting a few keys and calling flush_all.

Flush means invalidate all keys, it doesn't actually perform the invalidation since it may contain a lot of keys. It simply marks the keys as invalidated and will not return the values.

This is unlike delete which will actually delete the key (and update the stats)."
Amazon Elasticache	"Missing CloudWatch metrics
Hi,

We have 4 large caches in two clusters.

All is working well, however we've just noticed that some CloudWatch metrics are missing for some caches.

For example, 3 caches have the Evictions metric, but one doesn't.

2 caches have BytesUsedForCacheItems, but 2 caches don't.

Some of the missing metrics are quite important for us to keep an eye on, so it would be good to have this fixed.

Is there any reason these might be missing?

Cheers,
Kelly."
Amazon Elasticache	"Re: Missing CloudWatch metrics
Hi - 

Sorry for the delayed response. I do not see any missing CloudWatch data for your ElastiCache cache clusters. Was this issue answered in this linked message? Re: CloudWatch metrics missing?

Thanks.

Rajat"
Amazon Elasticache	"Re: Missing CloudWatch metrics
Yes it has, thanks.

It was just because the web console only loads 5000 metrics by default.  When I click to load all metrics they are all there.

Cheers,
Kelly."
Amazon Elasticache	"Feedback: ElastiCache small pricing (reservations, please!)
Greetings,

I just thought I'd drop in to offer some feedback for ElastiCache. This is an absolutely wonderful idea for a service, and I was thrilled to see it offered. However, I looked at the pricing for the small variant and my exuberance was quickly killed. More specifically, the lack of the ability to get something like a reserved instance.

We don't want to have to manage an additional EC2 instance, and would love to ""outsource"" it to ElastiCache, but the small on-demand elasticache is just marked up too high for this to be attractive for a small company such as ourselves. We hope to see reservations offered soon!"
Amazon Elasticache	"Re: Feedback: ElastiCache small pricing (reservations, please!)
Thanks for your feedback. We have logged your feedback about ElastiCache reservations and are considering it for our future road map planning. Will update the thread when we have more information to share.

Thanks,
Pavan"
Amazon Elasticache	"Re: Feedback: ElastiCache small pricing (reservations, please!)
Hi There,

Just wanted to let you know that we now offer Reserved Cache Nodes for ElastiCache.

You can read more at: http://aws.amazon.com/elasticache/reserved-cache-nodes

Thanks.

Rahul"
Amazon Elasticache	"Reversed Price - Heavy Utilization 3r term... always charged?
Amazon,

Thank you creating reserved pricing for elasticache.  I just went to purchase and saw text in there I wanted to understand.  

When selecting 3 years for small instances with Heavy Utilization there is text about paying regardless of usage.  So if we need to move to a ""large cache cluster"" in say 2 years, then we will still pay for the small cache cluster the remaining year even though the nodes are turned off?

Thanks for the clarification.

Jeremy"
Amazon Elasticache	"Re: Reversed Price - Heavy Utilization 3r term... always charged?
Hi Jeremy,

You are correct. If you purchase a Heavy Utilization Reserved Cache Node, you are charged the hourly rate for the duration of the term whether you use the node or not.

However, if you buy and run a small 3yr Reserved Cache Node for more than 11 months of the three year term, you save money compared running it On Demand.

If you purchase a 3 year Heavy Utilization reservation and run the node for 2 years, it will cost you less than 50% of what you would have paid by running the node on an On Demand basis for those 2 years.

Rahul"
Amazon Elasticache	"Re: Reversed Price - Heavy Utilization 3r term... always charged?
Rahul,

Thanks for the heads up -- we agree that everything is cheaper when when compared to an ""on demand"" pricing as well ;o)

For flexibility though it sounds like it will be best for us to do a heavy 1yr or Medium 3yr. -- yes, we could keep adding nodes to cluster (presently 2 nodes) but we learned on RDS the limitations of small versus large as well and assuming elasticache is similar too.

Thanks,
Jeremy"
Amazon Elasticache	"ElastiCache CLI doc page is empty
Hello,

I think there is a problem with the following page:

http://docs.amazonwebservices.com/AmazonElastiCache/latest/CommandLineReference


The page is empty, and its source code looks like:

<html>
   <head>
      <meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"">

      <title>Amazon ElastiCache</
Regards,

Mauro"
Amazon Elasticache	"Re: ElastiCache CLI doc page is empty
Hi There,

Thanks for flagging this. We're looking into it.

Sincerely,

Rahul"
Amazon Elasticache	"Re: ElastiCache CLI doc page is empty
Hi There,

This issue has been fixed. Thank you for bringing it to our attention and please let us know if continue to have trouble.

Sincerely,

Rahul"
Amazon Elasticache	"Account stuck in Pending (still)
I posted a few days ago but have not received a response...

https://forums.aws.amazon.com/message.jspa?messageID=322468#322468

We have signed up for this service but it is still marked as pending in the control panel.

I also tried emailing elasticache-forums@amazon.com with the issue but have not received a response.

Any advice?"
Amazon Elasticache	"Re: Account stuck in Pending (still)
Hi There,

This should be resolved. Please let us know if you continue to have trouble.

Cheers,

Rahul"
Amazon Elasticache	"Re: Account stuck in Pending (still)
I've corresponded w/ the customer."
Amazon Elasticache	"Programmatically getting endpoints with the Java SDK
I'm trying to programmatically get a list of ElastiCache endpoints from my Java app using the latest Java SDK. Things don't seem to be working - I can find a valid CacheCluster, but then when I list its nodes, it's empty. Here's my code:

CacheCluster cc = it.next();
 
System.out.println(""Cache node type: "" + cc.getCacheNodeType());
System.out.println(""Number cache nodes: "" + cc.getNumCacheNodes());
 
List<CacheNode> listCache = cc.getCacheNodes();
      
System.out.println(""List size: "" + listCache.size());


When I run it, I get the following output:

Cache node type: cache.m1.small
Number cache nodes: 1
List size: 0


This seems so simple, but doesn't seem to work. I have started an ElastiCache cluster with a single node, but the list comes up empty when I call getCacheNodes(). I've tried to run this code locally and on an EC2 instance, and I get the same thing both times.

Any ideas on what I could be doing wrong?"
Amazon Elasticache	"Re: Programmatically getting endpoints with the Java SDK
Okay, found the answer. Here's the updated code:

AmazonElastiCacheClient client = new AmazonElastiCacheClient(credentials);
DescribeCacheClustersRequest dccRequest = new DescribeCacheClustersRequest();    
dccRequest.setShowCacheNodeInfo(true);
DescribeCacheClustersResult clusterResult = client.describeCacheClusters(dccRequest);


The point is, you need to set this flag to say you want the node info."
Amazon Elasticache	"ElastiCache Reserved Instances?
Hello,

I wonder if (and when) ElastiCache reserved instances will become available? Is this already planned?

Best regards,
Jonas"
Amazon Elasticache	"Re: ElastiCache Reserved Instances?
As a general rule, we don't comment on the future direction of the service. However, we're always interested in input from our customers and I'd love to hear the details of your use case. Reserved Instances are definitely on our list.

Please PM me if you're open to setting up a call.

Rahul"
Amazon Elasticache	"Re: ElastiCache Reserved Instances?
Is there any estimate on when something like that would be possible?

I am about to reserve a few EC2 instances but would hold on if reserved pricing for elasticache would be becoming available in the near future.

Any indication would help!

thanks!"
Amazon Elasticache	"Re: ElastiCache Reserved Instances?
Is there any estimate on when something like that would be possible?

I am about to reserve a few EC2 instances but would hold on if reserved pricing for elasticache would be becoming available in the near future.

Any indication would help!

thanks!"
Amazon Elasticache	"Re: ElastiCache Reserved Instances?
Hi there,

We don't comment on specific dates, but RI pricing for ElastiCache is high on our priority list. I've PM'ed you to set up a time to discuss this in more detail and to help us understand your timeline.

Thanks.

Rahul"
Amazon Elasticache	"Re: ElastiCache Reserved Instances?
I'd be interested in this too. At present, Elasticache nodes are 3 times as expensive as a heavy utlization reserved EC2 instance - and I'm sure there's some good AMIs out there that are pre-configured with memcached which would take hardly any time to setup.

Whilst I appreciate the node failover and elastication that's built around a node cluster, I can't really justify spending three times as much on a comparable server with the same resources."
Amazon Elasticache	"Can't authorize ec2 security group
I keep trying to assign my default cache security group to two specific ec2 security groups, but right after authorizing the control panel automatically revokes the authorization saying:

Revoking authorization as EC2 security group xxxx owned by AWS_ID does not exist.

However, they do exist.  I'm selecting them from the drop-downs, and they are assigned to my ec2 instances.

What do I have to do to get this to work?"
Amazon Elasticache	"Re: Can't authorize ec2 security group
I'm having the same problem. It seems that it converts the security group name into the ID of the group (the id is shown in the details section while the rule is being authorized, while the existing rules show the group name in the details section). Could that be the problem? I understood that the API requires the name to be used.

Either way, it's not working and what dramadar said, happens to me too."
Amazon Elasticache	"Re: Can't authorize ec2 security group
I'm having the exact same problem, and I think it is a bug in the web console. Looking at the event log, I see that the cache did this exact same behaviour on valentine's day - I added five security group entries, and it automatically revoked them all. I didn't notice the revocation, because that cache was not yet in use; a team member went to use it last night and found that it was refusing connections. Tried adding the five groups again today, and they just immediately revoke themselves instead of authorizing.

The cache is in US-EAST-1B, as are the security groups/EC2 instances."
Amazon Elasticache	"Re: Can't authorize ec2 security group
I found I have to use the command line tools, the web console is broken.

elasticache-authorize-cache-security-group-ingress default  --ec2-security-group-name myec2group --ec2-security-group-owner-id 987654321021"
Amazon Elasticache	"Re: Can't authorize ec2 security group
That worked for me (thanks!) - I guess the issue is that the web console is sending the security group ""code"" (sg-whatever) instead of the assigned name."
Amazon Elasticache	"Re: Can't authorize ec2 security group
This issue should be resolved. Please let us know if you continue to have problems.

Thanks for bring this to our attention.

Sincerely,

Rahul"
Amazon Elasticache	"ElastiCache account stuck in pending
We signed up for this service quite some time ago, and it is still marked as pending.  All info on the account is correct, and we are a frequent user of many AWS services.  Could someone help me out?  Thanks!"
Amazon Elasticache	"When will ElasticCache be availanle in US West?
I understand the service is beta -- any timeframes for other regions?"
Amazon Elasticache	"Re: When will ElasticCache be availanle in US West?
I'm also onboard once its available in US West.  Any ballpark timeframes?"
Amazon Elasticache	"Re: When will ElasticCache be availanle in US West?
We're out here as well. Very interested in this."
Amazon Elasticache	"Re: When will ElasticCache be available in other regions
Very interested in this service too (we're in EU West)"
Amazon Elasticache	"Re: When will ElasticCache be availanle in US West?
ping any updates?"
Amazon Elasticache	"Re: When will ElasticCache be availanle in US West?
Amazon ElastiCache is now available in four new Regions including US West. Please refer to this announcement: https://forums.aws.amazon.com/ann.jspa?annID=1261

Thanks,
Pavan"
Amazon Elasticache	"Re: When will ElasticCache be availanle in US West?
It's a tiny bit frustrating that ElastiCache just showed up in almost every region except the one we're in - Oregon.  I hope it's on the way here as well, we'd like to move away from managing our own memcached servers."
Amazon Elasticache	"Re: When will ElasticCache be availanle in US West?
We're starting to discuss a genuine need for ElastiCache and we're running in the OR datacenter.  Can we expect it there anytime in the near future?"
Amazon Elasticache	"Re: When will ElasticCache be availanle in US West?
Hi There,

We just released ElastiCache in the Oregon datacenter.

https://forums.aws.amazon.com/ann.jspa?annID=1368

Rahul"
Amazon Elasticache	"Account pending?
Hi, I signed up for this (so it seems) weeks ago, but i still get the ""Thank you for signing up for Amazon ElastiCache. Your subscription is being processed."" message when I visit the page. I'm using all the other services just fine so I'm wondering why this is taking so long.

Thanks."
Amazon Elasticache	"Re: Account pending?
Hi There,

Could you please verify that the information associated with the account is entered correctly and not expired? If so, please email us at elasticache-forums@amazon.com and we'll do our best to get things sorted out.

Thank you.

Rahul"
Amazon Elasticache	"Re: Account pending?
Hi, thanks for the reply.  Sorry but I didn't even notice that this was actually responded to.

I've been using my AWS account for a bit now and I get charged on a regular basis, so I know that the credit card on file is up to date.

For some reason though it just started working several days ago; I didn't change anything.

Thanks again."
Amazon Elasticache	"AmazonElastiCacheClient (java) : How to store/retrieve objects?
Hi,
I was looking at the Amazon aws java sdk 1.3 API. AmazonElastiCacheClient  has methods to connect, create a cache, delete it etc. 

But it does not seem to have any methods to store/retrieve/delete objects in the cache ?

Is there a different API?

Thanks
Bala"
Amazon Elasticache	"Re: AmazonElastiCacheClient (java) : How to store/retrieve objects?
This is a class made to handle the administration of ElastiCache, not a class to actually store, retrieve and delete cache data.

ElastiCache is Memcache protocol compliant so you can use any Memcache client with it.

There is a not so much updated list here.
The Couchbase client should be rather up-to-date and working well, if you want to try it out.

Once you create an ElastiCache cluster you can take the address specified at the AWS console and use it to connect with the Memcache client."
Amazon Elasticache	"Elasticache (free) testing
Ten days ago, I followed a webinar ""Turbo-charge your web apps using Amazon ElastiCache"".  We were promised some free testing, but I heard nothing since.

Q"
Amazon Elasticache	"Re: Elasticache (free) testing
You should receive an email today with instructions. Please let us know if you don't hear anything by mid-day."
Amazon Elasticache	"Re: Elasticache (free) testing
Hello, We also attended the webinar and did not receive a email for free testing. Was it ever sent out?
I am very interested in trying this service still."
Amazon Elasticache	"Re: Elasticache (free) testing
The emails were sent out on Dec 12 and were resent last Friday. Please PM me with the email address you used to register for the webinar and I'll investigate.

Thanks for your interest in ElastiCache.

Rahul"
Amazon Elasticache	"How to check items cached in Elastic Cache?
Hi Everyone,

I am new to Elastic Cache, using it for the first time.

I just setup a small Elastic Cache node and Its working.

But i am not able to find a way to check which items are currently cached.

This is important because I need to know if a particular piece of object was cached correctly or not and how much memory it took.

Thanks a lot in advance.
vikas"
Amazon Elasticache	"Re: How to check items cached in Elastic Cache?
I finally Found this code on this URL: 
http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html

Fortunately it works for me. 

<?
		error_reporting(E_ALL);
	    
		define('ELASTIC_CACHE_NODE','abc.efg.xyz.cache.amazonaws.com');
		
		$memcache = new Memcache;
		$memcache->connect(ELASTIC_CACHE_NODE, 11211) or die (""Could not connect to Elastic Cache"");
		
		$list = array();
		$allSlabs = $memcache->getExtendedStats('slabs');
	    $items = $memcache->getExtendedStats('items');
	    foreach($allSlabs as $server => $slabs) {
    	    foreach($slabs AS $slabId => $slabMeta) {
    	        $cdump = $memcache->getExtendedStats('cachedump',(int)$slabId);
    	        foreach($cdump AS $server => $entries) {
    	            if($entries) {
        	            foreach($entries AS $eName => $eData) {
        	                $list[$eName] = array(
        	                     'key' => $eName,
        	                     'server' => $server,
        	                     'slabId' => $slabId,
        	                     'detail' => $eData,
        	                     'age' => $items[$server]['items'][$slabId]['age'],
        	                     );
        	            }
    	            }
    	        }
    	    }
	    }
	    $memcache->close();
		ksort($list);
		
		echo ""<pre>"";
			print_r($list);
		echo ""</pre>"";
		
?>"
Amazon Elasticache	"API to check memory usage
Is there a way (in terms of API) that I can know how much memory I have used?

How would the thing be if I attempt to store additional data while the memory is fully used?"
Amazon Elasticache	"Re: API to check memory usage
1) Is there a way (in terms of API) that I can know how much memory I have used?

If you want the memory being used to cache items, you can use the CloudWatch APIs to get the ""BytesUsedForCacheItems"" metric for each node - http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/CacheMetrics.html

If you're interested in how much memory the memcached process is using, you estimate it by run 'stats slabs' on each node and looking for the 'total_malloced' entry in the response.

2) How would the thing be if I attempt to store additional data while the memory is fully used?

You may start hitting swap space, and cache performance can get impacted. We recommend not loading your cache node to the point of using swap space. Please refer to section “Understanding and Tuning Memcached Connection Overhead” in the User Guide: http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/CacheParameterGroups.html#CacheParameterGroups.Parameters.Memcached.ConnectionOverhead"
Amazon Elasticache	"ElastiCache Free Tier
On the ElastiCache site there the following statement:

As part of AWS’s Free Usage Tier, new AWS customers will receive free 15 GB of data transfer out each month aggregated across all AWS services for one year.

Is ElastiCache part of this though? If not, what advantage does this have over  firing up redis, Kyoto, or even memcache to improve performance?"
Amazon Elasticache	"Re: ElastiCache Free Tier
Hi Seth,

ElastiCache does not charge for data transfer between your cache nodes and your EC2 instances. If your EC2 instances are in a different availability zone from your cache nodes, you will only be charged for data transfer in or out of EC2. This transfer in and out of EC2 is subject to the terms of the AWS Free Tier. Please note that charges for provisioning cache nodes are not covered by the AWS Free Tier.

Hope this helps.

Rahul"
Amazon Elasticache	"ElastiCache v.s. memcached
What is the advantage for using ElastiCache compared to installing memcached on EC2 Large Instance?

==========
ElastiCache $0.38 per hour
Large Cache Node (cache.m1.large): 7.1 GB memory, 4 ECUs (2 virtual cores with 2 ECUs each), 64-bit platform, High I/O Capacity

EC2 Large Instance $0.34 per hour
7.5 GB memory
4 EC2 Compute Units (2 virtual cores with 2 EC2 Compute Units each)
850 GB instance storage
64-bit platform
I/O Performance: High
API name: m1.large"
Amazon Elasticache	"Re: ElastiCache v.s. memcached
The ElastiCache product page covers it in one sentence:

""Amazon ElastiCache simplifies and offloads the management, monitoring, and operation of in-memory cache environments, enabling you to focus on the differentiating parts of your applications.""

This is a more managed service built on top of EC2. It is basically the same concept as RDS. AWS has taken an application and built a service around it. You can still set this up yourself, but using ElastiCache (or RDS) eliminates a lot of undifferentiated heavy lifting and allows you to focus on more important things."
Amazon Elasticache	"Re: ElastiCache v.s. memcached
How about performance? Any benchmark information please?

Is there any free trial currently?"
Amazon Elasticache	"Re: ElastiCache v.s. memcached
awsuser888 wrote:
Is there any free trial currently?

Unfortunately, ElastiCache instances are not covered by the free tier.

I'll have to leave the performance question for someone else. But in general, I believe it would be hard to beat ElastiCache when setting up your own EC2 instances. Others might be able to provide raw numbers though."
Amazon Elasticache	"Re: ElastiCache v.s. memcached
Thanks for your information.

Anyone else has any idea?"
Amazon Elasticache	"Re: ElastiCache v.s. memcached
One difference is that if you run Memcached on your EC2 instances, you can provide access to non-EC2-based machines, or instances in different regions.  This is currently not possible with ElastiCache.

Another difference is that if use ElastiCache, you also get additional CloudWatch metrics at no additional charge, so that you can monitor and optimise your cache cluster.  Even if you finally decide to use Memcached on your own instances, being able to see how your cache is performing is extremely useful.  Memcached provides useful stats, but having metrics over time, without having to write anything yourself is pretty useful.  You might discover that you only need a tiny cache on a single instance, or that you could do with a larger ElasticCache cluster, or that your cache code isn't working at all."
Amazon Elasticache	"Which API calls for java-client of Elasticache?
Hi

I'm new to Elasticache (and actually memcached too) and wish to evaluate it for our app.  I'm assuming that I could call Elasticache from my application's data access layer i.e. something like...

getObject(int id){
    Object o = getObjectFromElasticache(id);
    if(o not null) return;
    o = getObjectFromDatabase(id);
}

Is this the correct idea?  If so could you point me to the classes I need to use in your API docs?

Rob"
Amazon Elasticache	"Is ElestiCache supports local cache?
Hi All,
I am new to Amazon Web Service and exploring the ElestiCache. Its really amazing service. I want to know more and more about this service.

Can anyone tell me how ElestiCache supports following features:
(1)Local Cache: can ElestiCache allows to use the local memory for users to avoid hitting remote servers. Can users do configuration on client machine like number of objects to store and timeout settings to invalidate the cache. Because this can dramatically improve response times for frequently accessed data.
(2)Cache Updates: how ElestiCache updates the cache? how it handles the concurrent request of users? any locking or any version number?

Thanks
KK Paliwal"
Amazon Elasticache	"Concurrent request limitation
any?"
Amazon Elasticache	"Do I need ElastiCache for SimpleDB?
It is not clear if I need to use ElastiCache for caching SimpleDB queries results.
Does this make any sense?"
Amazon Elasticache	"Re: Do I need ElastiCache for SimpleDB?
Do you need to use ElastiCache to cache SimpleDB queries? No.

Should you implement a caching layer like ElastiCache for your SimpleDB queries? Probably, and most likely yes if you serve a vast amount of queries per day. You can easily avoid doing that if your application only serves a small handful of users (1-25 for example).

But for projects where you're performing hundreds of thousands of queries per day, adding a caching layer is critical. It improves speed and cuts costs. Being able to ping your cache which exists in extremely fast RAM is a lot easier than doing a full read to a database layer.

I wrote a  q & a on this a few months ago you might find useful: http://questional.com/4725-how-can-i-use-memcache-to-cache-database-calls/

I didn't use to cache but now I incorporate it into every new application I design, even if it doesn't require it then it may require it one day."
Amazon Elasticache	"Why is ElastiCache more EC2 like than S3 like?
This is a more general question around the ElastiCache strategy.  It seems that the pricing is setup to reflect running an EC2 instance.  This is kind of annoying if you just want a cache to grow dynamically with your application.  Google App Engine takes a more S3 type approach where they just charge you for memory consumed.  

Does AWS plan to have a pay as you go for memory the same as they do for storage (ala S3)?  I think this would be much more preferred by developers.  I realize this is sometimes simpler said that done, but I'd use the product for sure if it were more like the S3 of in memory cache."
Amazon Elasticache	"Re: Why is ElastiCache more EC2 like than S3 like?
This is basically the same concept as RDS. They take EC2 and add a service on top. There are actually EC2 instances running behind the scenes. These resources are fully dedicated to you. I was actually a bit surprised when they announced ElastiCache. An S3-like model would have worked better for small developers. Google does charge based on actual use, but I guess they can make more money in other places. With the new App Engine pricing model, you pay for instance hours. App Engine is more or less a sandbox. You can't really use their memcache service without having your application deeply tied into their platform. Sure, using ElastiCache outside of EC2 would be impractical as well. Not because of any artificial limitations - it would simply not make sense to introduce a high latency. It might not be impossible to offer this pricing model after all..."
Amazon Elasticache	"ANN: CloudFormation script for Membase Clusters instead of ElasticCache
Hi all,

Just wanted to let you know about a CloudFormation script I made which allows you to create a Membase cluster in a few short clicks.

Membase is a memcache protocol compliant server that in addition to regular memcache functionality can also:


Be persistent (survive restarts, upgrades and maintenances)
Support backup (if warming up your cache is expensive)
Built-in support for no downtime resizing of a cluster with automatic rebalancing of the data between servers
Multi-tenancy 
Password protected buckets
a lot more...


Benefits over ElastiCacche:

Runs in ALL regions
Allows multi availability zone and region deployments
Save money and utilize reserved instances including the new utilization pricing model!
No need for a single CNAME address - using a vBucket aware client or Moxi Proxy will update the topology of servers to all clients automatically 


Read more about it here

Grab the CloudFormation script from Github

Edited by: Eran Sandler on Dec 6, 2011 1:26 AM"
Amazon Elasticache	"ETA for AWS ElastiCache availability in Europe-West zone
Are there any news on the plans to roll out ElastiCache in EU-West zone as well?

We are currently using memcached on one of our instances but would like to shift this to ElastiCache as soon as possible.

Thanks,
Axel Amthor
advertzoom.de"
Amazon Elasticache	"Re: ETA for AWS ElastiCache availability in Europe-West zone
Is it even possible to get an ETA when this question will be answered by any amzonian ??"
Amazon Elasticache	"Re: ETA for AWS ElastiCache availability in Europe-West zone
Axel - We are expecting to support ElastiCache in EU in the next few weeks. Will update the thread when we have more concrete information.

Thanks for your patience,
Pavan"
Amazon Elasticache	"Re: ETA for AWS ElastiCache availability in Europe-West zone
Thanks for the update, I'll keep an eye on this thread 
Axel"
Amazon Elasticache	"Re: ETA for AWS ElastiCache availability in Europe-West zone
Amazon ElastiCache is now available in four new Regions including EU West. Please refer to this announcement: https://forums.aws.amazon.com/ann.jspa?annID=1261

Thanks,
Pavan"
Amazon Elasticache	"Re: ETA for AWS ElastiCache availability in Europe-West zone
Ja ist denn heut' schon Weihnachten ...?

Thanks, great.
Regards,
Axel"
Amazon Elasticache	"elasticache node question
Hi All, 

Sorry for the newbie questions but i cant seem to find the information

1. Are all the nodes in the same cluster supposed to share the same exact information?

2. I am using php to connect to all the nodes, should i use memcache add server? it seems to connect to only the first successful node. does this mean all my servers need to connect to only the first node, and if it fails, goes to the second node?

3. If number 1 is not true, then how does adding new nodes help me scale if they cant use the same information? IE, if i need a larger memcached instance."
Amazon Elasticache	"Re: elasticache node question
anyone?"
Amazon Elasticache	"Re: elasticache node question
w3elf,

You do use the add server command to add all the nodes. Memcached clients distribute keys across all the nodes using a hashing algorithm.

If you add extra nodes using Amazon ElastiCache, merely add the new node address to your memcached client. Your application will then add the new node to the cluster and will start using it.

Please refer to the documentation for the Memcached client you are using for more details"
Amazon Elasticache	"Re: elasticache node question
When i add multiple nodes, my memcached client only uses the first node that it sees. If the node is down, then it uses the next node. Therefore not all the nodes are updated across elasticache. 

IE. If i make a change to node 1, it is not reflected in node 2 even if i add both nodes to my client."
Amazon Elasticache	"Re: elasticache node question
This IS the usual behaviour of memcached clients. This is by design. If you want to distribute information all around the memcached nodes, you must take care about that yourself. Refer to the memcached docs.

Scaling has nothing to do with redundancy nor failover. I.e. having 4 nodes with 1Gig mem each means nothing more than having a self-organizing storage of 4 Gigs"
Amazon Elasticache	"elasticache reboot failing after being unable to connect to cache
We have a cache cluster with a single small cache instance on elasticache, and other memcache instances that we are running ourselves. Last night PST the elasticache node suddenly changed so that we could not connect (using a php client), nor could we telnet to that port  though we could ping it.  Again this was an operational elasticache that has been running since august (so it has the proper security group).  We think that this is a bug with Elasticache.

Then, as was not usable, we tried to reboot the cluster this morning, some 12 later after the cache became unconnectable.  The reboot says it says could take ""minutes""... and is now going for 30 minutes without seeming to boot based on the management console.

HELP"
Amazon Elasticache	"Re: elasticache reboot failing after being unable to connect to cache
Update: after about 45 minutes the instance rebooted and now the cache can be connected to correctly. My bug report to the Elasticache crew still stands: it should not have got into the condition where it needed to be rebooted, where it it could not be connected to.  Right?"
Amazon Elasticache	"Intermittent Failures
I'm seeing intermittent failures when initially trying to access Elasticache. I'm using PHP and memcache to access Elasticache from an EC2 instance.

After getting the endpoint info from Elasticache I try to connect using the PHP memcache class. I frequently get ""connection timeout"" errors on initial attempts to connect.

I put in a retry loop with a delay (3 seconds). That seems to solve the problem (two or three tries usually suffices) but I'm not sure why a retry is needed. The Elasticache cluster is already up and running. I've been able to access it in the past but when I start up a new EC2 instance I get timeouts initially when trying to access it.

After I'm able to get a successful connection with the memcache class (with retries) I'll get frequent failures using the set() memcache method. At least for the first 20 to 50 attempts to access the cache.

I've tried putting in various delays after the connect but that doesn't seem to have an effect (and I'm not sure why a delay would be required but I figured it's worth a try).

Odd part is that after the process has the initial hard time connecting and the initial round of ""set()"" failures things eventually settle down and start working.

Anyone have a clue what's going on?"
Amazon Elasticache	"Unable to connect to ElastiCache clusters using Membase lib for Memcached
I am having problems with get/set to an ElastiCache cluster from my EC2 instance. I am getting - SEVERE: net.spy.memcached.OperationTimeoutException: Timeout waiting for value
 - error.

When I am trying to get or set a value. I used the same code on my local machine (albeit communicating with a local memcached server) and everything works fine. The complete stacktrace can be found here - http://pastebin.com/tYcCJ6cj

I first saw that can I at least get the IP address of all the nodes of a cluster so that I can feed it in to my membase client & I am indeed able to find out the node ip addresses. I also made sure that all my EC2 security groups are added to the default cache cluster security group as well.

Code snippet used to fetch a particular record -


public String getCachedValue(String namespace, String key) {
 
    String value = null;
 
    try {
        MemcachedClient client = CacheConnectionUtil.connectToElastiCacheMemcachedServer();
 
        // Point of origin for the exception.
        return (String) client.get(namespace + ""$"" + hashKey(key));
 
    } catch (IOException e) {
        e.printStackTrace();
    }
 
    return value;
}
 


Code snippet used to connect to the ElastiCache server - 

private static MemcachedClient connectToElastiCacheMemcachedServer() 
            throws IOException {
 
        DescribeCacheClustersResult cacheClustersInfo = null;
        DescribeCacheClustersRequest cacheClusterRequest = new DescribeCacheClustersRequest();
        cacheClusterRequest.setShowCacheNodeInfo(true);
 
        try {
            cacheClustersInfo = AWSConnectionUtil
                            .getElastiCacheObject(null)
                            .describeCacheClusters(cacheClusterRequest);
        } catch (Exception e) {
            e.printStackTrace();
            throw new IOException(""Unable to connect to ElastiCache Cluster."", e);
        }
 
        if (cacheClustersInfo == null) {
            throw new IOException(""ElastiCache Cluster Info Object is null."");
        }
 
        List<CacheCluster> clusters = cacheClustersInfo.getCacheClusters();
 
        if (clusters == null || clusters.isEmpty()) {
            throw new IOException(""No ElastiCache Clusters available."");
        }
 
        List<String> serverList = new ArrayList<String>();
        for (CacheCluster cluster : clusters) {
            if (cluster != null 
                    && AWSConstants.CACHE_CLUSTER_ID.equalsIgnoreCase(cluster.getCacheClusterId())) {
 
                List<CacheNode> nodes = cluster.getCacheNodes();
                if (nodes != null ) {
                    for (CacheNode node : nodes) {
                            if (node != null) {
                            Endpoint endpoint = node.getEndpoint();
                            if (endpoint != null && endpoint.getAddress() != null) {
                                serverList.add(endpoint.getAddress() + "":"" + endpoint.getPort());
                            }
                        }
                    }
                    }
            }
        }
 
        if (serverList.isEmpty()) {
            throw new IOException(""No Cached nodes available for cluster - "" + AWSConstants.CACHE_CLUSTER_ID); 
        }
 
 
        return new MemcachedClient(AddrUtil.getAddresses(serverList));
    }"
Amazon Elasticache	"Horrible Console Interface
I have to say, I love AWS, but the console interface for ElasticCache is horrible! Why do I have to lookup my own customer ID in order to copy/paste it into a field simply to get access to the cache (setting up a security group)? Then, once I've done that, I have to lookup the exact wording of the security group I used (on a completely different tab...losing the state of my edit box) to copy/paste that as well. So, in order to setup a security group, I have to leave the console twice, copy/paste the necessary information into a text document, go back to the ElasticCache console, edit the security group information, and re-copy/paste both of those values into the box.

Horrible! AWS, you can do better here."
Amazon Elasticache	"Re: Horrible Console Interface
I would have to agree, the Elasticache Security Group interface is not intuitive and is quite a pain to use for exactly the above mentioned reasons. Having an autofill for Sec-group name and 'default to own' account # would be a huge improvement."
Amazon Elasticache	"something similar to transaction in memcache
Is there a way to use something similar to transactions in amazon elastic mem cache .So that at a time only one user can access that. 

What about the number of write per seconds in amazon cache, i.e. how much traffic it can handle.

Can we be hundred percent sure that the mem cache won't be flushed if we stick to our allowted size, until we intervene"
Amazon Elasticache	"Re: something similar to transaction in memcache
1. You would have to handle something like that in your application code.
2. That would probably depend on the instance size, you can benchmark it to see what kind of performance you get.
3. Elasticcache is a managed version of memcached. Its not designed to be persistent like other database systems are. If the instance fails, you will lose all data stored in the cache. Generally memcached will keep the data until it needs more space(evictions) or the object expires"
Amazon Elasticache	"High Performance counters
How to implement high performance counters in elastic cache( to count something)
???"
Amazon Elasticache	"does not recognize my EC2 Security group
I'm having an issue where i am trying to add a security group so that i can access the cache, however it keeps stating that the EC2 security group does not exist, even tho RDS took the information fine. 

now the only thing i can think of is the ec2 security zone is in the west regien while cache is in the east. however the documents said this should be fine, we would just get charged for data transfer."
Amazon Elasticache	"Re: does not recognize my EC2 Security group
Unfortunately, security groups works within a region only. Referencing a security group from another region is not supported."
Amazon Elasticache	"Re: does not recognize my EC2 Security group
Hi smcloud,

Amazon EC2 regions are isolated from each other, meaning ec2 resources like ec2 security groups in one region are not visible to other regions. So if you have your cache cluster created in US-EAST-1, you cannot authorize the cache security group with an ec2 security group from other regions. Please check EC2's Region and Availability Zone FAQ for more details:
http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/index.html?FAQ_Regions_Availability_Zones.html

Why are my Amazon EC2 resources not visible in the EU Region or other Region?
Amazon EC2 Regions are isolated from each other. Resources such as SSH key pairs from a CreateKeyPair call, security groups, and AMIs, are not replicated between Regions.

Thanks"
Amazon Elasticache	"Re: does not recognize my EC2 Security group
thank you."
Amazon Elasticache	"Testing ElastiCache not in EC2
I want to test elasticache from my local dev box - is this a possibility?"
Amazon Elasticache	"Re: Testing ElastiCache not in EC2
That is not currently possible.  All clients to a Cache Cluster must be within the EC2 network, and authorized via security groups as described above

http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/CacheSecurityGroup.html"
Amazon Elasticache	"Re: Testing ElastiCache not in EC2
You can install memcached locally and connect to it. ElasticCache is just memcached with some management around it."
Amazon Elasticache	"Signing Up to ElasticCache
When I trying to access the Elastic Cache page, I receive:
""You must sign up for Amazon ElastiCache before you can use the Amazon ElastiCache Console.
It's quick and free to sign up, just click the button below.""

But when I click the signup button, I go to a page with: 
""You already have access to Amazon ElastiCache""

Anyone else had this issue?"
Amazon Elasticache	"Issue while Implementing Elasticache with c#.Net
Hello All,

I am new to Elasticache and trying to implement it in my application coded in c#.net but not finding any way. I had already created the clustors with nodes and endpoints. 

But as its written in the articles that Elasticache supports MemCache so I tried with memcache. The memcache works fine on the local server but on Amazone server its not working. 

As you may know the memcache requires the server IP/name + Port No., so I used the Node Endpoint and the port No. Shown in the Clustor Setttings Window, but still it dosn't works for me.

Can you please make me clear where I am wrong? And also suggest with the proper steps. 

Any help will be highly Appreciated.

Thanks
Naresh"
Amazon Elasticache	"Re: Issue while Implementing Elasticache with c#.Net
Have you configured your CacheSecurityGroup to allow access from you client EC2 instances?  If not, that is likely the problem.  To protect your CacheCluster from unwanted access, you have to explicitly allow access to your CacheCluster from the client EC2 instances you use to connect to your CacheCluster.  http://aws.amazon.com/elasticache/faqs/#How_do_I_control_access gives a bit more of an overview of CacheSecurityGroups and the section titled “Authorizing Network Access to an EC2 Security Group” at http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/index.html?USER_WorkingWithSecurityGroups.html gives instructions for authorizing access to your CacheCluster.

If you have already authorized access to your CacheCluster from your client EC2 instances, it would be helpful if you can provide more information about the error you are receiving.  In addition, information on how you are attempting to access you Cache Cluster such as whether you are using a memcached client library, customer application code, telnet, etc. would be useful."
Amazon Elasticache	"Adding Nodes to the ElastiCache Cluster
Hello,

We launched an ElastiCache Cluster with a single large Cache node. I could see that it is possible to add more large nodes to the cluster but i didnt see any option to select cache node types ( small / large / xlarge etc )  to the existing cache Cluster. e.g. Is it possible at all to add small cache node to a  Cache Cluster created using a large node.

Also is it possible to add  EIP / Instance ID / Private IP of the EC2 instance to the Cache Security Group rather than Security group of the EC2. This is because we have multiple EC2 instances using the same EC2 security group. I hope this shouldn't be a problem. Cache nodes will be used by only those instances where the Cache end points are given in the client ( app ) present in instances. Is that right? correct me if i am wrong. 

Thanks
Shankar

Edited by: sparkshankar on Oct 3, 2011 1:30 AM"
Amazon Elasticache	"Re: Adding Nodes to the ElastiCache Cluster
sparkshankar wrote:
Is it possible at all to add small cache node to a  Cache Cluster created using a large node.

All cache nodes needs to be of the same instance type.

http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/CacheCluster.html

Also is it possible to add  EIP / Instance ID / Private IP of the EC2 instance to the Cache Security Group rather than Security group of the EC2.

Unfortunately, IP-based access control is not supported yet.

http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/index.html?CacheSecurityGroup.html

Cache nodes will be used by only those instances where the Cache end points are given in the client ( app ) present in instances. Is that right?

Yes, the cache security group simply allows access from your instances. They will never use the cache cluster unless you configure your application to do so."
Amazon Elasticache	"Not able to get cache nodes from ElastiCache cluster
Hello, Guys

I'm trying to get node endpoints from ElastiCache cluster.

I'm able to print proper cluster id by using following code
LOGGER.info(""cache cluster id: "" + cluster.getCacheClusterId());


But not able to get the nodes in the cluster. Here is the code I used to get cache nodes.

private static List<String> getServerListFromAWS() {
	AmazonElastiCacheAsyncClient awsClient = new AmazonElastiCacheAsyncClient(getCredentials());
	
	DescribeCacheClustersResult result = null;
	
	try {
		result = awsClient.describeCacheClusters();
	} catch (Exception e) {
		ServerHelper.log(e);
		result = null;
	}
	
	if (result == null) {
	    LOGGER.info(""result is null"");
		return null;
	}
	
	List<CacheCluster> clusters = result.getCacheClusters();
	
	if (clusters == null || clusters.isEmpty()) {
		return null;
	}
	
	List<String> serverList = new ArrayList<String>();
	for (CacheCluster cluster:clusters) {
		if (cluster != null) {
		    LOGGER.info(""cache cluster id: "" + cluster.getCacheClusterId());
			List<CacheNode> nodes = cluster.getCacheNodes();
			if (nodes != null ) {
				if(nodes.isEmpty()) {
					LOGGER.info(""nodes isEmpty"");
				}
 
				for (CacheNode node:nodes) {
					if (node != null) {
						Endpoint endpoint = node.getEndpoint();
						if (endpoint != null && endpoint.getAddress() != null) {
							serverList.add(endpoint.getAddress() + "":"" + endpoint.getPort());
						}
					}
				}
			}
		}
	}
	LOGGER.info(""#getServerListFromAWS, result: "" + Arrays.asList(serverList));
	return serverList;
}

The above code prints ""nodes are empty"". But I do have active node which I can see from AWS console.

Why I'm not able to get the nodes from ElastiCache cluster?

Thanks,

Anil Madamala


Edited by: srini994 on Sep 23, 2011 1:59 PM

Edited by: srini994 on Sep 23, 2011 2:01 PM

Edited by: srini994 on Sep 23, 2011 2:09 PM"
Amazon Elasticache	"Re: Not able to get cache nodes from ElastiCache cluster
As mentioned here “http://docs.amazonwebservices.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/elasticache/AmazonElastiCacheClient.html#describeCacheClusters%28%29” , you need to use optional ShowDetails flag to obtain CacheNodes Information. Please let us know, if you still have problems retrieving Cache Nodes details using DescribeAPI call.

Thanks,"
Amazon Elasticache	"ElastiCache + SimpleDB
Is ElastiCache designed to work with SimpleDB?  I noticed in the overview it says it works well with RDS and EC2, but I'm wondering what the compatibility is like for SimpleDB that I have linked to EC2.

Thanks"
Amazon Elasticache	"Re: ElastiCache + SimpleDB
ElastiCache provides an in-memory cache for your data. It can be used to store information that might be expensive to retrieve from the database, such as a list of friends in a social network. Instead of querying the database, that information could be fetched from the cache instead, if present. This service does not require you to use any specific database technology. Both RDS and SimpleDB would work well. Your code can query the cache, find out if the information is present and go back to the database if it isn't. Cache the database response and repeat. The next time, it will be present in the cache, eliminating the need to query the database."
Amazon Elasticache	"Re: ElastiCache + SimpleDB
The term for that is read through cache.  You probably want to implement an expiration strategy in conjunction to make sure outdated date is expired."
Amazon Elasticache	"[Help] Issue creating Cache Cluster
Hi,

I created cache.m1.small Cache Cluster with 1 node ( as described in Getting Started guide). 
The cluster is still getting provisioned from last 30 minutes (as of writing this). 
Please help!!"
Amazon Elasticache	"Re: [Help] Issue creating Cache Cluster
Apologies for the delay in provisioning your cluster. We are currently experiencing delays in processing provisioning requests and other cache cluster management operations for Amazon ElastiCache in the US-EAST-1. We are working to resolve the issue. 

Up-to-date status will be posted on the status dashboard at 
http://status.aws.amazon.com/"
Amazon Elasticache	"Re: [Help] Issue creating Cache Cluster
Hi mohitsethi,

I just sent you a PM regarding your Cache Cluster. 

Best,

Matt T."
Amazon Elasticache	"Re: [Help] Issue creating Cache Cluster
Hi, 

We wanted to let you know that the issue has now been resolved.  The service is operating normally.  

Matt T.

Edited by: MattT@AWS on Sep 18, 2011 3:02 PM"
Amazon Elasticache	"Re: [Help] Issue creating Cache Cluster
Well, i can now  see cluster provisioned under my account. 

Thanks , Shyam, Matt."
Amazon Elasticache	"Elastic Load Balancer for ElastiCache cluster
Is there any plans for supporting Amazon ELB for ElastiCache cluster ? Also what options do we have to utilize auto scaling for  ElastiCache cluster."
Amazon Elasticache	"Re: Elastic Load Balancer for ElastiCache cluster
If part of your goal is to get a single URL for interacting with the cache cluster then you should add your support for this Proxy URL request: https://forums.aws.amazon.com/thread.jspa?threadID=74852&tstart=0. I'm pretty sure Autoscale will be coming shortly since there are already cloudwatch metrics."
Amazon Elasticache	"Does IP change when a replacement node is brought up?
Hi, in the case one of the nodes fails and needs to be replaced, it's to my understanding that the new node will have the same DNS name as the failed node, but will the IP address stay the same?

The reason I'm asking is that the .Net memcached client we're using - Enyim - works with IP addresses rather than DNS names.

Thanks,"
Amazon Elasticache	"Re: Does IP change when a replacement node is brought up?
http://aws.amazon.com/elasticache/faqs/#How_do_I_migrate
http://aws.amazon.com/elasticache/faqs/#How_does_Amazon_ElastiCache_respond_to_Cache_Node_failure"
Amazon Elasticache	"Re: Does IP change when a replacement node is brought up?
Thank you D. Svanlund for posting those links. Here is some additional information that may be helpful.

Amazon ElastiCache will ensure that the DNS name of a Cache Node is unchanged when Cache Nodes are recovered in case of failure; however, the underlying IP address of the cache node can change. Our recommendation is to frequently resolve the DNS names, as outlined in the Amazon ElastiCache User Guide (http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/ConfiguringClients.html). 

If you have memcached clients that cache IP addresses, you may need to either use a different memcached client, or come up with a solution to force the client to resolve DNS names again (which may involve reloading the entire client in your code).

In addition, some Memcached libraries will stop using a server (Cache Node) indefinitely if they encounter communication errors or timeouts with that server. If you associate an SNS topic with your Cache Cluster, when the new Cache Node is configured and ready to be used, Amazon ElastiCache will send an SNS notification to let you know that Cache Node recovery occured. This allows you to optionally arrange for your applications to force the Memcached client library to attempt to reconnect to the repaired Cache Nodes."
Amazon Elasticache	"cannot enable security group, keeps revoking it
I am trying to add an ec2 security group to the elasticache security group, but when i enter in a valid security group and amazon acct id it first says ""authorizing"" and then after a few moments it says ""revoking""... And then I'm back to square one, owning and paying for a non-functional elasticache node...

Is this a bug? Or is there something about the ec2 security group that isn't right? Or what? There's no diagnostics or anything to tell me what's going on..."
Amazon Elasticache	"Re: cannot enable security group, keeps revoking it
ah... you have to use the EC2 Security group NAME not the Group Id ...

Amazon: Clarify the instructions on that page to say this... it's not clear...

Also: the amazon account id requires that it be 12 characters, though the account id displayed in one's account page is separated with hyphens: it would be nice if one could cut/paste the hyphenated version of the account id..."
Amazon Elasticache	"Re: cannot enable security group, keeps revoking it
Thanks for your feedback. We have noted down both the issues you raised:  Clarifying the Security group name and allowing hyphenated account IDs.

-Pavan"
Amazon Elasticache	"Hit Rate and/or Hit % metric
Should I post here, or CloudWatch?  I'm testing ElasticCache in my dev environment, and knowing hit rate (or hit %) much more valuable to know than raw gets vs. hits..."
Amazon Elasticache	"Re: Hit Rate and/or Hit % metric
Thanks for the feedback. We have noted down your input and will consider it for our future road map planning.

-Pavan"
Amazon Elasticache	"Connecting Errors Timeouts (110) and Operation now in progress (115)
I am getting memcache.connect timeouts and Operation now in progress  how is this?  Do I have to have cached servers in each server zone?  

We have two webservers zone b1 and c1 the memcache server is in zone b1.

Operation now in progress (115)
2011/08/25 20:51:56 [error] 5981#0: *573318394 FastCGI sent in stderr: ""PHP Notice:  Memcache::connect() [<a href=""#"">memcache.connect</a>]: Server cache-1.rgnsm5.0002.use1.cache.amazonaws.com (tcp 11211, udp 0) failed with: Operation now in progress (115) in /mnt/web_data/html/include/memcache.php on line 13


Well I forgot to post this and we decided to try putting a memcache instance in each zone.  The logs so far seem to have errors in zone b1 but not c1...

Maybe there is an issue with b1...

Edited by: surgedirect on Aug 26, 2011 6:47 AM

b1 still getting connect issues and none so far on c1

Edited by: surgedirect on Aug 26, 2011 6:53 AM

b1 88 connect errors
c1 0

Edited by: surgedirect on Aug 26, 2011 7:36 AM

I am also seeing mysql connect errors... Is b1 having issues? (EAST) No mysql issues on c1.

Edited by: surgedirect on Aug 26, 2011 7:46 AM

748 from b1
0 from c1
I am going to push everything to c1 and test that out.

Edited by: surgedirect on Aug 26, 2011 10:04 AM

Well looks like the connect errors are gone as of now.   So I guess b1 is having issues.  Maybe someone from amazon can help us out 

Edited by: surgedirect on Aug 26, 2011 11:50 AM

So any amazon people.... feel free to chime in... we pay like 2-3K a month is server cost here 

Edited by: surgedirect on Aug 29, 2011 8:05 AM"
Amazon Elasticache	"is there an SLA for Elasticache
Given that it is in beta - not sure if there is a supporting SLA? Please let me know. 

Thanks!"
Amazon Elasticache	"Re: is there an SLA for Elasticache
In my experience, an SLA is not available for beta services. It is usually introduced when leaving the beta state. This was the case for CloudFront and Route 53."
Amazon Elasticache	"Can't connect to ElasticCache from EC2 instances in another region?
Hi,

Am I right in assuming that when you enter your EC2 security group information to be authorized in the Cache Security Group, that it only includes security groups within the same region? (i.e. only US East at the moment since ElasticCache is only available there)

I can't seem to get it to work with security groups outside of US East.  Hopefully there is a way around this?

Any idea when ElasticCache will be rolled out to the other regions (US West in particular)?

Cheers,
Kelly."
Amazon Elasticache	"Re: Can't connect to ElasticCache from EC2 instances in another region?
As you have noticed, ElastiCache is currently available in US East. According to the documentation, access can be granted using security groups only. Security groups work at the region level. It is currently not possible to use ElastiCache outside of that particular region. In the announcement, AWS said this service will be available in other regions in the coming months."
Amazon Elasticache	"Re: Can't connect to ElasticCache from EC2 instances in another region?
Thanks.  I was guessing security groups only worked at region level but never read it anywhere explicitly, so I was hoping I had it wrong 

Hopefully ElasticCache gets rolled out to other regions soon."
Amazon Elasticache	"To confirm, for stable cluster changes...
... I'll need to do ""consistent hashing"" in my client, right?  By ""cluster changes"" I mean adding or removing nodes.  The problem/solution is better stated in articles like:

http://www.mikeperham.com/2009/01/14/consistent-hashing-in-memcache-client/
http://www.last.fm/user/RJ/journal/2007/04/10/rz_libketama_-_a_consistent_hashing_algo_for_memcache_clients
http://blog.fedecarg.com/2008/12/24/memcached-consistent-hashing-mechanism/

But a quick summary (and FYI for people dipping their toes into the memory caching world), without implementing consistent hashing in your client code, adding/removing nodes will cause a massive storm of cache misses and disk hits, possibly grinding your site to a halt.

A guess a different way of confirming the same thing: are elasticache nodes nothing more than vanilla memcached servers?  

I do realize that they are vanilla++, in that they:
-are automatically tweaked for instance size
-automatically gather cloudwatch metrics
-automatically patch themselves
-on failure replace themselves with another memcache instance with the same DNS name"
Amazon Elasticache	"Re: To confirm, for stable cluster changes...
I guess you might have read about this in the AWS blog post. For other people ending up in this thread, it can be found under ""Client Libraries and Node Selection"".

http://aws.typepad.com/aws/2011/08/amazon-elasticache-distributed-in-memory-caching.html"
Amazon Elasticache	"Re: To confirm, for stable cluster changes...
No, I don't read the blog (but maybe I should start!).  I just knew of memcache cluster problems (in terms of scaling up and down dynamically) from personal experience, and was wondering if amazon solved it magically.   Based on the official docs, the answer seems to be no.  That blog post certainly confirms it   Though, they maybe should add a note to the official docs, as some people might blindly think they can scale their ElastiCache cluster without consequence."
Amazon Elasticache	"Can't sign up
Hey guys.  I log into my AWS management console, click on the ElastiCache tab and it says

""You must sign up for Amazon ElastiCache before you can use the Amazon ElastiCache Console. 
It's quick and free to sign up, just click the button below. ""

I click the button and it takes me to a page that says

""You already have access to Amazon ElastiCache""

Then when I go back to the AWS console and click on the ElastiCache tab, I get the same message as before."
Amazon Elasticache	"Re: Can't sign up
I have exactly the same problem. AWS guys, please look into this!
My account number is: 7104-7263-5043"
Amazon Elasticache	"Re: Can't sign up
This happened to me too.  I had to wait until I received a confirmation email before I could access ElastiCache in the management console.

-Michael"
Amazon Elasticache	"Re: Can't sign up
Same here....  Was really excited to try out elasticache."
Amazon Elasticache	"Re: Can't sign up
Apologies for the sign-up problems. We are looking into the issue and will update the thread as soon as we have more information.

Thanks,
Pavan"
Amazon Elasticache	"Re: Can't sign up
Just an update.  I just received an email confirmation and am now able to use ElastiCache.  And I don't know if it was coincidence or due to the fact that I needed to update my AWS payment information.  So if you guys are having trouble signing up, maybe check to see if your payment info is up to date."
Amazon Elasticache	"Re: Can't sign up
Thanks for the update. We reached out to customers having sign-up problems and some of them were due to invalid payment details. Please update the thread if you are still facing issues.

-Pavan"
Amazon Elasticache	"Re: Can't sign up
I am still not able to use the Elasticache. I updated my payment details, tried canceling and re-subsribing to the service, nothing helped."
Amazon Elasticache	"Re: Can't sign up
Update: I can use Elasticache now. Updating payment data seemed to help after all. Thanks."
Amazon Elasticache	"Replication
Is it possible to replicate the data stored in one node to all the nodes in the cache cluster? I have an usecase wherein I want a very small cache (500MB), but it should be available to many machines, so I want to replicate the cache over other nodes in the cluster so that I can query any node in the cluster for data."
Amazon Elasticache	"Re: Replication
https://forums.aws.amazon.com/thread.jspa?threadID=74831&tstart=0

Amazon ElastiCache does not perform/manage replication currently. Please refer to the 
""Setting up redundant Cache Clusters in different Availability Zones"" section of aws.amazon.com/elasticache for more information.

Setting up redundant Cache Clusters in different Availability Zones

Amazon ElastiCache monitors the health of your Cache Nodes and replaces them in the event of network partitioning, host hardware or software failure. However, given the ephemeral nature of a cache, Cache Node replacements begin empty (also called “cold”), and depending on your workload pattern, may take some time to be re-populated with data (also called “warming up”). Additionally, the auto-replacement functionality provided by Amazon ElastiCache is restricted to a single Availability Zone. If your application is sensitive to the failure recovery or the “warm up” time of Cache Nodes, or you want enhanced fault-tolerance for Availability Zone level failures, you may wish to deploy redundant ElastiCache Clusters in different Availability Zones.

One of the ways to manage data redundancy is to have your application apply all cache writes to Cache Nodes across these Availability Zones. If one or more of your Cache Nodes in the primary Availability Zone fails, you could direct reads to the corresponding Cache Node(s) in the secondary Availability Zone while Amazon ElastiCache restores the Cache Node(s) in the primary Availability Zone.


---

So this would need to be handled application side,"
Amazon Elasticache	"account id needed for elasticache security group, not displayed on console
In order to setup an elasticache security group an amazon account id is needed, but it's no longer displayed on the AWS Management Console.  It had been displayed up until recently.  So how can i get my account id?  I'm logged in of course to aws console but i don't see where it can be found.  Help!"
Amazon Elasticache	"Re: account id needed for elasticache security group, not displayed on console
I found it on the accounts page... never mind... (can't delete this question)..."
Amazon Elasticache	"Replication
Is Elasticache in any way replicated? If an instance fails, will the cache persist to its replacement instance?"
Amazon Elasticache	"Re: Replication
This type of caching is meant for information that can be rebuilt. It is not meant for persistant storage.

It is meant to provide you with information you already have somewhere else faster. If a node goes down the copy of the information is gone and you have to rebuild that part of the cache from your persistant storage.

Edited by: rbabe on Aug 23, 2011 10:36 AM"
Amazon Elasticache	"Re: Replication
Amazon ElastiCache does not perform/manage replication currently. Please refer to the 
""Setting up redundant Cache Clusters in different Availability Zones"" section of aws.amazon.com/elasticache for more information.



Setting up redundant Cache Clusters in different Availability Zones

Amazon ElastiCache monitors the health of your Cache Nodes and replaces them in the event of network partitioning, host hardware or software failure. However, given the ephemeral nature of a cache, Cache Node replacements begin empty (also called “cold”), and depending on your workload pattern, may take some time to be re-populated with data (also called “warming up”). Additionally, the auto-replacement functionality provided by Amazon ElastiCache is restricted to a single Availability Zone. If your application is sensitive to the failure recovery or the “warm up” time of Cache Nodes, or you want enhanced fault-tolerance for Availability Zone level failures, you may wish to deploy redundant ElastiCache Clusters in different Availability Zones.

One of the ways to manage data redundancy is to have your application apply all cache writes to Cache Nodes across these Availability Zones. If one or more of your Cache Nodes in the primary Availability Zone fails, you could direct reads to the corresponding Cache Node(s) in the secondary Availability Zone while Amazon ElastiCache restores the Cache Node(s) in the primary Availability Zone."
Amazon Elasticache	"Cannot telnet to cache node even after authorizing security group
Hello,

I have set up an ElastiCache cluster with 2 nodes. Also created an Amazon EC2 Linux instance in the same region and availability zone and assigned a certain EC2 security group to it. I also authorized the ""default"" security group of the cache cluster to be accessed from the same EC2 Security Group. After that I took an extra step of also rebooting both the cache cluster and the EC2 instance.

However, I am still unable to telnet from the EC2 instance to a node in the cache cluster since I get a timeout error.

ec2-user@ip-**-***-***-** ~$ telnet test*******.npz1rq.****.use1.cache.amazonaws.com
Trying **.**.**.***...
telnet: connect to address **.**.**.***: Connection timed out

I followed the steps mentioned in the Getting Started Guide for ElastiCache,

http://docs.amazonwebservices.com/AmazonElastiCache/latest/GettingStartedGuide/

Can you please tell me where I may be going wrong?

Thanks"
Amazon Elasticache	"Re: Cannot telnet to cache node even after authorizing security group
My bad.... had not appended the port  11211 after the telnet command...;)

Works now and am also able to run memcached commands!

Cheers"
Amazon Elasticache	"Re: Cannot telnet to cache node even after authorizing security group
see comment reply. had forgotten to add the telnet port at the end of the command."
Amazon Elasticache	"Timely Cached!
Thanks for the timely addition to the AWS family! 

Please add an Elastic Time Service for cloud-based scheduling soon."
Amazon Elasticache	"Re: Timely Cached!
That would be nice, with the posibility to submit a message to a SQS..."
Amazon Elasticache	"Telnet/Ping ElastiCache Instance
Hello,

I should be able to telnet in to my ElastiCache Instance, correct? I'm trying to do the following, but, am getting a connection timeout error:

telnet ***.cbzdoe.0001.use1.cache.amazonaws.com 11211


Am I missing something obvious?

Thanks,

Matt"
Amazon Elasticache	"Re: Telnet/Ping ElastiCache Instance
Matt,

When launching a new Cache Cluster, the default security group doesn’t have any authorizations unless you have already configured it explicitly.  You have to authorize the security group to allow traffic from your EC2 instances – take a look at http://docs.amazonwebservices.com/AmazonElastiCache/latest/UserGuide/index.html?USER_WorkingWithSecurityGroups.html.  You can grant this access from within the AWS ElastiCache console or using the CLI.

 Clay"
Amazon Elasticache	"Re: Telnet/Ping ElastiCache Instance
Ahha, that did the trick. Thank you very much!"
