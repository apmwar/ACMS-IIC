label	description
Amazon RDS	"RDS instances do not auto upgrade minor versions
Hi,

I have two RDS instances, both of which are currently running MariaDb 10.3.8. Both have ""Auto minor version upgrade"" configured to ""yes"", but neither have ever done an automatic upgrade. Currently, MariaDb 10.3.13 is available, but no automatic upgrades have happened or show any sign of happening soon.
I have seen the same (lack of) behaviour in 10.2.x as well as MySql instances I've had in the past.

If I do describe-pending-maintenance-actions, it outputs an empty list (even if I manually configure a change to be applied during the next maintenance window):
{
    ""PendingMaintenanceActions"": []
}


Is there anything else I have to do to activate this? Maybe something on the account level?"
Amazon RDS	"Re: RDS instances do not auto upgrade minor versions
This has been a misunderstood RDS feature for a very long time, and one that still doesn't reflect what many customers expect. While the expectation is that instances with AMVU allowed will be automatically updated to the latest minor version soon after its release, the actual usage is that periodically AWS will decide to apply a minor version to all applicable instances that allow AMVU.  So if you want your instances to stay updated with the latest minor version you will need to do it yourself, either manually or with a script you schedule to run periodically."
Amazon RDS	"M3/R3 Oracle instances support ending - What does this mean?
I received a notification stating that M3 and R3 instances for Oracle will no longer be supported later year:

After September 30, 2019, we will end the support of the db.m3 and db.r3 instance families on Amazon RDS Oracle.

But what exactly does that mean?  What will happen to M3 and R3 instances of RDS Oracle on that date?  Will they no longer function?"
Amazon RDS	"Re: M3/R3 Oracle instances support ending - What does this mean?
Bump.  Do I need to take action to keep M3 and R3 instances functioning after September 30?"
Amazon RDS	"Re: M3/R3 Oracle instances support ending - What does this mean?
Hopefully someone from the RDS Oracle will see this and comment, but they only tend to be in the forum intermittently.  Generally speaking, when support ends for a ""Previous Generation"" instance type you can either take manual action to migrate to a ""Latest Generation"" or ""Current Generation"" instance type, or RDS will auto-migrate you when support ends. But there are various parts of this process and it is unclear from your snippet what the process is here. Can you post the entire text of the notification (other than instance or customer-specific information of course)?

There are two big questions about any of these mandatory migrations that you need to look at. The first applies to everyone and it is the automatic vs manual move to a new instance type. In general a manual move is going to be better, certainly for production instances, since you can choose your exact timing and apply whatever testing and verification processes that make sense to you before changing instance types. The second question is are you still using EC2-Classic networking or are you in a VPC? The M3 and R3 are the last instance types available on RDS that support EC2-Classic networking, so there are no compatible current instance types to migrate them to. If you are still using EC2-Classic networking then you must migrate to a VPC before the end of M3 and R3 support.

I'm surprised by the end of support for M3 and R3, though that this is happening for RDS Oracle before other engine types is telling. Oracle tends to have narrow rules about what versions of Oracle database are supported on which versions of Oracle Linux, which in turn creates issues about support for underlying hardware by each version of Oracle Linux. As Oracle ends support for versions of various components it can become impractical or impossible to construct a supportable stack for older systems. There could be other reasons to drop instance support, but it has happened so rarely that I suspect something is forcing AWS' hand here."
Amazon RDS	"Pending maintenance not showing up?!
Via the console, I modified my SQL Server RDS instance (single-az to multi-az), and chose to have the modification applied during the next maintenance window. Despite this, when I clicked on the ""Maintenance & backups"" tab to check for my change, I saw ""none"" for Pending maintenance. 
Nothing shows up when I ran ""aws rds describe-pending-maintenance-actions,"" either.

Fortunately, the modified value did show up when I ran ""aws rds describe-db-instances.""

When my maintenance window arrived a few days later, my change was applied to my instance!

Why doesn't my pending maintenance show up in the console or via the cli?"
Amazon RDS	"Re: Pending maintenance not showing up?!
""Maintenance"" is when AWS must perform an operation on underlying resources. For example, when it must perform an operating system update, or migrate an instance off hardware that requires servicing. Modification requests that the user makes are not considered maintenance operations, though they are conducted during the next maintenance window unless requested to be done immediately. So you won't see changes you requested in the ""Pending Maintenance"" list.

https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.Maintenance.html"
Amazon RDS	"Cannot delete RDS backups
Hello,

I keep getting charged for a backup to an RDS database I deleted but I can't even find the backup.  Here is the message I receive under my bills

South America (Sao Paulo)
Amazon Relational Database Service Backup Storage $0.04
$0.095 per additional GB-month of backup storage exceeding free allocation
0.398 GB-Mo$0.04

When I login to South America (Sao Paulo) it says that RDS backups aren't available in that region.  How do I delete the backup storage for this?  The amount keeps going up by a cent every few days.  I'm not that concerned about the cost.  However, it is frustrating being charged for a service when I can't delete it.  I'm wondering if I need to delete the Amazon account and create a new one.

Thanks"
Amazon RDS	"Postgres Migration 10.6 -> 11.1:  ""permission denied for schema public""
We have increased our storage from 600GB to 1 TB and migrated from Postgres 10.6 to 11.1.
After the migration all the Postgres roles including the master role cannot access objects in the public schema any more. 
E.g.:
select * from public.spatial_ref_sys;

results in 42501 ERROR: permission denied for schema public

This query executed as master shows false for create and usage permissions:
WITH ""names""(""name"") AS (
  SELECT n.nspname AS ""name""
    FROM pg_catalog.pg_namespace n
      WHERE n.nspname = 'public'
) SELECT ""name"",
  pg_catalog.has_schema_privilege(current_user, ""name"", 'CREATE') AS ""create"",
  pg_catalog.has_schema_privilege(current_user, ""name"", 'USAGE') AS ""usage""
    FROM ""names"";


I have tried
GRANT ALL ON DATABASE dwh TO master;
 which is executing without errors. But
GRANT ALL ON SCHEMA public TO master;
 would result in permission denied error.

Does anyone have an idea, how this can be resolved?"
Amazon RDS	"Re: Postgres Migration 10.6 -> 11.1:  ""permission denied for schema public""
Hello,

Can you try running the following first as a role that has rds_superuser:

ALTER SCHEMA public OWNER to master;


And if that resolves your issue?

Thanks!
John H

Edited by: awsatjohnh on Apr 12, 2019 6:15 PM"
Amazon RDS	"RDS Replica stopped working with secure-file-priv error
---

Edited by: Wolfi8 on Jan 24, 2019 5:59 AM"
Amazon RDS	"Re: RDS Replica stopped working with secure-file-priv error
Hello Wolfi8,

I found your read replicas and changed the secure-file-priv parameter on the back-end to allow LOAD DATA INFILE statements to successfully replicate in RDS MySQL 5.7.23. Please reboot your instances and send me a private message if you still experience the issue or have other replicas that needs the same configuration change.

Note, that the change in question only applies to your existing RDS MySQL 5.7.23 replicas. New replicas will not have the same configuration change. We are aware of this breaking behavior in 5.7.23 and are working on a more permanent solution.

Additionally another workaround is to enable row-based replication by creating a custom parameter group for your master and setting binlog_format = ROW.

Regards,
Jaime"
Amazon RDS	"Re: RDS Replica stopped working with secure-file-priv error
Hi

We're experiencing the same issue on our MySQL replica.

Can you please perform the fix on our account?

Kind regards,
Dan"
Amazon RDS	"Re: RDS Replica stopped working with secure-file-priv error
Hello danhunt,

I applied the same fix on your 5.7.23 replica a few weeks ago and I believe your Solution Architect communicated this to you. Please send me a private message if there are any additional issues or new replicas that need the fix.

Regards,
Jaime"
Amazon RDS	"Re: RDS Replica stopped working with secure-file-priv error
Hi,

Same issue here MYSQL replication breaks with LOAD DATA, i've setup binlog_format = ROW and the problem persists.

Can you change secure_file_priv?

Best regards,"
Amazon RDS	"Re: RDS Replica stopped working with secure-file-priv error
Hello lsvbparts,

I applied a fix onto your replica. Please see the private message I sent with more details.

Regards,
Jaime"
Amazon RDS	"Re: RDS Replica stopped working with secure-file-priv error
Will upgrading to 5.7.24 or 25 fix this issue?   I am seeing the same problem on one of our test instance read replicas.

Edited by: jrule on Mar 27, 2019 5:02 PM"
Amazon RDS	"Re: RDS Replica stopped working with secure-file-priv error
Dear Jaime,

The replica was working fine, but since today we're experience the same issue.

Could you please help? Our replica is showing replication error.

Thank you"
Amazon RDS	"Add pg_cron to RDS Postgres extensions.
We rely on pg_cron for scheduled db jobs on most of our applications. It would be great if RDS Postgres supported it."
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
Can you add more details on what jobs are you expecting to run in the jobs? 
Can they be executed from a client (EC2 based cronjob using psql)?

Regards,
Jignesh"
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
Speaking for my own organization:
 • stats aggregation
 • log table truncation, dropping off older entries
 • refreshing materialized views
 • creating new table partitions by date range

To set up in MySQL, you would CREATE EVENT. This keeps database housekeeping in the database without outside and more complex dependencies like CloudFormation schedules or a separate dedicated EC2 host with a cron daemon running. pg_cron would allow for a similar level of flexibility and convenience in PostgreSQL that is already enjoyed by its MySQL counterpart in the RDS/Aurora family of products."
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
Hi Jignesh,

This would be a great feature for RDS. Yes, crons can be run from outside rds and use a client to connect but pg_cron reduces the infrastructure overhead (the need to deploy and maintain separate containers to run trivial scheduled queries for example)

Cheers"
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
Pg_cron is one of the feature that is in pipeline and should be available in RDS in future. Currently, there is no estimated date when this feature will be available because pg_cron needs to be tested thoroughly before making it available for customer.

Meanwhile, you could use crontab from EC2 Linux instance until this feature is available in RDS."
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
AWS Support,
Do we have any update on this ? 
what are the options we have in order to schedule a job to be executed automatically on a schedule?
Looking for alternative of MS SQL Server Agent-Job

Thanks"
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
+1 would love this feature"
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
Just an FYI that there is a AWS Database Blog entry describing how to replace SQL Server Agent Jobs with AWS Step Functions. https://aws.amazon.com/blogs/database/replace-sql-server-agent-job-with-aws-step-functions/"
Amazon RDS	"Re: Add pg_cron to RDS Postgres extensions.
Hello,
pg_cron would be very much appreciated by the community of RDS postgres users I believe.
Workarounds are welcome if there are no better solutions, but it does not seem like anything comes close to the user-friendly options pg_cron offers and given the fact that it only requires an extension to be installed there is little interest in using a workaround!
Regards

@AWS Support, any update of status/plans maybe?

Edited by: aber on Apr 11, 2019 11:55 PM"
Amazon RDS	"RDS Aurora High CPU load
Hi,
We are having problems with an RDS Instance where the CPU load suddenly spiked about 2 hours from now. We haven't been able to get it down.

We've tried to follow this, but cannot find anything suspicious right now.
Can any AWS employees check the instance for us to see what is wrong?

Regards,
Eirik"
Amazon RDS	"Re: RDS Aurora High CPU load
What version and type (PostgreSQL or MySQL) of Aurora are you using ?
Both types of Aurora support Performance Insights (PI) though on the MySQL type PI is limited to certain versions.
If you enable PI, you will be able to see what SQL is putting CPU load on the database.
Here is a quick demo of PI on Aurora PostgreSQL:
https://www.youtube.com/watch?time_continue=6&v=yOeWcPBT458

Kyle"
Amazon RDS	"Aurora MySQL cluster showing no events
I have an Aurora MySQL cluster in RDS with two instances (along with a staging cluster with single instance) but RDS is showing no events in the console or CLI.
$ aws rds describe-db-clusters --db-cluster-identifier prod-cluster
{
    ""DBClusters"": [
        {
            ""MasterUsername"": ""..."", 
            ""ReaderEndpoint"": ""..."", 
            ""HttpEndpointEnabled"": false, 
            ""ReadReplicaIdentifiers"": [], 
            ""VpcSecurityGroups"": [
                {
                    ""Status"": ""active"", 
                    ""VpcSecurityGroupId"": ""...""
                }
            ], 
            ""CopyTagsToSnapshot"": false, 
            ""HostedZoneId"": ""..."", 
            ""EngineMode"": ""provisioned"", 
            ""Status"": ""available"", 
            ""MultiAZ"": true, 
            ""LatestRestorableTime"": ""2019-04-11T16:26:44.252Z"", 
            ""PreferredBackupWindow"": ""06:00-06:30"", 
            ""DBSubnetGroup"": ""default"", 
            ""AllocatedStorage"": 1, 
            ""BackupRetentionPeriod"": 7, 
            ""PreferredMaintenanceWindow"": ""fri:03:25-fri:03:55"", 
            ""Engine"": ""aurora-mysql"", 
            ""Endpoint"": ""..."", 
            ""AssociatedRoles"": [], 
            ""EarliestRestorableTime"": ""2019-04-04T06:07:29.128Z"", 
            ""IAMDatabaseAuthenticationEnabled"": true, 
            ""ClusterCreateTime"": ""2018-09-19T15:10:30.288Z"", 
            ""EngineVersion"": ""5.7.12"", 
            ""EnabledCloudwatchLogsExports"": [
                ""audit"", 
                ""error"", 
                ""general"", 
                ""slowquery""
            ], 
            ""DeletionProtection"": true, 
            ""DBClusterIdentifier"": ""prod-cluster"", 
            ""DbClusterResourceId"": ""cluster-..."", 
            ""DBClusterMembers"": [
                {
                    ""IsClusterWriter"": false, 
                    ""DBClusterParameterGroupStatus"": ""in-sync"", 
                    ""PromotionTier"": 1, 
                    ""DBInstanceIdentifier"": ""prod""
                }, 
                {
                    ""IsClusterWriter"": true, 
                    ""DBClusterParameterGroupStatus"": ""in-sync"", 
                    ""PromotionTier"": 1, 
                    ""DBInstanceIdentifier"": ""prod-us-east-1d""
                }
            ], 
            ""DBClusterArn"": ""arn:aws:rds:us-east-1:...:cluster:prod-cluster"", 
            ""StorageEncrypted"": true, 
            ""DatabaseName"": ""level"", 
            ""DBClusterParameterGroup"": ""prod-rds"", 
            ""AvailabilityZones"": [
                ""us-east-1c"", 
                ""us-east-1d"", 
                ""us-east-1a""
            ], 
            ""Port"": 3306
        }
    ]
}


However absolutely no events: 
$ aws rds describe-events
{
    ""Events"": []
}


Anyone have any ideas what could be going on?"
Amazon RDS	"Aurora Instance Restarts on large queries
Hi,

tl;dr: We have two aurora instances running. One of the instances frequently restarts citing memory errors whenever a specific large query is executed.  

Engine - Aurora 5.6.10a.31.19, Class - db.r3.large - 2 vCPU , 15 GB Ram

As mentioned above, we have two Aurora instances running (PR and DEV). We have identified a single query which when issued against the PR instance always causes the instance to reboot (we know this because the RDS error logs capture the same query every time). The incident is characterized by a rapid drop in freeable memory and a spike in cpu utilization before the instance restarts.

The query in question is about 3.3 MB in size. The query is issued by an ORM engine - so there is little we can do to tune it.  Every time the query is issued, Aurora restarts and an malloc() error is logged (see below).

We were unable to replicate the problem in our DEV instance. An larger version of the same query on the DEV instance returns an appropriate error code and error message (""1064, ""memory exhausted near.."" ). This never happens with our PR instance. 

I get that we can probably tune max_allowed_packet, but why is Aurora's query parser not gracefully returning an error code in our PR instance as it does on the DEV instance?  We have other applications running on other databases in this instance and we cannot have it bring down all our applications everytime. Any help is appreciated!

Error Log:
<jemalloc>: Error in malloc(): out of memory
05:29:47 UTC - mysqld got signal 6 ;
This could be because you hit a bug. It is also possible that this binary
or one of the libraries it was linked against is corrupt, improperly built,
or misconfigured. This error can also be caused by malfunctioning hardware.
We will try our best to scrape up some info that will hopefully help
diagnose the problem, but since we have already crashed, 
something is definitely wrong and this may fail.

key_buffer_size=16777216
read_buffer_size=262144
max_used_connections=110
max_threads=1000
thread_count=93
connection_count=93
It is possible that mysqld could use up to 
key_buffer_size + (read_buffer_size + sort_buffer_size)*max_threads = 542446 K bytes of memory
Hope that's ok; if not, decrease some variables in the equation.

Thread pointer: 0x2ac905092000
Attempting backtrace. You can use the following information to find out
where mysqld died. If you see no messages after this, something went
terribly wrong...
stack_bottom = 2ac6bc7c8c18 thread_stack 0x40000
/rdsdbbin/oscar/bin/mysqld(my_print_stacktrace+0x2c)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(handle_fatal_signal+0x6a6)https://forums.aws.amazon.com/
/lib64/libpthread.so.0(+0xf5b0)https://forums.aws.amazon.com/
/lib64/libc.so.6(gsignal+0x39)https://forums.aws.amazon.com/
/lib64/libc.so.6(abort+0x148)https://forums.aws.amazon.com/
/rdsdbbin/oscar/lib/libjemalloc.so(malloc+0x52c)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(my_malloc+0x25)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(alloc_root+0x8f)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z10sql_memdupPKvm+0x15)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_ZN11QUICK_RANGEC2EPKhjmS1_jmj+0x4c)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x1f8)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x2e3)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x4a)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x277)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x2e3)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z14get_quick_keysP5PARAMP18QUICK_RANGE_SELECTP11st_key_partP7SEL_ARGPhjS7_j+0x2e3)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z16get_quick_selectP5PARAMjP7SEL_ARGjjP11st_mem_root+0x12b)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_ZN9TRP_RANGE10make_quickEP5PARAMbP11st_mem_root+0x25)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_ZN10SQL_SELECT17test_quick_selectEP3THD6BitmapILj64EEyybN8st_order10enum_orderE+0x25d5)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqldhttps://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_ZN4JOIN8optimizeEv+0x878)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z12mysql_selectP3THDP10TABLE_LISTjR4ListI4ItemEPS4_P10SQL_I_ListI8st_orderESB_S7_yP13select_resultP18st_select_lex_unitP13st_select_lex+0x21f)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z13handle_selectP3THDP13select_resultm+0x127)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqldhttps://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z30mysql_execute_command_internalP3THD+0x38a7)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z21mysql_execute_commandP3THD+0x30)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z11mysql_parseP3THDPcjP12Parser_state+0x3b8)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_Z16dispatch_command19enum_server_commandP3THDPcj+0xf1c)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_ZN22OscarSchedulerConsumer7consumeEjj+0x87)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_ZN22OscarSchedulerConsumer5startEv+0xa0)https://forums.aws.amazon.com/
/rdsdbbin/oscar/bin/mysqld(_ZN22OscarSchedulerConsumer11drain_queueEPv+0x6a)https://forums.aws.amazon.com/
/lib64/libpthread.so.0(+0x7f18)https://forums.aws.amazon.com/
/lib64/libc.so.6(clone+0x6d)https://forums.aws.amazon.com/

Edited by: Pras-gd on Feb 24, 2017 8:47 AM"
Amazon RDS	"Re: Aurora Instance Restarts on large queries
Hello Pras-gd, 

Apologizes for reply taking this long. Is the issue still present? Could you please get back to us with a Private Message and provide your account ID, region and an instance name? We'll have someone on the team to have a look at this.

Hope this helps, 
Aurora team"
Amazon RDS	"Re: Aurora Instance Restarts on large queries
Alex,

I have sent you a private message with information.

Thanks
Anand"
Amazon RDS	"Re: Aurora Instance Restarts on large queries
Hello analogGD,

Thank you for the provided details. We're going to have a look and get back to you as soon as we can, some more information might be required regarding a query which causes these crashes.

Aurora Team"
Amazon RDS	"Re: Aurora Instance Restarts on large queries
Hi, I am having the same issue. Have you found the root cause of this error?"
Amazon RDS	"Re: Aurora Instance Restarts on large queries
Hello Eysa, 

Is the still an issue ? Could you please get back to us with a Private Message and provide your account ID, region and an instance name?"
Amazon RDS	"Re: Aurora Instance Restarts on large queries
I am also having similar issue with my Aurora RDS instance crashing with error :

Available memory is low. Trying to avoid OOM crash:  system KB: 62920240  available KB: 590824  low-threshold KB: 3146012  decline query: no  tune caches: no  kill query: no  kill connection: no
<jemalloc>: Error in mmap(): err: 12, msg: Cannot allocate memory
<jemalloc>: Error in mmap(): err: 12, msg: Cannot allocate memory
<jemalloc>: Error in malloc(): out of memory
<jemalloc>: Error in malloc(): out of memory
<jemalloc>: Error in mmap(): err: 12, msg: Cannot allocate memory
<jemalloc>: Error in malloc(): out of memory
<jemalloc>: System-wide: MemTotal: 62920240kb, MemFree: 504032kb, Buffers: 240kb, Cached: 151932kb, Active: 17587744kb, Dirty: 512kb, Inactive: 96kb, Mapped: 64464kb
<jemalloc>: terminating process due to out of resources
<jemalloc>: System-wide: MemTotal: 62920240kb, MemFree: 499396kb, Buffers: 236kb, Cached: 154420kb, Active: 17591052kb, Dirty: 244kb, Inactive: 940kb, Mapped: 66988kb
<jemalloc>: terminating process due to out of resources
<jemalloc>: System-wide: MemTotal: 62920240kb, MemFree: 504032kb, Buffers: 240kb, Cached: 151932kb, Active: 17587744kb, Dirty: 512kb, Inactive: 96kb, Mapped: 64464kb"
Amazon RDS	"Re: Aurora Instance Restarts on large queries
Having the same issues please provide ticket support to AWS"
Amazon RDS	"Aurora Serverless Current Units Capacity of CPU
How to query the current capacity units of CPU usage using AWS CLI in Aurora serverless database?"
Amazon RDS	"RDS Multi-AZ Instance CF Error
Can anyone help me with deploying a MultiAZ RDS Instance?
I have created a Subnet Group with 2 Subnets (in different AZ's), if I create a MultiAZ RDS Instance using the web console, it creates fine. However if I try deploying using CloudFormation passing in the same subnet group I get the following error:
Cannot create a db.t3.small Multi-AZ instance because at least 2 subnets must exist in availability zones with sufficient capacity for VPC and storage type : standard for db.t3.small, so 1 more must be created in other availability zones

If I create another Subnet Group with subnets from 3 AZ's, I can deploy via CF. But.. What if I want to deploy into a region with only 2 AZ's? (e.g. Canada).
I have also tried using different instance types in case one region was exhausted of instance types (even though they create through the Web Console).

The A and B subnets are as follows:
ap-southeast-2a (apse2-az1), Available IPv4 Addresses: 246
ap-southeast-2b (apse2-az3), Available IPv4 Addresses: 247

I have attached my CF Template (cut down to try troubleshoot, removed replicas etc). If I pass in the exact same params except one, the RDS instance being created with DataBaseMultiAZ=false deploys, the one with DataBaseMultiAZ=true fails as per the above italicized message."
Amazon RDS	"Re: RDS Multi-AZ Instance CF Error
Update: It seems making a Subnet Group with only 2 subnets, but this time in Availability Zones A (ap-southeast-2a (apse2-az1)) and C (ap-southeast-2c (apse2-az2)) works. Something seems dodgy with Availability Zone B (ap-southeast-2b (apse2-az3))."
Amazon RDS	"IAM RDS Token Auth only working sometimes
I'm encountered an issue that I've pretty much slammed my head against for a solid day or so. I enabled token based auth for our RDS instances. For testing reasons when I went about enabling I took a snapshot from an already existing db (let's call it db1). 

With db1's snapshot I created db2. 

Within db2 I created a user for token access and opened proper grants.
I created the IAM reference to that user and db2.
I enabled Token based auth on db2. 

When testing this works great. I am able to log in with multiple accounts.

Fast forward to the next day, I go to implement the same steps on db1. 
After creating the proper user in the db, after ensuring the db reference maps in IAM
and after enabling token based auth on db1 I cannot connect.

I thought maybe this was specific to the instance so I started to test other `devel` type DBs and none of them worked.

I decided to make another test instance off of another currently running db's snapshot (let's call it db3). 

I created db4 off of that db3 snapshot. Went thru all of the steps and this works. 
I am able to log in fine with token based auth.

To conclude, it seems like I can use this token based auth on any new DB I spin up off of a snapshot, but enabling it on current DBs does not work. I have tried a reboot and a stop/start for sanity reasons after enabling to no avail. 

I'm pretty stuck at this point and wondering if there is something that's not obvious?"
Amazon RDS	"Re: IAM RDS Token Auth only working sometimes
This was alleviated by doing a minor version upgrade on all currently running DBs. Why this was required is still beyond us. it seems like only newer DBs 2019+ work with the token auth despite matching mysql versions across our dbs. If you have a similar issue where you have long running older DBs (even if on the proper version) consider doing a minor upgrade."
Amazon RDS	"RDS Postgres Tablespaces - Opinions Sought
Hello All,

I've come to Postgres from a strong Oracle background, and am seeking some insights with respect to tablespaces and planning them.

I'm aware that in RDS, the tablespace files are written to the same EBS volume, so there's nothing to be gained from segregating storage to separate mountpoints. Having said this, I still feel it might be a useful exercise from a schema management perspective/logical separation of schema data at disk folder level. Based on the reading I've done, I've found the following Stackoverflow post, which shows it can be done:

https://stackoverflow.com/questions/39616672/create-tablespace-on-postgresql-rds

However, opinion does seem to be divided on this, with some leaning towards just storing all table data in the pg_default tablespace on RDS Postgres instances. In the AWS documentation, referenced below, the only guidance I can find regarding tablespaces is this:

""Tablespaces are supported in PostgreSQL on Amazon RDS for compatibility; since all storage is on a single logical volume, tablespaces cannot be used for IO splitting or isolation. We have benchmarks and practical experience that shows that a single logical volume is the best setup for most use cases.""

https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_PostgreSQL.html#PostgreSQL.Concepts.General.FeatureSupport.Tablespaces

The above kind of implies there is no point using tablespaces on new databases, and I may as well just use pg_default. I just wondered if any forum readers have any strong opinions here?

Thanks in anticipation"
Amazon RDS	"Aurora MySQL and PCI compliance
Hello there,

As we are currently using Amazon Aurora and I noted the version of MySQL within there are fixed (5.6.10a and 5.7.12 if I am not mistaken), could I get confirmed that listed MySQL vulnerabilities for these version actually DO NOT impact on PCI compliance and a properly updated Aurora database will always be PCI compliant (if properly configured of course as per the shared responsibility model).

I would like to validate this for both versions, Aurora MySQL 5.6 and Aurora MySQL 5.7. As we are running some security assessment our consultant came back with a list of vulnerabilities impacting these versions of MySQL and if Aurora is actually impacted, we would want to revert back to MySQL or other database engines.

Thanks in advance."
Amazon RDS	"Re: Aurora MySQL and PCI compliance
To be more specific on my enquiry, I would like to ensure those vulnerabilities are actually not applicable to Aurora."
Amazon RDS	"Deleting Read replica stuck
Figured out

Edited by: cmuench on Apr 10, 2019 6:23 AM"
Amazon RDS	"incompatible-restore: your MySql memory setting is inappropriate for the us
Hi, we've been unable to use `create-db-instance-read-replica` in our main RDS MySQL 5.6.39 database for a few days.

We've used it reliably for years and do it weekly, but starting this week it has consistently failed to produce a replica. The instance created by the API call lands on the ""incompatible-restore"" state. This is what we see:


Summary > Info

    * Incompatible-restore

Logs & Events > Recent events

    * Database instance put into incompatible-restore. Your MySql memory setting is inappropriate for the usages

We haven't found anyone reporting this specific scenario, only a thread mentioning ""memory setting is inappropriate"" for Aurora, but with ""incompatible-parameters"", not ""incompatible-restore.""

We found this thread https://forums.aws.amazon.com/thread.jspa?messageID=537144 for a different ""incompatible-restore"" scenario with pointers to:


Temporary tables: We don't have any long-running sessions that could be clinging on to temporary tables (from querying sys.session) nor any MEMORY tables listed in `information_schema.TABLES`.
MyISAM: We don't have any MyISAM tables outside the mysql/information_schema Table Schemas


Someone also jumped in there to say they managed to clone some time later, but we've been trying for 3 days with no success.

I'd love some help understanding what's happening or pointers into how I could dig further and solve this problem.

ps: the instance is `temp-staging-reports-replica`

Edited by: julianobsnri on Mar 29, 2019 12:24 PM"
Amazon RDS	"Re: incompatible-restore: your MySql memory setting is inappropriate for the us
Having exactly the same problem. In one account where we had this issue the first time it started working somehow after a few days/tries. Setting up a secondary account now with the same setup and issues are back.

Did you by any chance create the RDS and removed it again, then recreated it? The Logs&Events tab show some DB info from days before even though I just created the database. Also changing the name makes it deploy with no issues. Seems that the replica technology does not clean up well.

Also, see this post over at stackexchange:

https://dba.stackexchange.com/questions/233717/mysql-rds-incompatible-restore-while-creating-read-replica"
Amazon RDS	"Re: incompatible-restore: your MySql memory setting is inappropriate for the us
Did you by any chance create the RDS and removed it again, then recreated it?

Yeah, we do this every week and have been doing so for more than a year.

Also, see this post over at stackexchange:

Thanks, I will test different params later this week. I hope they don't have to be set on the primary because doing that for our scenario is pretty risky."
Amazon RDS	"Re: incompatible-restore: your MySql memory setting is inappropriate for the us
Hello julianonri,

Can you please attempt another read replica creation and send me a private message if it fails? We recently deployed a change that should allow you to create read replicas again without the instance being placed into incompatible-restore due to memory settings.

Regards,
Jaime"
Amazon RDS	"Re: incompatible-restore: your MySql memory setting is inappropriate for the us
I can confirm we can successfully create read replicas again =]"
Amazon RDS	"RDS > Create Event Subscription : UI does not load
AWS Console does not load RDS > Event Subscriptions > ""Create event subscription"" view. It happens in Chrome/Firefox in public/private mode. The same functionality works (in the same browser) for another AWS account that I own."
Amazon RDS	"Re: RDS > Create Event Subscription : UI does not load
I can confirm that you are definitely right: this wasn't isolated to your account, but constituted a wider situation instead. Our internal teams were already aware about this and they have already fixed this condition and the service is operating normally."
Amazon RDS	"max_wal_senders invalid setting
Hi guys, 

We have a single Postgresql 10 rds instance replicating to another instance and haven't changed any default parameters
We had a brief outage on Sunday, looking at the event logs on the main server we see the following:

Sun, 10 Mar 2019 13:11:11 GMT   Recovery of the DB instance has started. Recovery time will vary with the amount of data to be recovered.
Sun, 10 Mar 2019 13:15:27 GMT   The parameter max_wal_senders was set to a value incompatible with replication. It has been adjusted from 10 to 15.
Sun, 10 Mar 2019 13:16:01 GMT   Recovery of the DB instance is complete.
Sun, 10 Mar 2019 13:16:28 GMT   The parameter max_wal_senders was set to a value incompatible with replication. It has been adjusted from 10 to 15.
Sun, 10 Mar 2019 13:16:31 GMT   DB instance restarted

I'm not entirely sure from this what the cause of the outage was... looking at the default parameters our max_wal_senders is set to 10 still

Does anyone have any ideas how a) i can work out what happened? and b) if 10 is actually a valid value for that setting?

thanks!

Dan"
Amazon RDS	"Re: max_wal_senders invalid setting
Message: ""The parameter max_wal_senders was set to a value incompatible with replication. It has been adjusted from 10 to 15."",""

Please be assured the above message is a known message when an RDS instance is restarted, this event is harmless and has no performance impact on the instance. Kindly note that the internal team is aware of this event occurrence and is working on rolling out a fix. 
Hence, currently, there is no requirement of setting up the above parameter and you can safely ignore this Warning message until the internal team rolls out a fix at the backend. 

Unfortunately, I do not have a valid ETA for when the fix will be rolled out by internal team, however please be assured that this message is harmless and it's level is ""Warning"" and no action is required from your end."
Amazon RDS	"Unable to upgrade RDS postgres instance from 9.5.15 to 9.6.11
Hi,
We are testing a RDS posgres upgrade from 9.5.15 to 9.6.11 and are running in the following error message when performing the upgrade:

Database instance is in a state that cannot be upgraded: PreUpgrade checks failed: The instance could not be upgraded because one or more databases have views or materialized views which depend on 'pg_stat_activity'. Please drop them and try again.

The upgrade is being performed with the following AWS cli command:

aws rds modify-db-instance \
  --apply-immediately \
  --allow-major-version-upgrade \
  --db-parameter-group-name ... \
  --engine-version ... \
  --db-instance-identifier ...

The problems appears to be that there are some views that are owned by rdsadmin that we cannot drop:

scp=> drop view pg_stat_activity;
ERROR:  must be owner of relation pg_stat_activity

Anyone run into this before or has some tips howto resolve it?"
Amazon RDS	"Re: Unable to upgrade RDS postgres instance from 9.5.15 to 9.6.11
Resolved via AWS technical support."
Amazon RDS	"Re: Unable to upgrade RDS postgres instance from 9.5.15 to 9.6.11
We are glad that AWS Premium Support was able to help you in upgrading the instance from 9.5.15 to 9.6.11."
Amazon RDS	"Aurora Read Replica Stuck in Creating State
I have a cross region read replica in eu-west-1 that is stuck in a ""Creating"" state for over 3 hours."
Amazon RDS	"Re: Aurora Read Replica Stuck in Creating State
Resolved after 5 hours..."
Amazon RDS	"Re: Aurora Read Replica Stuck in Creating State
We are glad that the aurora replica was finally created. Please reach out to AWS Premium Support in case of any further concerns."
Amazon RDS	"Copy snapshot in same region stuck at Creating 0%
I am trying to copy an unencrypted snapshot to an encrypted snapshot.  It has been stuck at ""Creating 0%"" for 7 hours.  I tried again but same results.

Thanks for any help you can provide."
Amazon RDS	"Re: Copy snapshot in same region stuck at Creating 0%
I am all set now.  It appears that the RDS snapshot functionality was backed up on that date.  Overnight all my stuck snapshots eventually completed successfully.  These took somewhere around 12-18 hours to complete.  However, the next day everything was fast again."
Amazon RDS	"Re: Copy snapshot in same region stuck at Creating 0%
Between Mar 7 9:07 PM and 11:33 PM PST we faced an issue due to which some of the customers experienced delayed snapshot creation in the US-EAST-1 Region. The issue has been resolved and the service is operating normally."
Amazon RDS	"Aurora with PostgreSQL -- ETA support for higher-memory instance classes?
Hi,

We're currently running on a db.r4.16xlarge for our primary Aurora for PostgreSQL instance.  I'm interested in when you will provide access to the next-generation instances such as r5.25xlarge (ballpark timeline).

Thank you for your time."
Amazon RDS	"Re: Aurora with PostgreSQL -- ETA support for higher-memory instance classes?
I understand that you wish to have a higher instance class, such as  r5.25xlarge for Aurora Postgres database. RDS Aurora team are working towards adding support for higher instance class in the future, however, I'm unable to provide an ETA.  Please keep an eye on the following page for product update announcements:

https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/WhatsNew.html
https://aws.amazon.com/new/#database-services"
Amazon RDS	"Connecting to PostgreSQL using boto3 Python
Hello,

I am trying to connect to PostgreSQL RDS using boto3 in python. The code I am using 

    client = boto3.client('rds-data',region_name=""us-east-1a"")
    response = client.execute_sql(
        awsSecretStoreArn='secret ARN',
        database=db_name,
        dbClusterOrInstanceArn='Instance ARN',
        schema='test',
        sqlStatements='select * from test_table'
    )
I am using the code provided in boto3 documentation. But I am getting the error EndpointConnection Error: Could not connect to the endpoint URL: ""https://rds-data.us-east-1a.amazonaws.com/ExecuteSql"".

can anyone please suggest how to connect to database using python. My endgoal is to deploy the code in lambda and use API Gateway to call the function.

The database accepts connections from all IP addresses.

Edited by: bxdemo on Apr 9, 2019 10:38 PM"
Amazon RDS	"Re: Connecting to PostgreSQL using boto3 Python
I got through the Endpointurl error by fixing the region. The console says availability zone as us-east-1a' but when I changed it to 'us-east-1'. The endpoint url worked. But now I am getting the BadRequestException for cluster id : arn:aws:rds:us-east-1:692303975045:db:sacmanagement . That is the ARN in the console and the documentation asks to use InstanceARN."
Amazon RDS	"Modifying an Amazon RDS DB Instance and first-touch penalties
Hello,

I was wondering how modifying an Amazon RDS DB Instance works internally. Is the old volume reused? Is a snapshot loaded from S3?

Namely, what I really want to know if changing the instance type lead to first-touch penalties on the first queries or not?

Best regards.
João Costa"
Amazon RDS	"Re: Modifying an Amazon RDS DB Instance and first-touch penalties
RDS Instance type modification does not require ""pre-warming"" the storage, since the storage volumes are reutilized and reattached to the new instance."
