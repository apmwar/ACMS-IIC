label	description
Amazon Elastic Beanstalk	"cannot ssh into eb environment - operation timed out
I created a VPC and then a subsequent Elastic Beanstalk environment.

I then did ""eb init -interactive"" to setup SSH.

I then did ""eb ssh --setup"" which terminated/recreated my eb environment and then allowed me to select keypair and instance to SSH into.

It then runs: 

ssh -i /Users/mac/.ssh/aws-eb ec2-user@ip-172-31-3-94.ec2.internal

which results in: 

ssh: Could not resolve hostname ip-172-31-3-94.ec2.internal: nodename nor servname provided, or not known

If I try to use Elastic IP of VPC then operation times out.

Any suggestions much appreciated."
Amazon Elastic Beanstalk	"Re: cannot ssh into eb environment - operation timed out
had to create bastion instance to SSH into VPC"
Amazon Elastic Beanstalk	"Unsuccessful command execution on instance id(s)
Hi
I have not been able to fix an instance. 
It all started when I added the next file in ebextension and deployed:
file: .ebextensions/supervisor.config
commands:
    03-install_supervisor:
        test: '[ ! /etc/supervisor ] && echo ""supervisor not installed""'
        command: pip install supervisor
 
    04-supervisor_conf:
        test: '[ ! /usr/local/bin/echo_supervisord_conf ] && echo ""supervisor not configured""'
        command: | 
            /usr/local/bin/echo_supervisord_conf
            echo_supervisord_conf > /etc/supervisord.conf
            cat .ebextensions/supervisor/laravel_queue.conf >> /etc/supervisord.conf
            mkdir -p ~/logs
            touch ~/logs/worker.log
            supervisord -c /etc/supervisord.conf
            supervisorctl reread
            supervisorctl update
            supervisorctl start laravel-worker:*
 
    05-supervisor-start:
        test: supervisorctl status | grep -oP STOPPED
        command: supervisorctl start laravel-worker:*

I deleted this file and deployed again, but this took a lot of time and the instance was not fixed.
I restart the server, took a lot of time again and not was fixed.
When I tried to get the log files the instance started to update, and I don't get them
I can access via ssh
Can someone help me?

Edited by: marco1 on Apr 12, 2019 3:42 PM"
Amazon Elastic Beanstalk	"cannot delete load balancer (and other resources)
doing:

aws elbv2 delete-load-balancer --load-balancer-arn arn:aws:elasticloadbalancing:us-east-1:687962234335:loadbalancer/net/awseb-AWSEB-13KYXMXRF8Y6Y/236f3fda538b822c

results in:

An error occurred (ResourceInUse) when calling the DeleteLoadBalancer operation: Load balancer 'arn:aws:elasticloadbalancing:us-east-1:687962234335:loadbalancer/net/awseb-AWSEB-13KYXMXRF8Y6Y/236f3fda538b822c' cannot be deleted because it is currently associated with another service

I am also unable to delete various other resources such as subnets, network interface and VPC. 

Admins - please help."
Amazon Elastic Beanstalk	"Elastic Beanstalk Caching Env. Variables and App is in an ""Invalid State""?
We have an application that is not updating the environment variables in Elastic Beanstalk. It seems to be caching them. Is this known behavior? We haven't experienced this previously so it seems like maybe a bug?

Additionally, the application shows as being in an ""ok"" state but when trying to change anything in the config (scaling up for example) it just says that the application is in an invalid state. How can I get it out of this? We are being billed for it but can't do anything to shut it off.

Attached is a screenshot of the invalid state message

Edited by: MKonpeak on Apr 11, 2019 10:34 AM"
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk Caching Env. Variables and App is in an ""Invalid State""?
Hi MKonpeak,

Sorry about the problem you are facing.

1. Do the logs show anything?
2. Is there anything obvious in the Beanstalk events tab indicating why the failure occurred?

`InvalidParameterValue` exceptions are typically generated by the Beanstalk service.

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk Caching Env. Variables and App is in an ""Invalid State""?
Hi Rahul-

The logs do show this:

2019-04-11T13:27:29.253Z DEBUG https://forums.aws.amazon.com/  : Using cached environment metadata.

That seems to confirm my suspicious about something in the env variables possibly being cached. We can see that a value in the console for an environment variable is not being loaded properly and it is instead using an old value from yesterday. We are getting billed on this currently and are looking for some way to get the app responsive and able to be worked with again. Right now it just keeps saying that it's in an invalid state.

Mark"
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk Caching Env. Variables and App is in an ""Invalid State""?
Thanks for your quick response.

Would it be possible to share extended information from your logs over Private Messaging? The message ""Using cached environment metadata."" might not necessarily refer to caching env. vars. 

Also, is there anything suspicious in the Events table? It is likely that a precise reason for failure is shown there.

Can you also tell me when you last attempted an update of your environment variables?

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk Caching Env. Variables and App is in an ""Invalid State""?
Hi Rahul-

Yes, that's possible. How can I share the logs with you? As I mentioned, we can't scale it down or do anything with it so this is fairly time and financially sensitive to us.

The events table says there were issues during launch but then a minute later it says: ""Environment health has transitioned from Info to Ok. Initialization completed 44 seconds ago and took 19 minutes.""

Thanks,
Mark"
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk Caching Env. Variables and App is in an ""Invalid State""?
Hi Mark,

Further down in the events list, you should see ""The following resource(s) failed to create: https://forums.aws.amazon.com/. "". I think that is is what caused you the problem. I've contacted the right person on the Beanstalk team to take a look.

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk Caching Env. Variables and App is in an ""Invalid State""?
Hi Mark, 

Please check your message inbox.

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Permission Denied Error in Django Web Application
I have deployed a Django project (MyProj) to Amazon beanstalk using the eb CLI. This project is physically located at ~/MyProj. It has an app, named myapp, which needs to execute external python scripts. For this purpose, I have my_launcher.py in ~/MyProj/myapp directory. A code snippet in my_launcher.py is:
import os 
import importlib
  
PROJECTS_DIR = os.path.join(os.path.expanduser(os.environ.get('LOCATION')), 'app/python/')  
 
MY_MODULE = os.path.join(PROJECTS_DIR, 'MyModule/my_script.py') 
spec = importlib.util.spec_from_file_location('my_script', My_MODULE) 
MyModule = importlib.util.module_from_spec(spec) 
spec.loader.exec_module(MyModule)

The reason for using the environment variable LOCATION is to dynamically set the location of external python scripts. I have defined this environment variable and some others through the AWS admin console under the Elastic Beanstalk section. In my example, I have:
LOCATION = '/home/ec2-user/company/'

This script fails at the last line with the error:
PermissionError at /myapp [Errno 13] Permission denied: '/home/ec2-user/company/app/python/MyModule/my_script.py'

The things I have done so far to no avail:

1. After reading many online pages (e.g., Django https://forums.aws.amazon.com/ Permission denied: '/var/www/media/animals/user_uploads' at Link: https://stackoverflow.com/questions/21797372/django-errno-13-permission-denied-var-www-media-animals-user-uploads), I thought the issue is Linux permissions (not related to Django) on the location where the executable python scripts are (i.e., /home/ec2-user/company/app/python/). For the sake of testing this hypothesis (even though I know it is a bad approach for production), I ran the command sudo chmod -R 777 company while being in /home/ec2-user directory. I redeployed the project and even rebooted the EC2 instance all together. This didn't help. 

2. I moved the company directory inside ~/MyProj/myapp (and updated the environment variable LOCATION on the server) thinking that the wsgi user does not have execution permission on any directory outside ~/MyProj/myapp. This didn't help.

3. Following the solution suggested in this AWS forum (at Link: https://forums.aws.amazon.com/thread.jspa?threadID=157423), I moved the company directory inside ~/MyProj/myapp and added the 00permissions.config file to the ~/MyProj/.ebextensions directory. I deployed the application after that and even rebooted the EC2 instance all together. This did not help either.
container_commands:
  01fix_permissions_dirs:
    command: ""find company/app/python -type d -exec chmod 777 {} ';'""
  02fix_permissions_files:
    command: ""find company/app/python -type f -exec chmod 777 {} ';'""

I really appreciate any help.
By the way, I am using python 3.6 and Django 2.1.7."
Amazon Elastic Beanstalk	"Error. Eb clone using BASH script
So, I'm trying to clone all our beanstalk environments and wrote a shell script which gets the environments using awscli and then make use of awsebcli to clone.

I loop thru the environment running the following code:
echo 1 | eb init ""${BEANSTALK_APPNAME}"" -r ""${AWS_REGION}"" --debug
eb use -r ""${AWS_REGION}"" ""${BEANSTALK_ENVNAME}""
eb clone ""${BEANSTALK_ENVNAME}"" -n ""${BEANSTALK_CLONE_ENVNAME}"" -r ""${AWS_REGION}"" --exact


I get some success cloning some environments however encounter errors cloning others. 

Running in debug mode I realise that the problem stems from the eb init stage which causes ERROR: NotFoundError - Environment ""BEANSTALK_ENVNAME"" not Found at the eb clone stage.

What am I doing wrong please? 

Below is a log sample from the eb init stage.
eb : Traceback (most recent call last):
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/ebcli/core/ebrun.py"", line 41, in run_app
    app.run()
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/cement/core/foundation.py"", line 797, in run
    return_val = self.controller._dispatch()
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/cement/core/controller.py"", line 472, in _dispatch
    return func()
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/cement/core/controller.py"", line 478, in _dispatch
    return func()
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/ebcli/core/abstractcontroller.py"", line 85, in default
    self.do_command()
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/ebcli/controllers/initialize.py"", line 203, in do_command
    io.validate_action(prompts['codecommit.usecc'], ""y"")
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/ebcli/core/io.py"", line 232, in validate_action
    result = get_input(output)
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/ebcli/core/io.py"", line 152, in get_input
    result = _get_input(output)
  File ""/usr/local/Cellar/aws-elasticbeanstalk/3.14.6/libexec/lib/python2.7/site-packages/ebcli/core/io.py"", line 158, in _get_input
    return input(output + ': ').strip()
EOFError: EOF when reading a line"
Amazon Elastic Beanstalk	"Re: Error. Eb clone using BASH script
Hi tuxan,

Thanks for reaching out.

1. From the stack trace on `eb init`, it appears that `eb` is waiting for user input. Passing the `--platform` to `eb init` should get you around that problem.

2. Note that there is no problem with your `eb clone ...` command per se, however, it is good practice to short-circuit command combinations using `&&` (i.e. -- `eb init ...` && `eb use ...` && `eb clone ...`), so that the first command that fails is the last to execute.

Please let me know if you encounter further problems.

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Re: Error. Eb clone using BASH script
Thank you Rahul.

Yes, I went with the short-circuited command combinations. Thought explicitly laying them out will make for clearer reading up here.

I ended up resolving the issue by creating a new directory for each environment and cloning from within the directory. After the clone I took out the directory and moved on to the next environment. Lots of IO... but just about all I could think of to get passed the problem.

It appeared that there was a lot of conflict/contention making use of the same .elasticbeanstalk/config.yml file in a single directory for all the environments being cloned and making use of different directories resolved it.

Thanks for your response.

Cheers."
Amazon Elastic Beanstalk	"Re: Error. Eb clone using BASH script
Thread creator has found a workaround to their problem."
Amazon Elastic Beanstalk	"Standard files when launching an EC2 instance
Hello.
I want to have a predefined httpd.conf file on every ec2 instance launched from elastic beanstalk.
From the docs. I got the following configured in my .elasticbeanstalk --> config.yml.
files:
  ""/etc/httpd/conf/httpd.conf"":
      user: root
      group: root
      mode: ""000644""
      source: https://s3.eu-central-1.amazonaws.com/...

But the above does not have any impact on the httpd.conf file when a new instance is launched. I have set the correct permissions for my s3 bucket.

Looking forward to hearing your ideas.!"
Amazon Elastic Beanstalk	"Re: Standard files when launching an EC2 instance
Does anyone have any ideas?
Thanks."
Amazon Elastic Beanstalk	"Re: Standard files when launching an EC2 instance
Are you trying to append the above code in your httpd.conf ?"
Amazon Elastic Beanstalk	"Re: Standard files when launching an EC2 instance
I have a whole httpd.conf file that I want to replace the default httpd.conf file

Edited by: Maltmax on Apr 11, 2019 2:56 AM"
Amazon Elastic Beanstalk	"Elastic Beanstalk doesn't run commands in the background
I created config file ""z.config"" in .ebextensions with the following in it:

container_commands: 
  00queue:
    command: ""nohup php /var/app/ondeck/artisan queue:work > text.out 2> error.err < /dev/null &"" 

The deployment process gets stuck for almost an hour, and after a while it redeploy itself again!! 
When SSHing to the EC2 I ran the command with no errors.

Is there any thing wrong with the syntax or Is there another way to run the command in the background without going to infinite deploying loop??

I tried also ""php /var/app/ondeck/artisan queue:work &"", ""php artisan queue:work &"", ""php artisan queue:work < /dev/null &""
None worked as expected.
I have other configurations and commands and they're working great except that one."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk doesn't run commands in the background
Any one ?!"
Amazon Elastic Beanstalk	"Application Load Balancer fon N Elastic Beanstalk Environment
Hi, does anyone know if it is possible to configure an ALB for N Elastic Beanstalk Environment?

Maybe through .ebextensions ....

Thank you."
Amazon Elastic Beanstalk	"Elastic Beanstalk environment does not terminate
Hi,

I have a Beanstalk environment (id: e-vnnpcfxsww) that I can't terminate. I tried it more than twelve hours ago and I've retried several times but it does not terminate. I get this messages in the events log but nothing happens: terminateEnvironment is starting.

How can I terminate this environment?"
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk environment does not terminate
Hi 1010010,

Thanks for reaching out. Which region is your environment in?

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk environment does not terminate
Hi,

It's in us-east-1."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk environment does not terminate
Thanks for getting back.

Can you verify your environment still exists? I am unable to find it.

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk environment does not terminate
Yes, the  environment with Environment ID: e-vnnpcfxsww still exists. It is grey and in ""Health status: Suspended""."
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk environment does not terminate
Sorry about the confusion. I am able to see your environment now.

It is hard to tell from the logs, but my guess is that the ASG group originally associated with your environment no longer exists or there is an extraneous target group associated with your environment. This is causing Beanstalk confusion, so it retries the termination process several times.

You can get around this problem as described here: https://forums.aws.amazon.com/thread.jspa?threadID=300949#jive-message-895822

Please let me know if that doesn't work.

Thanks,
Rahul.

Edited by: Rahul-AWS on Apr 9, 2019 7:40 PM"
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk environment does not terminate
Hi, 

It looks like it worked. It's still visible but it is in the ""Terminated"" state now."
Amazon Elastic Beanstalk	"Nginx 1.12 Retirement
Hi,

We received a notification for a couple of our beanstalk environments concerning the deprecation of the platform. Here is the notice:
AWS Elastic Beanstalk has detected you have active Elastic Beanstalk environments in US-EAST-1 that are running on a platform version with an upcoming retirement date of March 01, 2020. Elastic Beanstalk is retiring these platform versions containing Nginx 1.12 or earlier, which are marked end of life by its supplier. You can find more information about the upcoming retirement dates in the AWS Elastic Beanstalk Support Policy.[1]
 
* What do I need to do?
We recommend that you migrate your environments to the latest supported platform version as soon as possible. Your environments running on platform versions with a retirement date of March 01, 2020 in the US-EAST-1 Region are listed in the 'Affected Resources' tab.
 
* Why do I need to take an action?
Migrating to the latest supported platform version will benefit your application with important security, performance, and functionality enhancements. For more information about platform migration, see ""Updating Your Elastic Beanstalk Environment's Platform Version"" section of our documentation[2] in the AWS Elastic Beanstalk Developer Guide. 
 
* What will happen after March 01, 2020?
Starting March 01, 2020, you will no longer be able to create new Elastic Beanstalk environments using a retired platform version.
 
If you have any questions or concerns, you can contact the AWS Support Team on the community forums and via AWS Premium Support.[3]
 
[1] https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/platforms-support-policy.html
[2] https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.platform.upgrade.html
[3] https://aws.amazon.com/support


I looked at the concerned environments and I don't get it. We are running on docker environments and they are at the current latest platform: `Docker running on 64bit Amazon Linux/2.12.9`. Is it possible that the NGINX version is relative to the AMI configured under the `instance` settings? If ever I want to update that AMI, what AMI should I use?"
Amazon Elastic Beanstalk	"Re: Nginx 1.12 Retirement
Hi, I am still wondering what I should do with that piece of information! 

Am I the only one with that problem?"
Amazon Elastic Beanstalk	"Elastic Beanstalk has error with .NET Core files zipped on mac
I am having issues with Elastic Beanstalk and my .NET Core web service that I'm attempting to build and deploy from my mac.

I downloaded the dotnet-core-tutorial-bundle.zip from this page: https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/dotnet-core-tutorial.html and confirmed that I can upload and deploy this zip.

When I unzip that folder using Finder and rezip using Finder or the zip command line tool, the deployment fails with message ""Error during deployment: Application test-dotnet-core is missing web.config file.""

I downloaded the same zip on a Windows computer, unzipped using Explorer, and rezipped using Explorer and the deployment succeeds.

Does anyone know a way to zip on a mac that will make Elastic Beanstalk happy? I did find several tutorials and forum posts that indicated that the commands I am running to zip have worked in the past.

My zip script:
zip -r -X site.zip site/ 
zip my-service.zip site.zip aws-windows-deployment-manifest.json


Edited by: christis on Apr 9, 2019 4:16 AM"
Amazon Elastic Beanstalk	"Re: Elastic Beanstalk has error with .NET Core files zipped on mac
Mac's zip function was adding an extra site folder to my archive. This isn't the most beautiful script but it works.

dotnet publish -o site -c Release
cd site
zip -r -X ../site.zip .
cd ..
zip my-service.zip site.zip aws-windows-deployment-manifest.json


Edited by: christis on Apr 9, 2019 5:02 PM"
Amazon Elastic Beanstalk	"Error while uploading a flask application onto elastic beanstalk
I tried uploading a project onto elastic beanstalk but i am getting an error:

https://forums.aws.amazon.com/ Command failed on instance. Return code: 1 Output: (TRUNCATED)...) File ""/usr/lib64/python2.7/subprocess.py"", line 190, in check_call raise CalledProcessError(retcode, cmd) CalledProcessError: Command '/opt/python/run/venv/bin/pip install -r /opt/python/ondeck/app/requirements.txt' returned non-zero exit status 1. Hook /opt/elasticbeanstalk/hooks/appdeploy/pre/03deploy.py failed. For more detail, check /var/log/eb-activity.log using console or EB CLI.

eb-activity.log file:

/var/log/eb-activity.log

    running build_py
    creating build
    creating build/lib.linux-x86_64-3.6
    creating build/lib.linux-x86_64-3.6/implicit
    copying implicit/recommender_base.py -> build/lib.linux-x86_64-3.6/implicit
    copying implicit/nearest_neighbours.py -> build/lib.linux-x86_64-3.6/implicit
    copying implicit/__init__.py -> build/lib.linux-x86_64-3.6/implicit
    copying implicit/approximate_als.py -> build/lib.linux-x86_64-3.6/implicit
    copying implicit/utils.py -> build/lib.linux-x86_64-3.6/implicit
    copying implicit/als.py -> build/lib.linux-x86_64-3.6/implicit
    creating build/lib.linux-x86_64-3.6/implicit/cuda
    copying implicit/cuda/__init__.py -> build/lib.linux-x86_64-3.6/implicit/cuda
    creating build/lib.linux-x86_64-3.6/implicit/datasets
    copying implicit/datasets/million_song_dataset.py -> build/lib.linux-x86_64-3.6/implicit/datasets
    copying implicit/datasets/__init__.py -> build/lib.linux-x86_64-3.6/implicit/datasets
    copying implicit/datasets/lastfm.py -> build/lib.linux-x86_64-3.6/implicit/datasets
    copying implicit/datasets/reddit.py -> build/lib.linux-x86_64-3.6/implicit/datasets
    copying implicit/datasets/_download.py -> build/lib.linux-x86_64-3.6/implicit/datasets
    copying implicit/datasets/movielens.py -> build/lib.linux-x86_64-3.6/implicit/datasets
    copying implicit/datasets/sketchfab.py -> build/lib.linux-x86_64-3.6/implicit/datasets
    running build_ext
    building 'implicit._als' extension
    creating build/temp.linux-x86_64-3.6
    creating build/temp.linux-x86_64-3.6/implicit
    gcc -pthread -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/include/python3.6m -c implicit/_als.cpp -o build/temp.linux-x86_64-3.6/implicit/_als.o -Wno-unused-function -Wno-maybe-uninitialized -O3 -ffast-math -fopenmp -std=c++11
    gcc: error trying to exec 'cc1plus': execvp: No such file or directory
    error: command 'gcc' failed with exit status 1


    Failed building wheel for implicit
    Running setup.py clean for implicit
    Running setup.py bdist_wheel for sklearn: started
    Running setup.py bdist_wheel for sklearn: finished with status 'done'
    Stored in directory: /root/.cache/pip/wheels/76/03/bb/589d421d27431bcd2c6da284d5f2286c8e3b2ea3cf1594c074
    Running setup.py bdist_wheel for visitor: started
    Running setup.py bdist_wheel for visitor: finished with status 'done'
    Stored in directory: /root/.cache/pip/wheels/68/b0/a2/cc8c7cf94ca3d1088a7d2e27936c1e0da170e05f560973e8dd
  Successfully built Flask-Bootstrap sklearn visitor
  Failed to build implicit
  Installing collected packages: dominate, visitor, Flask-Bootstrap, numpy, scipy, tqdm, implicit, pytz, six, python-dateutil, pandas, scikit-learn, sklearn
    Running setup.py install for implicit: started
      Running setup.py install for implicit: finished with status 'error'
      Complete output from command /opt/python/run/venv/bin/python3.6 -u -c ""import setuptools, tokenize;__file__='/tmp/pip-build-0vg5ora6/implicit/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n', '\n');f.close();exec(compile(code, __file__, 'exec'))"" install --record /tmp/pip-p3cgxevr-record/install-record.txt --single-version-externally-managed --compile --install-headers /opt/python/run/venv/include/site/python3.6/implicit:
      WARNING:root:The nvcc binary could not be located in your $PATH. Either add it to your path, or set $CUDAHOME to enable CUDA extensions
      Failed to find CUDA toolkit. Building without GPU acceleration.
      running install
      running build
      running build_py
      creating build
      creating build/lib.linux-x86_64-3.6
      creating build/lib.linux-x86_64-3.6/implicit
      copying implicit/recommender_base.py -> build/lib.linux-x86_64-3.6/implicit
      copying implicit/nearest_neighbours.py -> build/lib.linux-x86_64-3.6/implicit
      copying implicit/__init__.py -> build/lib.linux-x86_64-3.6/implicit
      copying implicit/approximate_als.py -> build/lib.linux-x86_64-3.6/implicit
      copying implicit/utils.py -> build/lib.linux-x86_64-3.6/implicit
      copying implicit/als.py -> build/lib.linux-x86_64-3.6/implicit
      creating build/lib.linux-x86_64-3.6/implicit/cuda
      copying implicit/cuda/__init__.py -> build/lib.linux-x86_64-3.6/implicit/cuda
      creating build/lib.linux-x86_64-3.6/implicit/datasets
      copying implicit/datasets/million_song_dataset.py -> build/lib.linux-x86_64-3.6/implicit/datasets
      copying implicit/datasets/__init__.py -> build/lib.linux-x86_64-3.6/implicit/datasets
      copying implicit/datasets/lastfm.py -> build/lib.linux-x86_64-3.6/implicit/datasets
      copying implicit/datasets/reddit.py -> build/lib.linux-x86_64-3.6/implicit/datasets
      copying implicit/datasets/_download.py -> build/lib.linux-x86_64-3.6/implicit/datasets
      copying implicit/datasets/movielens.py -> build/lib.linux-x86_64-3.6/implicit/datasets
      copying implicit/datasets/sketchfab.py -> build/lib.linux-x86_64-3.6/implicit/datasets
      running build_ext
      building 'implicit._als' extension
      creating build/temp.linux-x86_64-3.6
      creating build/temp.linux-x86_64-3.6/implicit
      gcc -pthread -Wno-unused-result -Wsign-compare -DDYNAMIC_ANNOTATIONS_ENABLED=1 -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/include/python3.6m -c implicit/_als.cpp -o build/temp.linux-x86_64-3.6/implicit/_als.o -Wno-unused-function -Wno-maybe-uninitialized -O3 -ffast-math -fopenmp -std=c++11
      gcc: error trying to exec 'cc1plus': execvp: No such file or directory
      error: command 'gcc' failed with exit status 1


  Command ""/opt/python/run/venv/bin/python3.6 -u -c ""import setuptools, tokenize;__file__='/tmp/pip-build-0vg5ora6/implicit/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n', '\n');f.close();exec(compile(code, __file__, 'exec'))"" install --record /tmp/pip-p3cgxevr-record/install-record.txt --single-version-externally-managed --compile --install-headers /opt/python/run/venv/include/site/python3.6/implicit"" failed with error code 1 in /tmp/pip-build-0vg5ora6/implicit/
  You are using pip version 9.0.1, however version 19.0.3 is available.
  You should consider upgrading via the 'pip install --upgrade pip' command.
  2019-04-07 20:24:08,598 ERROR    Error installing dependencies: Command '/opt/python/run/venv/bin/pip install -r /opt/python/ondeck/app/requirements.txt' returned non-zero exit status 1
  Traceback (most recent call last):
    File ""/opt/elasticbeanstalk/hooks/appdeploy/pre/03deploy.py"", line 22, in main
      install_dependencies()
    File ""/opt/elasticbeanstalk/hooks/appdeploy/pre/03deploy.py"", line 18, in install_dependencies
      check_call('%s install -r %s' % (os.path.join(APP_VIRTUAL_ENV, 'bin', 'pip'), requirements_file), shell=True)
    File ""/usr/lib64/python2.7/subprocess.py"", line 190, in check_call
      raise CalledProcessError(retcode, cmd)
  CalledProcessError: Command '/opt/python/run/venv/bin/pip install -r /opt/python/ondeck/app/requirements.txt' returned non-zero exit status 1 (Executor::NonZeroExitStatus)

2019-04-07T20:24:08.607Z INFO  https://forums.aws.amazon.com/  - Application update myProj@5/AppDeployStage0/AppDeployPreHook/03deploy.py : Activity failed.
2019-04-07T20:24:08.607Z INFO  https://forums.aws.amazon.com/  - Application update myProj@5/AppDeployStage0/AppDeployPreHook : Activity failed.
2019-04-07T20:24:08.607Z INFO  https://forums.aws.amazon.com/  - Application update myProj@5/AppDeployStage0 : Activity failed.
2019-04-07T20:24:08.608Z INFO  https://forums.aws.amazon.com/  - Application update myProj@5 : Completed activity. Result:
  Application update - Command CMD-AppDeploy failed
2019-04-07T20:27:07.548Z INFO  https://forums.aws.amazon.com/  - https://forums.aws.amazon.com/ : Starting activity...
2019-04-07T20:27:07.548Z INFO  https://forums.aws.amazon.com/  - CMD-TailLogs/AddonsBefore : Starting activity...
2019-04-07T20:27:07.548Z INFO  https://forums.aws.amazon.com/  - CMD-TailLogs/AddonsBefore : Completed activity.
2019-04-07T20:27:07.549Z INFO  https://forums.aws.amazon.com/  - CMD-TailLogs/TailLogs : Starting activity...
2019-04-07T20:27:07.549Z INFO  https://forums.aws.amazon.com/  - CMD-TailLogs/TailLogs/TailLogs : Starting activity...

Any solution would be appreciated

Edited by: niwash on Apr 7, 2019 3:34 PM"
Amazon Elastic Beanstalk	"Re: Error while uploading a flask application onto elastic beanstalk
Try looking if all modules in requirements.txt versions are correct/exists by using pip freeze. I had the same error when I noticed I had modules like translate-language==0.1.0 in requirements.txt, after removing the modules that mismatched or didn't exist the deployment returned to normal"
Amazon Elastic Beanstalk	"Re: Error while uploading a flask application onto elastic beanstalk
requirements.txt

Click==7.0
dominate==2.3.5
Flask==1.0.2
Flask-Bootstrap==3.3.7.1
implicit==0.3.8
itsdangerous==1.1.0
Jinja2==2.10.1
MarkupSafe==1.1.1
numpy==1.16.2
pandas==0.24.2
python-dateutil==2.8.0
pytz==2018.9
scikit-learn==0.20.3
scipy==1.2.1
six==1.12.0
sklearn==0.0
tqdm==4.31.1
visitor==0.1.3
Werkzeug==0.15.2

I figured out the error is caused by implicit package >>implicit==0.3.8<<. I tried downgrading the version and deploying but still same error. It seems like the elastic bean is unable to install the implicit package. Is there any way i can manually install the package in my application environment?

Edited by: niwash on Apr 8, 2019 5:13 AM"
Amazon Elastic Beanstalk	"Re: Error while uploading a flask application onto elastic beanstalk
Hi niwash,

Thanks for reaching out.

The core of the problem is hinted at in the failure:

gcc: error trying to exec 'cc1plus': execvp: No such file or directory


Basically, EB is failing to compile certain C++ programs because support to compile C++ is missing. I think you should be able to get around this problem by adding the following snippet in a .ebextensions config file:

packages:
  yum:
    gcc-c++: []


Additionally, going by the discussion here: https://stackoverflow.com/questions/29516084/gcc-failed-during-pandas-build-on-aws-elastic-beanstalk, it is likely that you will also need to add `python-devel.x86_64` to the above `yum` list.

Documentation for setting .ebextensions is here: https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers-ec2.html#linux-packages-snippet

Thanks,
Rahul.

Edited by: Rahul-AWS on Apr 8, 2019 12:29 PM"
Amazon Elastic Beanstalk	"EB permission denied Erro 13
Trying to use ansible on a python web application(Flask), but ansible returns a permission denied error when trying to create a folder. How do you configure it so it has the permission to do so?

Error log:
https://gyazo.com/69cfc101360884b033ed89f6e1116714

Edited by: Savio on Apr 4, 2019 5:40 AM"
Amazon Elastic Beanstalk	"Re: EB permission denied Erro 13
configuring my instance to have same security group as my eb-env fixed the issue (instance config security group was on default and eb-env's was on a generated group)"
Amazon Elastic Beanstalk	"Started seeing timeouts on EBS this week
I've got a small JVM app running on EB.  It's been up (but sitting almost entirely idle) for months.  I could run ""eb deploy"" here and it would take my war file and get it running in production in a minute or two.

In the past week, I've started working on this project again, and it's been super unreliable, both in terms of deploying and running.  The exact same command line deployment will get to ""Deploying new version to instance(s)"", and then sit there for 10 minutes, and finally time out with:

""ERROR: TimeoutError - The EB CLI timed out after 10 minute(s). The operation might still be running. To keep viewing events, run 'eb events -f'. To set timeout duration, use '--timeout MINUTES'.""

I noticed it was using (I believe) ""Tomcat 8.5 with Java 8 running on 64bit Amazon Linux/3.0.2"", and the AWS console said there was a newer version available, so I clicked the button to upgrade to ""...Linux/3.1.2"", and that upgrade fixed it for a bit, and then the very next deploy went back to timing out.

When it's timing out, the public webpage gives an HTTP/504 (eventually).

The AWS Monitoring doesn't show any smoking guns.  All of the monitors look pretty normal (and mostly idle), except ""Environment Health"" which is always ""Severe"" now (what does that mean?).  The Events log simply says ""ERROR: Failed to deploy application"".  Trying to Request Logs in the console does nothing at all.

What could be going wrong with my instance, how do I fix it, and more importantly, how do I debug this sort of issue when it happens?  EBS is great when it works, but when it fails it's really not giving me much to go on.

Thanks."
Amazon Elastic Beanstalk	"Impossible to use the last SolutionStack for NodeJS deployment
Hi,

I am trying to use the solution stack name : ""64bit Amazon Linux 2018.03 v4.8.0 running Node.js"" but I get an error : ""No Solution Stack named '64bit Amazon Linux 2018.03 v4.8.0 running Node.js' found. (Service: AWSElasticBeanstalk; Status Code: 400; Error Code: InvalidParameterValue;""

However, I am using the last version of the stack ... it was working few weeks ago with the previous version. Can you help me ? I am in eu-west-1 region.

Thanks

Best regards"
Amazon Elastic Beanstalk	"Re: Impossible to use the last SolutionStack for NodeJS deployment
Hi thomasArioneo ,

Thanks for reaching out.

""64bit Amazon Linux 2018.03 v4.8.0 running Node.js"" does not exist in eu-west-1 through your account. To retrieve the set of solution stacks available at your disposal, you an execute the following AWS CLI command in your Bash shell:

aws elasticbeanstalk list-available-solution-stacks --region eu-west-1 | grep ""SolutionStackName.*Node.js""


For instance, when I run the above command, I see the following, among other, as being available:

""SolutionStackName"": ""64bit Amazon Linux 2018.03 v4.8.2 running Node.js"",

Thanks,
Rahul.

Edited by: Rahul-AWS on Apr 4, 2019 5:59 PM"
Amazon Elastic Beanstalk	"Unable to load Environments/Applications in EB managment console
Hi,
There is something bad on Elastic Beanstalk? I'm unable to see anything in the management console. No one of the environments/apps are being loaded."
Amazon Elastic Beanstalk	"Cloudformation: specify .ebextensions packages/commands/files/services
Hello,

I have a cloudformation template that I use to launch elasticbeanstalk application / environments.  I would like to move my .ebextensions/*.config files out of my applications project directory.   Is there a way to specify (with optionsettings/optionvalues).

For example, is there a way to define these settings in a cloudformation template for an elastic beanstalk environment:

packages:
  yum:
    newrelic-sysmond: []
  rpm:
    newrelic: http://yum.newrelic.com/pub/newrelic/el5/x86_64/newrelic-repo-5-3.noarch.rpm
commands:
  100_configure_new_relic_sysmond:
    command: ""/usr/sbin/nrsysmond-config --set license_key=mylicensekey
services:
  sysvinit:
    newrelic-sysmond:
      ensureRunning: true
      enabled: true


One reason I would like to do this is because of having to specify the license key in this file.  The commands: key in the .ebextensions file does not allow you to reference environment variables.  For example, I can't do this:

packages:
  yum:
    newrelic-sysmond: []
  rpm:
    newrelic: http://yum.newrelic.com/pub/newrelic/el5/x86_64/newrelic-repo-5-3.noarch.rpm
commands:
  100_configure_new_relic_sysmond:
    command: ""/usr/sbin/nrsysmond-config --set license_key={$MY_LICENCEKEY_ENV}
services:
  sysvinit:
    newrelic-sysmond:
      ensureRunning: true
      enabled: true


Also, I just want to have my application git repository clean of any elastic beanstalk specific extensions.  Is this possible to achieve these settings with a Cloudformation template?"
Amazon Elastic Beanstalk	"Re: Cloudformation: specify .ebextensions packages/commands/files/services
+1.  Did you ever find a resolution to this?"
Amazon Elastic Beanstalk	"Stuck in grey after reach the instance limit
Hi,

On ElasticBeanstalk we are in grey after reach limit instance.
We have request limit upgrade, that was accept. 
But we are always stuck in grey.
The service is working but we need to make some adjustement and we can't as long we are in grey mode.

After a lot of test, like remove all instance of the ElasticBeanstalk in EC2 by the Auto Scaling Groups, we had message ""Environment health has transitioned from RED to GREEN"" in Events, but Dashboard always stay grey in Health status.

Can someone help us please.

Environment ID: e-5srzt3bp9f 
Region : eu-west-1

Regards,

Renaud

Edited by: renaudba on Apr 4, 2019 5:03 AM"
Amazon Elastic Beanstalk	"Dockerized server gets 502 errors when under load
I have a server hosted in a Docker container in Elastic Beanstalk.  When the server is under load, the beanstalk returns 502 (Bad Gateway) errors, which I suspect is because nginx isn't getting a response from the application fast enough.  If this persists for too long though it seems like the beanstalk thinks the application is broken and just kills it permanently.  I have an update that happens once a day that lasts for ~10 min, and this seems to be enough to bring it down.  

Is there a setting I can adjust somewhere to change this timeout?




Edit



I have found the settings to change the time between health checks and the number of checks to change status.  Even with maxing these out, my server gets terminated and restarted, and on restart it tries to rebuild it's indexes, etc., which in turn takes long enough that my server is considered unresponsive and is restarted... 

This being the case.  I have decided that Elastic Beanstalk is not the right environment to run this service in.

Edited by: swallace on Apr 3, 2019 12:20 PM

Edited by: swallace on Apr 3, 2019 12:25 PM"
Amazon Elastic Beanstalk	"EC2 upgrade fails and rollsback
Hello,

I have been trying to upgrade an instance type for some time, but it becomes stuck at ""Still waiting for the following 1 instances to become healthy: (instance id)"". It has given a reason null for rollback once and then: Received 0 SUCCESS signal(s) out of 1. Unable to satisfy 100% MinSuccessfulInstancesPercent requirement, so I am not really sure what this means. My instance has never been healthy to begin with, but it was working fine (I still have to understand why is not healthy).

Could that be the reason?

Thanks.

Edited by: gzuniga on Apr 1, 2019 4:32 PM"
Amazon Elastic Beanstalk	"Re: EC2 upgrade fails and rollsback
Well, if anyone had this very same problem... well, yes. It was because it was never healthy. I deployed a WebSockets only server, so it was not handling any http requests over '/'. So elastic beanstalk would consider it dead because it was failing the health check. Once I created an end point, elastic beanstalk could request and get its 200 status code, I managed to upgrade my instance type."
Amazon Elastic Beanstalk	"Problem with environment 3.1.2  // registry.getTimeZone(""Europe/Berlin"");
Hi,

my application does not deploy on 3.1.2 anymore, the call 

registry.getTimeZone(""Europe/Berlin"");

returns null.

The EBS documentation stops at Java 8 mit Tomcat 8.5 Version 3.1.0, there is neither documentation vor 3.1.1 nor for 3.1.2."
Amazon Elastic Beanstalk	"Renamed an RDS, now can't fully terminate an EB instance
While trying to debug a database problem, I manually renamed the RDS created as part of an EB instance.  I eventually wanted to tear down the EB and start over, so I ran `eb terminate <env name>`.  I got an error talking about an inability to find the RDS under its old name, and then two more errors relating to failed security group deletions due to dependency violations.  The final error reads

Stack deletion failed: The following resource(s) failed to delete: AWSEBSecurityGroup, AWSEBRDSDatabase, AWSEBLoadBalancerSecurityGroup.

How can I terminate the dangling resources and finalize the termination of the EB instance?

Edited by: nbarnes on Mar 30, 2019 1:47 PM"
Amazon Elastic Beanstalk	"Re: Renamed an RDS, now can't fully terminate an EB instance
Hi nbarnes ,

Presently, the only way to terminate your environment is to first delete the underlying CloudFormation stack:

1. Go to the CloudFormation console.
2. From the list of stacks, find the stack that is associated with your environment.
3. Delete the particular CFN stack.
4. Go to the Elastic Beanstalk console.
5. Attempt to terminate the environment.

Please let me know if this doesn't work.

Thanks,
Rahul."
Amazon Elastic Beanstalk	"Re: Renamed an RDS, now can't fully terminate an EB instance
+1, worked like a charm.  Thanks."
Amazon Elastic Beanstalk	"First managed platform update for Windows to 2.0.2 fails with perm error
Our environments have been trying to update to the latest Windows platform version (2.0.2) and failing every time:

Creating Auto Scaling group named: awseb-e-xxx-immutable-stack-AWSEBAutoScalingGroup-xxx failed. Reason: API: autoscaling:EnableMetricsCollection User: arn:aws:sts::xxx:assumed-role/xxx-EBServiceRole-xxx/elasticbeanstalk is not authorized to perform: autoscaling:EnableMetricsCollection on resource: arn:aws:autoscaling:us-west-2:xxx:autoScalingGroup:xxx:autoScalingGroupName/awseb-e-xxx-immutable-stack-AWSEBAutoScalingGroup-xxx

Each environment has its own service role with these 2 policies:

arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkService
arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth

Neither of them have the autoscaling:EnableMetricsCollection permission. Is this something we have to add manually to the roles, or is this a bug in EB?"
Amazon Elastic Beanstalk	"Docker config isn't made available when pulling images (eb local run)
When I attempt to run `eb local run` I get a failure to pull from the docker repository we’re using:

$ eb local run 
time=""2019-03-30T08:07:43Z"" level=error msg=""Error retrieving credentials"" error=""ecr: Failed to get authorization token: UnrecognizedClientException: The security token included in the request is invalid.\n\tstatus code: 400, request id: e52e2417-52c2-11e9-b06e-b3fcb14e31db""
Error response from daemon: Get https://****.dkr.ecr.eu-west-1.amazonaws.com/v2/example/repo/manifests/latest: no basic auth credentials
ERROR: CommandError - None

The issue is that I need to set the AWS profile that should be used, so `AWS_PROFILE=myprofile eb local run` works fine. This was a little confusing because after setting up the eb environment all other eb commands (eg `eb ssh`) don’t require the profile to be manually set and looking in the config:

$ grep profile .elasticbeanstalk/config.yml 
 instance_profile: null
 profile: myprofile

shows that elaticbeanstalk knows which is the correct profile to use and this is why I don’t normally need to specify it. However for our deployment we are using the  https://github.com/awslabs/amazon-ecr-credential-helper  and I am guessing when the docker pull command is issued the AWS_PROFILE environmental variable isn’t set so the credentials helper doesn’t know which profile to use.

Would it be sensible to always set the AWS_PROFILE environmental variable when executing docker commands from eb?

NB: `eb local run --profile=myprofile` doesn’t fix it because it’s doing the same thing as the setting in the config file and doesn’t actually change the credentials that the helper ends up using."
